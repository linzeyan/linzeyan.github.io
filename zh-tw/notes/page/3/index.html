<!doctype html><html lang=zh-tw><head><title>Notes</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.bbe59c28ecd86b627aff7fb62bea93cefad0976023ffe8fdee3d61cad0f08f41.css integrity="sha256-u+WcKOzYa2J6/3+2K+qTzvrQl2Aj/+j97j1hytDwj0E="><link rel=icon type=image/png href=/images/site/highlight.svg><meta property="og:url" content="https://linzeyan.github.io/zh-tw/notes/"><meta property="og:site_name" content="Ricky"><meta property="og:title" content="Notes"><meta property="og:locale" content="zh_tw"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Notes"><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "27a0cd9f0e3b46909879cf99f7cc6878"}'></script><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-notes kind-section" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/zh-tw><img src=/images/site/highlight.svg id=logo alt=Logo>
Ricky</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/zh-tw#home>首頁</a></li><li class=nav-item><a class=nav-link href=/zh-tw#about>關於</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>更多的</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/zh-tw#skills>技能</a>
<a class=dropdown-item href=/zh-tw#experiences>經歷</a>
<a class=dropdown-item href=/zh-tw#education>學歷</a>
<a class=dropdown-item href=/zh-tw#projects>專案</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/zh-tw/posts>文章</a></li><li class=nav-item><a class=nav-link id=note-link href=/zh-tw/notes>筆記</a></li><li class=nav-item><a class=nav-link href=https://linzeyan.github.io/activities>活動</a></li><li class=nav-item><a class=nav-link href=https://linzeyan.github.io/running>跑步</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=languageSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="flag-icon flag-icon-tw"></span>
Chinese</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/notes><span class="flag-icon flag-icon-us"></span>
English
</a><a class="dropdown-item nav-link languages-item" href=/zh-tw/notes><span class="flag-icon flag-icon-tw"></span>
Chinese</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/highlight.svg class=d-none id=main-logo alt=Logo>
<img src=/images/site/highlight.svg class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/zh-tw/search><input type=text name=keyword placeholder=搜索 data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/zh-tw/notes data-filter=all>筆記</a></li><div class=subtree><li><i data-feather=plus-circle></i><a class=list-link href=/zh-tw/notes/aws/> AWS</a><ul><li><a class=list-link href=/zh-tw/notes/aws/command/ title=command>command</a></li><li><a class=list-link href=/zh-tw/notes/aws/configure/ title=configure>configure</a></li><li><a class=list-link href=/zh-tw/notes/aws/terraform/ title=terraform>terraform</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/zh-tw/notes/bash/> Bash</a><ul><li><a class=list-link href=/zh-tw/notes/bash/ansible/ title=ansible>ansible</a></li><li><a class=list-link href=/zh-tw/notes/bash/common/ title=common>common</a></li><li><a class=list-link href=/zh-tw/notes/bash/docker/ title=docker>docker</a></li><li><a class=list-link href=/zh-tw/notes/bash/file/ title=file>file</a></li><li><a class=list-link href=/zh-tw/notes/bash/git/ title=git>git</a></li><li><a class=list-link href=/zh-tw/notes/bash/gitlab/ title=gitlab>gitlab</a></li><li><a class=list-link href=/zh-tw/notes/bash/gpg/ title=gpg>gpg</a></li><li><a class=list-link href=/zh-tw/notes/bash/k8s/ title=k8s>k8s</a></li><li><a class=list-link href=/zh-tw/notes/bash/network/ title=network>network</a></li><li><a class=list-link href=/zh-tw/notes/bash/pandoc/ title=pandoc>pandoc</a></li><li><a class=list-link href=/zh-tw/notes/bash/redis/ title=redis>redis</a></li><li><a class=list-link href=/zh-tw/notes/bash/ssh/ title=ssh>ssh</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/zh-tw/notes/docs/> Docs</a><ul><li><a class=list-link href=/zh-tw/notes/docs/cloudflare/ title=cloudflare>cloudflare</a></li><li><a class=list-link href=/zh-tw/notes/docs/diagrams/ title=diagrams>diagrams</a></li><li><a class=list-link href=/zh-tw/notes/docs/docker/ title=docker>docker</a></li><li><a class=list-link href=/zh-tw/notes/docs/gitlab/ title=gitlab>gitlab</a></li><li><a class=list-link href=/zh-tw/notes/docs/linux/ title=linux>linux</a></li><li><a class=list-link href=/zh-tw/notes/docs/mermaid/ title=mermaid>mermaid</a></li><li><a class=list-link href=/zh-tw/notes/docs/network/ title=network>network</a></li><li><a class=list-link href=/zh-tw/notes/docs/nginx/ title=nginx>nginx</a></li><li><a class=list-link href=/zh-tw/notes/docs/vagrant/ title=vagrant>vagrant</a></li><li><a class=list-link href=/zh-tw/notes/docs/zabbix/ title=zabbix>zabbix</a></li></ul></li><li><a class=list-link href=/zh-tw/notes/elasticsearch/ title=Elasticsearch>Elasticsearch</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/zh-tw/notes/gcp/> GCP</a><ul><li><a class=list-link href=/zh-tw/notes/gcp/command/ title=command>command</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/zh-tw/notes/go/> Go</a><ul><li><a class=list-link href=/zh-tw/notes/go/libraries/ title=Libraries>Libraries</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/zh-tw/notes/go/questions/> Questions</a><ul><li><a class=list-link href=/zh-tw/notes/go/questions/array/ title=Array>Array</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/channel/ title=Channel>Channel</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/context/ title=Context>Context</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/defer/ title=Defer>Defer</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/goroutine/ title=Goroutine>Goroutine</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/interface/ title=Interface>Interface</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/iota/ title=Iota>Iota</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/json/ title=JSON>JSON</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/len/ title=Len>Len</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/map/ title=Map>Map</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/print/ title=Print>Print</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/race/ title=Race>Race</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/select/ title=Select>Select</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/slice/ title=Slice>Slice</a></li><li><a class=list-link href=/zh-tw/notes/go/questions/variable/ title=Variable>Variable</a></li></ul></li><li><a class=list-link href=/zh-tw/notes/go/snippet/ title=Snippet>Snippet</a></li><li><a class=list-link href=/zh-tw/notes/go/tools/ title=Tools>Tools</a></li></ul></li><li><a class=list-link href=/zh-tw/notes/input-method/ title=Input-Method>Input-Method</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class="content container-fluid" id=content><div class="container-fluid note-card-holder" id=note-card-holder><div class=note-card><div class=item><h5 class=note-title><span>Synology Active Backup for Bussiness backup task failed</span></h5><div class=card><div class=card-body><h6 id=due-to-ip-change-last-week>Due to IP change last week</h6><ol start=0><li>Firewall policy create NAS_to_ESXi。</li><li>虛擬機器 -> 任務清單 -> 刪除任務。</li><li>虛擬機器 -> VMware vSphere -> 管理 Hypervisor -> 刪除舊的 IP，新增新的 IP。</li></ol></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Set LACP for Synology NAS and NETGEAR switch</span></h5><div class=card><div class=card-body><h6 id=netgear>NETGEAR</h6><ol><li>Switching -> LAG -> LAG Configuration -> ch1 -> 41、42 -> Apply。</li><li>ch1 -> Description: NAS、LAG Type:LACP -> Apply。</li><li>Switching -> VLAN -> Port PVID Configuration -> g41、g42 PVID:99、VLAN Member:10-14,17-23,99,101、VLAN Tag:10-14,17-23,99,101 -> Apply。</li></ol><h6 id=synology>Synology</h6><ul><li>控制台 -> 網路 -> 網路介面 -> 新增 Bond。</li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Set NAT in FortiGate</span></h5><div class=card><div class=card-body><h5 id=1-政策物件---虛擬-ip---新增>1. 政策&物件 -> 虛擬 IP -> 新增</h5><ul><li>名稱: IT-VPN</li><li>介面: wan2</li><li>對外 IP: 0.0.0.0</li></ul><h6 id=埠號轉發>埠號轉發</h6><ul><li>協定: TCP</li><li>外部服務埠號: 19979</li><li>對應到埠號: 19979</li></ul><h5 id=2-政策物件---ipv4-政策>2. 政策&物件 -> IPv4 政策</h5><ol><li>From zone wan2 to zone Knowhow_Vlan</li><li>From any to IT-VPN</li></ol></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Juniper SRX 320</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 查看當前軟體版本號</span>
</span></span><span style=display:flex><span>show system software
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看系統啟動時間</span>
</span></span><span style=display:flex><span>show system uptime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看硬體板卡及序號</span>
</span></span><span style=display:flex><span>show chassis haredware
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看硬體板卡當前狀態</span>
</span></span><span style=display:flex><span>show chassis environment
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看主控板（RE）資源使用及狀態</span>
</span></span><span style=display:flex><span>show chassis routing-engine
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看當前防火牆併發會話數</span>
</span></span><span style=display:flex><span>show security flow session summary
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看當前防火牆具體併發會話</span>
</span></span><span style=display:flex><span>show security flow session
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 清除當前 session</span>
</span></span><span style=display:flex><span>clear security flow session all
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 檢查全域 ALG 開啟情況</span>
</span></span><span style=display:flex><span>show security alg status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查OID</span>
</span></span><span style=display:flex><span>show snmp mib walk decimal 1.3.6.1.2.1.2.2.1.2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定政策</span>
</span></span><span style=display:flex><span>set security policy zones from-zone to-zone
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看路由表</span>
</span></span><span style=display:flex><span>show route
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看 ARP 表</span>
</span></span><span style=display:flex><span>show arp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看系統日誌</span>
</span></span><span style=display:flex><span>show log messages
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看所有介面運行狀態</span>
</span></span><span style=display:flex><span>show interface terse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看介面運行細節資訊</span>
</span></span><span style=display:flex><span>show interface ge-x/y/z detail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 比較修改</span>
</span></span><span style=display:flex><span>show | compare rollback ?
</span></span><span style=display:flex><span>show | compare rollback <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看系統</span>
</span></span><span style=display:flex><span>show system
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看設定</span>
</span></span><span style=display:flex><span>show configuration
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 動態統計介面資料包轉發資訊</span>
</span></span><span style=display:flex><span>monitor interface ge-x/y/z
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 動態報文抓取（Tcpdump，類似 ScreenOS snoop命令）</span>
</span></span><span style=display:flex><span>monitor traffic interface ge-x/y/z
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Check port status</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># `(echo &gt;/dev/tcp/${host}/${port})`</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>echo &gt;/dev/tcp/192.168.57.24/80<span style=color:#f92672>)</span> &amp;&gt;/dev/null <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;open&#34;</span> <span style=color:#f92672>||</span> echo <span style=color:#e6db74>&#34;closed&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>timeout <span style=color:#ae81ff>1</span> bash -c <span style=color:#e6db74>&#39;&gt;/dev/tcp/192.168.57.24/80 &amp;&gt;/dev/null&#39;</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;open&#34;</span> <span style=color:#f92672>||</span> echo <span style=color:#e6db74>&#34;closed&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>timeout <span style=color:#ae81ff>1</span> bash -c <span style=color:#e6db74>&#39;&gt;/dev/tcp/192.168.57.24/80&#39;</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;open&#34;</span> <span style=color:#f92672>||</span> echo <span style=color:#e6db74>&#34;closed&#34;</span>
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Block subnets</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ip route add blackhole 192.168.0.0/24
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>map</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#75715e># map
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>map</span> $remote_addr $limit_key {
</span></span><span style=display:flex><span>    <span style=color:#f92672>35.229.201.209</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>default</span> $binary_remote_addr;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e># wss.conf
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>limit_req_zone</span> $limit_key <span style=color:#e6db74>zone=websocket:10m</span> <span style=color:#e6db74>rate=20r/s</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>limit_req_status</span> <span style=color:#ae81ff>499</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> = <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>limit_req</span> <span style=color:#e6db74>zone=websocket</span> <span style=color:#e6db74>nodelay</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>limit_req_log_level</span> <span style=color:#e6db74>warn</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>rewrite</span></h5><div class=card><div class=card-body><h6 id=1>1</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#75715e># https://localhost/img/nginx.svg can access /data/nginxconfig.io/src/static/nginx.svg
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/img</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>rewrite</span> <span style=color:#e6db74>&#39;^/img/(.*)</span>$&#39; <span style=color:#e6db74>/static/</span>$1;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/static</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/data/nginxconfig.io/src</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>index</span> <span style=color:#e6db74>nginx.svg</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h6 id=2>2</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#75715e># https://localhost/photo/nginx.svg can access /data/nginxconfig.io/src/static/nginx.svg
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/photo</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/data/nginxconfig.io/src</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>try_files</span> $uri <span style=color:#e6db74>/</span>$uri <span style=color:#e6db74>@pic</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>location</span> <span style=color:#e6db74>@pic</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>rewrite</span> <span style=color:#e6db74>&#39;^/photo/(.*)</span>$&#39; <span style=color:#e6db74>/static/</span>$1;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h6 id=3>3</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#75715e># remove prefix path and allow proxy_pass POST
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/upload/</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Real-IP</span> $remote_addr;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-For</span> $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/data/nginx/html</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e># Remove path
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>rewrite</span> <span style=color:#e6db74>^/upload/(.*)</span> <span style=color:#e6db74>/</span>$1  <span style=color:#e6db74>break</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>https://logo</span>$uri$is_args$args;
</span></span><span style=display:flex><span>    <span style=color:#75715e># Proxy_pass POST
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>proxy_http_version</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>.1</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Upgrade</span> $http_upgrade;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Connection</span> <span style=color:#e6db74>&#39;upgrade&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_cache_bypass</span> $http_upgrade;
</span></span><span style=display:flex><span>    <span style=color:#75715e>#proxy_redirect  https://logo/ /;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Real-IP</span> $remote_addr;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-For</span> $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/data/nginx/html</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>index</span>  <span style=color:#e6db74>index.html</span> <span style=color:#e6db74>index.htm</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>grafana behind nginx</span></h5><div class=card><div class=card-body><h6 id=serversslconf>server/ssl.conf</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>ssl_certificate</span>     <span style=color:#e6db74>/etc/ssl/go2cloudten.com.crt</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>ssl_certificate_key</span> <span style=color:#e6db74>/etc/ssl/go2cloudten.com.key</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>ssl_ciphers</span> <span style=color:#e6db74>&#34;EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH+aRSA+RC4:EECDH:EDH+aRSA:HIGH:!RC2:!RC4:!aNULL:!eNULL:!LOW:!IDEA:!DES:!TDES:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!EXPORT:!ANON&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>ssl_prefer_server_ciphers</span> <span style=color:#66d9ef>on</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>ssl_protocols</span> <span style=color:#e6db74>TLSv1.2</span> <span style=color:#e6db74>TLSv1.3</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>ssl_session_timeout</span> <span style=color:#ae81ff>50m</span>;
</span></span></code></pre></div><h6 id=serverproxyconf>server/proxy.conf</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>proxy_set_header</span> <span style=color:#e6db74>X-Real-IP</span> $remote_addr;
</span></span><span style=display:flex><span><span style=color:#66d9ef>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-For</span> $proxy_add_x_forwarded_for;
</span></span></code></pre></div><h6 id=grafanaconf>grafana.conf</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span>       <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span>  <span style=color:#e6db74>grafana-test.go2cloudten.com</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span>  <span style=color:#e6db74>grafana.go2cloudten.com</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>include</span> <span style=color:#e6db74>server/ssl.conf</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>include</span> <span style=color:#e6db74>server/proxy.conf</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>access_log</span>  <span style=color:#e6db74>logs/grafana.log</span> <span style=color:#e6db74>json</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>error_log</span>   <span style=color:#e6db74>logs/grafana.error.log</span> <span style=color:#e6db74>warn</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span>   <span style=color:#e6db74>http://grafana</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_connect_timeout</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_read_timeout</span> <span style=color:#ae81ff>700</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_send_timeout</span> <span style=color:#ae81ff>700</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Upgrade</span> $http_upgrade;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Connection</span> <span style=color:#e6db74>&#34;Upgrade&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>texlive</span></h5><div class=card><div class=card-body><ul><li>macOS</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># brew install textlive</span>
</span></span><span style=display:flex><span><span style=color:#75715e># npm i -g mermaid-filter</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Render mermaid</span>
</span></span><span style=display:flex><span>pandoc -F mermaid-filter -o readme.pdf readme.md
</span></span></code></pre></div><ul><li>Ubuntu</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># sudo apt install pandoc -y</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sudo apt-get -y install texlive-latex-recommended texlive-pictures texlive-latex-extra texlive-fonts-recommended</span>
</span></span><span style=display:flex><span><span style=color:#75715e># npm i -g mermaid-filter</span>
</span></span><span style=display:flex><span>pandoc -F mermaid-filter -o readme.pdf readme.md
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Install</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Ubuntu22.04</span>
</span></span><span style=display:flex><span>sudo add-apt-repository ppa:redislabs/redis
</span></span><span style=display:flex><span>sudo apt install redis-server
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Generate ssh key</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># RSA</span>
</span></span><span style=display:flex><span>ssh-keygen -m PEM -t rsa -b <span style=color:#ae81ff>4096</span> -C <span style=color:#e6db74>&#34;zeyanlin@outlook.com&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ED25519</span>
</span></span><span style=display:flex><span>ssh-keygen -t ed25519 -C <span style=color:#e6db74>&#34;dev&#34;</span> -f ~/.ssh/ed25519
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>ssh config</span></h5><div class=card><div class=card-body><pre tabindex=0><code class=language-sshconfig data-lang=sshconfig>Host private.example.com
  ProxyCommand /usr/local/bin/cloudflared access ssh --hostname %h
</code></pre></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Vagrantfile template</span></h5><div class=card><div class=card-body><h5 id=docker>docker</h5><ul><li><a href=/notes/docs/vagrant/files/docker/Vagrantfile>Nginx</a></li></ul><h5 id=hyperv>hyperv</h5><ul><li><a href=/notes/docs/vagrant/files/hyperv/Vagrantfile.CentOS7>CentOS7</a></li><li><a href=/notes/docs/vagrant/files/hyperv/Vagrantfile.Win2019>Win2019</a></li></ul><h5 id=virtualbox>virtualbox</h5><ul><li><a href=/notes/docs/vagrant/files/virtualbox/Vagrantfile>Vagrantfile</a></li></ul><h5 id=vmware>vmware</h5><ul><li><a href=/notes/docs/vagrant/files/vmware_fusion/Vagrantfile>Vagrantfile</a></li></ul><h5 id=multi>multi</h5><ul><li><a href=/notes/docs/vagrant/files/multi/Vagrantfile>Vagrantfile</a></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>others</span></h5><div class=card><div class=card-body><h5 id=common>common</h5><ul><li><a href=/notes/docs/vagrant/files/common/Vagrantfile>Vagrantfile</a></li></ul><h5 id=metasploitable3>Metasploitable3</h5><ul><li><a href=/notes/docs/vagrant/files/metasploitable3/Vagrantfile>Vagrantfile</a></li></ul></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>send alert</span></h5><div class=card><div class=card-body><ol><li>Use Webhook, Create Channel and Webhook in Mattermost, and put script to $(grep AlertScriptsPath /etc/zabbix/zabbix_server.conf).</li><li>Create Media types in Zabbix(Administration -> Medai types).</li><li>Add media to user(Administration -> Users -> Media).</li><li>Create action(Configuration -> Actions -> Trigger actions)。</li><li>Debug(Write log in script).<ol><li>Media types:<ol><li>PROBLEM:\nProblem started at {EVENT.TIME} on {EVENT.DATE}\n 問題: {EVENT.NAME}\n 主機: {HOST.NAME}\nSeverity: {EVENT.SEVERITY}\n 目前數值: {EVENT.OPDATA}\n 問題 ID: {EVENT.ID}\n{TRIGGER.URL}</li><li>RECOVERY:\nProblem has been resolved at {EVENT.RECOVERY.TIME} on {EVENT.RECOVERY.DATE}\n 問題: {EVENT.NAME}\n 持續時間: {EVENT.DURATION}\n 主機: {HOST.NAME}\nSeverity: {EVENT.SEVERITY}\n 問題 ID: {EVENT.ID}\n{TRIGGER.URL}</li></ol></li></ol></li></ol></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>zabbix server</span></h5><div class=card><div class=card-body><h6 id=etczabbixzabbix_serverconf>/etc/zabbix/zabbix_server.conf</h6><p>Zabbix Server perform high loading, and slow query. Increase ValueCacheSize solve this problem.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>LogFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>/var/log/zabbix/zabbix_server.log</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LogFileSize</span><span style=color:#f92672>=</span><span style=color:#e6db74>5</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PidFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>/var/run/zabbix/zabbix_server.pid</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SocketDir</span><span style=color:#f92672>=</span><span style=color:#e6db74>/var/run/zabbix</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DBHost</span><span style=color:#f92672>=</span><span style=color:#e6db74>localhost</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DBName</span><span style=color:#f92672>=</span><span style=color:#e6db74>zabbix_db</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DBUser</span><span style=color:#f92672>=</span><span style=color:#e6db74>zabbix_user</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DBPassword</span><span style=color:#f92672>=</span><span style=color:#e6db74>zabbix</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DBSocket</span><span style=color:#f92672>=</span><span style=color:#e6db74>/data/mysql/mysql.sock</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>StartPollers</span><span style=color:#f92672>=</span><span style=color:#e6db74>200</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>StartPreprocessors</span><span style=color:#f92672>=</span><span style=color:#e6db74>30</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>StartPollersUnreachable</span><span style=color:#f92672>=</span><span style=color:#e6db74>30</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>StartTrappers</span><span style=color:#f92672>=</span><span style=color:#e6db74>100</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>StartDiscoverers</span><span style=color:#f92672>=</span><span style=color:#e6db74>30</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SNMPTrapperFile</span><span style=color:#f92672>=</span><span style=color:#e6db74>/var/log/snmptrap/snmptrap.log</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CacheSize</span><span style=color:#f92672>=</span><span style=color:#e6db74>4G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>HistoryCacheSize</span><span style=color:#f92672>=</span><span style=color:#e6db74>2G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>HistoryIndexCacheSize</span><span style=color:#f92672>=</span><span style=color:#e6db74>2G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TrendCacheSize</span><span style=color:#f92672>=</span><span style=color:#e6db74>2G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ValueCacheSize</span><span style=color:#f92672>=</span><span style=color:#e6db74>24G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Timeout</span><span style=color:#f92672>=</span><span style=color:#e6db74>30</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>UnavailableDelay</span><span style=color:#f92672>=</span><span style=color:#e6db74>120</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>AlertScriptsPath</span><span style=color:#f92672>=</span><span style=color:#e6db74>/usr/lib/zabbix/alertscripts</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExternalScripts</span><span style=color:#f92672>=</span><span style=color:#e6db74>/usr/lib/zabbix/externalscripts</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LogSlowQueries</span><span style=color:#f92672>=</span><span style=color:#e6db74>3000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>StatsAllowedIP</span><span style=color:#f92672>=</span><span style=color:#e6db74>127.0.0.1</span>
</span></span></code></pre></div><h6 id=etcmycnf>/etc/my.cnf</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[client-server]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket</span><span style=color:#f92672>=</span><span style=color:#e6db74>/data/mysql/mysql.sock</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[mysqld]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket</span><span style=color:#f92672>=</span><span style=color:#e6db74>/data/mysql/mysql.sock</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>datadir</span><span style=color:#f92672>=</span><span style=color:#e6db74>/data/mysql</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>character_set_server</span><span style=color:#f92672>=</span><span style=color:#e6db74>utf8mb4</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>character_set_filesystem</span><span style=color:#f92672>=</span><span style=color:#e6db74>utf8</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_allowed_packet</span><span style=color:#f92672>=</span><span style=color:#e6db74>32M</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>event_scheduler</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>default_storage_engine</span><span style=color:#f92672>=</span><span style=color:#e6db74>innodb</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>open_files_limit</span><span style=color:#f92672>=</span><span style=color:#e6db74>65535</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_infile</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sysdate_is_now</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>back_log</span><span style=color:#f92672>=</span><span style=color:#e6db74>256</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##error log format</span>
</span></span><span style=display:flex><span><span style=color:#75715e># connection</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>interactive_timeout</span><span style=color:#f92672>=</span><span style=color:#e6db74>28800</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>wait_timeout</span><span style=color:#f92672>=</span><span style=color:#e6db74>28800</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>lock_wait_timeout</span><span style=color:#f92672>=</span><span style=color:#e6db74>28800</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>skip_name_resolve</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_connections</span><span style=color:#f92672>=</span><span style=color:#e6db74>2000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_user_connections</span><span style=color:#f92672>=</span><span style=color:#e6db74>1000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_connect_errors</span><span style=color:#f92672>=</span><span style=color:#e6db74>1000000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># table cache performance settings #</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>table_open_cache</span><span style=color:#f92672>=</span><span style=color:#e6db74>8192</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>table_definition_cache</span><span style=color:#f92672>=</span><span style=color:#e6db74>8192</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>table_open_cache_instances</span><span style=color:#f92672>=</span><span style=color:#e6db74>16</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># session memory settings #</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>read_buffer_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>131072</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>read_rnd_buffer_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>262144</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sort_buffer_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>262144</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tmp_table_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>67108864</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>join_buffer_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>8M</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>thread_cache_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>256</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># log settings #</span>
</span></span><span style=display:flex><span><span style=color:#75715e>###slow log  ###</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>slow_query_log</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log_queries_not_using_indexes</span><span style=color:#f92672>=</span><span style=color:#e6db74>0</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log_slow_admin_statements</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#log_slow_slave_statements = 1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log_throttle_queries_not_using_indexes</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>long_query_time</span><span style=color:#f92672>=</span><span style=color:#e6db74>0.5</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log_bin_trust_function_creators</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>###binlog ###</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>binlog_cache_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>32K</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_binlog_cache_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>1G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>max_binlog_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>2G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>expire_logs_days</span><span style=color:#f92672>=</span><span style=color:#e6db74>31</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log_slave_updates</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#binlog_format=STATEMENT</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>binlog_format</span><span style=color:#f92672>=</span><span style=color:#e6db74>ROW</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>slave_compressed_protocol</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># innodb settings #</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#innodb_data_file_path=ibdata1:4G;ibdata2:4G:autoextend</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_page_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>16384</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_buffer_pool_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>4G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_buffer_pool_instances</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_buffer_pool_load_at_startup</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_buffer_pool_dump_at_shutdown</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_lock_wait_timeout</span><span style=color:#f92672>=</span><span style=color:#e6db74>50</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_io_capacity</span><span style=color:#f92672>=</span><span style=color:#e6db74>100</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_io_capacity_max</span><span style=color:#f92672>=</span><span style=color:#e6db74>200</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_flush_neighbors</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_file_per_table</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_log_files_in_group</span><span style=color:#f92672>=</span><span style=color:#e6db74>3</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_log_file_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>2G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_log_buffer_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>33554432</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_purge_threads</span><span style=color:#f92672>=</span><span style=color:#e6db74>2</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_large_prefix</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_thread_concurrency</span><span style=color:#f92672>=</span><span style=color:#e6db74>64</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_print_all_deadlocks</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_strict_mode</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_sort_buffer_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>67108864</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_write_io_threads</span><span style=color:#f92672>=</span><span style=color:#e6db74>4</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_read_io_threads</span><span style=color:#f92672>=</span><span style=color:#e6db74>4</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_online_alter_log_max_size</span><span style=color:#f92672>=</span><span style=color:#e6db74>1G</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_open_files</span><span style=color:#f92672>=</span><span style=color:#e6db74>60000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_max_dirty_pages_pct</span><span style=color:#f92672>=</span><span style=color:#e6db74>75</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_adaptive_flushing</span><span style=color:#f92672>=</span><span style=color:#e6db74>on</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>innodb_flush_log_at_trx_commit</span><span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sync_binlog</span> <span style=color:#f92672>=</span><span style=color:#e6db74>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[mysqld_safe]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log-error</span><span style=color:#f92672>=</span><span style=color:#e6db74>/var/log/mariadb/mariadb.log</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># include *.cnf from the config directory</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>!includedir /etc/my.cnf.d</span>
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>array</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>a</span> <span style=color:#f92672>:=</span> [<span style=color:#ae81ff>5</span>]<span style=color:#66d9ef>int</span>{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>}
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>t</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>[<span style=color:#ae81ff>3</span>:<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>t</span>[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>A. 3</li><li>B. 4</li><li>C. compilation error</li></ul><details><summary>Answer</summary><pre><a href=https://go.dev/play/p/z3KqBXFXMm3 target=_blank>Try it</a>
<code>B
</code></pre></details></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>channel</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ch</span> <span style=color:#f92672>:=</span> make(<span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> &lt; <span style=color:#ae81ff>10</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>ch</span> <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>i</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>ch</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;close&#34;</span>)
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;a: &#34;</span>, <span style=color:#a6e22e>a</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}()
</span></span><span style=display:flex><span>	close(<span style=color:#a6e22e>ch</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;ok&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Sleep</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Second</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><details><summary>Answer</summary><pre><a href=https://go.dev/play/p/OtDbNbLE1cH target=_blank>Try it</a>
<code class=language-shell>ok
panic: send on closed channel
</code></pre></details></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>channel1</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> make(<span style=color:#66d9ef>chan</span> <span style=color:#66d9ef>int</span>)
</span></span><span style=display:flex><span>	close(<span style=color:#a6e22e>c</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>val</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&lt;-</span><span style=color:#a6e22e>c</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>val</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><details><summary>Answer</summary><pre><a href=https://go.dev/play/p/S9Juy0nlAvz target=_blank>Try it</a>
<code class=language-shell>0
</code></pre></details></div></div></div></div></div><div class=paginator><ul class="pagination pagination-default"><li class=page-item><a href=/zh-tw/notes/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/zh-tw/notes/page/2/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/zh-tw/notes/ aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/zh-tw/notes/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class="page-item active"><a aria-current=page aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/zh-tw/notes/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/zh-tw/notes/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/zh-tw/notes/page/4/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/zh-tw/notes/page/5/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>導覽列</h5><ul><li class=nav-item><a class=smooth-scroll href=https://linzeyan.github.io/zh-tw/#about>關於</a></li><li class=nav-item><a class=smooth-scroll href=https://linzeyan.github.io/zh-tw/#skills>技能</a></li><li class=nav-item><a class=smooth-scroll href=https://linzeyan.github.io/zh-tw/#experiences>經歷</a></li><li class=nav-item><a class=smooth-scroll href=https://linzeyan.github.io/zh-tw/#education>學歷</a></li><li class=nav-item><a class=smooth-scroll href=https://linzeyan.github.io/zh-tw/#projects>專案</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>聯絡方式:</h5><ul><li><a href=mailto:zeyanlin@outlook.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>zeyanlin@outlook.com</span></a></li><li><a href=https://github.com/linzeyan target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>linzeyan</span></a></li><li><a href=https://line.me/ti/p/m7ME9ChZXV target=_blank rel=noopener><span><i class="fab fa-fab fa-line"></i></span> <span>Ricky</span></a></li><li><a href=https://www.strava.com/athletes/rickylin target=_blank rel=noopener><span><i class="fab fa-fab fa-strava"></i></span> <span>Ricky</span></a></li><li><a href=https://t.me/ricky_lin target=_blank rel=noopener><span><i class="fab fa-fab fa-telegram"></i></span> <span>Ricky</span></a></li></ul></div></div></div></footer><script src=/application.15bb2ca4ca8a5e8802639ac47416296518da80750faab642e748d8146859214e.js integrity="sha256-FbsspMqKXogCY5rEdBYpZRjagHUPqrZC50jYFGhZIU4=" defer></script></body></html>